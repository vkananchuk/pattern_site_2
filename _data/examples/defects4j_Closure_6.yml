---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: TypeValidator
        children: []
        pos: 2521
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 2540
          length: 40
        - type: field_declaration
          fields:
            text: private final JSTypeRegistry typeRegistry;
          children: []
          pos: 2583
          length: 42
        - type: field_declaration
          fields:
            text: private final JSType allValueTypes;
          children: []
          pos: 2628
          length: 35
        - type: field_declaration
          fields:
            text: private boolean shouldReport = true;
          children: []
          pos: 2666
          length: 36
        - type: field_declaration
          fields:
            text: private final JSType nullOrUndefined;
          children: []
          pos: 2705
          length: 37
        - type: field_declaration
          fields:
            text: private final List<TypeMismatch> mismatches = Lists.newArrayList();
          children: []
          pos: 2957
          length: 67
        - type: field_declaration
          fields:
            text: |-
              private static final String FOUND_REQUIRED =
                    "{0}\n" +
                    "found   : {1}\n" +
                    "required: {2}";
          children: []
          pos: 3047
          length: 109
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType INVALID_CAST =
                    DiagnosticType.warning("JSC_INVALID_CAST",
                        "invalid cast - must be a subtype or supertype\n" +
                        "from: {0}\n" +
                        "to  : {1}");
          children: []
          pos: 3160
          length: 203
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType TYPE_MISMATCH_WARNING =
                    DiagnosticType.warning(
                        "JSC_TYPE_MISMATCH",
                        "{0}");
          children: []
          pos: 3367
          length: 130
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType MISSING_EXTENDS_TAG_WARNING =
                    DiagnosticType.warning(
                        "JSC_MISSING_EXTENDS_TAG",
                        "Missing @extends tag on type {0}");
          children: []
          pos: 3501
          length: 171
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType DUP_VAR_DECLARATION =
                    DiagnosticType.warning("JSC_DUP_VAR_DECLARATION",
                        "variable {0} redefined with type {1}, " +
                        "original definition at {2}:{3} with type {4}");
          children: []
          pos: 3676
          length: 217
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType HIDDEN_PROPERTY_MISMATCH =
                    DiagnosticType.warning("JSC_HIDDEN_PROPERTY_MISMATCH",
                        "mismatch of the {0} property type and the type " +
                        "of the property it overrides from superclass {1}\n" +
                        "original: {2}\n" +
                        "override: {3}");
          children: []
          pos: 3897
          length: 300
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType INTERFACE_METHOD_NOT_IMPLEMENTED =
                    DiagnosticType.warning(
                        "JSC_INTERFACE_METHOD_NOT_IMPLEMENTED",
                        "property {0} on interface {1} is not implemented by type {2}");
          children: []
          pos: 4201
          length: 217
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType HIDDEN_INTERFACE_PROPERTY_MISMATCH =
                    DiagnosticType.warning(
                      "JSC_HIDDEN_INTERFACE_PROPERTY_MISMATCH",
                      "mismatch of the {0} property type and the type " +
                      "of the property it overrides from interface {1}\n" +
                      "original: {2}\n" +
                      "override: {3}");
          children: []
          pos: 4422
          length: 320
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType UNKNOWN_TYPEOF_VALUE =
                    DiagnosticType.warning("JSC_UNKNOWN_TYPEOF_VALUE", "unknown type: {0}");
          children: []
          pos: 4746
          length: 129
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType ILLEGAL_PROPERTY_ACCESS =
                    DiagnosticType.warning("JSC_ILLEGAL_PROPERTY_ACCESS",
                                           "Cannot do {0} access on a {1}");
          children: []
          pos: 4879
          length: 176
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticGroup ALL_DIAGNOSTICS = new DiagnosticGroup(
                    INVALID_CAST,
                    TYPE_MISMATCH_WARNING,
                    MISSING_EXTENDS_TAG_WARNING,
                    DUP_VAR_DECLARATION,
                    HIDDEN_PROPERTY_MISMATCH,
                    INTERFACE_METHOD_NOT_IMPLEMENTED,
                    HIDDEN_INTERFACE_PROPERTY_MISMATCH,
                    UNKNOWN_TYPEOF_VALUE,
                    ILLEGAL_PROPERTY_ACCESS);
          children: []
          pos: 5059
          length: 352
        - type: constructor_declaration
          fields:
            text: |-
              TypeValidator(AbstractCompiler compiler) {
                  this.compiler = compiler;
                  this.typeRegistry = compiler.getTypeRegistry();
                  this.allValueTypes = typeRegistry.createUnionType(
                      STRING_TYPE, NUMBER_TYPE, BOOLEAN_TYPE, NULL_TYPE, VOID_TYPE);
                  this.nullOrUndefined = typeRegistry.createUnionType(
                      NULL_TYPE, VOID_TYPE);
                }
          children: []
          pos: 5415
          length: 342
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMismatches
              children: []
              pos: 5977
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5954
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return mismatches;
                children: []
                pos: 5999
                length: 18
              pos: 5993
              length: 28
          children: []
          pos: 5954
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setShouldReport
              children: []
              pos: 6030
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: boolean report
                children: []
                pos: 6046
                length: 14
              pos: 6025
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.shouldReport = report;
                children: []
                pos: 6068
                length: 27
              pos: 6062
              length: 37
          children: []
          pos: 6025
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectValidTypeofName
              children: []
              pos: 6347
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 6369
                length: 15
              pos: 6342
              length: 148
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: report(JSError.make(t.getSourceName(), n, UNKNOWN_TYPEOF_VALUE,
                    found));
                children: []
                pos: 6414
                length: 72
              pos: 6408
              length: 82
          children: []
          pos: 6342
          length: 148
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectObject
              children: []
              pos: 6761
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 6774
                length: 15
              pos: 6753
              length: 205
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesObjectContext()"
                        children: []
                        pos: 6834
                        length: 28
                    children: []
                    pos: 6833
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, OBJECT_TYPE);
                    children: []
                    pos: 6872
                    length: 39
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 6918
                    length: 13
                  pos: 6864
                  length: 73
                pos: 6830
                length: 107
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 6942
                length: 12
              pos: 6824
              length: 134
          children: []
          pos: 6753
          length: 205
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectActualObject
              children: []
              pos: 7091
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7110
                length: 15
              pos: 7086
              length: 159
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.isObject()"
                        children: []
                        pos: 7170
                        length: 16
                    children: []
                    pos: 7169
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, OBJECT_TYPE);
                    children: []
                    pos: 7196
                    length: 39
                  pos: 7188
                  length: 53
                pos: 7166
                length: 75
              pos: 7160
              length: 85
          children: []
          pos: 7086
          length: 159
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectAnyObject
              children: []
              pos: 7416
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7432
                length: 15
              pos: 7411
              length: 253
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSType anyObjectType = getNativeType(NO_OBJECT_TYPE);
                children: []
                pos: 7488
                length: 53
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!anyObjectType.isSubtype(type)"
                            children: []
                            pos: 7550
                            length: 30
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.isEmptyType()"
                            children: []
                            pos: 7584
                            length: 19
                        children: []
                        pos: 7550
                        length: 53
                    children: []
                    pos: 7549
                    length: 55
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, anyObjectType);
                    children: []
                    pos: 7613
                    length: 41
                  pos: 7605
                  length: 55
                pos: 7546
                length: 114
              pos: 7482
              length: 182
          children: []
          pos: 7411
          length: 253
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectString
              children: []
              pos: 7857
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7870
                length: 15
              pos: 7852
              length: 165
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesStringContext()"
                        children: []
                        pos: 7930
                        length: 28
                    children: []
                    pos: 7929
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, STRING_TYPE);
                    children: []
                    pos: 7968
                    length: 39
                  pos: 7960
                  length: 53
                pos: 7926
                length: 87
              pos: 7920
              length: 97
          children: []
          pos: 7852
          length: 165
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectNumber
              children: []
              pos: 8210
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 8223
                length: 15
              pos: 8205
              length: 165
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesNumberContext()"
                        children: []
                        pos: 8283
                        length: 28
                    children: []
                    pos: 8282
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, NUMBER_TYPE);
                    children: []
                    pos: 8321
                    length: 39
                  pos: 8313
                  length: 53
                pos: 8279
                length: 87
              pos: 8273
              length: 97
          children: []
          pos: 8205
          length: 165
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectBitwiseable
              children: []
              pos: 8585
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 8603
                length: 15
              pos: 8580
              length: 206
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.matchesNumberContext()"
                            children: []
                            pos: 8663
                            length: 28
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.isSubtype(allValueTypes)"
                            children: []
                            pos: 8695
                            length: 30
                        children: []
                        pos: 8663
                        length: 62
                    children: []
                    pos: 8662
                    length: 64
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, allValueTypes);
                    children: []
                    pos: 8735
                    length: 41
                  pos: 8727
                  length: 55
                pos: 8659
                length: 123
              pos: 8653
              length: 133
          children: []
          pos: 8580
          length: 206
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectStringOrNumber
              children: []
              pos: 9001
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 9029
                length: 15
              pos: 8996
              length: 214
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.matchesNumberContext()"
                            children: []
                            pos: 9089
                            length: 28
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.matchesStringContext()"
                            children: []
                            pos: 9121
                            length: 28
                        children: []
                        pos: 9089
                        length: 60
                    children: []
                    pos: 9088
                    length: 62
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, NUMBER_STRING);
                    children: []
                    pos: 9159
                    length: 41
                  pos: 9151
                  length: 55
                pos: 9085
                length: 121
              pos: 9079
              length: 131
          children: []
          pos: 8996
          length: 214
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectNotNullOrUndefined
              children: []
              pos: 9552
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 9584
                length: 15
              pos: 9544
              length: 923
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!type.isNoType()"
                                    children: []
                                    pos: 9665
                                    length: 16
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!type.isUnknownType()"
                                    children: []
                                    pos: 9685
                                    length: 21
                                children: []
                                pos: 9665
                                length: 41
                              right:
                                type: method_invocation
                                fields:
                                  text: type.isSubtype(nullOrUndefined)
                                children: []
                                pos: 9718
                                length: 31
                            children: []
                            pos: 9665
                            length: 84
                          right:
                            type: unary_expression
                            fields:
                              text: "!containsForwardDeclaredUnresolvedName(type)"
                            children: []
                            pos: 9761
                            length: 44
                        children: []
                        pos: 9665
                        length: 140
                    children: []
                    pos: 9664
                    length: 142
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: n.isGetProp()
                                    children: []
                                    pos: 10274
                                    length: 13
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!t.inGlobalScope()"
                                    children: []
                                    pos: 10301
                                    length: 18
                                children: []
                                pos: 10274
                                length: 45
                              right:
                                type: method_invocation
                                fields:
                                  text: type.isNullType()
                                children: []
                                pos: 10323
                                length: 17
                            children: []
                            pos: 10274
                            length: 66
                        children: []
                        pos: 10273
                        length: 68
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return true;
                        children: []
                        pos: 10352
                        length: 12
                      pos: 10342
                      length: 30
                    pos: 10270
                    length: 102
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, expectedType);
                    children: []
                    pos: 10380
                    length: 40
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 10427
                    length: 13
                  pos: 9807
                  length: 639
                pos: 9661
                length: 785
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 10451
                length: 12
              pos: 9655
              length: 812
          children: []
          pos: 9544
          length: 923
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containsForwardDeclaredUnresolvedName
              children: []
              pos: 10487
              length: 37
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType type
                children: []
                pos: 10525
                length: 11
              pos: 10471
              length: 310
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: type.isUnionType()
                        children: []
                        pos: 10548
                        length: 18
                    children: []
                    pos: 10547
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: enhanced_for_statement
                    fields:
                      text: |-
                        for (JSType alt : type.toMaybeUnionType().getAlternates()) {
                                if (containsForwardDeclaredUnresolvedName(alt)) {
                                  return true;
                                }
                              }
                    children: []
                    pos: 10576
                    length: 159
                  pos: 10568
                  length: 173
                pos: 10544
                length: 197
              - type: return_statement
                fields:
                  text: return type.isNoResolvedType();
                children: []
                pos: 10746
                length: 31
              pos: 10538
              length: 243
          children: []
          pos: 10471
          length: 310
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectSwitchMatchesCase
              children: []
              pos: 10895
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 10919
                length: 15
              pos: 10890
              length: 627
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!switchType.canTestForShallowEqualityWith(caseType)"
                            children: []
                            pos: 11228
                            length: 51
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: caseType.autoboxesTo()
                                        children: []
                                        pos: 11292
                                        length: 22
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 11318
                                        length: 4
                                    children: []
                                    pos: 11292
                                    length: 30
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!caseType.autoboxesTo().isSubtype(switchType)"
                                    children: []
                                    pos: 11338
                                    length: 45
                                children: []
                                pos: 11292
                                length: 91
                            children: []
                            pos: 11291
                            length: 93
                        children: []
                        pos: 11228
                        length: 156
                    children: []
                    pos: 11227
                    length: 158
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        mismatch(t, n.getFirstChild(),
                                  "case expression doesn't match switch",
                                  caseType, switchType);
                    children: []
                    pos: 11394
                    length: 113
                  pos: 11386
                  length: 127
                pos: 11224
                length: 289
              pos: 10986
              length: 531
          children: []
          pos: 10890
          length: 627
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectIndexMatch
              children: []
              pos: 11916
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 11933
                length: 15
              pos: 11911
              length: 1157
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Preconditions.checkState(n.isGetElem());
                children: []
                pos: 12022
                length: 40
              - type: local_variable_declaration
                fields:
                  text: Node indexNode = n.getLastChild();
                children: []
                pos: 12067
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: objType.isStruct()
                        children: []
                        pos: 12110
                        length: 18
                    children: []
                    pos: 12109
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        report(JSError.make(t.getSourceName(), indexNode,
                                                  ILLEGAL_PROPERTY_ACCESS, "'[]'", "struct"));
                    children: []
                    pos: 12138
                    length: 120
                  pos: 12130
                  length: 134
                pos: 12106
                length: 158
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: objType.isUnknownType()
                        children: []
                        pos: 12273
                        length: 23
                    children: []
                    pos: 12272
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: expectStringOrNumber(t, indexNode, indexType, "property
                        access");
                    children: []
                    pos: 12306
                    length: 65
                  pos: 12298
                  length: 79
                pos: 12269
                length: 795
              pos: 12016
              length: 1052
          children: []
          pos: 11911
          length: 1157
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanAssignToPropertyOf
              children: []
              pos: 13573
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 13601
                length: 15
              pos: 13565
              length: 946
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!leftType.isNoType()"
                            children: []
                            pos: 13766
                            length: 20
                          right:
                            type: unary_expression
                            fields:
                              text: "!rightType.canAssignTo(leftType)"
                            children: []
                            pos: 13790
                            length: 32
                        children: []
                        pos: 13766
                        length: 56
                    children: []
                    pos: 13765
                    length: 58
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JSType ownerType = getJSType(owner);
                    children: []
                    pos: 13996
                    length: 36
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: ownerType.isFunctionPrototypeType()
                            children: []
                            pos: 14043
                            length: 35
                        children: []
                        pos: 14042
                        length: 37
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: FunctionType ownerFn = ownerType.toObjectType().getOwnerFunction();
                        children: []
                        pos: 14090
                        length: 67
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: and
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: ownerFn.isInterface()
                                        children: []
                                        pos: 14170
                                        length: 21
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: rightType.isFunctionType()
                                        children: []
                                        pos: 14207
                                        length: 26
                                    children: []
                                    pos: 14170
                                    length: 63
                                  right:
                                    type: method_invocation
                                    fields:
                                      text: leftType.isFunctionType()
                                    children: []
                                    pos: 14237
                                    length: 25
                                children: []
                                pos: 14170
                                length: 92
                            children: []
                            pos: 14169
                            length: 94
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return true;
                            children: []
                            pos: 14276
                            length: 12
                          pos: 14264
                          length: 34
                        pos: 14166
                        length: 132
                      pos: 14080
                      length: 226
                    pos: 14039
                    length: 267
                  - type: expression_statement
                    fields:
                      text: |-
                        mismatch(t, n,
                                  "assignment to property " + propName + " of " +
                                  getReadableJSTypeName(owner, true),
                                  rightType, leftType);
                    children: []
                    pos: 14314
                    length: 150
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 14471
                    length: 13
                  pos: 13824
                  length: 666
                pos: 13762
                length: 728
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 14495
                length: 12
              pos: 13696
              length: 815
          children: []
          pos: 13565
          length: 946
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanAssignTo
              children: []
              pos: 14961
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 14979
                length: 15
              pos: 14953
              length: 244
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!rightType.canAssignTo(leftType)"
                        children: []
                        pos: 15067
                        length: 32
                    children: []
                    pos: 15066
                    length: 34
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, rightType, leftType);
                    children: []
                    pos: 15109
                    length: 41
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 15157
                    length: 13
                  pos: 15101
                  length: 75
                pos: 15063
                length: 113
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 15181
                length: 12
              pos: 15057
              length: 140
          children: []
          pos: 14953
          length: 244
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectArgumentMatchesParameter
              children: []
              pos: 15645
              length: 30
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 15676
                length: 15
              pos: 15640
              length: 419
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!argType.canAssignTo(paramType)"
                        children: []
                        pos: 15779
                        length: 31
                    children: []
                    pos: 15778
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        mismatch(t, n,
                                  String.format("actual parameter %d of %s does not match " +
                                      "formal parameter", ordinal,
                                      getReadableJSTypeName(callNode.getFirstChild(), false)),
                                  argType, paramType);
                    children: []
                    pos: 15820
                    length: 229
                  pos: 15812
                  length: 243
                pos: 15775
                length: 280
              pos: 15769
              length: 290
          children: []
          pos: 15640
          length: 419
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanOverride
              children: []
              pos: 16553
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 16571
                length: 15
              pos: 16548
              length: 419
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!overridingType.canAssignTo(hiddenType)"
                        children: []
                        pos: 16693
                        length: 39
                    children: []
                    pos: 16692
                    length: 41
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(overridingType, hiddenType,
                                  report(t.makeError(n, HIDDEN_PROPERTY_MISMATCH, propertyName,
                                    ownerType.toString(), hiddenType.toString(),
                                    overridingType.toString())));
                    children: []
                    pos: 16742
                    length: 215
                  pos: 16734
                  length: 229
                pos: 16689
                length: 274
              pos: 16683
              length: 284
          children: []
          pos: 16548
          length: 419
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectSuperType
              children: []
              pos: 17262
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 17278
                length: 15
              pos: 17257
              length: 978
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: FunctionType subCtor = subObject.getConstructor();
                children: []
                pos: 17361
                length: 50
              - type: local_variable_declaration
                fields:
                  text: ObjectType implicitProto = subObject.getImplicitPrototype();
                children: []
                pos: 17416
                length: 60
              - type: local_variable_declaration
                fields:
                  text: |-
                    ObjectType declaredSuper =
                            implicitProto == null ? null : implicitProto.getImplicitPrototype();
                children: []
                pos: 17481
                length: 103
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: declaredSuper
                                    children: []
                                    pos: 17593
                                    length: 13
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 17610
                                    length: 4
                                children: []
                                pos: 17593
                                length: 21
                              right:
                                type: unary_expression
                                fields:
                                  text: "!(superObject instanceof UnknownType)"
                                children: []
                                pos: 17626
                                length: 37
                            children: []
                            pos: 17593
                            length: 70
                          right:
                            type: unary_expression
                            fields:
                              text: "!declaredSuper.isEquivalentTo(superObject)"
                            children: []
                            pos: 17675
                            length: 42
                        children: []
                        pos: 17593
                        length: 124
                    children: []
                    pos: 17592
                    length: 126
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: declaredSuper.isEquivalentTo(getNativeType(OBJECT_TYPE))
                            children: []
                            pos: 17731
                            length: 56
                        children: []
                        pos: 17730
                        length: 58
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: |-
                            registerMismatch(superObject, declaredSuper, report(
                                        t.makeError(n, MISSING_EXTENDS_TAG_WARNING, subObject.toString())));
                        children: []
                        pos: 17799
                        length: 133
                      pos: 17789
                      length: 151
                    pos: 17727
                    length: 366
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!subCtor.hasCachedValues()"
                            children: []
                            pos: 18138
                            length: 26
                        children: []
                        pos: 18137
                        length: 28
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: subCtor.setPrototypeBasedOn(superObject);
                        children: []
                        pos: 18176
                        length: 41
                      pos: 18166
                      length: 59
                    pos: 18134
                    length: 91
                  pos: 17719
                  length: 512
                pos: 17589
                length: 642
              pos: 17355
              length: 880
          children: []
          pos: 17257
          length: 978
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanCast
              children: []
              pos: 18574
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 18588
                length: 15
              pos: 18569
              length: 386
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: castType = castType.restrictByNotNullOrUndefined();
                children: []
                pos: 18649
                length: 51
              - type: expression_statement
                fields:
                  text: type = type.restrictByNotNullOrUndefined();
                children: []
                pos: 18705
                length: 43
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.canAssignTo(castType)"
                            children: []
                            pos: 18758
                            length: 27
                          right:
                            type: unary_expression
                            fields:
                              text: "!castType.canAssignTo(type)"
                            children: []
                            pos: 18789
                            length: 27
                        children: []
                        pos: 18758
                        length: 58
                    children: []
                    pos: 18757
                    length: 60
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(type, castType, report(t.makeError(n, INVALID_CAST,
                                  castType.toString(), type.toString())));
                    children: []
                    pos: 18826
                    length: 119
                  pos: 18818
                  length: 133
                pos: 18754
                length: 197
              pos: 18643
              length: 312
          children: []
          pos: 18569
          length: 386
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectUndeclaredVariable
              children: []
              pos: 19618
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String sourceName
                children: []
                pos: 19643
                length: 17
              pos: 19614
              length: 2342
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Var newVar = var;
                children: []
                pos: 19762
                length: 17
              - type: local_variable_declaration
                fields:
                  text: boolean allowDupe = false;
                children: []
                pos: 19784
                length: 26
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.isGetProp()
                            children: []
                            pos: 19819
                            length: 13
                          right:
                            type: method_invocation
                            fields:
                              text: NodeUtil.isObjectLitKey(n, parent)
                            children: []
                            pos: 19844
                            length: 34
                        children: []
                        pos: 19819
                        length: 59
                    children: []
                    pos: 19818
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JSDocInfo info = n.getJSDocInfo();
                    children: []
                    pos: 19888
                    length: 34
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: info
                                children: []
                                pos: 19933
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 19941
                                length: 4
                            children: []
                            pos: 19933
                            length: 12
                        children: []
                        pos: 19932
                        length: 14
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: info = parent.getJSDocInfo();
                        children: []
                        pos: 19957
                        length: 29
                      pos: 19947
                      length: 47
                    pos: 19929
                    length: 65
                  - type: expression_statement
                    fields:
                      text: |-
                        allowDupe =
                                  info != null && info.getSuppressions().contains("duplicate");
                    children: []
                    pos: 20001
                    length: 83
                  pos: 19880
                  length: 210
                pos: 19815
                length: 275
              - type: local_variable_declaration
                fields:
                  text: JSType varType = var.getType();
                children: []
                pos: 20096
                length: 31
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: varType
                                        children: []
                                        pos: 20309
                                        length: 7
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 20320
                                        length: 4
                                    children: []
                                    pos: 20309
                                    length: 15
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: varType
                                        children: []
                                        pos: 20336
                                        length: 7
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: typeRegistry.getNativeType(UNKNOWN_TYPE)
                                        children: []
                                        pos: 20347
                                        length: 40
                                    children: []
                                    pos: 20336
                                    length: 51
                                children: []
                                pos: 20309
                                length: 78
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: newType
                                    children: []
                                    pos: 20399
                                    length: 7
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 20410
                                    length: 4
                                children: []
                                pos: 20399
                                length: 15
                            children: []
                            pos: 20309
                            length: 105
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: newType
                                children: []
                                pos: 20426
                                length: 7
                              right:
                                type: method_invocation
                                fields:
                                  text: typeRegistry.getNativeType(UNKNOWN_TYPE)
                                children: []
                                pos: 20437
                                length: 40
                            children: []
                            pos: 20426
                            length: 51
                        children: []
                        pos: 20309
                        length: 168
                    children: []
                    pos: 20308
                    length: 170
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: var.input
                                children: []
                                pos: 20848
                                length: 9
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 20861
                                length: 4
                            children: []
                            pos: 20848
                            length: 17
                        children: []
                        pos: 20847
                        length: 19
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: Scope s = var.getScope();
                        children: []
                        pos: 20877
                        length: 25
                      - type: expression_statement
                        fields:
                          text: s.undeclare(var);
                        children: []
                        pos: 20911
                        length: 17
                      - type: expression_statement
                        fields:
                          text: newVar = s.declare(variableName, n, varType, input,
                            false);
                        children: []
                        pos: 20937
                        length: 59
                      - type: expression_statement
                        fields:
                          text: n.setJSType(varType);
                        children: []
                        pos: 21006
                        length: 21
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: parent.isVar()
                                children: []
                                pos: 21040
                                length: 14
                            children: []
                            pos: 21039
                            length: 16
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: n.getFirstChild()
                                        children: []
                                        pos: 21072
                                        length: 17
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 21093
                                        length: 4
                                    children: []
                                    pos: 21072
                                    length: 25
                                children: []
                                pos: 21071
                                length: 27
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: n.getFirstChild().setJSType(varType);
                                children: []
                                pos: 21113
                                length: 37
                              pos: 21099
                              length: 63
                            pos: 21068
                            length: 94
                          pos: 21056
                          length: 116
                        pos: 21036
                        length: 247
                      pos: 20867
                      length: 424
                    pos: 20844
                    length: 1082
                  pos: 20479
                  length: 1453
                pos: 20305
                length: 1627
              - type: return_statement
                fields:
                  text: return newVar;
                children: []
                pos: 21938
                length: 14
              pos: 19756
              length: 2200
          children: []
          pos: 19614
          length: 2342
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectAllInterfaceProperties
              children: []
              pos: 22091
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 22120
                length: 15
              pos: 22086
              length: 461
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: ObjectType instance = type.getInstanceType();
                children: []
                pos: 22176
                length: 45
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (ObjectType implemented : type.getAllImplementedInterfaces()) {
                          if (implemented.getImplicitPrototype() != null) {
                            for (String prop :
                                 implemented.getImplicitPrototype().getOwnPropertyNames()) {
                              expectInterfaceProperty(t, n, instance, implemented, prop);
                            }
                          }
                        }
                children: []
                pos: 22226
                length: 317
              pos: 22170
              length: 377
          children: []
          pos: 22086
          length: 461
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectInterfaceProperty
              children: []
              pos: 22689
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 22713
                length: 15
              pos: 22676
              length: 1546
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StaticSlot<JSType> propSlot = instance.getSlot(prop);
                children: []
                pos: 22817
                length: 53
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: propSlot
                            children: []
                            pos: 22879
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 22891
                            length: 4
                        children: []
                        pos: 22879
                        length: 16
                    children: []
                    pos: 22878
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: String sourceName = n.getSourceFileName();
                    children: []
                    pos: 22930
                    length: 42
                  - type: expression_statement
                    fields:
                      text: 'sourceName = sourceName == null ? "" : sourceName;'
                    children: []
                    pos: 22979
                    length: 50
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(instance, implementedInterface,
                                  report(JSError.make(sourceName, n,
                                  INTERFACE_METHOD_NOT_IMPLEMENTED,
                                  prop, implementedInterface.toString(), instance.toString())));
                    children: []
                    pos: 23036
                    length: 210
                  pos: 22897
                  length: 355
                pos: 22875
                length: 1343
              pos: 22811
              length: 1411
          children: []
          pos: 22676
          length: 1546
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 24279
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 24288
                length: 15
              pos: 24266
              length: 177
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: mismatch(t.getSourceName(), n, msg, found, required);
                children: []
                pos: 24386
                length: 53
              pos: 24380
              length: 63
          children: []
          pos: 24266
          length: 177
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 24460
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 24469
                length: 15
              pos: 24447
              length: 182
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: mismatch(t, n, msg, found, getNativeType(required));
                children: []
                pos: 24573
                length: 52
              pos: 24567
              length: 62
          children: []
          pos: 24447
          length: 182
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 24646
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String sourceName
                children: []
                pos: 24655
                length: 17
              pos: 24633
              length: 293
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: |-
                    registerMismatch(found, required, report(
                            JSError.make(sourceName, n, TYPE_MISMATCH_WARNING,
                                         formatFoundRequired(msg, found, required))));
                children: []
                pos: 24755
                length: 167
              pos: 24749
              length: 177
          children: []
          pos: 24633
          length: 293
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: registerMismatch
              children: []
              pos: 24943
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType found
                children: []
                pos: 24960
                length: 12
              pos: 24930
              length: 1046
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: found = found.restrictByNotNullOrUndefined();
                children: []
                pos: 25121
                length: 45
              - type: expression_statement
                fields:
                  text: required = required.restrictByNotNullOrUndefined();
                children: []
                pos: 25171
                length: 51
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: found.canAssignTo(required)
                            children: []
                            pos: 25231
                            length: 27
                          right:
                            type: method_invocation
                            fields:
                              text: required.canAssignTo(found)
                            children: []
                            pos: 25262
                            length: 27
                        children: []
                        pos: 25231
                        length: 58
                    children: []
                    pos: 25230
                    length: 60
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 25299
                    length: 7
                  pos: 25291
                  length: 21
                pos: 25227
                length: 85
              - type: expression_statement
                fields:
                  text: mismatches.add(new TypeMismatch(found, required, error));
                children: []
                pos: 25318
                length: 57
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: found.isFunctionType()
                            children: []
                            pos: 25384
                            length: 22
                          right:
                            type: method_invocation
                            fields:
                              text: required.isFunctionType()
                            children: []
                            pos: 25418
                            length: 25
                        children: []
                        pos: 25384
                        length: 59
                    children: []
                    pos: 25383
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: FunctionType fnTypeA = found.toMaybeFunctionType();
                    children: []
                    pos: 25453
                    length: 51
                  - type: local_variable_declaration
                    fields:
                      text: FunctionType fnTypeB = required.toMaybeFunctionType();
                    children: []
                    pos: 25511
                    length: 54
                  - type: local_variable_declaration
                    fields:
                      text: Iterator<Node> paramItA = fnTypeA.getParameters().iterator();
                    children: []
                    pos: 25572
                    length: 61
                  - type: local_variable_declaration
                    fields:
                      text: Iterator<Node> paramItB = fnTypeB.getParameters().iterator();
                    children: []
                    pos: 25640
                    length: 61
                  - type: while_statement
                    fields:
                      text: |-
                        while (paramItA.hasNext() && paramItB.hasNext()) {
                                registerIfMismatch(paramItA.next().getJSType(),
                                    paramItB.next().getJSType(), error);
                              }
                    children: []
                    pos: 25708
                    length: 163
                  - type: expression_statement
                    fields:
                      text: |-
                        registerIfMismatch(
                                  fnTypeA.getReturnType(), fnTypeB.getReturnType(), error);
                    children: []
                    pos: 25879
                    length: 87
                  pos: 25445
                  length: 527
                pos: 25380
                length: 592
              pos: 25006
              length: 970
          children: []
          pos: 24930
          length: 1046
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: registerIfMismatch
              children: []
              pos: 25993
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType found
                children: []
                pos: 26019
                length: 12
              pos: 25980
              length: 229
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: found
                                    children: []
                                    pos: 26075
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 26084
                                    length: 4
                                children: []
                                pos: 26075
                                length: 13
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: required
                                    children: []
                                    pos: 26092
                                    length: 8
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 26104
                                    length: 4
                                children: []
                                pos: 26092
                                length: 16
                            children: []
                            pos: 26075
                            length: 33
                          right:
                            type: unary_expression
                            fields:
                              text: "!found.canAssignTo(required)"
                            children: []
                            pos: 26120
                            length: 28
                        children: []
                        pos: 26075
                        length: 73
                    children: []
                    pos: 26074
                    length: 75
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: registerMismatch(found, required, error);
                    children: []
                    pos: 26158
                    length: 41
                  pos: 26150
                  length: 55
                pos: 26071
                length: 134
              pos: 26065
              length: 144
          children: []
          pos: 25980
          length: 229
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: formatFoundRequired
              children: []
              pos: 26285
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String description
                children: []
                pos: 26305
                length: 18
              pos: 26270
              length: 176
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return MessageFormat.format(FOUND_REQUIRED, description, found,
                    required);
                children: []
                pos: 26368
                length: 74
              pos: 26362
              length: 84
          children: []
          pos: 26270
          length: 176
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReadableJSTypeName
              children: []
              pos: 26875
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 26897
                length: 6
              pos: 26868
              length: 1822
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: n.isGetProp()
                        children: []
                        pos: 27126
                        length: 13
                    children: []
                    pos: 27125
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: ObjectType objectType = getJSType(n.getFirstChild()).dereference();
                    children: []
                    pos: 27149
                    length: 67
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: objectType
                                children: []
                                pos: 27227
                                length: 10
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 27241
                                length: 4
                            children: []
                            pos: 27227
                            length: 18
                        children: []
                        pos: 27226
                        length: 20
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: String propName = n.getLastChild().getString();
                        children: []
                        pos: 27257
                        length: 47
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: objectType.getConstructor()
                                        children: []
                                        pos: 27317
                                        length: 27
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 27348
                                        length: 4
                                    children: []
                                    pos: 27317
                                    length: 35
                                  right:
                                    type: method_invocation
                                    fields:
                                      text: objectType.getConstructor().isInterface()
                                    children: []
                                    pos: 27368
                                    length: 41
                                children: []
                                pos: 27317
                                length: 92
                            children: []
                            pos: 27316
                            length: 94
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: |-
                                objectType = FunctionType.getTopDefiningInterface(
                                              objectType, propName);
                            children: []
                            pos: 27423
                            length: 87
                          pos: 27411
                          length: 109
                        pos: 27313
                        length: 396
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: objectType
                                        children: []
                                        pos: 27847
                                        length: 10
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 27861
                                        length: 4
                                    children: []
                                    pos: 27847
                                    length: 18
                                  right:
                                    type: parenthesized_expression
                                    fields:
                                      expression:
                                        type: or
                                        fields:
                                          left:
                                            type: not_equals
                                            fields:
                                              left:
                                                type: method_invocation
                                                fields:
                                                  text: objectType.getConstructor()
                                                children: []
                                                pos: 27882
                                                length: 27
                                              right:
                                                type: null_literal
                                                fields: {}
                                                children: []
                                                pos: 27913
                                                length: 4
                                            children: []
                                            pos: 27882
                                            length: 35
                                          right:
                                            type: method_invocation
                                            fields:
                                              text: objectType.isFunctionPrototypeType()
                                            children: []
                                            pos: 27934
                                            length: 36
                                        children: []
                                        pos: 27882
                                        length: 88
                                    children: []
                                    pos: 27881
                                    length: 90
                                children: []
                                pos: 27847
                                length: 124
                            children: []
                            pos: 27846
                            length: 126
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return objectType.toString() + "." + propName;
                            children: []
                            pos: 27985
                            length: 46
                          pos: 27973
                          length: 68
                        pos: 27843
                        length: 198
                      pos: 27247
                      length: 802
                    pos: 27223
                    length: 826
                  pos: 27141
                  length: 914
                pos: 27122
                length: 933
              - type: local_variable_declaration
                fields:
                  text: JSType type = getJSType(n);
                children: []
                pos: 28061
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: dereference
                        children: []
                        pos: 28097
                        length: 11
                    children: []
                    pos: 28096
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: ObjectType dereferenced = type.dereference();
                    children: []
                    pos: 28118
                    length: 45
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: dereferenced
                                children: []
                                pos: 28174
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 28190
                                length: 4
                            children: []
                            pos: 28174
                            length: 20
                        children: []
                        pos: 28173
                        length: 22
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: type = dereferenced;
                        children: []
                        pos: 28206
                        length: 20
                      pos: 28196
                      length: 38
                    pos: 28170
                    length: 64
                  pos: 28110
                  length: 130
                pos: 28093
                length: 147
              - type: local_variable_declaration
                fields:
                  text: String qualifiedName = n.getQualifiedName();
                children: []
                pos: 28246
                length: 44
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: type.isFunctionPrototypeType()
                            children: []
                            pos: 28299
                            length: 30
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: type.toObjectType()
                                        children: []
                                        pos: 28342
                                        length: 19
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 28365
                                        length: 4
                                    children: []
                                    pos: 28342
                                    length: 27
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: type.toObjectType().getConstructor()
                                        children: []
                                        pos: 28382
                                        length: 36
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 28422
                                        length: 4
                                    children: []
                                    pos: 28382
                                    length: 44
                                children: []
                                pos: 28342
                                length: 84
                            children: []
                            pos: 28341
                            length: 86
                        children: []
                        pos: 28299
                        length: 128
                    children: []
                    pos: 28298
                    length: 130
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return type.toString();
                    children: []
                    pos: 28437
                    length: 23
                  pos: 28429
                  length: 37
                pos: 28295
                length: 391
              pos: 26926
              length: 1764
          children: []
          pos: 26868
          length: 1822
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getJSType
              children: []
              pos: 28815
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 28825
                length: 6
              pos: 28800
              length: 455
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSType jsType = n.getJSType();
                children: []
                pos: 28839
                length: 30
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: jsType
                            children: []
                            pos: 28878
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 28888
                            length: 4
                        children: []
                        pos: 28878
                        length: 14
                    children: []
                    pos: 28877
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return getNativeType(UNKNOWN_TYPE);
                    children: []
                    pos: 29176
                    length: 35
                  pos: 28894
                  length: 323
                pos: 28874
                length: 377
              pos: 28833
              length: 422
          children: []
          pos: 28800
          length: 455
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getNativeType
              children: []
              pos: 29274
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSTypeNative typeId
                children: []
                pos: 29288
                length: 19
              pos: 29259
              length: 102
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return typeRegistry.getNativeType(typeId);
                children: []
                pos: 29315
                length: 42
              pos: 29309
              length: 52
          children: []
          pos: 29259
          length: 102
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: report
              children: []
              pos: 29381
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSError error
                children: []
                pos: 29388
                length: 13
              pos: 29365
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: shouldReport
                        children: []
                        pos: 29413
                        length: 12
                    children: []
                    pos: 29412
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: compiler.report(error);
                    children: []
                    pos: 29435
                    length: 23
                  pos: 29427
                  length: 37
                pos: 29409
                length: 55
              - type: return_statement
                fields:
                  text: return error;
                children: []
                pos: 29469
                length: 13
              pos: 29403
              length: 83
          children: []
          pos: 29365
          length: 121
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: TypeMismatch
              children: []
              pos: 29725
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final JSType typeA;
                children: []
                pos: 29744
                length: 19
              - type: field_declaration
                fields:
                  text: final JSType typeB;
                children: []
                pos: 29768
                length: 19
              - type: field_declaration
                fields:
                  text: final JSError src;
                children: []
                pos: 29792
                length: 18
              - type: constructor_declaration
                fields:
                  text: |-
                    TypeMismatch(JSType a, JSType b, JSError src) {
                          this.typeA = a;
                          this.typeB = b;
                          this.src = src;
                        }
                children: []
                pos: 29991
                length: 119
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: equals
                    children: []
                    pos: 30141
                    length: 6
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object object
                      children: []
                      pos: 30148
                      length: 13
                    pos: 30116
                    length: 402
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: object instanceof TypeMismatch
                              children: []
                              pos: 30175
                              length: 30
                          children: []
                          pos: 30174
                          length: 32
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: TypeMismatch that = (TypeMismatch) object;
                          children: []
                          pos: 30217
                          length: 42
                        - type: return_statement
                          fields:
                            text: |-
                              return (that.typeA.isEquivalentTo(this.typeA)
                                              && that.typeB.isEquivalentTo(this.typeB))
                                          || (that.typeB.isEquivalentTo(this.typeA)
                                              && that.typeA.isEquivalentTo(this.typeB));
                          children: []
                          pos: 30268
                          length: 216
                        pos: 30207
                        length: 285
                      pos: 30171
                      length: 321
                    - type: return_statement
                      fields:
                        text: return false;
                      children: []
                      pos: 30499
                      length: 13
                    pos: 30163
                    length: 355
                children: []
                pos: 30116
                length: 402
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: hashCode
                    children: []
                    pos: 30545
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 30524
                    length: 84
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return Objects.hashCode(typeA, typeB);
                      children: []
                      pos: 30564
                      length: 38
                    pos: 30556
                    length: 52
                children: []
                pos: 30524
                length: 84
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: toString
                    children: []
                    pos: 30638
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 30614
                    length: 89
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return "(" + typeA + ", " + typeB + ")";
                      children: []
                      pos: 30657
                      length: 40
                    pos: 30649
                    length: 54
                children: []
                pos: 30614
                length: 89
              pos: 29712
              length: 995
          children: []
          pos: 29712
          length: 995
        pos: 2515
        length: 28194
    children: []
    pos: 2515
    length: 28194
  pos: 0
  length: 30710
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: TypeValidator
        children: []
        pos: 2521
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 2540
          length: 40
        - type: field_declaration
          fields:
            text: private final JSTypeRegistry typeRegistry;
          children: []
          pos: 2583
          length: 42
        - type: field_declaration
          fields:
            text: private final JSType allValueTypes;
          children: []
          pos: 2628
          length: 35
        - type: field_declaration
          fields:
            text: private boolean shouldReport = true;
          children: []
          pos: 2666
          length: 36
        - type: field_declaration
          fields:
            text: private final JSType nullOrUndefined;
          children: []
          pos: 2705
          length: 37
        - type: field_declaration
          fields:
            text: private final List<TypeMismatch> mismatches = Lists.newArrayList();
          children: []
          pos: 2957
          length: 67
        - type: field_declaration
          fields:
            text: |-
              private static final String FOUND_REQUIRED =
                    "{0}\n" +
                    "found   : {1}\n" +
                    "required: {2}";
          children: []
          pos: 3047
          length: 109
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType INVALID_CAST =
                    DiagnosticType.warning("JSC_INVALID_CAST",
                        "invalid cast - must be a subtype or supertype\n" +
                        "from: {0}\n" +
                        "to  : {1}");
          children: []
          pos: 3160
          length: 203
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType TYPE_MISMATCH_WARNING =
                    DiagnosticType.warning(
                        "JSC_TYPE_MISMATCH",
                        "{0}");
          children: []
          pos: 3367
          length: 130
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType MISSING_EXTENDS_TAG_WARNING =
                    DiagnosticType.warning(
                        "JSC_MISSING_EXTENDS_TAG",
                        "Missing @extends tag on type {0}");
          children: []
          pos: 3501
          length: 171
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType DUP_VAR_DECLARATION =
                    DiagnosticType.warning("JSC_DUP_VAR_DECLARATION",
                        "variable {0} redefined with type {1}, " +
                        "original definition at {2}:{3} with type {4}");
          children: []
          pos: 3676
          length: 217
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType HIDDEN_PROPERTY_MISMATCH =
                    DiagnosticType.warning("JSC_HIDDEN_PROPERTY_MISMATCH",
                        "mismatch of the {0} property type and the type " +
                        "of the property it overrides from superclass {1}\n" +
                        "original: {2}\n" +
                        "override: {3}");
          children: []
          pos: 3897
          length: 300
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType INTERFACE_METHOD_NOT_IMPLEMENTED =
                    DiagnosticType.warning(
                        "JSC_INTERFACE_METHOD_NOT_IMPLEMENTED",
                        "property {0} on interface {1} is not implemented by type {2}");
          children: []
          pos: 4201
          length: 217
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType HIDDEN_INTERFACE_PROPERTY_MISMATCH =
                    DiagnosticType.warning(
                      "JSC_HIDDEN_INTERFACE_PROPERTY_MISMATCH",
                      "mismatch of the {0} property type and the type " +
                      "of the property it overrides from interface {1}\n" +
                      "original: {2}\n" +
                      "override: {3}");
          children: []
          pos: 4422
          length: 320
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType UNKNOWN_TYPEOF_VALUE =
                    DiagnosticType.warning("JSC_UNKNOWN_TYPEOF_VALUE", "unknown type: {0}");
          children: []
          pos: 4746
          length: 129
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType ILLEGAL_PROPERTY_ACCESS =
                    DiagnosticType.warning("JSC_ILLEGAL_PROPERTY_ACCESS",
                                           "Cannot do {0} access on a {1}");
          children: []
          pos: 4879
          length: 176
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticGroup ALL_DIAGNOSTICS = new DiagnosticGroup(
                    INVALID_CAST,
                    TYPE_MISMATCH_WARNING,
                    MISSING_EXTENDS_TAG_WARNING,
                    DUP_VAR_DECLARATION,
                    HIDDEN_PROPERTY_MISMATCH,
                    INTERFACE_METHOD_NOT_IMPLEMENTED,
                    HIDDEN_INTERFACE_PROPERTY_MISMATCH,
                    UNKNOWN_TYPEOF_VALUE,
                    ILLEGAL_PROPERTY_ACCESS);
          children: []
          pos: 5059
          length: 352
        - type: constructor_declaration
          fields:
            text: |-
              TypeValidator(AbstractCompiler compiler) {
                  this.compiler = compiler;
                  this.typeRegistry = compiler.getTypeRegistry();
                  this.allValueTypes = typeRegistry.createUnionType(
                      STRING_TYPE, NUMBER_TYPE, BOOLEAN_TYPE, NULL_TYPE, VOID_TYPE);
                  this.nullOrUndefined = typeRegistry.createUnionType(
                      NULL_TYPE, VOID_TYPE);
                }
          children: []
          pos: 5415
          length: 342
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMismatches
              children: []
              pos: 5977
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5954
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return mismatches;
                children: []
                pos: 5999
                length: 18
              pos: 5993
              length: 28
          children: []
          pos: 5954
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setShouldReport
              children: []
              pos: 6030
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: boolean report
                children: []
                pos: 6046
                length: 14
              pos: 6025
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.shouldReport = report;
                children: []
                pos: 6068
                length: 27
              pos: 6062
              length: 37
          children: []
          pos: 6025
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectValidTypeofName
              children: []
              pos: 6347
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 6369
                length: 15
              pos: 6342
              length: 148
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: report(JSError.make(t.getSourceName(), n, UNKNOWN_TYPEOF_VALUE,
                    found));
                children: []
                pos: 6414
                length: 72
              pos: 6408
              length: 82
          children: []
          pos: 6342
          length: 148
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectObject
              children: []
              pos: 6761
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 6774
                length: 15
              pos: 6753
              length: 205
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesObjectContext()"
                        children: []
                        pos: 6834
                        length: 28
                    children: []
                    pos: 6833
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, OBJECT_TYPE);
                    children: []
                    pos: 6872
                    length: 39
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 6918
                    length: 13
                  pos: 6864
                  length: 73
                pos: 6830
                length: 107
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 6942
                length: 12
              pos: 6824
              length: 134
          children: []
          pos: 6753
          length: 205
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectActualObject
              children: []
              pos: 7091
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7110
                length: 15
              pos: 7086
              length: 159
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.isObject()"
                        children: []
                        pos: 7170
                        length: 16
                    children: []
                    pos: 7169
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, OBJECT_TYPE);
                    children: []
                    pos: 7196
                    length: 39
                  pos: 7188
                  length: 53
                pos: 7166
                length: 75
              pos: 7160
              length: 85
          children: []
          pos: 7086
          length: 159
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectAnyObject
              children: []
              pos: 7416
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7432
                length: 15
              pos: 7411
              length: 253
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSType anyObjectType = getNativeType(NO_OBJECT_TYPE);
                children: []
                pos: 7488
                length: 53
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!anyObjectType.isSubtype(type)"
                            children: []
                            pos: 7550
                            length: 30
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.isEmptyType()"
                            children: []
                            pos: 7584
                            length: 19
                        children: []
                        pos: 7550
                        length: 53
                    children: []
                    pos: 7549
                    length: 55
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, anyObjectType);
                    children: []
                    pos: 7613
                    length: 41
                  pos: 7605
                  length: 55
                pos: 7546
                length: 114
              pos: 7482
              length: 182
          children: []
          pos: 7411
          length: 253
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectString
              children: []
              pos: 7857
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 7870
                length: 15
              pos: 7852
              length: 165
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesStringContext()"
                        children: []
                        pos: 7930
                        length: 28
                    children: []
                    pos: 7929
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, STRING_TYPE);
                    children: []
                    pos: 7968
                    length: 39
                  pos: 7960
                  length: 53
                pos: 7926
                length: 87
              pos: 7920
              length: 97
          children: []
          pos: 7852
          length: 165
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectNumber
              children: []
              pos: 8210
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 8223
                length: 15
              pos: 8205
              length: 165
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!type.matchesNumberContext()"
                        children: []
                        pos: 8283
                        length: 28
                    children: []
                    pos: 8282
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, NUMBER_TYPE);
                    children: []
                    pos: 8321
                    length: 39
                  pos: 8313
                  length: 53
                pos: 8279
                length: 87
              pos: 8273
              length: 97
          children: []
          pos: 8205
          length: 165
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectBitwiseable
              children: []
              pos: 8585
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 8603
                length: 15
              pos: 8580
              length: 206
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.matchesNumberContext()"
                            children: []
                            pos: 8663
                            length: 28
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.isSubtype(allValueTypes)"
                            children: []
                            pos: 8695
                            length: 30
                        children: []
                        pos: 8663
                        length: 62
                    children: []
                    pos: 8662
                    length: 64
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, allValueTypes);
                    children: []
                    pos: 8735
                    length: 41
                  pos: 8727
                  length: 55
                pos: 8659
                length: 123
              pos: 8653
              length: 133
          children: []
          pos: 8580
          length: 206
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectStringOrNumber
              children: []
              pos: 9001
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 9029
                length: 15
              pos: 8996
              length: 214
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.matchesNumberContext()"
                            children: []
                            pos: 9089
                            length: 28
                          right:
                            type: unary_expression
                            fields:
                              text: "!type.matchesStringContext()"
                            children: []
                            pos: 9121
                            length: 28
                        children: []
                        pos: 9089
                        length: 60
                    children: []
                    pos: 9088
                    length: 62
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, NUMBER_STRING);
                    children: []
                    pos: 9159
                    length: 41
                  pos: 9151
                  length: 55
                pos: 9085
                length: 121
              pos: 9079
              length: 131
          children: []
          pos: 8996
          length: 214
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectNotNullOrUndefined
              children: []
              pos: 9552
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 9584
                length: 15
              pos: 9544
              length: 923
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!type.isNoType()"
                                    children: []
                                    pos: 9665
                                    length: 16
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!type.isUnknownType()"
                                    children: []
                                    pos: 9685
                                    length: 21
                                children: []
                                pos: 9665
                                length: 41
                              right:
                                type: method_invocation
                                fields:
                                  text: type.isSubtype(nullOrUndefined)
                                children: []
                                pos: 9718
                                length: 31
                            children: []
                            pos: 9665
                            length: 84
                          right:
                            type: unary_expression
                            fields:
                              text: "!containsForwardDeclaredUnresolvedName(type)"
                            children: []
                            pos: 9761
                            length: 44
                        children: []
                        pos: 9665
                        length: 140
                    children: []
                    pos: 9664
                    length: 142
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: n.isGetProp()
                                    children: []
                                    pos: 10274
                                    length: 13
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!t.inGlobalScope()"
                                    children: []
                                    pos: 10301
                                    length: 18
                                children: []
                                pos: 10274
                                length: 45
                              right:
                                type: method_invocation
                                fields:
                                  text: type.isNullType()
                                children: []
                                pos: 10323
                                length: 17
                            children: []
                            pos: 10274
                            length: 66
                        children: []
                        pos: 10273
                        length: 68
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return true;
                        children: []
                        pos: 10352
                        length: 12
                      pos: 10342
                      length: 30
                    pos: 10270
                    length: 102
                  - type: expression_statement
                    fields:
                      text: mismatch(t, n, msg, type, expectedType);
                    children: []
                    pos: 10380
                    length: 40
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 10427
                    length: 13
                  pos: 9807
                  length: 639
                pos: 9661
                length: 785
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 10451
                length: 12
              pos: 9655
              length: 812
          children: []
          pos: 9544
          length: 923
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containsForwardDeclaredUnresolvedName
              children: []
              pos: 10487
              length: 37
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType type
                children: []
                pos: 10525
                length: 11
              pos: 10471
              length: 310
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: type.isUnionType()
                        children: []
                        pos: 10548
                        length: 18
                    children: []
                    pos: 10547
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: enhanced_for_statement
                    fields:
                      text: |-
                        for (JSType alt : type.toMaybeUnionType().getAlternates()) {
                                if (containsForwardDeclaredUnresolvedName(alt)) {
                                  return true;
                                }
                              }
                    children: []
                    pos: 10576
                    length: 159
                  pos: 10568
                  length: 173
                pos: 10544
                length: 197
              - type: return_statement
                fields:
                  text: return type.isNoResolvedType();
                children: []
                pos: 10746
                length: 31
              pos: 10538
              length: 243
          children: []
          pos: 10471
          length: 310
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectSwitchMatchesCase
              children: []
              pos: 10895
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 10919
                length: 15
              pos: 10890
              length: 627
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!switchType.canTestForShallowEqualityWith(caseType)"
                            children: []
                            pos: 11228
                            length: 51
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: caseType.autoboxesTo()
                                        children: []
                                        pos: 11292
                                        length: 22
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 11318
                                        length: 4
                                    children: []
                                    pos: 11292
                                    length: 30
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!caseType.autoboxesTo().isSubtype(switchType)"
                                    children: []
                                    pos: 11338
                                    length: 45
                                children: []
                                pos: 11292
                                length: 91
                            children: []
                            pos: 11291
                            length: 93
                        children: []
                        pos: 11228
                        length: 156
                    children: []
                    pos: 11227
                    length: 158
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        mismatch(t, n.getFirstChild(),
                                  "case expression doesn't match switch",
                                  caseType, switchType);
                    children: []
                    pos: 11394
                    length: 113
                  pos: 11386
                  length: 127
                pos: 11224
                length: 289
              pos: 10986
              length: 531
          children: []
          pos: 10890
          length: 627
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectIndexMatch
              children: []
              pos: 11916
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 11933
                length: 15
              pos: 11911
              length: 1157
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Preconditions.checkState(n.isGetElem());
                children: []
                pos: 12022
                length: 40
              - type: local_variable_declaration
                fields:
                  text: Node indexNode = n.getLastChild();
                children: []
                pos: 12067
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: objType.isStruct()
                        children: []
                        pos: 12110
                        length: 18
                    children: []
                    pos: 12109
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        report(JSError.make(t.getSourceName(), indexNode,
                                                  ILLEGAL_PROPERTY_ACCESS, "'[]'", "struct"));
                    children: []
                    pos: 12138
                    length: 120
                  pos: 12130
                  length: 134
                pos: 12106
                length: 158
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: objType.isUnknownType()
                        children: []
                        pos: 12273
                        length: 23
                    children: []
                    pos: 12272
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: expectStringOrNumber(t, indexNode, indexType, "property
                        access");
                    children: []
                    pos: 12306
                    length: 65
                  pos: 12298
                  length: 79
                pos: 12269
                length: 795
              pos: 12016
              length: 1052
          children: []
          pos: 11911
          length: 1157
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanAssignToPropertyOf
              children: []
              pos: 13573
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 13601
                length: 15
              pos: 13565
              length: 1144
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!leftType.isNoType()"
                            children: []
                            pos: 13766
                            length: 20
                          right:
                            type: unary_expression
                            fields:
                              text: "!rightType.canAssignTo(leftType)"
                            children: []
                            pos: 13790
                            length: 32
                        children: []
                        pos: 13766
                        length: 56
                    children: []
                    pos: 13765
                    length: 58
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: leftType.isConstructor()
                                        children: []
                                        pos: 13837
                                        length: 24
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: leftType.isEnumType()
                                        children: []
                                        pos: 13865
                                        length: 21
                                    children: []
                                    pos: 13837
                                    length: 49
                                children: []
                                pos: 13836
                                length: 51
                              right:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: rightType.isConstructor()
                                        children: []
                                        pos: 13892
                                        length: 25
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: rightType.isEnumType()
                                        children: []
                                        pos: 13921
                                        length: 22
                                    children: []
                                    pos: 13892
                                    length: 51
                                children: []
                                pos: 13891
                                length: 53
                            children: []
                            pos: 13836
                            length: 108
                        children: []
                        pos: 13835
                        length: 110
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: registerMismatch(rightType, leftType, null);
                        children: []
                        pos: 13956
                        length: 44
                      pos: 13946
                      length: 62
                    pos: 13832
                    length: 830
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 14669
                    length: 13
                  pos: 13824
                  length: 864
                pos: 13762
                length: 926
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 14693
                length: 12
              pos: 13696
              length: 1013
          children: []
          pos: 13565
          length: 1144
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanAssignTo
              children: []
              pos: 15159
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 15177
                length: 15
              pos: 15151
              length: 442
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!rightType.canAssignTo(leftType)"
                        children: []
                        pos: 15265
                        length: 32
                    children: []
                    pos: 15264
                    length: 34
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: leftType.isConstructor()
                                        children: []
                                        pos: 15312
                                        length: 24
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: leftType.isEnumType()
                                        children: []
                                        pos: 15340
                                        length: 21
                                    children: []
                                    pos: 15312
                                    length: 49
                                children: []
                                pos: 15311
                                length: 51
                              right:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: rightType.isConstructor()
                                        children: []
                                        pos: 15367
                                        length: 25
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: rightType.isEnumType()
                                        children: []
                                        pos: 15396
                                        length: 22
                                    children: []
                                    pos: 15367
                                    length: 51
                                children: []
                                pos: 15366
                                length: 53
                            children: []
                            pos: 15311
                            length: 108
                        children: []
                        pos: 15310
                        length: 110
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: registerMismatch(rightType, leftType, null);
                        children: []
                        pos: 15431
                        length: 44
                      pos: 15421
                      length: 62
                    pos: 15307
                    length: 239
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 15553
                    length: 13
                  pos: 15299
                  length: 273
                pos: 15261
                length: 311
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 15577
                length: 12
              pos: 15255
              length: 338
          children: []
          pos: 15151
          length: 442
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectArgumentMatchesParameter
              children: []
              pos: 16041
              length: 30
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 16072
                length: 15
              pos: 16036
              length: 419
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!argType.canAssignTo(paramType)"
                        children: []
                        pos: 16175
                        length: 31
                    children: []
                    pos: 16174
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        mismatch(t, n,
                                  String.format("actual parameter %d of %s does not match " +
                                      "formal parameter", ordinal,
                                      getReadableJSTypeName(callNode.getFirstChild(), false)),
                                  argType, paramType);
                    children: []
                    pos: 16216
                    length: 229
                  pos: 16208
                  length: 243
                pos: 16171
                length: 280
              pos: 16165
              length: 290
          children: []
          pos: 16036
          length: 419
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanOverride
              children: []
              pos: 16949
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 16967
                length: 15
              pos: 16944
              length: 419
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!overridingType.canAssignTo(hiddenType)"
                        children: []
                        pos: 17089
                        length: 39
                    children: []
                    pos: 17088
                    length: 41
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(overridingType, hiddenType,
                                  report(t.makeError(n, HIDDEN_PROPERTY_MISMATCH, propertyName,
                                    ownerType.toString(), hiddenType.toString(),
                                    overridingType.toString())));
                    children: []
                    pos: 17138
                    length: 215
                  pos: 17130
                  length: 229
                pos: 17085
                length: 274
              pos: 17079
              length: 284
          children: []
          pos: 16944
          length: 419
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectSuperType
              children: []
              pos: 17658
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 17674
                length: 15
              pos: 17653
              length: 978
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: FunctionType subCtor = subObject.getConstructor();
                children: []
                pos: 17757
                length: 50
              - type: local_variable_declaration
                fields:
                  text: ObjectType implicitProto = subObject.getImplicitPrototype();
                children: []
                pos: 17812
                length: 60
              - type: local_variable_declaration
                fields:
                  text: |-
                    ObjectType declaredSuper =
                            implicitProto == null ? null : implicitProto.getImplicitPrototype();
                children: []
                pos: 17877
                length: 103
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: declaredSuper
                                    children: []
                                    pos: 17989
                                    length: 13
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 18006
                                    length: 4
                                children: []
                                pos: 17989
                                length: 21
                              right:
                                type: unary_expression
                                fields:
                                  text: "!(superObject instanceof UnknownType)"
                                children: []
                                pos: 18022
                                length: 37
                            children: []
                            pos: 17989
                            length: 70
                          right:
                            type: unary_expression
                            fields:
                              text: "!declaredSuper.isEquivalentTo(superObject)"
                            children: []
                            pos: 18071
                            length: 42
                        children: []
                        pos: 17989
                        length: 124
                    children: []
                    pos: 17988
                    length: 126
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: declaredSuper.isEquivalentTo(getNativeType(OBJECT_TYPE))
                            children: []
                            pos: 18127
                            length: 56
                        children: []
                        pos: 18126
                        length: 58
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: |-
                            registerMismatch(superObject, declaredSuper, report(
                                        t.makeError(n, MISSING_EXTENDS_TAG_WARNING, subObject.toString())));
                        children: []
                        pos: 18195
                        length: 133
                      pos: 18185
                      length: 151
                    pos: 18123
                    length: 366
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!subCtor.hasCachedValues()"
                            children: []
                            pos: 18534
                            length: 26
                        children: []
                        pos: 18533
                        length: 28
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: subCtor.setPrototypeBasedOn(superObject);
                        children: []
                        pos: 18572
                        length: 41
                      pos: 18562
                      length: 59
                    pos: 18530
                    length: 91
                  pos: 18115
                  length: 512
                pos: 17985
                length: 642
              pos: 17751
              length: 880
          children: []
          pos: 17653
          length: 978
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectCanCast
              children: []
              pos: 18970
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 18984
                length: 15
              pos: 18965
              length: 386
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: castType = castType.restrictByNotNullOrUndefined();
                children: []
                pos: 19045
                length: 51
              - type: expression_statement
                fields:
                  text: type = type.restrictByNotNullOrUndefined();
                children: []
                pos: 19101
                length: 43
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!type.canAssignTo(castType)"
                            children: []
                            pos: 19154
                            length: 27
                          right:
                            type: unary_expression
                            fields:
                              text: "!castType.canAssignTo(type)"
                            children: []
                            pos: 19185
                            length: 27
                        children: []
                        pos: 19154
                        length: 58
                    children: []
                    pos: 19153
                    length: 60
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(type, castType, report(t.makeError(n, INVALID_CAST,
                                  castType.toString(), type.toString())));
                    children: []
                    pos: 19222
                    length: 119
                  pos: 19214
                  length: 133
                pos: 19150
                length: 197
              pos: 19039
              length: 312
          children: []
          pos: 18965
          length: 386
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectUndeclaredVariable
              children: []
              pos: 20014
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String sourceName
                children: []
                pos: 20039
                length: 17
              pos: 20010
              length: 2342
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Var newVar = var;
                children: []
                pos: 20158
                length: 17
              - type: local_variable_declaration
                fields:
                  text: boolean allowDupe = false;
                children: []
                pos: 20180
                length: 26
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.isGetProp()
                            children: []
                            pos: 20215
                            length: 13
                          right:
                            type: method_invocation
                            fields:
                              text: NodeUtil.isObjectLitKey(n, parent)
                            children: []
                            pos: 20240
                            length: 34
                        children: []
                        pos: 20215
                        length: 59
                    children: []
                    pos: 20214
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JSDocInfo info = n.getJSDocInfo();
                    children: []
                    pos: 20284
                    length: 34
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: info
                                children: []
                                pos: 20329
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 20337
                                length: 4
                            children: []
                            pos: 20329
                            length: 12
                        children: []
                        pos: 20328
                        length: 14
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: info = parent.getJSDocInfo();
                        children: []
                        pos: 20353
                        length: 29
                      pos: 20343
                      length: 47
                    pos: 20325
                    length: 65
                  - type: expression_statement
                    fields:
                      text: |-
                        allowDupe =
                                  info != null && info.getSuppressions().contains("duplicate");
                    children: []
                    pos: 20397
                    length: 83
                  pos: 20276
                  length: 210
                pos: 20211
                length: 275
              - type: local_variable_declaration
                fields:
                  text: JSType varType = var.getType();
                children: []
                pos: 20492
                length: 31
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: varType
                                        children: []
                                        pos: 20705
                                        length: 7
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 20716
                                        length: 4
                                    children: []
                                    pos: 20705
                                    length: 15
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: varType
                                        children: []
                                        pos: 20732
                                        length: 7
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: typeRegistry.getNativeType(UNKNOWN_TYPE)
                                        children: []
                                        pos: 20743
                                        length: 40
                                    children: []
                                    pos: 20732
                                    length: 51
                                children: []
                                pos: 20705
                                length: 78
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: newType
                                    children: []
                                    pos: 20795
                                    length: 7
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 20806
                                    length: 4
                                children: []
                                pos: 20795
                                length: 15
                            children: []
                            pos: 20705
                            length: 105
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: newType
                                children: []
                                pos: 20822
                                length: 7
                              right:
                                type: method_invocation
                                fields:
                                  text: typeRegistry.getNativeType(UNKNOWN_TYPE)
                                children: []
                                pos: 20833
                                length: 40
                            children: []
                            pos: 20822
                            length: 51
                        children: []
                        pos: 20705
                        length: 168
                    children: []
                    pos: 20704
                    length: 170
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: var.input
                                children: []
                                pos: 21244
                                length: 9
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 21257
                                length: 4
                            children: []
                            pos: 21244
                            length: 17
                        children: []
                        pos: 21243
                        length: 19
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: Scope s = var.getScope();
                        children: []
                        pos: 21273
                        length: 25
                      - type: expression_statement
                        fields:
                          text: s.undeclare(var);
                        children: []
                        pos: 21307
                        length: 17
                      - type: expression_statement
                        fields:
                          text: newVar = s.declare(variableName, n, varType, input,
                            false);
                        children: []
                        pos: 21333
                        length: 59
                      - type: expression_statement
                        fields:
                          text: n.setJSType(varType);
                        children: []
                        pos: 21402
                        length: 21
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: parent.isVar()
                                children: []
                                pos: 21436
                                length: 14
                            children: []
                            pos: 21435
                            length: 16
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: n.getFirstChild()
                                        children: []
                                        pos: 21468
                                        length: 17
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 21489
                                        length: 4
                                    children: []
                                    pos: 21468
                                    length: 25
                                children: []
                                pos: 21467
                                length: 27
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: n.getFirstChild().setJSType(varType);
                                children: []
                                pos: 21509
                                length: 37
                              pos: 21495
                              length: 63
                            pos: 21464
                            length: 94
                          pos: 21452
                          length: 116
                        pos: 21432
                        length: 247
                      pos: 21263
                      length: 424
                    pos: 21240
                    length: 1082
                  pos: 20875
                  length: 1453
                pos: 20701
                length: 1627
              - type: return_statement
                fields:
                  text: return newVar;
                children: []
                pos: 22334
                length: 14
              pos: 20152
              length: 2200
          children: []
          pos: 20010
          length: 2342
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectAllInterfaceProperties
              children: []
              pos: 22487
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 22516
                length: 15
              pos: 22482
              length: 461
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: ObjectType instance = type.getInstanceType();
                children: []
                pos: 22572
                length: 45
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (ObjectType implemented : type.getAllImplementedInterfaces()) {
                          if (implemented.getImplicitPrototype() != null) {
                            for (String prop :
                                 implemented.getImplicitPrototype().getOwnPropertyNames()) {
                              expectInterfaceProperty(t, n, instance, implemented, prop);
                            }
                          }
                        }
                children: []
                pos: 22622
                length: 317
              pos: 22566
              length: 377
          children: []
          pos: 22482
          length: 461
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: expectInterfaceProperty
              children: []
              pos: 23085
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 23109
                length: 15
              pos: 23072
              length: 1546
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StaticSlot<JSType> propSlot = instance.getSlot(prop);
                children: []
                pos: 23213
                length: 53
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: propSlot
                            children: []
                            pos: 23275
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23287
                            length: 4
                        children: []
                        pos: 23275
                        length: 16
                    children: []
                    pos: 23274
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: String sourceName = n.getSourceFileName();
                    children: []
                    pos: 23326
                    length: 42
                  - type: expression_statement
                    fields:
                      text: 'sourceName = sourceName == null ? "" : sourceName;'
                    children: []
                    pos: 23375
                    length: 50
                  - type: expression_statement
                    fields:
                      text: |-
                        registerMismatch(instance, implementedInterface,
                                  report(JSError.make(sourceName, n,
                                  INTERFACE_METHOD_NOT_IMPLEMENTED,
                                  prop, implementedInterface.toString(), instance.toString())));
                    children: []
                    pos: 23432
                    length: 210
                  pos: 23293
                  length: 355
                pos: 23271
                length: 1343
              pos: 23207
              length: 1411
          children: []
          pos: 23072
          length: 1546
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 24675
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 24684
                length: 15
              pos: 24662
              length: 177
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: mismatch(t.getSourceName(), n, msg, found, required);
                children: []
                pos: 24782
                length: 53
              pos: 24776
              length: 63
          children: []
          pos: 24662
          length: 177
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 24856
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 24865
                length: 15
              pos: 24843
              length: 182
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: mismatch(t, n, msg, found, getNativeType(required));
                children: []
                pos: 24969
                length: 52
              pos: 24963
              length: 62
          children: []
          pos: 24843
          length: 182
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mismatch
              children: []
              pos: 25042
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String sourceName
                children: []
                pos: 25051
                length: 17
              pos: 25029
              length: 293
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: |-
                    registerMismatch(found, required, report(
                            JSError.make(sourceName, n, TYPE_MISMATCH_WARNING,
                                         formatFoundRequired(msg, found, required))));
                children: []
                pos: 25151
                length: 167
              pos: 25145
              length: 177
          children: []
          pos: 25029
          length: 293
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: registerMismatch
              children: []
              pos: 25339
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType found
                children: []
                pos: 25356
                length: 12
              pos: 25326
              length: 1046
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: found = found.restrictByNotNullOrUndefined();
                children: []
                pos: 25517
                length: 45
              - type: expression_statement
                fields:
                  text: required = required.restrictByNotNullOrUndefined();
                children: []
                pos: 25567
                length: 51
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: found.canAssignTo(required)
                            children: []
                            pos: 25627
                            length: 27
                          right:
                            type: method_invocation
                            fields:
                              text: required.canAssignTo(found)
                            children: []
                            pos: 25658
                            length: 27
                        children: []
                        pos: 25627
                        length: 58
                    children: []
                    pos: 25626
                    length: 60
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 25695
                    length: 7
                  pos: 25687
                  length: 21
                pos: 25623
                length: 85
              - type: expression_statement
                fields:
                  text: mismatches.add(new TypeMismatch(found, required, error));
                children: []
                pos: 25714
                length: 57
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: found.isFunctionType()
                            children: []
                            pos: 25780
                            length: 22
                          right:
                            type: method_invocation
                            fields:
                              text: required.isFunctionType()
                            children: []
                            pos: 25814
                            length: 25
                        children: []
                        pos: 25780
                        length: 59
                    children: []
                    pos: 25779
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: FunctionType fnTypeA = found.toMaybeFunctionType();
                    children: []
                    pos: 25849
                    length: 51
                  - type: local_variable_declaration
                    fields:
                      text: FunctionType fnTypeB = required.toMaybeFunctionType();
                    children: []
                    pos: 25907
                    length: 54
                  - type: local_variable_declaration
                    fields:
                      text: Iterator<Node> paramItA = fnTypeA.getParameters().iterator();
                    children: []
                    pos: 25968
                    length: 61
                  - type: local_variable_declaration
                    fields:
                      text: Iterator<Node> paramItB = fnTypeB.getParameters().iterator();
                    children: []
                    pos: 26036
                    length: 61
                  - type: while_statement
                    fields:
                      text: |-
                        while (paramItA.hasNext() && paramItB.hasNext()) {
                                registerIfMismatch(paramItA.next().getJSType(),
                                    paramItB.next().getJSType(), error);
                              }
                    children: []
                    pos: 26104
                    length: 163
                  - type: expression_statement
                    fields:
                      text: |-
                        registerIfMismatch(
                                  fnTypeA.getReturnType(), fnTypeB.getReturnType(), error);
                    children: []
                    pos: 26275
                    length: 87
                  pos: 25841
                  length: 527
                pos: 25776
                length: 592
              pos: 25402
              length: 970
          children: []
          pos: 25326
          length: 1046
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: registerIfMismatch
              children: []
              pos: 26389
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSType found
                children: []
                pos: 26415
                length: 12
              pos: 26376
              length: 229
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: found
                                    children: []
                                    pos: 26471
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 26480
                                    length: 4
                                children: []
                                pos: 26471
                                length: 13
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: required
                                    children: []
                                    pos: 26488
                                    length: 8
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 26500
                                    length: 4
                                children: []
                                pos: 26488
                                length: 16
                            children: []
                            pos: 26471
                            length: 33
                          right:
                            type: unary_expression
                            fields:
                              text: "!found.canAssignTo(required)"
                            children: []
                            pos: 26516
                            length: 28
                        children: []
                        pos: 26471
                        length: 73
                    children: []
                    pos: 26470
                    length: 75
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: registerMismatch(found, required, error);
                    children: []
                    pos: 26554
                    length: 41
                  pos: 26546
                  length: 55
                pos: 26467
                length: 134
              pos: 26461
              length: 144
          children: []
          pos: 26376
          length: 229
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: formatFoundRequired
              children: []
              pos: 26681
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String description
                children: []
                pos: 26701
                length: 18
              pos: 26666
              length: 176
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return MessageFormat.format(FOUND_REQUIRED, description, found,
                    required);
                children: []
                pos: 26764
                length: 74
              pos: 26758
              length: 84
          children: []
          pos: 26666
          length: 176
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReadableJSTypeName
              children: []
              pos: 27271
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 27293
                length: 6
              pos: 27264
              length: 1822
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: n.isGetProp()
                        children: []
                        pos: 27522
                        length: 13
                    children: []
                    pos: 27521
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: ObjectType objectType = getJSType(n.getFirstChild()).dereference();
                    children: []
                    pos: 27545
                    length: 67
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: objectType
                                children: []
                                pos: 27623
                                length: 10
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 27637
                                length: 4
                            children: []
                            pos: 27623
                            length: 18
                        children: []
                        pos: 27622
                        length: 20
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: String propName = n.getLastChild().getString();
                        children: []
                        pos: 27653
                        length: 47
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: objectType.getConstructor()
                                        children: []
                                        pos: 27713
                                        length: 27
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 27744
                                        length: 4
                                    children: []
                                    pos: 27713
                                    length: 35
                                  right:
                                    type: method_invocation
                                    fields:
                                      text: objectType.getConstructor().isInterface()
                                    children: []
                                    pos: 27764
                                    length: 41
                                children: []
                                pos: 27713
                                length: 92
                            children: []
                            pos: 27712
                            length: 94
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: |-
                                objectType = FunctionType.getTopDefiningInterface(
                                              objectType, propName);
                            children: []
                            pos: 27819
                            length: 87
                          pos: 27807
                          length: 109
                        pos: 27709
                        length: 396
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: objectType
                                        children: []
                                        pos: 28243
                                        length: 10
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 28257
                                        length: 4
                                    children: []
                                    pos: 28243
                                    length: 18
                                  right:
                                    type: parenthesized_expression
                                    fields:
                                      expression:
                                        type: or
                                        fields:
                                          left:
                                            type: not_equals
                                            fields:
                                              left:
                                                type: method_invocation
                                                fields:
                                                  text: objectType.getConstructor()
                                                children: []
                                                pos: 28278
                                                length: 27
                                              right:
                                                type: null_literal
                                                fields: {}
                                                children: []
                                                pos: 28309
                                                length: 4
                                            children: []
                                            pos: 28278
                                            length: 35
                                          right:
                                            type: method_invocation
                                            fields:
                                              text: objectType.isFunctionPrototypeType()
                                            children: []
                                            pos: 28330
                                            length: 36
                                        children: []
                                        pos: 28278
                                        length: 88
                                    children: []
                                    pos: 28277
                                    length: 90
                                children: []
                                pos: 28243
                                length: 124
                            children: []
                            pos: 28242
                            length: 126
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return objectType.toString() + "." + propName;
                            children: []
                            pos: 28381
                            length: 46
                          pos: 28369
                          length: 68
                        pos: 28239
                        length: 198
                      pos: 27643
                      length: 802
                    pos: 27619
                    length: 826
                  pos: 27537
                  length: 914
                pos: 27518
                length: 933
              - type: local_variable_declaration
                fields:
                  text: JSType type = getJSType(n);
                children: []
                pos: 28457
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: dereference
                        children: []
                        pos: 28493
                        length: 11
                    children: []
                    pos: 28492
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: ObjectType dereferenced = type.dereference();
                    children: []
                    pos: 28514
                    length: 45
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: dereferenced
                                children: []
                                pos: 28570
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 28586
                                length: 4
                            children: []
                            pos: 28570
                            length: 20
                        children: []
                        pos: 28569
                        length: 22
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: type = dereferenced;
                        children: []
                        pos: 28602
                        length: 20
                      pos: 28592
                      length: 38
                    pos: 28566
                    length: 64
                  pos: 28506
                  length: 130
                pos: 28489
                length: 147
              - type: local_variable_declaration
                fields:
                  text: String qualifiedName = n.getQualifiedName();
                children: []
                pos: 28642
                length: 44
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: type.isFunctionPrototypeType()
                            children: []
                            pos: 28695
                            length: 30
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: type.toObjectType()
                                        children: []
                                        pos: 28738
                                        length: 19
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 28761
                                        length: 4
                                    children: []
                                    pos: 28738
                                    length: 27
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: type.toObjectType().getConstructor()
                                        children: []
                                        pos: 28778
                                        length: 36
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 28818
                                        length: 4
                                    children: []
                                    pos: 28778
                                    length: 44
                                children: []
                                pos: 28738
                                length: 84
                            children: []
                            pos: 28737
                            length: 86
                        children: []
                        pos: 28695
                        length: 128
                    children: []
                    pos: 28694
                    length: 130
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return type.toString();
                    children: []
                    pos: 28833
                    length: 23
                  pos: 28825
                  length: 37
                pos: 28691
                length: 391
              pos: 27322
              length: 1764
          children: []
          pos: 27264
          length: 1822
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getJSType
              children: []
              pos: 29211
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 29221
                length: 6
              pos: 29196
              length: 455
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSType jsType = n.getJSType();
                children: []
                pos: 29235
                length: 30
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: jsType
                            children: []
                            pos: 29274
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 29284
                            length: 4
                        children: []
                        pos: 29274
                        length: 14
                    children: []
                    pos: 29273
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return getNativeType(UNKNOWN_TYPE);
                    children: []
                    pos: 29572
                    length: 35
                  pos: 29290
                  length: 323
                pos: 29270
                length: 377
              pos: 29229
              length: 422
          children: []
          pos: 29196
          length: 455
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getNativeType
              children: []
              pos: 29670
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSTypeNative typeId
                children: []
                pos: 29684
                length: 19
              pos: 29655
              length: 102
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return typeRegistry.getNativeType(typeId);
                children: []
                pos: 29711
                length: 42
              pos: 29705
              length: 52
          children: []
          pos: 29655
          length: 102
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: report
              children: []
              pos: 29777
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSError error
                children: []
                pos: 29784
                length: 13
              pos: 29761
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: shouldReport
                        children: []
                        pos: 29809
                        length: 12
                    children: []
                    pos: 29808
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: compiler.report(error);
                    children: []
                    pos: 29831
                    length: 23
                  pos: 29823
                  length: 37
                pos: 29805
                length: 55
              - type: return_statement
                fields:
                  text: return error;
                children: []
                pos: 29865
                length: 13
              pos: 29799
              length: 83
          children: []
          pos: 29761
          length: 121
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: TypeMismatch
              children: []
              pos: 30121
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final JSType typeA;
                children: []
                pos: 30140
                length: 19
              - type: field_declaration
                fields:
                  text: final JSType typeB;
                children: []
                pos: 30164
                length: 19
              - type: field_declaration
                fields:
                  text: final JSError src;
                children: []
                pos: 30188
                length: 18
              - type: constructor_declaration
                fields:
                  text: |-
                    TypeMismatch(JSType a, JSType b, JSError src) {
                          this.typeA = a;
                          this.typeB = b;
                          this.src = src;
                        }
                children: []
                pos: 30387
                length: 119
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: equals
                    children: []
                    pos: 30537
                    length: 6
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object object
                      children: []
                      pos: 30544
                      length: 13
                    pos: 30512
                    length: 402
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: object instanceof TypeMismatch
                              children: []
                              pos: 30571
                              length: 30
                          children: []
                          pos: 30570
                          length: 32
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: TypeMismatch that = (TypeMismatch) object;
                          children: []
                          pos: 30613
                          length: 42
                        - type: return_statement
                          fields:
                            text: |-
                              return (that.typeA.isEquivalentTo(this.typeA)
                                              && that.typeB.isEquivalentTo(this.typeB))
                                          || (that.typeB.isEquivalentTo(this.typeA)
                                              && that.typeA.isEquivalentTo(this.typeB));
                          children: []
                          pos: 30664
                          length: 216
                        pos: 30603
                        length: 285
                      pos: 30567
                      length: 321
                    - type: return_statement
                      fields:
                        text: return false;
                      children: []
                      pos: 30895
                      length: 13
                    pos: 30559
                    length: 355
                children: []
                pos: 30512
                length: 402
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: hashCode
                    children: []
                    pos: 30941
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 30920
                    length: 84
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return Objects.hashCode(typeA, typeB);
                      children: []
                      pos: 30960
                      length: 38
                    pos: 30952
                    length: 52
                children: []
                pos: 30920
                length: 84
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: toString
                    children: []
                    pos: 31034
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 31010
                    length: 89
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return "(" + typeA + ", " + typeB + ")";
                      children: []
                      pos: 31053
                      length: 40
                    pos: 31045
                    length: 54
                children: []
                pos: 31010
                length: 89
              pos: 30108
              length: 995
          children: []
          pos: 30108
          length: 995
        pos: 2515
        length: 28590
    children: []
    pos: 2515
    length: 28590
  pos: 0
  length: 31106
text_diff: |
  --- before
  +++ after
  @@ -363,6 +363,9 @@
         JSType leftType, Node owner, String propName) {
       // The NoType check is a hack to make typedefs work OK.
       if (!leftType.isNoType() && !rightType.canAssignTo(leftType)) {
  +      if ((leftType.isConstructor() || leftType.isEnumType()) && (rightType.isConstructor() || rightType.isEnumType())) {
  +        registerMismatch(rightType, leftType, null);
  +      } else {
         // Do not type-check interface methods, because we expect that
         // they will have dummy implementations that do not match the type
         // annotations.
  @@ -379,6 +382,7 @@
             "assignment to property " + propName + " of " +
             getReadableJSTypeName(owner, true),
             rightType, leftType);
  +      }
         return false;
       }
       return true;
  @@ -398,7 +402,11 @@
     boolean expectCanAssignTo(NodeTraversal t, Node n, JSType rightType,
         JSType leftType, String msg) {
       if (!rightType.canAssignTo(leftType)) {
  +      if ((leftType.isConstructor() || leftType.isEnumType()) && (rightType.isConstructor() || rightType.isEnumType())) {
  +        registerMismatch(rightType, leftType, null);
  +      } else {
         mismatch(t, n, msg, rightType, leftType);
  +      }
         return false;
       }
       return true;
tree_diff: |+
  New cluster:
  Unknown cluster type
  ------------
  ===
  insert-tree
  ---
  if_statement [15307,15546]
      parenthesized_expression [15310,15420]
          and [15311,15419]
              parenthesized_expression [15311,15362]
                  or [15312,15361]
                      method_invocation: leftType.isConstructor() [15312,15336]
                      method_invocation: leftType.isEnumType() [15340,15361]
              parenthesized_expression [15366,15419]
                  or [15367,15418]
                      method_invocation: rightType.isConstructor() [15367,15392]
                      method_invocation: rightType.isEnumType() [15396,15418]
      block [15421,15483]
          expression_statement: registerMismatch(rightType, leftType, null); [15431,15475]
  to
  block [15101,15176]
  at 0

  New cluster:
  Unknown cluster type
  ------------
  ===
  insert-tree
  ---
  and [13836,13944]
      parenthesized_expression [13836,13887]
          or [13837,13886]
              method_invocation: leftType.isConstructor() [13837,13861]
              method_invocation: leftType.isEnumType() [13865,13886]
      parenthesized_expression [13891,13944]
          or [13892,13943]
              method_invocation: rightType.isConstructor() [13892,13917]
              method_invocation: rightType.isEnumType() [13921,13943]
  to
  parenthesized_expression [14042,14079]
  at 0

  New cluster:
  ===
  insert-node
  ---
  expression_statement: registerMismatch(rightType, leftType, null); [13956,14000]
  to
  block [14080,14306]
  at 0
  ------------
  ===
  insert-node
  ---
  expression_statement: registerMismatch(rightType, leftType, null); [13956,14000]
  to
  block [14080,14306]
  at 0

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: JSType ownerType = getJSType(owner); [13996,14032]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: JSType ownerType = getJSType(owner); [13996,14032]
  ===

  New cluster:
  ===
  delete-node
  ---
  method_invocation: ownerType.isFunctionPrototypeType() [14043,14078]
  ===
  ------------
  ===
  delete-node
  ---
  method_invocation: ownerType.isFunctionPrototypeType() [14043,14078]
  ===

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: FunctionType ownerFn = ownerType.toObjectType().getOwnerFunction(); [14090,14157]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: FunctionType ownerFn = ownerType.toObjectType().getOwnerFunction(); [14090,14157]
  ===

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  if_statement [14166,14298]
      parenthesized_expression [14169,14263]
          and [14170,14262]
              and [14170,14233]
                  method_invocation: ownerFn.isInterface() [14170,14191]
                  method_invocation: rightType.isFunctionType() [14207,14233]
              method_invocation: leftType.isFunctionType() [14237,14262]
      block [14264,14298]
          return_statement: return true; [14276,14288]

  New cluster:
  ===
  delete-node
  ---
  expression_statement: mismatch(t, n,
            "assignment to property " + propName + " of " +
            getReadableJSTypeName(owner, true),
            rightType, leftType); [14314,14464]
  ===
  ------------
  ===
  delete-node
  ---
  expression_statement: mismatch(t, n,
            "assignment to property " + propName + " of " +
            getReadableJSTypeName(owner, true),
            rightType, leftType); [14314,14464]
  ===

  New cluster:
  ===
  delete-node
  ---
  expression_statement: mismatch(t, n, msg, rightType, leftType); [15109,15150]
  ===
  ------------
  ===
  delete-node
  ---
  expression_statement: mismatch(t, n, msg, rightType, leftType); [15109,15150]
  ===

...
