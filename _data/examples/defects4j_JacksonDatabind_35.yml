---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: AsWrapperTypeDeserializer
        children: []
        pos: 789
        length: 25
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 5345570420394408290L;
          children: []
          pos: 890
          length: 66
        - type: constructor_declaration
          fields:
            text: |-
              public AsWrapperTypeDeserializer(JavaType bt, TypeIdResolver idRes,
                          String typePropertyName, boolean typeIdVisible, Class<?> defaultImpl)
                  {
                      super(bt, idRes, typePropertyName, typeIdVisible, defaultImpl);
                  }
          children: []
          pos: 962
          length: 233
        - type: constructor_declaration
          fields:
            text: |-
              protected AsWrapperTypeDeserializer(AsWrapperTypeDeserializer src, BeanProperty property) {
                      super(src, property);
                  }
          children: []
          pos: 1201
          length: 127
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: forProperty
              children: []
              pos: 1376
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: BeanProperty prop
                children: []
                pos: 1388
                length: 17
              pos: 1338
              length: 163
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (prop == _property) ? this : new AsWrapperTypeDeserializer(this,
                    prop);'
                children: []
                pos: 1417
                length: 78
              pos: 1407
              length: 94
          children: []
          pos: 1338
          length: 163
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getTypeInclusion
              children: []
              pos: 1535
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1511
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return As.WRAPPER_OBJECT;
                children: []
                pos: 1556
                length: 25
              pos: 1554
              length: 29
          children: []
          pos: 1511
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromObject
              children: []
              pos: 1717
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 1744
                length: 13
              pos: 1689
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 1817
                length: 30
              pos: 1807
              length: 46
          children: []
          pos: 1689
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromArray
              children: []
              pos: 1891
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 1917
                length: 13
              pos: 1863
              length: 163
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 1990
                length: 30
              pos: 1980
              length: 46
          children: []
          pos: 1863
          length: 163
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromScalar
              children: []
              pos: 2060
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 2087
                length: 13
              pos: 2032
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 2160
                length: 30
              pos: 2150
              length: 46
          children: []
          pos: 2032
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromAny
              children: []
              pos: 2230
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 2254
                length: 13
              pos: 2202
              length: 161
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 2327
                length: 30
              pos: 2317
              length: 46
          children: []
          pos: 2202
          length: 161
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _deserialize
              children: []
              pos: 2776
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser p
                children: []
                pos: 2789
                length: 12
              pos: 2721
              length: 2121
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: p.canReadTypeId()
                        children: []
                        pos: 2931
                        length: 17
                    children: []
                    pos: 2930
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Object typeId = p.getTypeId();
                    children: []
                    pos: 2964
                    length: 30
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: typeId
                                children: []
                                pos: 3011
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3021
                                length: 4
                            children: []
                            pos: 3011
                            length: 14
                        children: []
                        pos: 3010
                        length: 16
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return _deserializeWithNativeTypeId(p, ctxt, typeId);
                        children: []
                        pos: 3045
                        length: 53
                      pos: 3027
                      length: 85
                    pos: 3007
                    length: 105
                  pos: 2950
                  length: 172
                pos: 2927
                length: 195
              - type: local_variable_declaration
                fields:
                  text: JsonToken t = p.getCurrentToken();
                children: []
                pos: 3163
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: t
                            children: []
                            pos: 3210
                            length: 1
                          right:
                            type: field_access
                            fields:
                              text: JsonToken.START_OBJECT
                            children: []
                            pos: 3215
                            length: 22
                        children: []
                        pos: 3210
                        length: 27
                    children: []
                    pos: 3209
                    length: 29
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: p.nextToken()
                                children: []
                                pos: 3322
                                length: 13
                              right:
                                type: field_access
                                fields:
                                  text: JsonToken.FIELD_NAME
                                children: []
                                pos: 3339
                                length: 20
                            children: []
                            pos: 3322
                            length: 37
                        children: []
                        pos: 3321
                        length: 39
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: throw_statement
                        fields:
                          text: |-
                            throw ctxt.wrongTokenException(p, JsonToken.FIELD_NAME,
                                                    "need JSON String that contains type id (for subtype of "+baseTypeName()+")");
                        children: []
                        pos: 3379
                        length: 158
                      pos: 3361
                      length: 190
                    pos: 3318
                    length: 233
                  pos: 3239
                  length: 322
                pos: 3206
                length: 586
              - type: local_variable_declaration
                fields:
                  text: final String typeId = p.getText();
                children: []
                pos: 3801
                length: 34
              - type: local_variable_declaration
                fields:
                  text: JsonDeserializer<Object> deser = _findDeserializer(ctxt, typeId);
                children: []
                pos: 3844
                length: 65
              - type: expression_statement
                fields:
                  text: p.nextToken();
                children: []
                pos: 3918
                length: 14
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _typeIdVisible
                            children: []
                            pos: 4010
                            length: 14
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: p.getCurrentToken()
                                children: []
                                pos: 4028
                                length: 19
                              right:
                                type: field_access
                                fields:
                                  text: JsonToken.START_OBJECT
                                children: []
                                pos: 4051
                                length: 22
                            children: []
                            pos: 4028
                            length: 45
                        children: []
                        pos: 4010
                        length: 63
                    children: []
                    pos: 4009
                    length: 65
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: TokenBuffer tb = new TokenBuffer(null, false);
                    children: []
                    pos: 4177
                    length: 46
                  - type: expression_statement
                    fields:
                      text: tb.writeStartObject();
                    children: []
                    pos: 4236
                    length: 22
                  - type: expression_statement
                    fields:
                      text: tb.writeFieldName(_typePropertyName);
                    children: []
                    pos: 4296
                    length: 37
                  - type: expression_statement
                    fields:
                      text: tb.writeString(typeId);
                    children: []
                    pos: 4346
                    length: 23
                  - type: expression_statement
                    fields:
                      text: p = JsonParserSequence.createFlattened(tb.asParser(p),
                        p);
                    children: []
                    pos: 4382
                    length: 58
                  - type: expression_statement
                    fields:
                      text: p.nextToken();
                    children: []
                    pos: 4453
                    length: 14
                  pos: 4075
                  length: 402
                pos: 4006
                length: 471
              - type: local_variable_declaration
                fields:
                  text: Object value = deser.deserialize(p, ctxt);
                children: []
                pos: 4495
                length: 42
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: p.nextToken()
                            children: []
                            pos: 4598
                            length: 13
                          right:
                            type: field_access
                            fields:
                              text: JsonToken.END_OBJECT
                            children: []
                            pos: 4615
                            length: 20
                        children: []
                        pos: 4598
                        length: 37
                    children: []
                    pos: 4597
                    length: 39
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw ctxt.wrongTokenException(p, JsonToken.END_OBJECT,
                                            "expected closing END_OBJECT after type information and deserialized value");
                    children: []
                    pos: 4651
                    length: 153
                  pos: 4637
                  length: 177
                pos: 4594
                length: 220
              - type: return_statement
                fields:
                  text: return value;
                children: []
                pos: 4823
                length: 13
              pos: 2855
              length: 1987
          children: []
          pos: 2721
          length: 2121
        pos: 776
        length: 4068
    children: []
    pos: 776
    length: 4068
  pos: 0
  length: 4845
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: AsWrapperTypeDeserializer
        children: []
        pos: 789
        length: 25
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 5345570420394408290L;
          children: []
          pos: 890
          length: 66
        - type: constructor_declaration
          fields:
            text: |-
              public AsWrapperTypeDeserializer(JavaType bt, TypeIdResolver idRes,
                          String typePropertyName, boolean typeIdVisible, Class<?> defaultImpl)
                  {
                      super(bt, idRes, typePropertyName, typeIdVisible, defaultImpl);
                  }
          children: []
          pos: 962
          length: 233
        - type: constructor_declaration
          fields:
            text: |-
              protected AsWrapperTypeDeserializer(AsWrapperTypeDeserializer src, BeanProperty property) {
                      super(src, property);
                  }
          children: []
          pos: 1201
          length: 127
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: forProperty
              children: []
              pos: 1376
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: BeanProperty prop
                children: []
                pos: 1388
                length: 17
              pos: 1338
              length: 163
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (prop == _property) ? this : new AsWrapperTypeDeserializer(this,
                    prop);'
                children: []
                pos: 1417
                length: 78
              pos: 1407
              length: 94
          children: []
          pos: 1338
          length: 163
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getTypeInclusion
              children: []
              pos: 1535
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1511
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return As.WRAPPER_OBJECT;
                children: []
                pos: 1556
                length: 25
              pos: 1554
              length: 29
          children: []
          pos: 1511
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromObject
              children: []
              pos: 1717
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 1744
                length: 13
              pos: 1689
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 1817
                length: 30
              pos: 1807
              length: 46
          children: []
          pos: 1689
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromArray
              children: []
              pos: 1891
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 1917
                length: 13
              pos: 1863
              length: 163
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 1990
                length: 30
              pos: 1980
              length: 46
          children: []
          pos: 1863
          length: 163
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromScalar
              children: []
              pos: 2060
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 2087
                length: 13
              pos: 2032
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 2160
                length: 30
              pos: 2150
              length: 46
          children: []
          pos: 2032
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deserializeTypedFromAny
              children: []
              pos: 2230
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser jp
                children: []
                pos: 2254
                length: 13
              pos: 2202
              length: 161
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _deserialize(jp, ctxt);
                children: []
                pos: 2327
                length: 30
              pos: 2317
              length: 46
          children: []
          pos: 2202
          length: 161
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _deserialize
              children: []
              pos: 2776
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonParser p
                children: []
                pos: 2789
                length: 12
              pos: 2721
              length: 2048
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: p.canReadTypeId()
                        children: []
                        pos: 2931
                        length: 17
                    children: []
                    pos: 2930
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Object typeId = p.getTypeId();
                    children: []
                    pos: 2964
                    length: 30
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: typeId
                                children: []
                                pos: 3011
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3021
                                length: 4
                            children: []
                            pos: 3011
                            length: 14
                        children: []
                        pos: 3010
                        length: 16
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return _deserializeWithNativeTypeId(p, ctxt, typeId);
                        children: []
                        pos: 3045
                        length: 53
                      pos: 3027
                      length: 85
                    pos: 3007
                    length: 105
                  pos: 2950
                  length: 172
                pos: 2927
                length: 195
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: p.getCurrentToken()
                            children: []
                            pos: 3167
                            length: 19
                          right:
                            type: field_access
                            fields:
                              text: JsonToken.START_OBJECT
                            children: []
                            pos: 3190
                            length: 22
                        children: []
                        pos: 3167
                        length: 45
                    children: []
                    pos: 3166
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw ctxt.wrongTokenException(p, JsonToken.START_OBJECT,
                                            "need JSON Object to contain As.WRAPPER_OBJECT type information for class "+baseTypeName());
                    children: []
                    pos: 3228
                    length: 170
                  pos: 3214
                  length: 194
                pos: 3163
                length: 245
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: p.nextToken()
                            children: []
                            pos: 3490
                            length: 13
                          right:
                            type: field_access
                            fields:
                              text: JsonToken.FIELD_NAME
                            children: []
                            pos: 3507
                            length: 20
                        children: []
                        pos: 3490
                        length: 37
                    children: []
                    pos: 3489
                    length: 39
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw ctxt.wrongTokenException(p, JsonToken.FIELD_NAME,
                                                "need JSON String that contains type id (for subtype of "+baseTypeName()+")");
                    children: []
                    pos: 3547
                    length: 158
                  pos: 3529
                  length: 190
                pos: 3486
                length: 233
              - type: local_variable_declaration
                fields:
                  text: final String typeId = p.getText();
                children: []
                pos: 3728
                length: 34
              - type: local_variable_declaration
                fields:
                  text: JsonDeserializer<Object> deser = _findDeserializer(ctxt, typeId);
                children: []
                pos: 3771
                length: 65
              - type: expression_statement
                fields:
                  text: p.nextToken();
                children: []
                pos: 3845
                length: 14
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _typeIdVisible
                            children: []
                            pos: 3937
                            length: 14
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: p.getCurrentToken()
                                children: []
                                pos: 3955
                                length: 19
                              right:
                                type: field_access
                                fields:
                                  text: JsonToken.START_OBJECT
                                children: []
                                pos: 3978
                                length: 22
                            children: []
                            pos: 3955
                            length: 45
                        children: []
                        pos: 3937
                        length: 63
                    children: []
                    pos: 3936
                    length: 65
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: TokenBuffer tb = new TokenBuffer(null, false);
                    children: []
                    pos: 4104
                    length: 46
                  - type: expression_statement
                    fields:
                      text: tb.writeStartObject();
                    children: []
                    pos: 4163
                    length: 22
                  - type: expression_statement
                    fields:
                      text: tb.writeFieldName(_typePropertyName);
                    children: []
                    pos: 4223
                    length: 37
                  - type: expression_statement
                    fields:
                      text: tb.writeString(typeId);
                    children: []
                    pos: 4273
                    length: 23
                  - type: expression_statement
                    fields:
                      text: p = JsonParserSequence.createFlattened(tb.asParser(p),
                        p);
                    children: []
                    pos: 4309
                    length: 58
                  - type: expression_statement
                    fields:
                      text: p.nextToken();
                    children: []
                    pos: 4380
                    length: 14
                  pos: 4002
                  length: 402
                pos: 3933
                length: 471
              - type: local_variable_declaration
                fields:
                  text: Object value = deser.deserialize(p, ctxt);
                children: []
                pos: 4422
                length: 42
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: p.nextToken()
                            children: []
                            pos: 4525
                            length: 13
                          right:
                            type: field_access
                            fields:
                              text: JsonToken.END_OBJECT
                            children: []
                            pos: 4542
                            length: 20
                        children: []
                        pos: 4525
                        length: 37
                    children: []
                    pos: 4524
                    length: 39
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw ctxt.wrongTokenException(p, JsonToken.END_OBJECT,
                                            "expected closing END_OBJECT after type information and deserialized value");
                    children: []
                    pos: 4578
                    length: 153
                  pos: 4564
                  length: 177
                pos: 4521
                length: 220
              - type: return_statement
                fields:
                  text: return value;
                children: []
                pos: 4750
                length: 13
              pos: 2855
              length: 1914
          children: []
          pos: 2721
          length: 2048
        pos: 776
        length: 3995
    children: []
    pos: 776
    length: 3995
  pos: 0
  length: 4772
text_diff: |
  --- before
  +++ after
  @@ -86,17 +86,15 @@
               }
           }
           // first, sanity checks
  -        JsonToken t = p.getCurrentToken();
  -        if (t == JsonToken.START_OBJECT) {
  +        if (p.getCurrentToken() != JsonToken.START_OBJECT) {
  +            throw ctxt.wrongTokenException(p, JsonToken.START_OBJECT,
  +                    "need JSON Object to contain As.WRAPPER_OBJECT type information for class "+baseTypeName());
  +        }
               // should always get field name, but just in case...
               if (p.nextToken() != JsonToken.FIELD_NAME) {
                   throw ctxt.wrongTokenException(p, JsonToken.FIELD_NAME,
                           "need JSON String that contains type id (for subtype of "+baseTypeName()+")");
               }
  -        } else if (t != JsonToken.FIELD_NAME) {
  -            throw ctxt.wrongTokenException(p, JsonToken.START_OBJECT,
  -                    "need JSON Object to contain As.WRAPPER_OBJECT type information for class "+baseTypeName());
  -        }
           final String typeId = p.getText();
           JsonDeserializer<Object> deser = _findDeserializer(ctxt, typeId);
           p.nextToken();
tree_diff: |+
  New cluster:
  MOVE from block [2855,4842]
  ------------
  ===
  move-tree
  ---
  if_statement [3318,3551]
      parenthesized_expression [3321,3360]
          not_equals [3322,3359]
              method_invocation: p.nextToken() [3322,3335]
              field_access: JsonToken.FIELD_NAME [3339,3359]
      block [3361,3551]
          throw_statement: throw ctxt.wrongTokenException(p, JsonToken.FIELD_NAME,
                          "need JSON String that contains type id (for subtype of "+baseTypeName()+")"); [3379,3537]
  to
  block [2855,4842]
  at 3

  New cluster:
  Unknown cluster type
  ------------
  ===
  insert-tree
  ---
  not_equals [3167,3212]
      method_invocation: p.getCurrentToken() [3167,3186]
      field_access: JsonToken.START_OBJECT [3190,3212]
  to
  parenthesized_expression [3209,3238]
  at 0

  New cluster:
  ===
  insert-node
  ---
  throw_statement: throw ctxt.wrongTokenException(p, JsonToken.START_OBJECT,
                      "need JSON Object to contain As.WRAPPER_OBJECT type information for class "+baseTypeName()); [3228,3398]
  to
  block [3239,3561]
  at 0
  ------------
  ===
  insert-node
  ---
  throw_statement: throw ctxt.wrongTokenException(p, JsonToken.START_OBJECT,
                      "need JSON Object to contain As.WRAPPER_OBJECT type information for class "+baseTypeName()); [3228,3398]
  to
  block [3239,3561]
  at 0

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: JsonToken t = p.getCurrentToken(); [3163,3197]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: JsonToken t = p.getCurrentToken(); [3163,3197]
  ===

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  equals [3210,3237]
      identifier: t [3210,3211]
      field_access: JsonToken.START_OBJECT [3215,3237]

...
