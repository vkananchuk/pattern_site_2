---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: Attributes
        children: []
        pos: 907
        length: 10
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected static final String dataPrefix = "data-";
          children: []
          pos: 966
          length: 51
        - type: field_declaration
          fields:
            text: private static final int InitialCapacity = 4;
          children: []
          pos: 1022
          length: 45
        - type: field_declaration
          fields:
            text: private static final int GrowthFactor = 2;
          children: []
          pos: 1165
          length: 42
        - type: field_declaration
          fields:
            text: private static final String[] Empty = {};
          children: []
          pos: 1212
          length: 41
        - type: field_declaration
          fields:
            text: static final int NotFound = -1;
          children: []
          pos: 1258
          length: 31
        - type: field_declaration
          fields:
            text: private static final String EmptyString = "";
          children: []
          pos: 1294
          length: 45
        - type: field_declaration
          fields:
            text: private int size = 0;
          children: []
          pos: 1345
          length: 21
        - type: field_declaration
          fields:
            text: String[] keys = Empty;
          children: []
          pos: 1431
          length: 22
        - type: field_declaration
          fields:
            text: String[] vals = Empty;
          children: []
          pos: 1458
          length: 22
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkCapacity
              children: []
              pos: 1534
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int minNewSize
                children: []
                pos: 1548
                length: 14
              pos: 1521
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.isTrue(minNewSize >= size);
                children: []
                pos: 1574
                length: 36
              - type: local_variable_declaration
                fields:
                  text: int curSize = keys.length;
                children: []
                pos: 1619
                length: 26
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_or_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: curSize
                            children: []
                            pos: 1658
                            length: 7
                          right:
                            type: identifier
                            fields:
                              text: minNewSize
                            children: []
                            pos: 1669
                            length: 10
                        children: []
                        pos: 1658
                        length: 21
                    children: []
                    pos: 1657
                    length: 23
                children:
                - type: return_statement
                  fields:
                    text: return;
                  children: []
                  pos: 1693
                  length: 7
                pos: 1654
                length: 46
              - type: local_variable_declaration
                fields:
                  text: 'int newSize = curSize >= InitialCapacity ? size * GrowthFactor
                    : InitialCapacity;'
                children: []
                pos: 1710
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: minNewSize
                            children: []
                            pos: 1804
                            length: 10
                          right:
                            type: identifier
                            fields:
                              text: newSize
                            children: []
                            pos: 1817
                            length: 7
                        children: []
                        pos: 1804
                        length: 20
                    children: []
                    pos: 1803
                    length: 22
                children:
                - type: expression_statement
                  fields:
                    text: newSize = minNewSize;
                  children: []
                  pos: 1838
                  length: 21
                pos: 1800
                length: 59
              - type: expression_statement
                fields:
                  text: keys = copyOf(keys, newSize);
                children: []
                pos: 1869
                length: 29
              - type: expression_statement
                fields:
                  text: vals = copyOf(vals, newSize);
                children: []
                pos: 1907
                length: 29
              pos: 1564
              length: 378
          children: []
          pos: 1521
          length: 421
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: copyOf
              children: []
              pos: 2047
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String[] orig
                children: []
                pos: 2054
                length: 13
              pos: 2023
              length: 221
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final String[] copy = new String[size];
                children: []
                pos: 2089
                length: 39
              - type: expression_statement
                fields:
                  text: |-
                    System.arraycopy(orig, 0, copy, 0,
                                    Math.min(orig.length, size));
                children: []
                pos: 2137
                length: 80
              - type: return_statement
                fields:
                  text: return copy;
                children: []
                pos: 2226
                length: 12
              pos: 2079
              length: 165
          children: []
          pos: 2023
          length: 221
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: indexOfKey
              children: []
              pos: 2254
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 2265
                length: 10
              pos: 2250
              length: 204
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(key);
                children: []
                pos: 2287
                length: 22
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                if (key.equals(keys[i]))
                                    return i;
                            }
                children: []
                pos: 2318
                length: 105
              - type: return_statement
                fields:
                  text: return NotFound;
                children: []
                pos: 2432
                length: 16
              pos: 2277
              length: 177
          children: []
          pos: 2250
          length: 204
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: indexOfKeyIgnoreCase
              children: []
              pos: 2472
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 2493
                length: 10
              pos: 2460
              length: 232
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(key);
                children: []
                pos: 2515
                length: 22
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                if (key.equalsIgnoreCase(keys[i]))
                                    return i;
                            }
                children: []
                pos: 2546
                length: 115
              - type: return_statement
                fields:
                  text: return NotFound;
                children: []
                pos: 2670
                length: 16
              pos: 2505
              length: 187
          children: []
          pos: 2460
          length: 232
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkNotNull
              children: []
              pos: 2817
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String val
                children: []
                pos: 2830
                length: 10
              pos: 2803
              length: 94
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return val == null ? EmptyString : val;'
                children: []
                pos: 2852
                length: 39
              pos: 2842
              length: 55
          children: []
          pos: 2803
          length: 94
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: get
              children: []
              pos: 3140
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3144
                length: 10
              pos: 3126
              length: 138
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 3166
                length: 24
              - type: return_statement
                fields:
                  text: 'return i == NotFound ? EmptyString : checkNotNull(vals[i]);'
                children: []
                pos: 3199
                length: 59
              pos: 3156
              length: 108
          children: []
          pos: 3126
          length: 138
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getIgnoreCase
              children: []
              pos: 3503
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3517
                length: 10
              pos: 3489
              length: 158
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 3539
                length: 34
              - type: return_statement
                fields:
                  text: 'return i == NotFound ? EmptyString : checkNotNull(vals[i]);'
                children: []
                pos: 3582
                length: 59
              pos: 3529
              length: 118
          children: []
          pos: 3489
          length: 158
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: add
              children: []
              pos: 3714
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3718
                length: 10
              pos: 3701
              length: 153
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: checkCapacity(size + 1);
                children: []
                pos: 3754
                length: 24
              - type: expression_statement
                fields:
                  text: keys[size] = key;
                children: []
                pos: 3787
                length: 17
              - type: expression_statement
                fields:
                  text: vals[size] = value;
                children: []
                pos: 3813
                length: 19
              - type: expression_statement
                fields:
                  text: size++;
                children: []
                pos: 3841
                length: 7
              pos: 3744
              length: 110
          children: []
          pos: 3701
          length: 153
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 4086
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4090
                length: 10
              pos: 4068
              length: 207
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 4126
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 4163
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 4168
                            length: 8
                        children: []
                        pos: 4163
                        length: 13
                    children: []
                    pos: 4162
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: vals[i] = value;
                  children: []
                  pos: 4190
                  length: 16
                pos: 4159
                length: 89
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 4257
                length: 12
              pos: 4116
              length: 159
          children: []
          pos: 4068
          length: 207
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putIgnoreCase
              children: []
              pos: 4286
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4300
                length: 10
              pos: 4281
              length: 298
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 4336
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 4383
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 4388
                            length: 8
                        children: []
                        pos: 4383
                        length: 13
                    children: []
                    pos: 4382
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: vals[i] = value;
                    children: []
                    pos: 4412
                    length: 16
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!keys[i].equals(key)"
                            children: []
                            pos: 4445
                            length: 20
                        children: []
                        pos: 4444
                        length: 22
                    children:
                    - type: expression_statement
                      fields:
                        text: keys[i] = key;
                      children: []
                      pos: 4507
                      length: 14
                    pos: 4441
                    length: 80
                  pos: 4398
                  length: 133
                pos: 4379
                length: 194
              pos: 4326
              length: 253
          children: []
          pos: 4281
          length: 298
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 4829
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4833
                length: 10
              pos: 4811
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: value
                        children: []
                        pos: 4874
                        length: 5
                    children: []
                    pos: 4873
                    length: 7
                children:
                - type: expression_statement
                  fields:
                    text: putIgnoreCase(key, null);
                  children: []
                  pos: 4893
                  length: 25
                pos: 4870
                length: 86
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 4965
                length: 12
              pos: 4860
              length: 123
          children: []
          pos: 4811
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 5184
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Attribute attribute
                children: []
                pos: 5188
                length: 19
              pos: 5166
              length: 196
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(attribute);
                children: []
                pos: 5219
                length: 28
              - type: expression_statement
                fields:
                  text: put(attribute.getKey(), attribute.getValue());
                children: []
                pos: 5256
                length: 46
              - type: expression_statement
                fields:
                  text: attribute.parent = this;
                children: []
                pos: 5311
                length: 24
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 5344
                length: 12
              pos: 5209
              length: 153
          children: []
          pos: 5166
          length: 196
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: remove
              children: []
              pos: 5410
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 5417
                length: 9
              pos: 5397
              length: 380
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.isFalse(index >= size);
                children: []
                pos: 5438
                length: 32
              - type: local_variable_declaration
                fields:
                  text: int shifted = size - index - 1;
                children: []
                pos: 5479
                length: 31
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: shifted
                            children: []
                            pos: 5523
                            length: 7
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 5533
                            length: 1
                        children: []
                        pos: 5523
                        length: 11
                    children: []
                    pos: 5522
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: System.arraycopy(keys, index + 1, keys, index, shifted);
                    children: []
                    pos: 5550
                    length: 56
                  - type: expression_statement
                    fields:
                      text: System.arraycopy(vals, index + 1, vals, index, shifted);
                    children: []
                    pos: 5619
                    length: 56
                  pos: 5536
                  length: 149
                pos: 5519
                length: 166
              - type: expression_statement
                fields:
                  text: size--;
                children: []
                pos: 5694
                length: 7
              - type: expression_statement
                fields:
                  text: keys[size] = null;
                children: []
                pos: 5710
                length: 18
              - type: expression_statement
                fields:
                  text: vals[size] = null;
                children: []
                pos: 5753
                length: 18
              pos: 5428
              length: 349
          children: []
          pos: 5397
          length: 380
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: remove
              children: []
              pos: 5907
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 5914
                length: 10
              pos: 5895
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 5936
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 5973
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 5978
                            length: 8
                        children: []
                        pos: 5973
                        length: 13
                    children: []
                    pos: 5972
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: remove(i);
                  children: []
                  pos: 6000
                  length: 10
                pos: 5969
                length: 41
              pos: 5926
              length: 90
          children: []
          pos: 5895
          length: 121
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: removeIgnoreCase
              children: []
              pos: 6148
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6165
                length: 10
              pos: 6136
              length: 141
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 6187
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 6234
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 6239
                            length: 8
                        children: []
                        pos: 6234
                        length: 13
                    children: []
                    pos: 6233
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: remove(i);
                  children: []
                  pos: 6261
                  length: 10
                pos: 6230
                length: 41
              pos: 6177
              length: 100
          children: []
          pos: 6136
          length: 141
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasKey
              children: []
              pos: 6478
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6485
                length: 10
              pos: 6463
              length: 85
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return indexOfKey(key) != NotFound;
                children: []
                pos: 6507
                length: 35
              pos: 6497
              length: 51
          children: []
          pos: 6463
          length: 85
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasKeyIgnoreCase
              children: []
              pos: 6734
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6751
                length: 10
              pos: 6719
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return indexOfKeyIgnoreCase(key) != NotFound;
                children: []
                pos: 6773
                length: 45
              pos: 6763
              length: 61
          children: []
          pos: 6719
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: size
              children: []
              pos: 6922
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6911
              length: 46
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return size;
                children: []
                pos: 6939
                length: 12
              pos: 6929
              length: 28
          children: []
          pos: 6911
          length: 46
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addAll
              children: []
              pos: 7114
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Attributes incoming
                children: []
                pos: 7121
                length: 19
              pos: 7102
              length: 278
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: incoming.size()
                            children: []
                            pos: 7156
                            length: 15
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 7175
                            length: 1
                        children: []
                        pos: 7156
                        length: 20
                    children: []
                    pos: 7155
                    length: 22
                children:
                - type: return_statement
                  fields:
                    text: return;
                  children: []
                  pos: 7190
                  length: 7
                pos: 7152
                length: 45
              - type: expression_statement
                fields:
                  text: checkCapacity(size + incoming.size);
                children: []
                pos: 7206
                length: 36
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Attribute attr : incoming) {
                                // todo - should this be case insensitive?
                                put(attr);
                            }
                children: []
                pos: 7252
                length: 121
              pos: 7142
              length: 238
          children: []
          pos: 7102
          length: 278
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 7413
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7386
              length: 592
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new Iterator<Attribute>() {
                                int i = 0;

                                @Override
                                public boolean hasNext() {
                                    return i < size;
                                }

                                @Override
                                public Attribute next() {
                                    final Attribute attr = new Attribute(keys[i], vals[i], Attributes.this);
                                    i++;
                                    return attr;
                                }

                                @Override
                                public void remove() {
                                    Attributes.this.remove(--i); // next() advanced, so rewind
                                }
                            };
                children: []
                pos: 7434
                length: 538
              pos: 7424
              length: 554
          children: []
          pos: 7386
          length: 592
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asList
              children: []
              pos: 8137
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8114
              length: 443
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: ArrayList<Attribute> list = new ArrayList<>(size);
                children: []
                pos: 8156
                length: 50
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                Attribute attr = vals[i] == null ?
                                    new BooleanAttribute(keys[i]) : // deprecated class, but maybe someone still wants it
                                    new Attribute(keys[i], vals[i], Attributes.this);
                                list.add(attr);
                            }
                children: []
                pos: 8215
                length: 285
              - type: return_statement
                fields:
                  text: return Collections.unmodifiableList(list);
                children: []
                pos: 8509
                length: 42
              pos: 8146
              length: 411
          children: []
          pos: 8114
          length: 443
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: dataset
              children: []
              pos: 8804
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8777
              length: 78
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new Dataset(this);
                children: []
                pos: 8824
                length: 25
              pos: 8814
              length: 41
          children: []
          pos: 8777
          length: 78
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: html
              children: []
              pos: 9067
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 9053
              length: 363
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder accum = new StringBuilder();
                children: []
                pos: 9084
                length: 42
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: html(accum, (new Document("")).outputSettings());
                      children: []
                      pos: 9153
                      length: 49
                    pos: 9139
                    length: 133
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) { // ought never happen
                                      throw new SerializationException(e);
                                  }
                      children: []
                      pos: 9273
                      length: 104
                    pos: 9135
                    length: 242
                children: []
                pos: 9135
                length: 242
              - type: return_statement
                fields:
                  text: return accum.toString();
                children: []
                pos: 9386
                length: 24
              pos: 9074
              length: 342
          children: []
          pos: 9053
          length: 363
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: html
              children: []
              pos: 9433
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Appendable accum
                children: []
                pos: 9438
                length: 22
              pos: 9422
              length: 685
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int sz = size;
                children: []
                pos: 9526
                length: 20
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                // inlined from Attribute.html()
                                final String key = keys[i];
                                final String val = vals[i];
                                accum.append(' ').append(key);

                                // collapse checked=null, checked="", checked=checked; write out others
                                if (!Attribute.shouldCollapseAttribute(key, val, out)) {
                                    accum.append("=\"");
                                    Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                                    accum.append('"');
                                }
                            }
                children: []
                pos: 9555
                length: 546
              pos: 9516
              length: 591
          children: []
          pos: 9422
          length: 685
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 10141
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 10113
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return html();
                children: []
                pos: 10162
                length: 14
              pos: 10152
              length: 30
          children: []
          pos: 10113
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 10440
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 10447
                length: 8
              pos: 10411
              length: 351
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: this
                            fields: {}
                            children: []
                            pos: 10471
                            length: 4
                          right:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 10479
                            length: 1
                        children: []
                        pos: 10471
                        length: 9
                    children: []
                    pos: 10470
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 10482
                  length: 12
                pos: 10467
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: o
                                children: []
                                pos: 10507
                                length: 1
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 10512
                                length: 4
                            children: []
                            pos: 10507
                            length: 9
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: getClass()
                                children: []
                                pos: 10520
                                length: 10
                              right:
                                type: method_invocation
                                fields:
                                  text: o.getClass()
                                children: []
                                pos: 10534
                                length: 12
                            children: []
                            pos: 10520
                            length: 26
                        children: []
                        pos: 10507
                        length: 39
                    children: []
                    pos: 10506
                    length: 41
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10548
                  length: 13
                pos: 10503
                length: 58
              - type: local_variable_declaration
                fields:
                  text: Attributes that = (Attributes) o;
                children: []
                pos: 10571
                length: 33
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: size
                            children: []
                            pos: 10618
                            length: 4
                          right:
                            type: field_access
                            fields:
                              text: that.size
                            children: []
                            pos: 10626
                            length: 9
                        children: []
                        pos: 10618
                        length: 17
                    children: []
                    pos: 10617
                    length: 19
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10637
                  length: 13
                pos: 10614
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!Arrays.equals(keys, that.keys)"
                        children: []
                        pos: 10663
                        length: 31
                    children: []
                    pos: 10662
                    length: 33
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10696
                  length: 13
                pos: 10659
                length: 50
              - type: return_statement
                fields:
                  text: return Arrays.equals(vals, that.vals);
                children: []
                pos: 10718
                length: 38
              pos: 10457
              length: 305
          children: []
          pos: 10411
          length: 351
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hashCode
              children: []
              pos: 10953
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 10928
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int result = size;
                children: []
                pos: 10974
                length: 18
              - type: expression_statement
                fields:
                  text: result = 31 * result + Arrays.hashCode(keys);
                children: []
                pos: 11001
                length: 45
              - type: expression_statement
                fields:
                  text: result = 31 * result + Arrays.hashCode(vals);
                children: []
                pos: 11055
                length: 45
              - type: return_statement
                fields:
                  text: return result;
                children: []
                pos: 11109
                length: 14
              pos: 10964
              length: 165
          children: []
          pos: 10928
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: clone
              children: []
              pos: 11167
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 11135
              length: 356
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Attributes clone;
                children: []
                pos: 11185
                length: 17
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: clone = (Attributes) super.clone();
                      children: []
                      pos: 11229
                      length: 35
                    pos: 11215
                    length: 59
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (CloneNotSupportedException e) {
                                      throw new RuntimeException(e);
                                  }
                      children: []
                      pos: 11275
                      length: 91
                    pos: 11211
                    length: 155
                children: []
                pos: 11211
                length: 155
              - type: expression_statement
                fields:
                  text: clone.size = size;
                children: []
                pos: 11375
                length: 18
              - type: expression_statement
                fields:
                  text: keys = copyOf(keys, size);
                children: []
                pos: 11402
                length: 26
              - type: expression_statement
                fields:
                  text: vals = copyOf(vals, size);
                children: []
                pos: 11437
                length: 26
              - type: return_statement
                fields:
                  text: return clone;
                children: []
                pos: 11472
                length: 13
              pos: 11175
              length: 316
          children: []
          pos: 11135
          length: 356
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: normalize
              children: []
              pos: 11570
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 11558
              length: 124
            body:
              type: block
              fields: {}
              children:
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                keys[i] = lowerCase(keys[i]);
                            }
                children: []
                pos: 11592
                length: 84
              pos: 11582
              length: 100
          children: []
          pos: 11558
          length: 124
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: Dataset
              children: []
              pos: 11709
              length: 7
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Attributes attributes;
                children: []
                pos: 11763
                length: 36
              - type: constructor_declaration
                fields:
                  text: |-
                    private Dataset(Attributes attributes) {
                                this.attributes = attributes;
                            }
                children: []
                pos: 11809
                length: 92
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: entrySet
                    children: []
                    pos: 11963
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 11911
                    length: 109
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return new EntrySet();
                      children: []
                      pos: 11988
                      length: 22
                    pos: 11974
                    length: 46
                children: []
                pos: 11911
                length: 109
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: put
                    children: []
                    pos: 12062
                    length: 3
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String key
                      children: []
                      pos: 12066
                      length: 10
                    pos: 12030
                    length: 280
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: String dataKey = dataKey(key);
                      children: []
                      pos: 12106
                      length: 30
                    - type: local_variable_declaration
                      fields:
                        text: 'String oldValue = attributes.hasKey(dataKey) ? attributes.get(dataKey)
                          : null;'
                      children: []
                      pos: 12149
                      length: 78
                    - type: expression_statement
                      fields:
                        text: attributes.put(dataKey, value);
                      children: []
                      pos: 12240
                      length: 31
                    - type: return_statement
                      fields:
                        text: return oldValue;
                      children: []
                      pos: 12284
                      length: 16
                    pos: 12092
                    length: 218
                children: []
                pos: 12030
                length: 280
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: EntrySet
                    children: []
                    pos: 12334
                    length: 8
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: iterator
                          children: []
                          pos: 12470
                          length: 8
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 12405
                          length: 137
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return new DatasetIterator();
                            children: []
                            pos: 12499
                            length: 29
                          pos: 12481
                          length: 61
                      children: []
                      pos: 12405
                      length: 137
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: size
                          children: []
                          pos: 12589
                          length: 4
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 12556
                          length: 239
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: int count = 0;
                            children: []
                            pos: 12614
                            length: 14
                          - type: local_variable_declaration
                            fields:
                              text: Iterator iter = new DatasetIterator();
                            children: []
                            pos: 12645
                            length: 38
                          - type: while_statement
                            fields:
                              text: |-
                                while (iter.hasNext())
                                                    count++;
                            children: []
                            pos: 12700
                            length: 51
                          - type: return_statement
                            fields:
                              text: return count;
                            children: []
                            pos: 12768
                            length: 13
                          pos: 12596
                          length: 199
                      children: []
                      pos: 12556
                      length: 239
                    pos: 12320
                    length: 485
                children: []
                pos: 12320
                length: 485
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: DatasetIterator
                    children: []
                    pos: 12829
                    length: 15
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: field_declaration
                      fields:
                        text: private Iterator<Attribute> attrIter = attributes.iterator();
                      children: []
                      pos: 12906
                      length: 61
                    - type: field_declaration
                      fields:
                        text: private Attribute attr;
                      children: []
                      pos: 12980
                      length: 23
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: hasNext
                          children: []
                          pos: 13031
                          length: 7
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13016
                          length: 238
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: while_statement
                            fields:
                              text: |-
                                while (attrIter.hasNext()) {
                                                    attr = attrIter.next();
                                                    if (attr.isDataAttribute()) return true;
                                                }
                            children: []
                            pos: 13059
                            length: 151
                          - type: return_statement
                            fields:
                              text: return false;
                            children: []
                            pos: 13227
                            length: 13
                          pos: 13041
                          length: 213
                      children: []
                      pos: 13016
                      length: 238
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: next
                          children: []
                          pos: 13297
                          length: 4
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13268
                          length: 152
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return new Attribute(attr.getKey().substring(dataPrefix.length()),
                                attr.getValue());
                            children: []
                            pos: 13322
                            length: 84
                          pos: 13304
                          length: 116
                      children: []
                      pos: 13268
                      length: 152
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: remove
                          children: []
                          pos: 13446
                          length: 6
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13434
                          length: 86
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: attributes.remove(attr.getKey());
                            children: []
                            pos: 13473
                            length: 33
                          pos: 13455
                          length: 65
                      children: []
                      pos: 13434
                      length: 86
                    pos: 12815
                    length: 715
                children: []
                pos: 12815
                length: 715
              pos: 11688
              length: 1848
          children: []
          pos: 11688
          length: 1848
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: dataKey
              children: []
              pos: 13564
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 13572
                length: 10
              pos: 13542
              length: 82
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return dataPrefix + key;
                children: []
                pos: 13594
                length: 24
              pos: 13584
              length: 40
          children: []
          pos: 13542
          length: 82
        pos: 894
        length: 12732
    children: []
    pos: 894
    length: 12732
  pos: 0
  length: 13627
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: Attributes
        children: []
        pos: 907
        length: 10
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected static final String dataPrefix = "data-";
          children: []
          pos: 966
          length: 51
        - type: field_declaration
          fields:
            text: private static final int InitialCapacity = 4;
          children: []
          pos: 1022
          length: 45
        - type: field_declaration
          fields:
            text: private static final int GrowthFactor = 2;
          children: []
          pos: 1165
          length: 42
        - type: field_declaration
          fields:
            text: private static final String[] Empty = {};
          children: []
          pos: 1212
          length: 41
        - type: field_declaration
          fields:
            text: static final int NotFound = -1;
          children: []
          pos: 1258
          length: 31
        - type: field_declaration
          fields:
            text: private static final String EmptyString = "";
          children: []
          pos: 1294
          length: 45
        - type: field_declaration
          fields:
            text: private int size = 0;
          children: []
          pos: 1345
          length: 21
        - type: field_declaration
          fields:
            text: String[] keys = Empty;
          children: []
          pos: 1431
          length: 22
        - type: field_declaration
          fields:
            text: String[] vals = Empty;
          children: []
          pos: 1458
          length: 22
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkCapacity
              children: []
              pos: 1534
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int minNewSize
                children: []
                pos: 1548
                length: 14
              pos: 1521
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.isTrue(minNewSize >= size);
                children: []
                pos: 1574
                length: 36
              - type: local_variable_declaration
                fields:
                  text: int curSize = keys.length;
                children: []
                pos: 1619
                length: 26
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_or_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: curSize
                            children: []
                            pos: 1658
                            length: 7
                          right:
                            type: identifier
                            fields:
                              text: minNewSize
                            children: []
                            pos: 1669
                            length: 10
                        children: []
                        pos: 1658
                        length: 21
                    children: []
                    pos: 1657
                    length: 23
                children:
                - type: return_statement
                  fields:
                    text: return;
                  children: []
                  pos: 1693
                  length: 7
                pos: 1654
                length: 46
              - type: local_variable_declaration
                fields:
                  text: 'int newSize = curSize >= InitialCapacity ? size * GrowthFactor
                    : InitialCapacity;'
                children: []
                pos: 1710
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: minNewSize
                            children: []
                            pos: 1804
                            length: 10
                          right:
                            type: identifier
                            fields:
                              text: newSize
                            children: []
                            pos: 1817
                            length: 7
                        children: []
                        pos: 1804
                        length: 20
                    children: []
                    pos: 1803
                    length: 22
                children:
                - type: expression_statement
                  fields:
                    text: newSize = minNewSize;
                  children: []
                  pos: 1838
                  length: 21
                pos: 1800
                length: 59
              - type: expression_statement
                fields:
                  text: keys = copyOf(keys, newSize);
                children: []
                pos: 1869
                length: 29
              - type: expression_statement
                fields:
                  text: vals = copyOf(vals, newSize);
                children: []
                pos: 1907
                length: 29
              pos: 1564
              length: 378
          children: []
          pos: 1521
          length: 421
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: copyOf
              children: []
              pos: 2047
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String[] orig
                children: []
                pos: 2054
                length: 13
              pos: 2023
              length: 221
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final String[] copy = new String[size];
                children: []
                pos: 2089
                length: 39
              - type: expression_statement
                fields:
                  text: |-
                    System.arraycopy(orig, 0, copy, 0,
                                    Math.min(orig.length, size));
                children: []
                pos: 2137
                length: 80
              - type: return_statement
                fields:
                  text: return copy;
                children: []
                pos: 2226
                length: 12
              pos: 2079
              length: 165
          children: []
          pos: 2023
          length: 221
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: indexOfKey
              children: []
              pos: 2254
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 2265
                length: 10
              pos: 2250
              length: 204
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(key);
                children: []
                pos: 2287
                length: 22
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                if (key.equals(keys[i]))
                                    return i;
                            }
                children: []
                pos: 2318
                length: 105
              - type: return_statement
                fields:
                  text: return NotFound;
                children: []
                pos: 2432
                length: 16
              pos: 2277
              length: 177
          children: []
          pos: 2250
          length: 204
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: indexOfKeyIgnoreCase
              children: []
              pos: 2472
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 2493
                length: 10
              pos: 2460
              length: 232
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(key);
                children: []
                pos: 2515
                length: 22
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                if (key.equalsIgnoreCase(keys[i]))
                                    return i;
                            }
                children: []
                pos: 2546
                length: 115
              - type: return_statement
                fields:
                  text: return NotFound;
                children: []
                pos: 2670
                length: 16
              pos: 2505
              length: 187
          children: []
          pos: 2460
          length: 232
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkNotNull
              children: []
              pos: 2817
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String val
                children: []
                pos: 2830
                length: 10
              pos: 2803
              length: 94
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return val == null ? EmptyString : val;'
                children: []
                pos: 2852
                length: 39
              pos: 2842
              length: 55
          children: []
          pos: 2803
          length: 94
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: get
              children: []
              pos: 3140
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3144
                length: 10
              pos: 3126
              length: 138
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 3166
                length: 24
              - type: return_statement
                fields:
                  text: 'return i == NotFound ? EmptyString : checkNotNull(vals[i]);'
                children: []
                pos: 3199
                length: 59
              pos: 3156
              length: 108
          children: []
          pos: 3126
          length: 138
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getIgnoreCase
              children: []
              pos: 3503
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3517
                length: 10
              pos: 3489
              length: 158
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 3539
                length: 34
              - type: return_statement
                fields:
                  text: 'return i == NotFound ? EmptyString : checkNotNull(vals[i]);'
                children: []
                pos: 3582
                length: 59
              pos: 3529
              length: 118
          children: []
          pos: 3489
          length: 158
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: add
              children: []
              pos: 3714
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 3718
                length: 10
              pos: 3701
              length: 153
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: checkCapacity(size + 1);
                children: []
                pos: 3754
                length: 24
              - type: expression_statement
                fields:
                  text: keys[size] = key;
                children: []
                pos: 3787
                length: 17
              - type: expression_statement
                fields:
                  text: vals[size] = value;
                children: []
                pos: 3813
                length: 19
              - type: expression_statement
                fields:
                  text: size++;
                children: []
                pos: 3841
                length: 7
              pos: 3744
              length: 110
          children: []
          pos: 3701
          length: 153
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 4086
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4090
                length: 10
              pos: 4068
              length: 207
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 4126
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 4163
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 4168
                            length: 8
                        children: []
                        pos: 4163
                        length: 13
                    children: []
                    pos: 4162
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: vals[i] = value;
                  children: []
                  pos: 4190
                  length: 16
                pos: 4159
                length: 89
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 4257
                length: 12
              pos: 4116
              length: 159
          children: []
          pos: 4068
          length: 207
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putIgnoreCase
              children: []
              pos: 4286
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4300
                length: 10
              pos: 4281
              length: 298
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 4336
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 4383
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 4388
                            length: 8
                        children: []
                        pos: 4383
                        length: 13
                    children: []
                    pos: 4382
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: vals[i] = value;
                    children: []
                    pos: 4412
                    length: 16
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!keys[i].equals(key)"
                            children: []
                            pos: 4445
                            length: 20
                        children: []
                        pos: 4444
                        length: 22
                    children:
                    - type: expression_statement
                      fields:
                        text: keys[i] = key;
                      children: []
                      pos: 4507
                      length: 14
                    pos: 4441
                    length: 80
                  pos: 4398
                  length: 133
                pos: 4379
                length: 194
              pos: 4326
              length: 253
          children: []
          pos: 4281
          length: 298
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 4829
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 4833
                length: 10
              pos: 4811
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: value
                        children: []
                        pos: 4874
                        length: 5
                    children: []
                    pos: 4873
                    length: 7
                children:
                - type: expression_statement
                  fields:
                    text: putIgnoreCase(key, null);
                  children: []
                  pos: 4893
                  length: 25
                pos: 4870
                length: 86
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 4965
                length: 12
              pos: 4860
              length: 123
          children: []
          pos: 4811
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: put
              children: []
              pos: 5184
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Attribute attribute
                children: []
                pos: 5188
                length: 19
              pos: 5166
              length: 196
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(attribute);
                children: []
                pos: 5219
                length: 28
              - type: expression_statement
                fields:
                  text: put(attribute.getKey(), attribute.getValue());
                children: []
                pos: 5256
                length: 46
              - type: expression_statement
                fields:
                  text: attribute.parent = this;
                children: []
                pos: 5311
                length: 24
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 5344
                length: 12
              pos: 5209
              length: 153
          children: []
          pos: 5166
          length: 196
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: remove
              children: []
              pos: 5410
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 5417
                length: 9
              pos: 5397
              length: 380
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.isFalse(index >= size);
                children: []
                pos: 5438
                length: 32
              - type: local_variable_declaration
                fields:
                  text: int shifted = size - index - 1;
                children: []
                pos: 5479
                length: 31
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: shifted
                            children: []
                            pos: 5523
                            length: 7
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 5533
                            length: 1
                        children: []
                        pos: 5523
                        length: 11
                    children: []
                    pos: 5522
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: System.arraycopy(keys, index + 1, keys, index, shifted);
                    children: []
                    pos: 5550
                    length: 56
                  - type: expression_statement
                    fields:
                      text: System.arraycopy(vals, index + 1, vals, index, shifted);
                    children: []
                    pos: 5619
                    length: 56
                  pos: 5536
                  length: 149
                pos: 5519
                length: 166
              - type: expression_statement
                fields:
                  text: size--;
                children: []
                pos: 5694
                length: 7
              - type: expression_statement
                fields:
                  text: keys[size] = null;
                children: []
                pos: 5710
                length: 18
              - type: expression_statement
                fields:
                  text: vals[size] = null;
                children: []
                pos: 5753
                length: 18
              pos: 5428
              length: 349
          children: []
          pos: 5397
          length: 380
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: remove
              children: []
              pos: 5907
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 5914
                length: 10
              pos: 5895
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKey(key);
                children: []
                pos: 5936
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 5973
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 5978
                            length: 8
                        children: []
                        pos: 5973
                        length: 13
                    children: []
                    pos: 5972
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: remove(i);
                  children: []
                  pos: 6000
                  length: 10
                pos: 5969
                length: 41
              pos: 5926
              length: 90
          children: []
          pos: 5895
          length: 121
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: removeIgnoreCase
              children: []
              pos: 6148
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6165
                length: 10
              pos: 6136
              length: 141
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int i = indexOfKeyIgnoreCase(key);
                children: []
                pos: 6187
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 6234
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: NotFound
                            children: []
                            pos: 6239
                            length: 8
                        children: []
                        pos: 6234
                        length: 13
                    children: []
                    pos: 6233
                    length: 15
                children:
                - type: expression_statement
                  fields:
                    text: remove(i);
                  children: []
                  pos: 6261
                  length: 10
                pos: 6230
                length: 41
              pos: 6177
              length: 100
          children: []
          pos: 6136
          length: 141
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasKey
              children: []
              pos: 6478
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6485
                length: 10
              pos: 6463
              length: 85
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return indexOfKey(key) != NotFound;
                children: []
                pos: 6507
                length: 35
              pos: 6497
              length: 51
          children: []
          pos: 6463
          length: 85
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasKeyIgnoreCase
              children: []
              pos: 6734
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 6751
                length: 10
              pos: 6719
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return indexOfKeyIgnoreCase(key) != NotFound;
                children: []
                pos: 6773
                length: 45
              pos: 6763
              length: 61
          children: []
          pos: 6719
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: size
              children: []
              pos: 6922
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6911
              length: 46
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return size;
                children: []
                pos: 6939
                length: 12
              pos: 6929
              length: 28
          children: []
          pos: 6911
          length: 46
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addAll
              children: []
              pos: 7114
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Attributes incoming
                children: []
                pos: 7121
                length: 19
              pos: 7102
              length: 278
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: incoming.size()
                            children: []
                            pos: 7156
                            length: 15
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 7175
                            length: 1
                        children: []
                        pos: 7156
                        length: 20
                    children: []
                    pos: 7155
                    length: 22
                children:
                - type: return_statement
                  fields:
                    text: return;
                  children: []
                  pos: 7190
                  length: 7
                pos: 7152
                length: 45
              - type: expression_statement
                fields:
                  text: checkCapacity(size + incoming.size);
                children: []
                pos: 7206
                length: 36
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Attribute attr : incoming) {
                                // todo - should this be case insensitive?
                                put(attr);
                            }
                children: []
                pos: 7252
                length: 121
              pos: 7142
              length: 238
          children: []
          pos: 7102
          length: 278
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 7413
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7386
              length: 592
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new Iterator<Attribute>() {
                                int i = 0;

                                @Override
                                public boolean hasNext() {
                                    return i < size;
                                }

                                @Override
                                public Attribute next() {
                                    final Attribute attr = new Attribute(keys[i], vals[i], Attributes.this);
                                    i++;
                                    return attr;
                                }

                                @Override
                                public void remove() {
                                    Attributes.this.remove(--i); // next() advanced, so rewind
                                }
                            };
                children: []
                pos: 7434
                length: 538
              pos: 7424
              length: 554
          children: []
          pos: 7386
          length: 592
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asList
              children: []
              pos: 8137
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8114
              length: 443
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: ArrayList<Attribute> list = new ArrayList<>(size);
                children: []
                pos: 8156
                length: 50
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                Attribute attr = vals[i] == null ?
                                    new BooleanAttribute(keys[i]) : // deprecated class, but maybe someone still wants it
                                    new Attribute(keys[i], vals[i], Attributes.this);
                                list.add(attr);
                            }
                children: []
                pos: 8215
                length: 285
              - type: return_statement
                fields:
                  text: return Collections.unmodifiableList(list);
                children: []
                pos: 8509
                length: 42
              pos: 8146
              length: 411
          children: []
          pos: 8114
          length: 443
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: dataset
              children: []
              pos: 8804
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8777
              length: 78
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new Dataset(this);
                children: []
                pos: 8824
                length: 25
              pos: 8814
              length: 41
          children: []
          pos: 8777
          length: 78
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: html
              children: []
              pos: 9067
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 9053
              length: 363
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder accum = new StringBuilder();
                children: []
                pos: 9084
                length: 42
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: html(accum, (new Document("")).outputSettings());
                      children: []
                      pos: 9153
                      length: 49
                    pos: 9139
                    length: 133
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) { // ought never happen
                                      throw new SerializationException(e);
                                  }
                      children: []
                      pos: 9273
                      length: 104
                    pos: 9135
                    length: 242
                children: []
                pos: 9135
                length: 242
              - type: return_statement
                fields:
                  text: return accum.toString();
                children: []
                pos: 9386
                length: 24
              pos: 9074
              length: 342
          children: []
          pos: 9053
          length: 363
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: html
              children: []
              pos: 9433
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Appendable accum
                children: []
                pos: 9438
                length: 22
              pos: 9422
              length: 779
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int sz = size;
                children: []
                pos: 9526
                length: 20
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                // inlined from Attribute.html()
                                final String key = keys[i];
                                final String val = vals[i];
                                accum.append(' ').append(key);

                                // collapse checked=null, checked="", checked=checked; write out others
                                if (!(out.syntax() == Document.OutputSettings.Syntax.html
                                    && (val == null || val.equals(key) && Attribute.isBooleanAttribute(key)))) {
                                    accum.append("=\"");
                                    Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                                    accum.append('"');
                                }
                            }
                children: []
                pos: 9555
                length: 640
              pos: 9516
              length: 685
          children: []
          pos: 9422
          length: 779
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 10235
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 10207
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return html();
                children: []
                pos: 10256
                length: 14
              pos: 10246
              length: 30
          children: []
          pos: 10207
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 10534
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 10541
                length: 8
              pos: 10505
              length: 351
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: this
                            fields: {}
                            children: []
                            pos: 10565
                            length: 4
                          right:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 10573
                            length: 1
                        children: []
                        pos: 10565
                        length: 9
                    children: []
                    pos: 10564
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 10576
                  length: 12
                pos: 10561
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: o
                                children: []
                                pos: 10601
                                length: 1
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 10606
                                length: 4
                            children: []
                            pos: 10601
                            length: 9
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: getClass()
                                children: []
                                pos: 10614
                                length: 10
                              right:
                                type: method_invocation
                                fields:
                                  text: o.getClass()
                                children: []
                                pos: 10628
                                length: 12
                            children: []
                            pos: 10614
                            length: 26
                        children: []
                        pos: 10601
                        length: 39
                    children: []
                    pos: 10600
                    length: 41
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10642
                  length: 13
                pos: 10597
                length: 58
              - type: local_variable_declaration
                fields:
                  text: Attributes that = (Attributes) o;
                children: []
                pos: 10665
                length: 33
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: size
                            children: []
                            pos: 10712
                            length: 4
                          right:
                            type: field_access
                            fields:
                              text: that.size
                            children: []
                            pos: 10720
                            length: 9
                        children: []
                        pos: 10712
                        length: 17
                    children: []
                    pos: 10711
                    length: 19
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10731
                  length: 13
                pos: 10708
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!Arrays.equals(keys, that.keys)"
                        children: []
                        pos: 10757
                        length: 31
                    children: []
                    pos: 10756
                    length: 33
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 10790
                  length: 13
                pos: 10753
                length: 50
              - type: return_statement
                fields:
                  text: return Arrays.equals(vals, that.vals);
                children: []
                pos: 10812
                length: 38
              pos: 10551
              length: 305
          children: []
          pos: 10505
          length: 351
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hashCode
              children: []
              pos: 11047
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 11022
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int result = size;
                children: []
                pos: 11068
                length: 18
              - type: expression_statement
                fields:
                  text: result = 31 * result + Arrays.hashCode(keys);
                children: []
                pos: 11095
                length: 45
              - type: expression_statement
                fields:
                  text: result = 31 * result + Arrays.hashCode(vals);
                children: []
                pos: 11149
                length: 45
              - type: return_statement
                fields:
                  text: return result;
                children: []
                pos: 11203
                length: 14
              pos: 11058
              length: 165
          children: []
          pos: 11022
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: clone
              children: []
              pos: 11261
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 11229
              length: 356
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Attributes clone;
                children: []
                pos: 11279
                length: 17
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: clone = (Attributes) super.clone();
                      children: []
                      pos: 11323
                      length: 35
                    pos: 11309
                    length: 59
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (CloneNotSupportedException e) {
                                      throw new RuntimeException(e);
                                  }
                      children: []
                      pos: 11369
                      length: 91
                    pos: 11305
                    length: 155
                children: []
                pos: 11305
                length: 155
              - type: expression_statement
                fields:
                  text: clone.size = size;
                children: []
                pos: 11469
                length: 18
              - type: expression_statement
                fields:
                  text: keys = copyOf(keys, size);
                children: []
                pos: 11496
                length: 26
              - type: expression_statement
                fields:
                  text: vals = copyOf(vals, size);
                children: []
                pos: 11531
                length: 26
              - type: return_statement
                fields:
                  text: return clone;
                children: []
                pos: 11566
                length: 13
              pos: 11269
              length: 316
          children: []
          pos: 11229
          length: 356
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: normalize
              children: []
              pos: 11664
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 11652
              length: 124
            body:
              type: block
              fields: {}
              children:
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < size; i++) {
                                keys[i] = lowerCase(keys[i]);
                            }
                children: []
                pos: 11686
                length: 84
              pos: 11676
              length: 100
          children: []
          pos: 11652
          length: 124
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: Dataset
              children: []
              pos: 11803
              length: 7
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Attributes attributes;
                children: []
                pos: 11857
                length: 36
              - type: constructor_declaration
                fields:
                  text: |-
                    private Dataset(Attributes attributes) {
                                this.attributes = attributes;
                            }
                children: []
                pos: 11903
                length: 92
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: entrySet
                    children: []
                    pos: 12057
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 12005
                    length: 109
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return new EntrySet();
                      children: []
                      pos: 12082
                      length: 22
                    pos: 12068
                    length: 46
                children: []
                pos: 12005
                length: 109
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: put
                    children: []
                    pos: 12156
                    length: 3
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String key
                      children: []
                      pos: 12160
                      length: 10
                    pos: 12124
                    length: 280
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: String dataKey = dataKey(key);
                      children: []
                      pos: 12200
                      length: 30
                    - type: local_variable_declaration
                      fields:
                        text: 'String oldValue = attributes.hasKey(dataKey) ? attributes.get(dataKey)
                          : null;'
                      children: []
                      pos: 12243
                      length: 78
                    - type: expression_statement
                      fields:
                        text: attributes.put(dataKey, value);
                      children: []
                      pos: 12334
                      length: 31
                    - type: return_statement
                      fields:
                        text: return oldValue;
                      children: []
                      pos: 12378
                      length: 16
                    pos: 12186
                    length: 218
                children: []
                pos: 12124
                length: 280
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: EntrySet
                    children: []
                    pos: 12428
                    length: 8
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: iterator
                          children: []
                          pos: 12564
                          length: 8
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 12499
                          length: 137
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return new DatasetIterator();
                            children: []
                            pos: 12593
                            length: 29
                          pos: 12575
                          length: 61
                      children: []
                      pos: 12499
                      length: 137
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: size
                          children: []
                          pos: 12683
                          length: 4
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 12650
                          length: 239
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: int count = 0;
                            children: []
                            pos: 12708
                            length: 14
                          - type: local_variable_declaration
                            fields:
                              text: Iterator iter = new DatasetIterator();
                            children: []
                            pos: 12739
                            length: 38
                          - type: while_statement
                            fields:
                              text: |-
                                while (iter.hasNext())
                                                    count++;
                            children: []
                            pos: 12794
                            length: 51
                          - type: return_statement
                            fields:
                              text: return count;
                            children: []
                            pos: 12862
                            length: 13
                          pos: 12690
                          length: 199
                      children: []
                      pos: 12650
                      length: 239
                    pos: 12414
                    length: 485
                children: []
                pos: 12414
                length: 485
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: DatasetIterator
                    children: []
                    pos: 12923
                    length: 15
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: field_declaration
                      fields:
                        text: private Iterator<Attribute> attrIter = attributes.iterator();
                      children: []
                      pos: 13000
                      length: 61
                    - type: field_declaration
                      fields:
                        text: private Attribute attr;
                      children: []
                      pos: 13074
                      length: 23
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: hasNext
                          children: []
                          pos: 13125
                          length: 7
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13110
                          length: 238
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: while_statement
                            fields:
                              text: |-
                                while (attrIter.hasNext()) {
                                                    attr = attrIter.next();
                                                    if (attr.isDataAttribute()) return true;
                                                }
                            children: []
                            pos: 13153
                            length: 151
                          - type: return_statement
                            fields:
                              text: return false;
                            children: []
                            pos: 13321
                            length: 13
                          pos: 13135
                          length: 213
                      children: []
                      pos: 13110
                      length: 238
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: next
                          children: []
                          pos: 13391
                          length: 4
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13362
                          length: 152
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return new Attribute(attr.getKey().substring(dataPrefix.length()),
                                attr.getValue());
                            children: []
                            pos: 13416
                            length: 84
                          pos: 13398
                          length: 116
                      children: []
                      pos: 13362
                      length: 152
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: remove
                          children: []
                          pos: 13540
                          length: 6
                        parameters:
                          type: method_parameters
                          fields: {}
                          children: []
                          pos: 13528
                          length: 86
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: attributes.remove(attr.getKey());
                            children: []
                            pos: 13567
                            length: 33
                          pos: 13549
                          length: 65
                      children: []
                      pos: 13528
                      length: 86
                    pos: 12909
                    length: 715
                children: []
                pos: 12909
                length: 715
              pos: 11782
              length: 1848
          children: []
          pos: 11782
          length: 1848
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: dataKey
              children: []
              pos: 13658
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String key
                children: []
                pos: 13666
                length: 10
              pos: 13636
              length: 82
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return dataPrefix + key;
                children: []
                pos: 13688
                length: 24
              pos: 13678
              length: 40
          children: []
          pos: 13636
          length: 82
        pos: 894
        length: 12826
    children: []
    pos: 894
    length: 12826
  pos: 0
  length: 13721
text_diff: "--- before\n+++ after\n@@ -316,7 +316,8 @@\n             accum.append('
  ').append(key);\n \n             // collapse checked=null, checked=\"\", checked=checked;
  write out others\n-            if (!Attribute.shouldCollapseAttribute(key, val,
  out)) {\n+            if (!(out.syntax() == Document.OutputSettings.Syntax.html\n+
  \               && (val == null || val.equals(key) && Attribute.isBooleanAttribute(key))))
  {\n                 accum.append(\"=\\\"\");\n                 Entities.escape(accum,
  val == null ? EmptyString : val, out, true, false, false);\n                 accum.append('\"');\n"
tree_diff: |+
  New cluster:
  UPDATE from for (int i = 0; i < sz; i++) {
              // inlined from Attribute.html()
              final String key = keys[i];
              final String val = vals[i];
              accum.append(' ').append(key);

              // collapse checked=null, checked="", checked=checked; write out others
              if (!Attribute.shouldCollapseAttribute(key, val, out)) {
                  accum.append("=\"");
                  Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                  accum.append('"');
              }
          } to for (int i = 0; i < sz; i++) {
              // inlined from Attribute.html()
              final String key = keys[i];
              final String val = vals[i];
              accum.append(' ').append(key);

              // collapse checked=null, checked="", checked=checked; write out others
              if (!(out.syntax() == Document.OutputSettings.Syntax.html
                  && (val == null || val.equals(key) && Attribute.isBooleanAttribute(key)))) {
                  accum.append("=\"");
                  Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                  accum.append('"');
              }
          }
  ------------
  ===
  update-node
  ---
  for_statement: for (int i = 0; i < sz; i++) {
              // inlined from Attribute.html()
              final String key = keys[i];
              final String val = vals[i];
              accum.append(' ').append(key);

              // collapse checked=null, checked="", checked=checked; write out others
              if (!Attribute.shouldCollapseAttribute(key, val, out)) {
                  accum.append("=\"");
                  Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                  accum.append('"');
              }
          } [9555,10101]
  replace for (int i = 0; i < sz; i++) {
              // inlined from Attribute.html()
              final String key = keys[i];
              final String val = vals[i];
              accum.append(' ').append(key);

              // collapse checked=null, checked="", checked=checked; write out others
              if (!Attribute.shouldCollapseAttribute(key, val, out)) {
                  accum.append("=\"");
                  Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                  accum.append('"');
              }
          } by for (int i = 0; i < sz; i++) {
              // inlined from Attribute.html()
              final String key = keys[i];
              final String val = vals[i];
              accum.append(' ').append(key);

              // collapse checked=null, checked="", checked=checked; write out others
              if (!(out.syntax() == Document.OutputSettings.Syntax.html
                  && (val == null || val.equals(key) && Attribute.isBooleanAttribute(key)))) {
                  accum.append("=\"");
                  Entities.escape(accum, val == null ? EmptyString : val, out, true, false, false);
                  accum.append('"');
              }
          }

...
