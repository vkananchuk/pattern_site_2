---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: DateTimeSerializerBase
        children: []
        pos: 708
        length: 22
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final Boolean _useTimestamp;
          children: []
          pos: 946
          length: 38
        - type: field_declaration
          fields:
            text: protected final DateFormat _customFormat;
          children: []
          pos: 1219
          length: 41
        - type: constructor_declaration
          fields:
            text: |-
              protected DateTimeSerializerBase(Class<T> type,
                          Boolean useTimestamp, DateFormat customFormat)
                  {
                      super(type);
                      _useTimestamp = useTimestamp;
                      _customFormat = customFormat;
                  }
          children: []
          pos: 1266
          length: 215
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withFormat
              children: []
              pos: 1529
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Boolean timestamp
                children: []
                pos: 1540
                length: 17
              pos: 1487
              length: 97
          children: []
          pos: 1487
          length: 97
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createContextual
              children: []
              pos: 1629
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 1646
                length: 30
              pos: 1590
              length: 1544
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: property
                            children: []
                            pos: 1759
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 1771
                            length: 4
                        children: []
                        pos: 1759
                        length: 16
                    children: []
                    pos: 1758
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JsonFormat.Value format = serializers.getAnnotationIntrospector().findFormat((Annotated)property.getMember());
                    children: []
                    pos: 1791
                    length: 110
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: format
                                children: []
                                pos: 1918
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 1928
                                length: 4
                            children: []
                            pos: 1918
                            length: 14
                        children: []
                        pos: 1917
                        length: 16
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: JsonFormat.Shape shape = format.getShape();
                        children: []
                        pos: 2020
                        length: 43
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: shape.isNumeric()
                                children: []
                                pos: 2084
                                length: 17
                            children: []
                            pos: 2083
                            length: 19
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return withFormat(Boolean.TRUE, null);
                            children: []
                            pos: 2125
                            length: 38
                          pos: 2103
                          length: 78
                        pos: 2080
                        length: 101
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: or
                                    fields:
                                      left:
                                        type: or
                                        fields:
                                          left:
                                            type: parenthesized_expression
                                            fields:
                                              expression:
                                                type: equals
                                                fields:
                                                  left:
                                                    type: identifier
                                                    fields:
                                                      text: shape
                                                    children: []
                                                    pos: 2204
                                                    length: 5
                                                  right:
                                                    type: field_access
                                                    fields:
                                                      text: JsonFormat.Shape.STRING
                                                    children: []
                                                    pos: 2213
                                                    length: 23
                                                children: []
                                                pos: 2204
                                                length: 32
                                            children: []
                                            pos: 2203
                                            length: 34
                                          right:
                                            type: method_invocation
                                            fields:
                                              text: format.hasPattern()
                                            children: []
                                            pos: 2241
                                            length: 19
                                        children: []
                                        pos: 2203
                                        length: 57
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: format.hasLocale()
                                        children: []
                                        pos: 2296
                                        length: 18
                                    children: []
                                    pos: 2203
                                    length: 111
                                  right:
                                    type: method_invocation
                                    fields:
                                      text: format.hasTimeZone()
                                    children: []
                                    pos: 2318
                                    length: 20
                                children: []
                                pos: 2203
                                length: 135
                            children: []
                            pos: 2202
                            length: 137
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: TimeZone tz = format.getTimeZone();
                            children: []
                            pos: 2362
                            length: 35
                          - type: local_variable_declaration
                            fields:
                              text: |-
                                final String pattern = format.hasPattern()
                                                                    ? format.getPattern()
                                                                    : StdDateFormat.DATE_FORMAT_STR_ISO8601;
                            children: []
                            pos: 2418
                            length: 177
                          - type: local_variable_declaration
                            fields:
                              text: |-
                                final Locale loc = format.hasLocale()
                                                                    ? format.getLocale()
                                                                    : serializers.getLocale();
                            children: []
                            pos: 2616
                            length: 157
                          - type: local_variable_declaration
                            fields:
                              text: SimpleDateFormat df = new SimpleDateFormat(pattern,
                                loc);
                            children: []
                            pos: 2794
                            length: 57
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: tz
                                        children: []
                                        pos: 2876
                                        length: 2
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 2882
                                        length: 4
                                    children: []
                                    pos: 2876
                                    length: 10
                                children: []
                                pos: 2875
                                length: 12
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: tz = serializers.getTimeZone();
                                children: []
                                pos: 2914
                                length: 31
                              pos: 2888
                              length: 79
                            pos: 2872
                            length: 95
                          - type: expression_statement
                            fields:
                              text: df.setTimeZone(tz);
                            children: []
                            pos: 2988
                            length: 19
                          - type: return_statement
                            fields:
                              text: return withFormat(Boolean.FALSE, df);
                            children: []
                            pos: 3028
                            length: 37
                          pos: 2340
                          length: 743
                        pos: 2199
                        length: 884
                      pos: 1934
                      length: 1163
                    pos: 1914
                    length: 1183
                  pos: 1777
                  length: 1330
                pos: 1755
                length: 1352
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 3116
                length: 12
              pos: 1745
              length: 1389
          children: []
          pos: 1590
          length: 1544
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isEmpty
              children: []
              pos: 3346
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 3354
                length: 7
              pos: 3301
              length: 200
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (value == null) || (_timestamp(value) == 0L);
                children: []
                pos: 3443
                length: 52
              pos: 3363
              length: 138
          children: []
          pos: 3301
          length: 200
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isEmpty
              children: []
              pos: 3536
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 3544
                length: 30
              pos: 3507
              length: 216
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (value == null) || (_timestamp(value) == 0L);
                children: []
                pos: 3665
                length: 52
              pos: 3585
              length: 138
          children: []
          pos: 3507
          length: 216
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _timestamp
              children: []
              pos: 3757
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 3768
                length: 7
              pos: 3733
              length: 44
          children: []
          pos: 3733
          length: 44
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getSchema
              children: []
              pos: 3817
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 3827
                length: 30
              pos: 3787
              length: 246
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return createSchemaNode(_asTimestamp(serializers) ? "number"
                    : "string", true);'
                children: []
                pos: 3948
                length: 79
              pos: 3874
              length: 159
          children: []
          pos: 3787
          length: 246
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: acceptJsonFormatVisitor
              children: []
              pos: 4065
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 4089
                length: 32
              pos: 4039
              length: 232
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _acceptJsonFormatVisitor(visitor, typeHint, _asTimestamp(visitor.getProvider()));
                children: []
                pos: 4184
                length: 81
              pos: 4174
              length: 97
          children: []
          pos: 4039
          length: 232
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serialize
              children: []
              pos: 4484
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 4494
                length: 7
              pos: 4449
              length: 132
          children: []
          pos: 4449
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _asTimestamp
              children: []
              pos: 4775
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 4788
                length: 30
              pos: 4757
              length: 602
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _useTimestamp
                            children: []
                            pos: 4838
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4855
                            length: 4
                        children: []
                        pos: 4838
                        length: 21
                    children: []
                    pos: 4837
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return _useTimestamp.booleanValue();
                    children: []
                    pos: 4875
                    length: 36
                  pos: 4861
                  length: 60
                pos: 4834
                length: 87
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _customFormat
                            children: []
                            pos: 4934
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4951
                            length: 4
                        children: []
                        pos: 4934
                        length: 21
                    children: []
                    pos: 4933
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: serializers
                                children: []
                                pos: 4975
                                length: 11
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4990
                                length: 4
                            children: []
                            pos: 4975
                            length: 19
                        children: []
                        pos: 4974
                        length: 21
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return serializers.isEnabled(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
                        children: []
                        pos: 5014
                        length: 77
                      pos: 4996
                      length: 109
                    pos: 4971
                    length: 134
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Null SerializerProvider
                        passed for "+handledType().getName());
                    children: []
                    pos: 5223
                    length: 98
                  pos: 4957
                  length: 374
                pos: 4930
                length: 401
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 5340
                length: 13
              pos: 4824
              length: 535
          children: []
          pos: 4757
          length: 602
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _acceptJsonFormatVisitor
              children: []
              pos: 5380
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 5405
                length: 32
              pos: 5365
              length: 405
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: asNumber
                        children: []
                        pos: 5524
                        length: 8
                    children: []
                    pos: 5523
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        visitIntFormat(visitor, typeHint,
                                            JsonParser.NumberType.LONG, JsonValueFormat.UTC_MILLISEC);
                    children: []
                    pos: 5548
                    length: 112
                  pos: 5534
                  length: 136
                pos: 5520
                length: 244
              pos: 5510
              length: 260
          children: []
          pos: 5365
          length: 405
        pos: 658
        length: 5114
    children: []
    pos: 658
    length: 5114
  pos: 0
  length: 5773
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: DateTimeSerializerBase
        children: []
        pos: 708
        length: 22
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final Boolean _useTimestamp;
          children: []
          pos: 946
          length: 38
        - type: field_declaration
          fields:
            text: protected final DateFormat _customFormat;
          children: []
          pos: 1219
          length: 41
        - type: constructor_declaration
          fields:
            text: |-
              protected DateTimeSerializerBase(Class<T> type,
                          Boolean useTimestamp, DateFormat customFormat)
                  {
                      super(type);
                      _useTimestamp = useTimestamp;
                      _customFormat = customFormat;
                  }
          children: []
          pos: 1266
          length: 215
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withFormat
              children: []
              pos: 1529
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Boolean timestamp
                children: []
                pos: 1540
                length: 17
              pos: 1487
              length: 97
          children: []
          pos: 1487
          length: 97
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createContextual
              children: []
              pos: 1629
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 1646
                length: 30
              pos: 1590
              length: 1453
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: property
                            children: []
                            pos: 1759
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 1771
                            length: 4
                        children: []
                        pos: 1759
                        length: 16
                    children: []
                    pos: 1758
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JsonFormat.Value format = serializers.getAnnotationIntrospector().findFormat((Annotated)property.getMember());
                    children: []
                    pos: 1791
                    length: 110
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: format
                                children: []
                                pos: 1918
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 1928
                                length: 4
                            children: []
                            pos: 1918
                            length: 14
                        children: []
                        pos: 1917
                        length: 16
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: JsonFormat.Shape shape = format.getShape();
                        children: []
                        pos: 2020
                        length: 43
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: shape.isNumeric()
                                children: []
                                pos: 2084
                                length: 17
                            children: []
                            pos: 2083
                            length: 19
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return withFormat(Boolean.TRUE, null);
                            children: []
                            pos: 2125
                            length: 38
                          pos: 2103
                          length: 78
                        pos: 2080
                        length: 101
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: format.getShape()
                                    children: []
                                    pos: 2203
                                    length: 17
                                  right:
                                    type: field_access
                                    fields:
                                      text: JsonFormat.Shape.STRING
                                    children: []
                                    pos: 2224
                                    length: 23
                                children: []
                                pos: 2203
                                length: 44
                            children: []
                            pos: 2202
                            length: 46
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: TimeZone tz = format.getTimeZone();
                            children: []
                            pos: 2271
                            length: 35
                          - type: local_variable_declaration
                            fields:
                              text: |-
                                final String pattern = format.hasPattern()
                                                                    ? format.getPattern()
                                                                    : StdDateFormat.DATE_FORMAT_STR_ISO8601;
                            children: []
                            pos: 2327
                            length: 177
                          - type: local_variable_declaration
                            fields:
                              text: |-
                                final Locale loc = format.hasLocale()
                                                                    ? format.getLocale()
                                                                    : serializers.getLocale();
                            children: []
                            pos: 2525
                            length: 157
                          - type: local_variable_declaration
                            fields:
                              text: SimpleDateFormat df = new SimpleDateFormat(pattern,
                                loc);
                            children: []
                            pos: 2703
                            length: 57
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: tz
                                        children: []
                                        pos: 2785
                                        length: 2
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 2791
                                        length: 4
                                    children: []
                                    pos: 2785
                                    length: 10
                                children: []
                                pos: 2784
                                length: 12
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: tz = serializers.getTimeZone();
                                children: []
                                pos: 2823
                                length: 31
                              pos: 2797
                              length: 79
                            pos: 2781
                            length: 95
                          - type: expression_statement
                            fields:
                              text: df.setTimeZone(tz);
                            children: []
                            pos: 2897
                            length: 19
                          - type: return_statement
                            fields:
                              text: return withFormat(Boolean.FALSE, df);
                            children: []
                            pos: 2937
                            length: 37
                          pos: 2249
                          length: 743
                        pos: 2199
                        length: 793
                      pos: 1934
                      length: 1072
                    pos: 1914
                    length: 1092
                  pos: 1777
                  length: 1239
                pos: 1755
                length: 1261
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 3025
                length: 12
              pos: 1745
              length: 1298
          children: []
          pos: 1590
          length: 1453
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isEmpty
              children: []
              pos: 3255
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 3263
                length: 7
              pos: 3210
              length: 200
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (value == null) || (_timestamp(value) == 0L);
                children: []
                pos: 3352
                length: 52
              pos: 3272
              length: 138
          children: []
          pos: 3210
          length: 200
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isEmpty
              children: []
              pos: 3445
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 3453
                length: 30
              pos: 3416
              length: 216
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (value == null) || (_timestamp(value) == 0L);
                children: []
                pos: 3574
                length: 52
              pos: 3494
              length: 138
          children: []
          pos: 3416
          length: 216
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _timestamp
              children: []
              pos: 3666
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 3677
                length: 7
              pos: 3642
              length: 44
          children: []
          pos: 3642
          length: 44
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getSchema
              children: []
              pos: 3726
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 3736
                length: 30
              pos: 3696
              length: 246
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return createSchemaNode(_asTimestamp(serializers) ? "number"
                    : "string", true);'
                children: []
                pos: 3857
                length: 79
              pos: 3783
              length: 159
          children: []
          pos: 3696
          length: 246
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: acceptJsonFormatVisitor
              children: []
              pos: 3974
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 3998
                length: 32
              pos: 3948
              length: 232
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _acceptJsonFormatVisitor(visitor, typeHint, _asTimestamp(visitor.getProvider()));
                children: []
                pos: 4093
                length: 81
              pos: 4083
              length: 97
          children: []
          pos: 3948
          length: 232
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serialize
              children: []
              pos: 4393
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: T value
                children: []
                pos: 4403
                length: 7
              pos: 4358
              length: 132
          children: []
          pos: 4358
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _asTimestamp
              children: []
              pos: 4684
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider serializers
                children: []
                pos: 4697
                length: 30
              pos: 4666
              length: 602
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _useTimestamp
                            children: []
                            pos: 4747
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4764
                            length: 4
                        children: []
                        pos: 4747
                        length: 21
                    children: []
                    pos: 4746
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return _useTimestamp.booleanValue();
                    children: []
                    pos: 4784
                    length: 36
                  pos: 4770
                  length: 60
                pos: 4743
                length: 87
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _customFormat
                            children: []
                            pos: 4843
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4860
                            length: 4
                        children: []
                        pos: 4843
                        length: 21
                    children: []
                    pos: 4842
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: serializers
                                children: []
                                pos: 4884
                                length: 11
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4899
                                length: 4
                            children: []
                            pos: 4884
                            length: 19
                        children: []
                        pos: 4883
                        length: 21
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return serializers.isEnabled(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);
                        children: []
                        pos: 4923
                        length: 77
                      pos: 4905
                      length: 109
                    pos: 4880
                    length: 134
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Null SerializerProvider
                        passed for "+handledType().getName());
                    children: []
                    pos: 5132
                    length: 98
                  pos: 4866
                  length: 374
                pos: 4839
                length: 401
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 5249
                length: 13
              pos: 4733
              length: 535
          children: []
          pos: 4666
          length: 602
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _acceptJsonFormatVisitor
              children: []
              pos: 5289
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 5314
                length: 32
              pos: 5274
              length: 405
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: asNumber
                        children: []
                        pos: 5433
                        length: 8
                    children: []
                    pos: 5432
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        visitIntFormat(visitor, typeHint,
                                            JsonParser.NumberType.LONG, JsonValueFormat.UTC_MILLISEC);
                    children: []
                    pos: 5457
                    length: 112
                  pos: 5443
                  length: 136
                pos: 5429
                length: 244
              pos: 5419
              length: 260
          children: []
          pos: 5274
          length: 405
        pos: 658
        length: 5023
    children: []
    pos: 658
    length: 5023
  pos: 0
  length: 5682
text_diff: "--- before\n+++ after\n@@ -60,8 +60,7 @@\n                     return
  withFormat(Boolean.TRUE, null);\n                 }\n \n-                if ((shape
  == JsonFormat.Shape.STRING) || format.hasPattern()\n-                                ||
  format.hasLocale() || format.hasTimeZone()) {\n+                if (format.getShape()
  == JsonFormat.Shape.STRING) {\n                     TimeZone tz = format.getTimeZone();\n
  \                    final String pattern = format.hasPattern()\n                                     ?
  format.getPattern()\n"
tree_diff: |+
  New cluster:
  Unknown cluster type
  ------------
  ===
  insert-tree
  ---
  equals [2203,2247]
      method_invocation: format.getShape() [2203,2220]
      field_access: JsonFormat.Shape.STRING [2224,2247]
  to
  parenthesized_expression [2202,2339]
  at 0

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  or [2203,2338]
      or [2203,2314]
          or [2203,2260]
              parenthesized_expression [2203,2237]
                  equals [2204,2236]
                      identifier: shape [2204,2209]
                      field_access: JsonFormat.Shape.STRING [2213,2236]
              method_invocation: format.hasPattern() [2241,2260]
          method_invocation: format.hasLocale() [2296,2314]
      method_invocation: format.hasTimeZone() [2318,2338]

...
