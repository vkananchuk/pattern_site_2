---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: TypedScopeCreator
        children: []
        pos: 4660
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: static final String DELEGATE_PROXY_SUFFIX = "(Proxy)";
          children: []
          pos: 4789
          length: 54
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType MALFORMED_TYPEDEF =
                    DiagnosticType.warning(
                        "JSC_MALFORMED_TYPEDEF",
                        "Typedef for {0} does not have any type information");
          children: []
          pos: 4847
          length: 177
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType ENUM_INITIALIZER =
                    DiagnosticType.warning(
                        "JSC_ENUM_INITIALIZER_NOT_ENUM",
                        "enum initializer must be an object literal or an enum");
          children: []
          pos: 5028
          length: 187
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType CONSTRUCTOR_EXPECTED =
                    DiagnosticType.warning(
                        "JSC_REFLECT_CONSTRUCTOR_EXPECTED",
                        "Constructor expected as first argument");
          children: []
          pos: 5219
          length: 179
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 5402
          length: 40
        - type: field_declaration
          fields:
            text: private final ErrorReporter typeParsingErrorReporter;
          children: []
          pos: 5445
          length: 53
        - type: field_declaration
          fields:
            text: private final TypeValidator validator;
          children: []
          pos: 5501
          length: 38
        - type: field_declaration
          fields:
            text: private final CodingConvention codingConvention;
          children: []
          pos: 5542
          length: 48
        - type: field_declaration
          fields:
            text: private final JSTypeRegistry typeRegistry;
          children: []
          pos: 5593
          length: 42
        - type: field_declaration
          fields:
            text: private List<ObjectType> delegateProxyPrototypes = Lists.newArrayList();
          children: []
          pos: 5638
          length: 72
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DeferredSetType
              children: []
              pos: 5871
              length: 15
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final Node node;
                children: []
                pos: 5893
                length: 16
              - type: field_declaration
                fields:
                  text: final JSType type;
                children: []
                pos: 5914
                length: 18
              - type: constructor_declaration
                fields:
                  text: |-
                    DeferredSetType(Node node, JSType type) {
                          Preconditions.checkNotNull(node);
                          Preconditions.checkNotNull(type);
                          this.node = node;
                          this.type = type;

                          // Other parts of this pass may read off the node.
                          // (like when we set the LHS of an assign with a typed RHS function.)
                          node.setJSType(type);
                        }
                children: []
                pos: 5938
                length: 337
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolve
                    children: []
                    pos: 6286
                    length: 7
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Scope scope
                      children: []
                      pos: 6294
                      length: 11
                    pos: 6281
                    length: 102
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: node.setJSType(type.resolve(typeParsingErrorReporter,
                          scope));
                      children: []
                      pos: 6315
                      length: 62
                    pos: 6307
                    length: 76
                children: []
                pos: 6281
                length: 102
              pos: 5857
              length: 530
          children: []
          pos: 5857
          length: 530
        - type: constructor_declaration
          fields:
            text: |-
              TypedScopeCreator(AbstractCompiler compiler) {
                  this(compiler, compiler.getCodingConvention());
                }
          children: []
          pos: 6391
          length: 102
        - type: constructor_declaration
          fields:
            text: |-
              TypedScopeCreator(AbstractCompiler compiler,
                    CodingConvention codingConvention) {
                  this.compiler = compiler;
                  this.validator = compiler.getTypeValidator();
                  this.codingConvention = codingConvention;
                  this.typeRegistry = compiler.getTypeRegistry();
                  this.typeParsingErrorReporter = typeRegistry.getErrorReporter();
                }
          children: []
          pos: 6497
          length: 338
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createScope
              children: []
              pos: 6989
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node root
                children: []
                pos: 7001
                length: 9
              pos: 6976
              length: 1725
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Scope newScope = null;
                children: []
                pos: 7221
                length: 22
              - type: local_variable_declaration
                fields:
                  text: AbstractScopeBuilder scopeBuilder = null;
                children: []
                pos: 7248
                length: 41
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: parent
                            children: []
                            pos: 7298
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 7308
                            length: 4
                        children: []
                        pos: 7298
                        length: 14
                    children: []
                    pos: 7297
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: newScope = createInitialScope(root);
                    children: []
                    pos: 7373
                    length: 36
                  - type: local_variable_declaration
                    fields:
                      text: GlobalScopeBuilder globalScopeBuilder = new GlobalScopeBuilder(newScope);
                    children: []
                    pos: 7417
                    length: 73
                  - type: expression_statement
                    fields:
                      text: scopeBuilder = globalScopeBuilder;
                    children: []
                    pos: 7497
                    length: 34
                  - type: expression_statement
                    fields:
                      text: NodeTraversal.traverse(compiler, root, scopeBuilder);
                    children: []
                    pos: 7538
                    length: 53
                  pos: 7314
                  length: 283
                pos: 7294
                length: 508
              - type: expression_statement
                fields:
                  text: scopeBuilder.resolveStubDeclarations();
                children: []
                pos: 7808
                length: 39
              - type: expression_statement
                fields:
                  text: scopeBuilder.resolveTypes();
                children: []
                pos: 7852
                length: 28
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Node functionNode : scopeBuilder.nonExternFunctions) {
                          JSType type = functionNode.getJSType();
                          if (type != null && type instanceof FunctionType) {
                            FunctionType fnType = (FunctionType) type;
                            ObjectType fnThisType = fnType.getTypeOfThis();
                            if (!fnThisType.isUnknownType()) {
                              NodeTraversal.traverse(compiler, functionNode.getLastChild(),
                                  scopeBuilder.new CollectProperties(fnThisType));
                            }
                          }
                        }
                children: []
                pos: 8048
                length: 472
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: parent
                            children: []
                            pos: 8530
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8540
                            length: 4
                        children: []
                        pos: 8530
                        length: 14
                    children: []
                    pos: 8529
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        codingConvention.defineDelegateProxyPrototypeProperties(
                                  typeRegistry, newScope, delegateProxyPrototypes);
                    children: []
                    pos: 8554
                    length: 116
                  pos: 8546
                  length: 130
                pos: 8526
                length: 150
              - type: return_statement
                fields:
                  text: return newScope;
                children: []
                pos: 8681
                length: 16
              pos: 7026
              length: 1675
          children: []
          pos: 6976
          length: 1725
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createInitialScope
              children: []
              pos: 8860
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node root
                children: []
                pos: 8879
                length: 9
              pos: 8833
              length: 1616
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: NodeTraversal.traverse(compiler, root, new DiscoverEnums(typeRegistry));
                children: []
                pos: 8897
                length: 72
              - type: local_variable_declaration
                fields:
                  text: Scope s = new Scope(root, compiler);
                children: []
                pos: 8975
                length: 36
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, ARRAY_FUNCTION_TYPE);
                children: []
                pos: 9016
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, BOOLEAN_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9071
                length: 59
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, DATE_FUNCTION_TYPE);
                children: []
                pos: 9135
                length: 49
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, ERROR_FUNCTION_TYPE);
                children: []
                pos: 9189
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, EVAL_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9244
                length: 55
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, FUNCTION_FUNCTION_TYPE);
                children: []
                pos: 9304
                length: 53
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, NUMBER_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9362
                length: 58
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9425
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, RANGE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9481
                length: 56
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, REFERENCE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9542
                length: 60
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, REGEXP_FUNCTION_TYPE);
                children: []
                pos: 9607
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, STRING_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9663
                length: 58
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, SYNTAX_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9726
                length: 57
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, TYPE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9788
                length: 55
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, URI_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9848
                length: 54
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "undefined", VOID_TYPE);
                children: []
                pos: 9907
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "goog.typedef", NO_TYPE);
                children: []
                pos: 10142
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "ActiveXObject", NO_OBJECT_TYPE);
                children: []
                pos: 10371
                length: 59
              - type: return_statement
                fields:
                  text: return s;
                children: []
                pos: 10436
                length: 9
              pos: 8890
              length: 1559
          children: []
          pos: 8833
          length: 1616
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeFunctionType
              children: []
              pos: 10466
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10492
                length: 11
              pos: 10453
              length: 304
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: FunctionType t = typeRegistry.getNativeFunctionType(tId);
                children: []
                pos: 10529
                length: 57
              - type: expression_statement
                fields:
                  text: declareNativeType(scope, t.getInstanceType().getReferenceName(),
                    t);
                children: []
                pos: 10591
                length: 68
              - type: expression_statement
                fields:
                  text: |-
                    declareNativeType(
                            scope, t.getPrototype().getReferenceName(), t.getPrototype());
                children: []
                pos: 10664
                length: 89
              pos: 10523
              length: 234
          children: []
          pos: 10453
          length: 304
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeValueType
              children: []
              pos: 10774
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10797
                length: 11
              pos: 10761
              length: 160
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: declareNativeType(scope, name, typeRegistry.getNativeType(tId));
                children: []
                pos: 10853
                length: 64
              pos: 10847
              length: 74
          children: []
          pos: 10761
          length: 160
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeType
              children: []
              pos: 10938
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10956
                length: 11
              pos: 10925
              length: 119
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: scope.declare(name, null, t, null, false);
                children: []
                pos: 10998
                length: 42
              pos: 10992
              length: 52
          children: []
          pos: 10925
          length: 119
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DiscoverEnums
              children: []
              pos: 11069
              length: 13
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final JSTypeRegistry registry;
                children: []
                pos: 11130
                length: 38
              - type: constructor_declaration
                fields:
                  text: |-
                    DiscoverEnums(JSTypeRegistry registry) {
                          this.registry = registry;
                        }
                children: []
                pos: 11174
                length: 78
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 11284
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 11290
                      length: 15
                    pos: 11258
                    length: 681
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node nameNode = null;
                      children: []
                      pos: 11339
                      length: 21
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: node.getType()
                              children: []
                              pos: 11375
                              length: 14
                          children: []
                          pos: 11374
                          length: 16
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {
                                      case Token.VAR:
                                        for (Node child = node.getFirstChild();
                                             child != null; child = child.getNext()) {
                                          identifyEnumInNameNode(
                                              child, NodeUtil.getInfoForNameNode(child));
                                        }
                                        break;
                                      case Token.EXPR_RESULT:
                                        Node maybeAssign = node.getFirstChild();
                                        if (maybeAssign.getType() == Token.ASSIGN) {
                                          identifyEnumInNameNode(
                                              maybeAssign.getFirstChild(), maybeAssign.getJSDocInfo());
                                        }
                                        break;
                                    }
                          children: []
                          pos: 11391
                          length: 542
                      children: []
                      pos: 11367
                      length: 566
                    pos: 11331
                    length: 608
                children: []
                pos: 11258
                length: 681
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: identifyEnumInNameNode
                    children: []
                    pos: 11958
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node nameNode
                      children: []
                      pos: 11981
                      length: 13
                    pos: 11945
                    length: 203
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 12024
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 12032
                                      length: 4
                                  children: []
                                  pos: 12024
                                  length: 12
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasEnumParameterType()
                                  children: []
                                  pos: 12040
                                  length: 27
                              children: []
                              pos: 12024
                              length: 43
                          children: []
                          pos: 12023
                          length: 45
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: registry.identifyEnumName(nameNode.getQualifiedName());
                          children: []
                          pos: 12079
                          length: 55
                        pos: 12069
                        length: 73
                      pos: 12020
                      length: 122
                    pos: 12012
                    length: 136
                children: []
                pos: 11945
                length: 203
              pos: 11048
              length: 1104
          children: []
          pos: 11048
          length: 1104
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getPrototypePropertyOwner
              children: []
              pos: 12382
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 12408
                length: 6
              pos: 12362
              length: 432
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.getType()
                            children: []
                            pos: 12426
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Token.GETPROP
                            children: []
                            pos: 12441
                            length: 13
                        children: []
                        pos: 12426
                        length: 28
                    children: []
                    pos: 12425
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Node firstChild = n.getFirstChild();
                    children: []
                    pos: 12464
                    length: 36
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: firstChild.getType()
                                    children: []
                                    pos: 12511
                                    length: 20
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.GETPROP
                                    children: []
                                    pos: 12535
                                    length: 13
                                children: []
                                pos: 12511
                                length: 37
                              right:
                                type: method_invocation
                                fields:
                                  text: firstChild.getLastChild().getString().equals("prototype")
                                children: []
                                pos: 12562
                                length: 57
                            children: []
                            pos: 12511
                            length: 108
                        children: []
                        pos: 12510
                        length: 110
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: Node maybeOwner = firstChild.getFirstChild();
                        children: []
                        pos: 12631
                        length: 45
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: maybeOwner.isQualifiedName()
                                children: []
                                pos: 12689
                                length: 28
                            children: []
                            pos: 12688
                            length: 30
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return maybeOwner;
                            children: []
                            pos: 12731
                            length: 18
                          pos: 12719
                          length: 40
                        pos: 12685
                        length: 74
                      pos: 12621
                      length: 146
                    pos: 12507
                    length: 260
                  pos: 12456
                  length: 317
                pos: 12422
                length: 351
              - type: return_statement
                fields:
                  text: return null;
                children: []
                pos: 12778
                length: 12
              pos: 12416
              length: 378
          children: []
          pos: 12362
          length: 432
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: attachLiteralTypes
              children: []
              pos: 12811
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 12830
                length: 6
              pos: 12798
              length: 997
            body:
              type: block
              fields: {}
              children:
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: n.getType()
                        children: []
                        pos: 12852
                        length: 11
                    children: []
                    pos: 12851
                    length: 13
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                              case Token.NULL:
                                n.setJSType(getNativeType(NULL_TYPE));
                                break;

                              case Token.VOID:
                                n.setJSType(getNativeType(VOID_TYPE));
                                break;

                              case Token.STRING:
                                n.setJSType(getNativeType(STRING_TYPE));
                                break;

                              case Token.NUMBER:
                                n.setJSType(getNativeType(NUMBER_TYPE));
                                break;

                              case Token.TRUE:
                              case Token.FALSE:
                                n.setJSType(getNativeType(BOOLEAN_TYPE));
                                break;

                              case Token.REGEXP:
                                n.setJSType(getNativeType(REGEXP_TYPE));
                                break;

                              case Token.REF_SPECIAL:
                                n.setJSType(getNativeType(UNKNOWN_TYPE));
                                break;

                              case Token.OBJECTLIT:
                                if (n.getJSType() == null) {
                                  n.setJSType(typeRegistry.createAnonymousObjectType());
                                }
                                break;

                              // NOTE(nicksantos): If we ever support Array tuples,
                              // we will need to put ARRAYLIT here as well.
                            }
                    children: []
                    pos: 12865
                    length: 926
                children: []
                pos: 12844
                length: 947
              pos: 12838
              length: 957
          children: []
          pos: 12798
          length: 997
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getNativeType
              children: []
              pos: 13814
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSTypeNative nativeType
                children: []
                pos: 13828
                length: 23
              pos: 13799
              length: 110
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return typeRegistry.getNativeType(nativeType);
                children: []
                pos: 13859
                length: 46
              pos: 13853
              length: 56
          children: []
          pos: 13799
          length: 110
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: AbstractScopeBuilder
              children: []
              pos: 13936
              length: 20
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final Scope scope;
                children: []
                pos: 14058
                length: 18
              - type: field_declaration
                fields:
                  text: |-
                    private final List<DeferredSetType> deferredSetTypes =
                            Lists.newArrayList();
                children: []
                pos: 14082
                length: 84
              - type: field_declaration
                fields:
                  text: private final List<Node> nonExternFunctions = Lists.newArrayList();
                children: []
                pos: 14259
                length: 67
              - type: field_declaration
                fields:
                  text: |-
                    private final List<StubDeclaration> stubDeclarations =
                            Lists.newArrayList();
                children: []
                pos: 14502
                length: 84
              - type: field_declaration
                fields:
                  text: private String sourceName = null;
                children: []
                pos: 14654
                length: 33
              - type: constructor_declaration
                fields:
                  text: |-
                    private AbstractScopeBuilder(Scope scope) {
                          this.scope = scope;
                        }
                children: []
                pos: 14693
                length: 75
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: setDeferredType
                    children: []
                    pos: 14779
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node node
                      children: []
                      pos: 14795
                      length: 9
                    pos: 14774
                    length: 113
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: deferredSetTypes.add(new DeferredSetType(node, type));
                      children: []
                      pos: 14827
                      length: 54
                    pos: 14819
                    length: 68
                children: []
                pos: 14774
                length: 113
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolveTypes
                    children: []
                    pos: 14898
                    length: 12
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 14893
                    length: 500
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (DeferredSetType deferred : deferredSetTypes) {
                                  deferred.resolve(scope);
                                }
                      children: []
                      pos: 14970
                      length: 92
                    - type: local_variable_declaration
                      fields:
                        text: Iterator<Var> vars = scope.getVars();
                      children: []
                      pos: 15125
                      length: 37
                    - type: while_statement
                      fields:
                        text: |-
                          while (vars.hasNext()) {
                                  vars.next().resolveType(typeParsingErrorReporter);
                                }
                      children: []
                      pos: 15169
                      length: 91
                    - type: expression_statement
                      fields:
                        text: typeRegistry.resolveTypesInScope(scope);
                      children: []
                      pos: 15347
                      length: 40
                    pos: 14913
                    length: 480
                children: []
                pos: 14893
                length: 500
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: shouldTraverse
                    children: []
                    pos: 15434
                    length: 14
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal nodeTraversal
                      children: []
                      pos: 15449
                      length: 27
                    pos: 15399
                    length: 536
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 15519
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 15534
                                      length: 14
                                  children: []
                                  pos: 15519
                                  length: 29
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 15562
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.SCRIPT
                                      children: []
                                      pos: 15577
                                      length: 12
                                  children: []
                                  pos: 15562
                                  length: 27
                              children: []
                              pos: 15519
                              length: 70
                          children: []
                          pos: 15518
                          length: 72
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: sourceName = (String) n.getProp(Node.SOURCENAME_PROP);
                          children: []
                          pos: 15601
                          length: 54
                        pos: 15591
                        length: 72
                      pos: 15515
                      length: 148
                    - type: return_statement
                      fields:
                        text: |-
                          return parent == null || parent.getType() != Token.FUNCTION ||
                                    n == parent.getFirstChild() || parent == scope.getRootNode();
                      children: []
                      pos: 15795
                      length: 134
                    pos: 15507
                    length: 428
                children: []
                pos: 15399
                length: 536
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 15967
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 15973
                      length: 15
                    pos: 15941
                    length: 1550
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: attachLiteralTypes(n);
                      children: []
                      pos: 16019
                      length: 22
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.getType()
                              children: []
                              pos: 16057
                              length: 11
                          children: []
                          pos: 16056
                          length: 13
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {
                                      case Token.CALL:
                                        checkForClassDefiningCalls(t, n, parent);
                                        break;

                                      case Token.FUNCTION:
                                        if (t.getInput() == null || !t.getInput().isExtern()) {
                                          nonExternFunctions.add(n);
                                        }

                                        // VARs and ASSIGNs are handled in different branches of this
                                        // switch statement.
                                        if (parent.getType() != Token.ASSIGN &&
                                            parent.getType() != Token.NAME) {
                                          defineDeclaredFunction(n, parent);
                                        }

                                        break;

                                      case Token.ASSIGN:
                                        // Handle constructor and enum definitions.
                                        defineNamedTypeAssign(n, parent);

                                        // Handle initialization of properties.
                                        Node firstChild = n.getFirstChild();
                                        if (firstChild.getType() == Token.GETPROP &&
                                            firstChild.isQualifiedName()) {
                                          maybeDeclareQualifiedName(t, n.getJSDocInfo(),
                                              firstChild, n, firstChild.getNext());
                                        }
                                        break;

                                      case Token.CATCH:
                                        defineCatch(n, parent);
                                        break;

                                      case Token.VAR:
                                        defineVar(n, parent);
                                        break;

                                      case Token.GETPROP:
                                        // Handle stubbed properties.
                                        if (parent.getType() == Token.EXPR_RESULT &&
                                            n.isQualifiedName()) {
                                          maybeDeclareQualifiedName(t, n.getJSDocInfo(), n, parent, null);
                                        }
                                        break;
                                    }
                          children: []
                          pos: 16070
                          length: 1415
                      children: []
                      pos: 16049
                      length: 1436
                    pos: 16011
                    length: 1480
                children: []
                pos: 15941
                length: 1550
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredTypeInAnnotation
                    children: []
                    pos: 17734
                    length: 27
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 17771
                      length: 15
                    pos: 17727
                    length: 168
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return getDeclaredTypeInAnnotation(t.getSourceName(),
                          node, info);
                      children: []
                      pos: 17823
                      length: 66
                    pos: 17815
                    length: 80
                children: []
                pos: 17727
                length: 168
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredTypeInAnnotation
                    children: []
                    pos: 17908
                    length: 27
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String sourceName
                      children: []
                      pos: 17936
                      length: 17
                    pos: 17901
                    length: 1675
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: JSType jsType = null;
                      children: []
                      pos: 17998
                      length: 21
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          Node objNode = node.getType() == Token.GETPROP ?
                                    node.getFirstChild() : null;
                      children: []
                      pos: 18026
                      length: 87
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: info
                                  children: []
                                  pos: 18124
                                  length: 4
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 18132
                                  length: 4
                              children: []
                              pos: 18124
                              length: 12
                          children: []
                          pos: 18123
                          length: 14
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 18152
                                  length: 14
                              children: []
                              pos: 18151
                              length: 16
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: jsType = info.getType().evaluate(scope, typeRegistry);
                              children: []
                              pos: 18180
                              length: 54
                            pos: 18168
                            length: 76
                          pos: 18148
                          length: 1393
                        pos: 18138
                        length: 1411
                      pos: 18120
                      length: 1429
                    - type: return_statement
                      fields:
                        text: return jsType;
                      children: []
                      pos: 19556
                      length: 14
                    pos: 17990
                    length: 1586
                children: []
                pos: 17901
                length: 1675
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: assertDefinitionNode
                    children: []
                    pos: 19731
                    length: 20
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 19752
                      length: 6
                    pos: 19726
                    length: 156
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkState(sourceName != null);
                      children: []
                      pos: 19778
                      length: 45
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkState(n.getType() == type);
                      children: []
                      pos: 19830
                      length: 46
                    pos: 19770
                    length: 112
                children: []
                pos: 19726
                length: 156
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineCatch
                    children: []
                    pos: 19943
                    length: 11
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 19955
                      length: 6
                    pos: 19938
                    length: 169
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.CATCH);
                      children: []
                      pos: 19984
                      length: 37
                    - type: local_variable_declaration
                      fields:
                        text: Node catchName = n.getFirstChild();
                      children: []
                      pos: 20028
                      length: 35
                    - type: expression_statement
                      fields:
                        text: defineSlot(catchName, n, null);
                      children: []
                      pos: 20070
                      length: 31
                    pos: 19976
                    length: 131
                children: []
                pos: 19938
                length: 169
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineVar
                    children: []
                    pos: 20171
                    length: 9
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 20181
                      length: 6
                    pos: 20166
                    length: 573
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.VAR);
                      children: []
                      pos: 20210
                      length: 35
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 20252
                      length: 34
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.hasMoreThanOneChild()
                              children: []
                              pos: 20297
                              length: 23
                          children: []
                          pos: 20296
                          length: 25
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 20336
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 20344
                                      length: 4
                                  children: []
                                  pos: 20336
                                  length: 12
                              children: []
                              pos: 20335
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: compiler.report(JSError.make(sourceName, n,
                                  MULTIPLE_VAR_DEF));
                              children: []
                              pos: 20393
                              length: 63
                            pos: 20350
                            length: 116
                          pos: 20332
                          length: 134
                        - type: enhanced_for_statement
                          fields:
                            text: |-
                              for (Node name : n.children()) {
                                        defineName(name, n, parent, name.getJSDocInfo());
                                      }
                          children: []
                          pos: 20475
                          length: 102
                        pos: 20322
                        length: 263
                      pos: 20293
                      length: 440
                    pos: 20202
                    length: 537
                children: []
                pos: 20166
                length: 573
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineDeclaredFunction
                    children: []
                    pos: 20802
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 20825
                      length: 6
                    pos: 20797
                    length: 670
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.FUNCTION);
                      children: []
                      pos: 20854
                      length: 40
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 20902
                      length: 34
                    - type: local_variable_declaration
                      fields:
                        text: int parentType = parent.getType();
                      children: []
                      pos: 20943
                      length: 34
                    - type: expression_statement
                      fields:
                        text: |-
                          Preconditions.checkState(
                                    (scope.isLocal() || parentType != Token.ASSIGN) &&
                                    parentType != Token.NAME,
                                    "function defined as standalone function when it is being " +
                                    "assigned");
                      children: []
                      pos: 20984
                      length: 217
                    - type: local_variable_declaration
                      fields:
                        text: String functionName = n.getFirstChild().getString();
                      children: []
                      pos: 21208
                      length: 52
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          FunctionType functionType = getFunctionType(functionName, n, info,
                                    null);
                      children: []
                      pos: 21267
                      length: 83
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: NodeUtil.isFunctionDeclaration(n)
                              children: []
                              pos: 21361
                              length: 33
                          children: []
                          pos: 21360
                          length: 35
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: defineSlot(n.getFirstChild(), n, functionType);
                          children: []
                          pos: 21406
                          length: 47
                        pos: 21396
                        length: 65
                      pos: 21357
                      length: 104
                    pos: 20846
                    length: 621
                children: []
                pos: 20797
                length: 670
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineNamedTypeAssign
                    children: []
                    pos: 21560
                    length: 21
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 21582
                      length: 6
                    pos: 21555
                    length: 1098
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.ASSIGN);
                      children: []
                      pos: 21611
                      length: 38
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 21656
                      length: 34
                    - type: local_variable_declaration
                      fields:
                        text: Node rvalue = n.getLastChild();
                      children: []
                      pos: 22038
                      length: 31
                    - type: local_variable_declaration
                      fields:
                        text: Node lvalue = n.getFirstChild();
                      children: []
                      pos: 22076
                      length: 32
                    - type: expression_statement
                      fields:
                        text: 'info = (info != null) ? info : rvalue.getJSDocInfo();'
                      children: []
                      pos: 22115
                      length: 53
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: rvalue.getType()
                                      children: []
                                      pos: 22179
                                      length: 16
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 22199
                                      length: 14
                                  children: []
                                  pos: 22179
                                  length: 34
                                right:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 22227
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 22235
                                          length: 4
                                      children: []
                                      pos: 22227
                                      length: 12
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: info.isConstructor()
                                      children: []
                                      pos: 22243
                                      length: 20
                                  children: []
                                  pos: 22227
                                  length: 36
                              children: []
                              pos: 22179
                              length: 84
                          children: []
                          pos: 22178
                          length: 86
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              getFunctionType(lvalue.getQualifiedName(), rvalue, info,
                                          lvalue);
                          children: []
                          pos: 22275
                          length: 77
                        pos: 22265
                        length: 95
                      pos: 22175
                      length: 472
                    pos: 21603
                    length: 1050
                children: []
                pos: 21555
                length: 1098
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineName
                    children: []
                    pos: 23056
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node name
                      children: []
                      pos: 23067
                      length: 9
                    pos: 23043
                    length: 1342
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node value = name.getFirstChild();
                      children: []
                      pos: 23125
                      length: 34
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: value
                                      children: []
                                      pos: 23171
                                      length: 5
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 23180
                                      length: 4
                                  children: []
                                  pos: 23171
                                  length: 13
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: value.getType()
                                      children: []
                                      pos: 23188
                                      length: 15
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 23207
                                      length: 14
                                  children: []
                                  pos: 23188
                                  length: 33
                              children: []
                              pos: 23171
                              length: 50
                          children: []
                          pos: 23170
                          length: 52
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: String functionName = name.getString();
                          children: []
                          pos: 23253
                          length: 39
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              FunctionType functionType =
                                          getFunctionType(functionName, value, info, null);
                          children: []
                          pos: 23301
                          length: 89
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: functionType.isReturnTypeInferred()
                                      children: []
                                      pos: 23403
                                      length: 35
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: scope.isLocal()
                                      children: []
                                      pos: 23454
                                      length: 15
                                  children: []
                                  pos: 23403
                                  length: 66
                              children: []
                              pos: 23402
                              length: 68
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: defineSlot(name, var, null);
                              children: []
                              pos: 23483
                              length: 28
                            pos: 23471
                            length: 50
                          pos: 23399
                          length: 186
                        pos: 23223
                        length: 370
                      pos: 23167
                      length: 1212
                    pos: 23117
                    length: 1268
                children: []
                pos: 23043
                length: 1342
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getFunctionType
                    children: []
                    pos: 25017
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String name
                      children: []
                      pos: 25033
                      length: 11
                    pos: 24996
                    length: 2991
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: FunctionType functionType = null;
                      children: []
                      pos: 25118
                      length: 33
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: rValue
                                          children: []
                                          pos: 25241
                                          length: 6
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 25251
                                          length: 4
                                      children: []
                                      pos: 25241
                                      length: 14
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: rValue.isQualifiedName()
                                      children: []
                                      pos: 25259
                                      length: 24
                                  children: []
                                  pos: 25241
                                  length: 42
                                right:
                                  type: method_invocation
                                  fields:
                                    text: scope.isGlobal()
                                  children: []
                                  pos: 25287
                                  length: 16
                              children: []
                              pos: 25241
                              length: 62
                          children: []
                          pos: 25240
                          length: 64
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var var = scope.getVar(rValue.getQualifiedName());
                          children: []
                          pos: 25315
                          length: 50
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: var
                                          children: []
                                          pos: 25378
                                          length: 3
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 25385
                                          length: 4
                                      children: []
                                      pos: 25378
                                      length: 11
                                    right:
                                      type: instanceof_expression
                                      fields:
                                        text: var.getType() instanceof FunctionType
                                      children: []
                                      pos: 25393
                                      length: 37
                                  children: []
                                  pos: 25378
                                  length: 52
                              children: []
                              pos: 25377
                              length: 54
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: functionType = (FunctionType) var.getType();
                              children: []
                              pos: 25444
                              length: 44
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: functionType
                                              children: []
                                              pos: 25503
                                              length: 12
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 25519
                                              length: 4
                                          children: []
                                          pos: 25503
                                          length: 20
                                        right:
                                          type: method_invocation
                                          fields:
                                            text: functionType.isConstructor()
                                          children: []
                                          pos: 25527
                                          length: 28
                                      children: []
                                      pos: 25503
                                      length: 52
                                  children: []
                                  pos: 25502
                                  length: 54
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: typeRegistry.declareType(name, functionType.getInstanceType());
                                  children: []
                                  pos: 25571
                                  length: 63
                                pos: 25557
                                length: 89
                              pos: 25499
                              length: 147
                            pos: 25432
                            length: 224
                          pos: 25374
                          length: 282
                        - type: return_statement
                          fields:
                            text: return functionType;
                          children: []
                          pos: 25665
                          length: 20
                        pos: 25305
                        length: 388
                      pos: 25237
                      length: 456
                    - type: local_variable_declaration
                      fields:
                        text: Node owner = null;
                      children: []
                      pos: 25701
                      length: 18
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: lvalueNode
                                  children: []
                                  pos: 25730
                                  length: 10
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 25744
                                  length: 4
                              children: []
                              pos: 25730
                              length: 18
                          children: []
                          pos: 25729
                          length: 20
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: owner = getPrototypePropertyOwner(lvalueNode);
                          children: []
                          pos: 25760
                          length: 46
                        pos: 25750
                        length: 64
                      pos: 25726
                      length: 88
                    - type: local_variable_declaration
                      fields:
                        text: 'Node errorRoot = rValue == null ? lvalueNode : rValue;'
                      children: []
                      pos: 25822
                      length: 54
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          boolean isFnLiteral =
                                    rValue != null && rValue.getType() == Token.FUNCTION;
                      children: []
                      pos: 25883
                      length: 85
                    - type: local_variable_declaration
                      fields:
                        text: 'Node fnRoot = isFnLiteral ? rValue : null;'
                      children: []
                      pos: 25975
                      length: 42
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          Node parametersNode = isFnLiteral ?
                                    rValue.getFirstChild().getNext() : null;
                      children: []
                      pos: 26024
                      length: 86
                    - type: local_variable_declaration
                      fields:
                        text: 'Node fnBlock = isFnLiteral ? parametersNode.getNext()
                          : null;'
                      children: []
                      pos: 26117
                      length: 61
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: functionType
                                          children: []
                                          pos: 26190
                                          length: 12
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26206
                                          length: 4
                                      children: []
                                      pos: 26190
                                      length: 20
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 26214
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26222
                                          length: 4
                                      children: []
                                      pos: 26214
                                      length: 12
                                  children: []
                                  pos: 26190
                                  length: 36
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 26230
                                  length: 14
                              children: []
                              pos: 26190
                              length: 54
                          children: []
                          pos: 26189
                          length: 56
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: JSType type = info.getType().evaluate(scope, typeRegistry);
                          children: []
                          pos: 26256
                          length: 59
                        - type: expression_statement
                          fields:
                            text: type = type.restrictByNotNullOrUndefined();
                          children: []
                          pos: 26397
                          length: 43
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: method_invocation
                                  fields:
                                    text: type.isFunctionType()
                                  children: []
                                  pos: 26453
                                  length: 21
                              children: []
                              pos: 26452
                              length: 23
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: functionType = (FunctionType) type;
                              children: []
                              pos: 26488
                              length: 35
                            - type: expression_statement
                              fields:
                                text: functionType.setJSDocInfo(info);
                              children: []
                              pos: 26534
                              length: 32
                            pos: 26476
                            length: 100
                          pos: 26449
                          length: 127
                        pos: 26246
                        length: 338
                      pos: 26186
                      length: 398
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: functionType
                                  children: []
                                  pos: 26596
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 26612
                                  length: 4
                              children: []
                              pos: 26596
                              length: 20
                          children: []
                          pos: 26595
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType overriddenPropType = null;
                          children: []
                          pos: 26681
                          length: 39
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: lvalueNode
                                              children: []
                                              pos: 26733
                                              length: 10
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 26747
                                              length: 4
                                          children: []
                                          pos: 26733
                                          length: 18
                                        right:
                                          type: equals
                                          fields:
                                            left:
                                              type: method_invocation
                                              fields:
                                                text: lvalueNode.getType()
                                              children: []
                                              pos: 26755
                                              length: 20
                                            right:
                                              type: field_access
                                              fields:
                                                text: Token.GETPROP
                                              children: []
                                              pos: 26779
                                              length: 13
                                          children: []
                                          pos: 26755
                                          length: 37
                                      children: []
                                      pos: 26733
                                      length: 59
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: lvalueNode.isQualifiedName()
                                      children: []
                                      pos: 26808
                                      length: 28
                                  children: []
                                  pos: 26733
                                  length: 103
                              children: []
                              pos: 26732
                              length: 105
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  Var var = scope.getVar(
                                                lvalueNode.getFirstChild().getQualifiedName());
                              children: []
                              pos: 26850
                              length: 85
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: var
                                          children: []
                                          pos: 26950
                                          length: 3
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26957
                                          length: 4
                                      children: []
                                      pos: 26950
                                      length: 11
                                  children: []
                                  pos: 26949
                                  length: 13
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: local_variable_declaration
                                  fields:
                                    text: ObjectType ownerType = ObjectType.cast(var.getType());
                                  children: []
                                  pos: 26977
                                  length: 54
                                - type: if_statement
                                  fields:
                                    condition:
                                      type: parenthesized_expression
                                      fields:
                                        expression:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: ownerType
                                              children: []
                                              pos: 27048
                                              length: 9
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 27061
                                              length: 4
                                          children: []
                                          pos: 27048
                                          length: 17
                                      children: []
                                      pos: 27047
                                      length: 19
                                  children:
                                  - type: block
                                    fields: {}
                                    children:
                                    - type: local_variable_declaration
                                      fields:
                                        text: String propName = lvalueNode.getLastChild().getString();
                                      children: []
                                      pos: 27083
                                      length: 56
                                    - type: expression_statement
                                      fields:
                                        text: overriddenPropType = findOverriddenFunction(ownerType,
                                          propName);
                                      children: []
                                      pos: 27154
                                      length: 65
                                    pos: 27067
                                    length: 166
                                  pos: 27044
                                  length: 189
                                pos: 26963
                                length: 282
                              pos: 26946
                              length: 299
                            pos: 26838
                            length: 417
                          pos: 26729
                          length: 526
                        - type: expression_statement
                          fields:
                            text: |-
                              functionType =
                                          new FunctionTypeBuilder(name, compiler, errorRoot, sourceName,
                                              scope)
                                          .setSourceNode(fnRoot)
                                          .inferFromOverriddenFunction(overriddenPropType, parametersNode)
                                          .inferTemplateTypeName(info)
                                          .inferReturnType(info)
                                          .inferInheritance(info)
                                          .inferThisType(info, owner)
                                          .inferParameterTypes(parametersNode, info)
                                          .inferReturnStatementsAsLastResort(fnBlock)
                                          .buildAndRegister();
                          children: []
                          pos: 27265
                          length: 520
                        pos: 26618
                        length: 1175
                      pos: 26592
                      length: 1201
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: rValue
                                  children: []
                                  pos: 27863
                                  length: 6
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 27873
                                  length: 4
                              children: []
                              pos: 27863
                              length: 14
                          children: []
                          pos: 27862
                          length: 16
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: setDeferredType(rValue, functionType);
                          children: []
                          pos: 27889
                          length: 38
                        pos: 27879
                        length: 56
                      pos: 27859
                      length: 76
                    - type: return_statement
                      fields:
                        text: return functionType;
                      children: []
                      pos: 27961
                      length: 20
                    pos: 25110
                    length: 2877
                children: []
                pos: 24996
                length: 2991
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: findOverriddenFunction
                    children: []
                    pos: 28101
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: ObjectType ownerType
                      children: []
                      pos: 28133
                      length: 20
                    pos: 28080
                    length: 740
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: JSType propType = ownerType.getPropertyType(propName);
                      children: []
                      pos: 28266
                      length: 54
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: propType instanceof FunctionType
                              children: []
                              pos: 28331
                              length: 32
                          children: []
                          pos: 28330
                          length: 34
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return (FunctionType) propType;
                          children: []
                          pos: 28375
                          length: 31
                        pos: 28365
                        length: 49
                      pos: 28327
                      length: 467
                    - type: return_statement
                      fields:
                        text: return null;
                      children: []
                      pos: 28802
                      length: 12
                    pos: 28172
                    length: 648
                children: []
                pos: 28080
                length: 740
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getEnumType
                    children: []
                    pos: 29489
                    length: 11
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String name
                      children: []
                      pos: 29501
                      length: 11
                    pos: 29472
                    length: 1569
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: EnumType enumType = null;
                      children: []
                      pos: 29576
                      length: 25
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 29642
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 29651
                                  length: 4
                              children: []
                              pos: 29642
                              length: 13
                          children: []
                          pos: 29641
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: value.getType()
                                      children: []
                                      pos: 29671
                                      length: 15
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.OBJECTLIT
                                      children: []
                                      pos: 29690
                                      length: 15
                                  children: []
                                  pos: 29671
                                  length: 34
                              children: []
                              pos: 29670
                              length: 36
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: enumType = typeRegistry.createEnumType(name,
                                  elementsType);
                              children: []
                              pos: 29754
                              length: 59
                            - type: local_variable_declaration
                              fields:
                                text: Node key = value.getFirstChild();
                              children: []
                              pos: 29862
                              length: 33
                            - type: while_statement
                              fields:
                                text: |-
                                  while (key != null) {
                                              String keyName = NodeUtil.getStringValue(key);

                                              if (enumType.hasOwnProperty(keyName)) {
                                                compiler.report(JSError.make(sourceName, key, ENUM_DUP, keyName));
                                              } else if (!codingConvention.isValidEnumKey(keyName)) {
                                                compiler.report(
                                                    JSError.make(sourceName, key, ENUM_NOT_CONSTANT, keyName));
                                              } else {
                                                enumType.defineElement(keyName);
                                              }
                                              key = key.getNext();
                                              key = (key == null) ? null : key.getNext();
                                            }
                              children: []
                              pos: 29906
                              length: 574
                            pos: 29707
                            length: 783
                          pos: 29667
                          length: 1056
                        pos: 29657
                        length: 1074
                      pos: 29638
                      length: 1093
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: enumType
                                  children: []
                                  pos: 30743
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 30755
                                  length: 4
                              children: []
                              pos: 30743
                              length: 16
                          children: []
                          pos: 30742
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: compiler.report(JSError.make(sourceName, parent,
                              ENUM_INITIALIZER));
                          children: []
                          pos: 30771
                          length: 68
                        pos: 30761
                        length: 86
                      pos: 30739
                      length: 272
                    - type: return_statement
                      fields:
                        text: return enumType;
                      children: []
                      pos: 31019
                      length: 16
                    pos: 29568
                    length: 1473
                children: []
                pos: 29472
                length: 1569
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineSlot
                    children: []
                    pos: 31464
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node name
                      children: []
                      pos: 31475
                      length: 9
                    pos: 31451
                    length: 120
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: defineSlot(name, parent, type, type == null);
                      children: []
                      pos: 31520
                      length: 45
                    pos: 31512
                    length: 59
                children: []
                pos: 31451
                length: 120
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineSlot
                    children: []
                    pos: 32065
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 32076
                      length: 6
                    pos: 32060
                    length: 3403
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(inferred || type != null);
                      children: []
                      pos: 32136
                      length: 54
                    - type: local_variable_declaration
                      fields:
                        text: boolean shouldDeclareOnGlobalThis = false;
                      children: []
                      pos: 32260
                      length: 42
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: n.getType()
                                  children: []
                                  pos: 32313
                                  length: 11
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.NAME
                                  children: []
                                  pos: 32328
                                  length: 10
                              children: []
                              pos: 32313
                              length: 25
                          children: []
                          pos: 32312
                          length: 27
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              Preconditions.checkArgument(
                                          parent.getType() == Token.FUNCTION ||
                                          parent.getType() == Token.VAR ||
                                          parent.getType() == Token.LP ||
                                          parent.getType() == Token.CATCH);
                          children: []
                          pos: 32350
                          length: 213
                        - type: expression_statement
                          fields:
                            text: |-
                              shouldDeclareOnGlobalThis = scope.isGlobal() &&
                                          (parent.getType() == Token.VAR ||
                                           parent.getType() == Token.FUNCTION);
                          children: []
                          pos: 32572
                          length: 143
                        pos: 32340
                        length: 383
                      pos: 32309
                      length: 613
                    - type: local_variable_declaration
                      fields:
                        text: String variableName = n.getQualifiedName();
                      children: []
                      pos: 32929
                      length: 43
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(!variableName.isEmpty());
                      children: []
                      pos: 32979
                      length: 53
                    - type: local_variable_declaration
                      fields:
                        text: Scope scopeToDeclareIn = scope;
                      children: []
                      pos: 33240
                      length: 31
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: equals
                                      fields:
                                        left:
                                          type: method_invocation
                                          fields:
                                            text: n.getType()
                                          children: []
                                          pos: 33282
                                          length: 11
                                        right:
                                          type: field_access
                                          fields:
                                            text: Token.GETPROP
                                          children: []
                                          pos: 33297
                                          length: 13
                                      children: []
                                      pos: 33282
                                      length: 28
                                    right:
                                      type: unary_expression
                                      fields:
                                        text: "!scope.isGlobal()"
                                      children: []
                                      pos: 33314
                                      length: 17
                                  children: []
                                  pos: 33282
                                  length: 49
                                right:
                                  type: method_invocation
                                  fields:
                                    text: isQnameRootedInGlobalScope(n)
                                  children: []
                                  pos: 33345
                                  length: 29
                              children: []
                              pos: 33282
                              length: 92
                          children: []
                          pos: 33281
                          length: 94
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Scope globalScope = scope.getGlobalScope();
                          children: []
                          pos: 33386
                          length: 43
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: unary_expression
                                  fields:
                                    text: "!globalScope.isDeclared(variableName, false)"
                                  children: []
                                  pos: 33556
                                  length: 44
                              children: []
                              pos: 33555
                              length: 46
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: scopeToDeclareIn = scope.getGlobalScope();
                              children: []
                              pos: 33614
                              length: 42
                            pos: 33602
                            length: 64
                          pos: 33552
                          length: 114
                        pos: 33376
                        length: 298
                      pos: 33278
                      length: 396
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: scopeToDeclareIn.isDeclared(variableName, false)
                              children: []
                              pos: 33722
                              length: 48
                          children: []
                          pos: 33721
                          length: 50
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var oldVar = scopeToDeclareIn.getVar(variableName);
                          children: []
                          pos: 33782
                          length: 51
                        - type: expression_statement
                          fields:
                            text: |-
                              validator.expectUndeclaredVariable(
                                          sourceName, n, parent, oldVar, variableName, type);
                          children: []
                          pos: 33842
                          length: 99
                        pos: 33772
                        length: 177
                      pos: 33718
                      length: 1739
                    pos: 32128
                    length: 3335
                children: []
                pos: 32060
                length: 3403
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: isQnameRootedInGlobalScope
                    children: []
                    pos: 35577
                    length: 26
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 35604
                      length: 6
                    pos: 35561
                    length: 302
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node root = NodeUtil.getRootOfQualifiedName(n);
                      children: []
                      pos: 35620
                      length: 47
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: root.getType()
                                  children: []
                                  pos: 35678
                                  length: 14
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.NAME
                                  children: []
                                  pos: 35696
                                  length: 10
                              children: []
                              pos: 35678
                              length: 28
                          children: []
                          pos: 35677
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var var = scope.getVar(root.getString());
                          children: []
                          pos: 35718
                          length: 41
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: var
                                      children: []
                                      pos: 35772
                                      length: 3
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 35779
                                      length: 4
                                  children: []
                                  pos: 35772
                                  length: 11
                              children: []
                              pos: 35771
                              length: 13
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: return_statement
                              fields:
                                text: return var.isGlobal();
                              children: []
                              pos: 35797
                              length: 22
                            pos: 35785
                            length: 44
                          pos: 35768
                          length: 61
                        pos: 35708
                        length: 129
                      pos: 35674
                      length: 163
                    - type: return_statement
                      fields:
                        text: return false;
                      children: []
                      pos: 35844
                      length: 13
                    pos: 35612
                    length: 251
                children: []
                pos: 35561
                length: 302
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredGetPropType
                    children: []
                    pos: 36247
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 36270
                      length: 15
                    pos: 36232
                    length: 506
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 36346
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 36354
                                      length: 4
                                  children: []
                                  pos: 36346
                                  length: 12
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 36362
                                  length: 14
                              children: []
                              pos: 36346
                              length: 30
                          children: []
                          pos: 36345
                          length: 32
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return getDeclaredTypeInAnnotation(t, n, info);
                          children: []
                          pos: 36388
                          length: 47
                        pos: 36378
                        length: 65
                      pos: 36342
                      length: 390
                    pos: 36334
                    length: 404
                children: []
                pos: 36232
                length: 506
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForClassDefiningCalls
                    children: []
                    pos: 36954
                    length: 26
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 36990
                      length: 15
                    pos: 36941
                    length: 2312
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          SubclassRelationship relationship =
                                    codingConvention.getClassesDefinedByCall(n);
                      children: []
                      pos: 37036
                      length: 90
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: relationship
                                  children: []
                                  pos: 37137
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 37153
                                  length: 4
                              children: []
                              pos: 37137
                              length: 20
                          children: []
                          pos: 37136
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType superClass = ObjectType.cast(
                                          typeRegistry.getType(relationship.superclassName));
                          children: []
                          pos: 37169
                          length: 104
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType subClass = ObjectType.cast(
                                          typeRegistry.getType(relationship.subclassName));
                          children: []
                          pos: 37282
                          length: 100
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: superClass
                                          children: []
                                          pos: 37395
                                          length: 10
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 37409
                                          length: 4
                                      children: []
                                      pos: 37395
                                      length: 18
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: subClass
                                          children: []
                                          pos: 37417
                                          length: 8
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 37429
                                          length: 4
                                      children: []
                                      pos: 37417
                                      length: 16
                                  children: []
                                  pos: 37395
                                  length: 38
                              children: []
                              pos: 37394
                              length: 40
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType superCtor = superClass.getConstructor();
                              children: []
                              pos: 37447
                              length: 53
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType subCtor = subClass.getConstructor();
                              children: []
                              pos: 37511
                              length: 49
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: equals
                                      fields:
                                        left:
                                          type: field_access
                                          fields:
                                            text: relationship.type
                                          children: []
                                          pos: 37576
                                          length: 17
                                        right:
                                          type: field_access
                                          fields:
                                            text: SubclassType.INHERITS
                                          children: []
                                          pos: 37597
                                          length: 21
                                      children: []
                                      pos: 37576
                                      length: 42
                                  children: []
                                  pos: 37575
                                  length: 44
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: validator.expectSuperType(t, n, superClass,
                                      subClass);
                                  children: []
                                  pos: 37634
                                  length: 54
                                pos: 37620
                                length: 80
                              pos: 37572
                              length: 128
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: superCtor
                                              children: []
                                              pos: 37716
                                              length: 9
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 37729
                                              length: 4
                                          children: []
                                          pos: 37716
                                          length: 17
                                        right:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: subCtor
                                              children: []
                                              pos: 37737
                                              length: 7
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 37748
                                              length: 4
                                          children: []
                                          pos: 37737
                                          length: 15
                                      children: []
                                      pos: 37716
                                      length: 36
                                  children: []
                                  pos: 37715
                                  length: 38
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: |-
                                      codingConvention.applySubclassRelationship(
                                                      superCtor, subCtor, relationship.type);
                                  children: []
                                  pos: 37768
                                  length: 99
                                pos: 37754
                                length: 125
                              pos: 37712
                              length: 167
                            pos: 37435
                            length: 454
                          pos: 37391
                          length: 498
                        pos: 37159
                        length: 738
                      pos: 37133
                      length: 764
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          String singletonGetterClassName =
                                    codingConvention.getSingletonGetterClassName(n);
                      children: []
                      pos: 37905
                      length: 92
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: singletonGetterClassName
                                  children: []
                                  pos: 38008
                                  length: 24
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 38036
                                  length: 4
                              children: []
                              pos: 38008
                              length: 32
                          children: []
                          pos: 38007
                          length: 34
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType objectType = ObjectType.cast(
                                          typeRegistry.getType(singletonGetterClassName));
                          children: []
                          pos: 38052
                          length: 101
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: objectType
                                      children: []
                                      pos: 38166
                                      length: 10
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 38180
                                      length: 4
                                  children: []
                                  pos: 38166
                                  length: 18
                              children: []
                              pos: 38165
                              length: 20
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType functionType = objectType.getConstructor();
                              children: []
                              pos: 38198
                              length: 56
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: functionType
                                          children: []
                                          pos: 38270
                                          length: 12
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 38286
                                          length: 4
                                      children: []
                                      pos: 38270
                                      length: 20
                                  children: []
                                  pos: 38269
                                  length: 22
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: local_variable_declaration
                                  fields:
                                    text: |-
                                      FunctionType getterType =
                                                      typeRegistry.createFunctionType(objectType);
                                  children: []
                                  pos: 38306
                                  length: 86
                                - type: expression_statement
                                  fields:
                                    text: |-
                                      codingConvention.applySingletonGetter(functionType, getterType,
                                                      objectType);
                                  children: []
                                  pos: 38405
                                  length: 92
                                pos: 38292
                                length: 217
                              pos: 38266
                              length: 243
                            pos: 38186
                            length: 333
                          pos: 38162
                          length: 357
                        pos: 38042
                        length: 485
                      pos: 38004
                      length: 523
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          DelegateRelationship delegateRelationship =
                                    codingConvention.getDelegateRelationship(n);
                      children: []
                      pos: 38535
                      length: 98
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: delegateRelationship
                                  children: []
                                  pos: 38644
                                  length: 20
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 38668
                                  length: 4
                              children: []
                              pos: 38644
                              length: 28
                          children: []
                          pos: 38643
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: applyDelegateRelationship(delegateRelationship);
                          children: []
                          pos: 38684
                          length: 48
                        pos: 38674
                        length: 66
                      pos: 38640
                      length: 100
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectLiteralCast objectLiteralCast =
                                    codingConvention.getObjectLiteralCast(t, n);
                      children: []
                      pos: 38748
                      length: 92
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: objectLiteralCast
                                  children: []
                                  pos: 38851
                                  length: 17
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 38872
                                  length: 4
                              children: []
                              pos: 38851
                              length: 25
                          children: []
                          pos: 38850
                          length: 27
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType type = ObjectType.cast(
                                          typeRegistry.getType(objectLiteralCast.typeName));
                          children: []
                          pos: 38888
                          length: 97
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: type
                                          children: []
                                          pos: 38998
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39006
                                          length: 4
                                      children: []
                                      pos: 38998
                                      length: 12
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: method_invocation
                                          fields:
                                            text: type.getConstructor()
                                          children: []
                                          pos: 39014
                                          length: 21
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39039
                                          length: 4
                                      children: []
                                      pos: 39014
                                      length: 29
                                  children: []
                                  pos: 38998
                                  length: 45
                              children: []
                              pos: 38997
                              length: 47
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: setDeferredType(objectLiteralCast.objectNode,
                                  type);
                              children: []
                              pos: 39057
                              length: 52
                            pos: 39045
                            length: 74
                          pos: 38994
                          length: 245
                        pos: 38878
                        length: 369
                      pos: 38847
                      length: 400
                    pos: 37028
                    length: 2225
                children: []
                pos: 36941
                length: 2312
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: applyDelegateRelationship
                    children: []
                    pos: 39350
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: DelegateRelationship delegateRelationship
                      children: []
                      pos: 39385
                      length: 41
                    pos: 39337
                    length: 1833
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegatorObject = ObjectType.cast(
                                    typeRegistry.getType(delegateRelationship.delegator));
                      children: []
                      pos: 39436
                      length: 110
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegateBaseObject = ObjectType.cast(
                                    typeRegistry.getType(delegateRelationship.delegateBase));
                      children: []
                      pos: 39553
                      length: 116
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegateSuperObject = ObjectType.cast(
                                    typeRegistry.getType(codingConvention.getDelegateSuperclassName()));
                      children: []
                      pos: 39676
                      length: 128
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegatorObject
                                          children: []
                                          pos: 39815
                                          length: 15
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39834
                                          length: 4
                                      children: []
                                      pos: 39815
                                      length: 23
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegateBaseObject
                                          children: []
                                          pos: 39852
                                          length: 18
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39874
                                          length: 4
                                      children: []
                                      pos: 39852
                                      length: 26
                                  children: []
                                  pos: 39815
                                  length: 63
                                right:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: delegateSuperObject
                                      children: []
                                      pos: 39892
                                      length: 19
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 39915
                                      length: 4
                                  children: []
                                  pos: 39892
                                  length: 27
                              children: []
                              pos: 39815
                              length: 104
                          children: []
                          pos: 39814
                          length: 106
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegatorCtor = delegatorObject.getConstructor();
                          children: []
                          pos: 39931
                          length: 62
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegateBaseCtor = delegateBaseObject.getConstructor();
                          children: []
                          pos: 40002
                          length: 68
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegateSuperCtor = delegateSuperObject.getConstructor();
                          children: []
                          pos: 40079
                          length: 70
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: delegatorCtor
                                              children: []
                                              pos: 40163
                                              length: 13
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 40180
                                              length: 4
                                          children: []
                                          pos: 40163
                                          length: 21
                                        right:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: delegateBaseCtor
                                              children: []
                                              pos: 40188
                                              length: 16
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 40208
                                              length: 4
                                          children: []
                                          pos: 40188
                                          length: 24
                                      children: []
                                      pos: 40163
                                      length: 49
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegateSuperCtor
                                          children: []
                                          pos: 40228
                                          length: 17
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 40249
                                          length: 4
                                      children: []
                                      pos: 40228
                                      length: 25
                                  children: []
                                  pos: 40163
                                  length: 90
                              children: []
                              pos: 40162
                              length: 92
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionParamBuilder functionParamBuilder =
                                                new FunctionParamBuilder(typeRegistry);
                              children: []
                              pos: 40267
                              length: 97
                            - type: expression_statement
                              fields:
                                text: |-
                                  functionParamBuilder.addRequiredParams(
                                                getNativeType(U2U_CONSTRUCTOR_TYPE));
                              children: []
                              pos: 40375
                              length: 91
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionType findDelegate = typeRegistry.createFunctionType(
                                                typeRegistry.createDefaultObjectUnion(delegateBaseObject),
                                                functionParamBuilder.build());
                              children: []
                              pos: 40477
                              length: 178
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionType delegateProxy = typeRegistry.createConstructorType(
                                                delegateBaseObject.getReferenceName() + DELEGATE_PROXY_SUFFIX,
                                                null, null, null);
                              children: []
                              pos: 40667
                              length: 174
                            - type: expression_statement
                              fields:
                                text: delegateProxy.setPrototypeBasedOn(delegateBaseObject);
                              children: []
                              pos: 40852
                              length: 54
                            - type: expression_statement
                              fields:
                                text: |-
                                  codingConvention.applyDelegateRelationship(
                                                delegateSuperObject, delegateBaseObject, delegatorObject,
                                                delegateProxy, findDelegate);
                              children: []
                              pos: 40918
                              length: 159
                            - type: expression_statement
                              fields:
                                text: delegateProxyPrototypes.add(delegateProxy.getPrototype());
                              children: []
                              pos: 41088
                              length: 58
                            pos: 40255
                            length: 901
                          pos: 40159
                          length: 997
                        pos: 39921
                        length: 1243
                      pos: 39811
                      length: 1353
                    pos: 39428
                    length: 1742
                children: []
                pos: 39337
                length: 1833
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: maybeDeclareQualifiedName
                    children: []
                    pos: 41604
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 41630
                      length: 15
                    pos: 41599
                    length: 4050
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node ownerNode = n.getFirstChild();
                      children: []
                      pos: 41715
                      length: 35
                    - type: local_variable_declaration
                      fields:
                        text: String ownerName = ownerNode.getQualifiedName();
                      children: []
                      pos: 41757
                      length: 48
                    - type: local_variable_declaration
                      fields:
                        text: String qName = n.getQualifiedName();
                      children: []
                      pos: 41812
                      length: 36
                    - type: local_variable_declaration
                      fields:
                        text: String propName = n.getLastChild().getString();
                      children: []
                      pos: 41855
                      length: 47
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(qName != null && ownerName
                          != null);
                      children: []
                      pos: 41909
                      length: 64
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: '"prototype".equals(propName)'
                              children: []
                              pos: 42220
                              length: 28
                          children: []
                          pos: 42219
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var qVar = scope.getVar(qName);
                          children: []
                          pos: 42260
                          length: 31
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: qVar
                                      children: []
                                      pos: 42304
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 42312
                                      length: 4
                                  children: []
                                  pos: 42304
                                  length: 12
                              children: []
                              pos: 42303
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: unary_expression
                                      fields:
                                        text: "!qVar.isTypeInferred()"
                                      children: []
                                      pos: 42334
                                      length: 22
                                  children: []
                                  pos: 42333
                                  length: 24
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: return_statement
                                  fields:
                                    text: return;
                                  children: []
                                  pos: 42431
                                  length: 7
                                pos: 42358
                                length: 92
                              pos: 42330
                              length: 120
                            - type: expression_statement
                              fields:
                                text: scope.undeclare(qVar);
                              children: []
                              pos: 42461
                              length: 22
                            pos: 42318
                            length: 175
                          pos: 42300
                          length: 193
                        pos: 42250
                        length: 251
                      pos: 42216
                      length: 285
                    - type: local_variable_declaration
                      fields:
                        text: JSType valueType = getDeclaredGetPropType(t, info, n,
                          rhsValue);
                      children: []
                      pos: 43090
                      length: 64
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: valueType
                                      children: []
                                      pos: 43165
                                      length: 9
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 43178
                                      length: 4
                                  children: []
                                  pos: 43165
                                  length: 17
                                right:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: rhsValue
                                      children: []
                                      pos: 43186
                                      length: 8
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 43198
                                      length: 4
                                  children: []
                                  pos: 43186
                                  length: 16
                              children: []
                              pos: 43165
                              length: 37
                          children: []
                          pos: 43164
                          length: 39
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: valueType = rhsValue.getJSType();
                          children: []
                          pos: 43249
                          length: 33
                        pos: 43204
                        length: 86
                      pos: 43161
                      length: 129
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: valueType
                                  children: []
                                  pos: 43302
                                  length: 9
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 43315
                                  length: 4
                              children: []
                              pos: 43302
                              length: 17
                          children: []
                          pos: 43301
                          length: 19
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: parent.getType()
                                      children: []
                                      pos: 43335
                                      length: 16
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.EXPR_RESULT
                                      children: []
                                      pos: 43355
                                      length: 17
                                  children: []
                                  pos: 43335
                                  length: 37
                              children: []
                              pos: 43334
                              length: 39
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: |-
                                  stubDeclarations.add(new StubDeclaration(
                                                n,
                                                t.getInput() != null && t.getInput().isExtern(),
                                                ownerName));
                              children: []
                              pos: 43386
                              length: 148
                            pos: 43374
                            length: 170
                          pos: 43331
                          length: 213
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 43554
                          length: 7
                        pos: 43321
                        length: 248
                      pos: 43298
                      length: 271
                    - type: local_variable_declaration
                      fields:
                        text: boolean inferred = true;
                      children: []
                      pos: 43577
                      length: 24
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: info
                                  children: []
                                  pos: 43612
                                  length: 4
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 43620
                                  length: 4
                              children: []
                              pos: 43612
                              length: 12
                          children: []
                          pos: 43611
                          length: 14
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              inferred = !(info.hasType() || info.hasEnumParameterType() ||
                                          FunctionTypeBuilder.isFunctionTypeDeclaration(info));
                          children: []
                          pos: 43683
                          length: 127
                        pos: 43626
                        length: 192
                      pos: 43608
                      length: 210
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: identifier
                              fields:
                                text: inferred
                              children: []
                              pos: 43830
                              length: 8
                          children: []
                          pos: 43829
                          length: 10
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              inferred = !(rhsValue != null &&
                                          rhsValue.getType() == Token.FUNCTION &&
                                          !scope.isDeclared(qName, false));
                          children: []
                          pos: 43892
                          length: 130
                        pos: 43840
                        length: 190
                      pos: 43826
                      length: 204
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: unary_expression
                              fields:
                                text: "!inferred"
                              children: []
                              pos: 44042
                              length: 9
                          children: []
                          pos: 44041
                          length: 11
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: ObjectType ownerType = getObjectSlot(ownerName);
                          children: []
                          pos: 44063
                          length: 48
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: ownerType
                                      children: []
                                      pos: 44124
                                      length: 9
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 44137
                                      length: 4
                                  children: []
                                  pos: 44124
                                  length: 17
                              children: []
                              pos: 44123
                              length: 19
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: boolean isExtern = t.getInput() != null && t.getInput().isExtern();
                              children: []
                              pos: 44256
                              length: 67
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: parenthesized_expression
                                          fields:
                                            expression:
                                              type: or
                                              fields:
                                                left:
                                                  type: unary_expression
                                                  fields:
                                                    text: "!ownerType.hasOwnProperty(propName)"
                                                  children: []
                                                  pos: 44339
                                                  length: 35
                                                right:
                                                  type: method_invocation
                                                  fields:
                                                    text: ownerType.isPropertyTypeInferred(propName)
                                                  children: []
                                                  pos: 44393
                                                  length: 42
                                              children: []
                                              pos: 44339
                                              length: 96
                                          children: []
                                          pos: 44338
                                          length: 98
                                        right:
                                          type: parenthesized_expression
                                          fields:
                                            expression:
                                              type: or
                                              fields:
                                                left:
                                                  type: parenthesized_expression
                                                  fields:
                                                    expression:
                                                      type: and
                                                      fields:
                                                        left:
                                                          type: identifier
                                                          fields:
                                                            text: isExtern
                                                          children: []
                                                          pos: 44456
                                                          length: 8
                                                        right:
                                                          type: unary_expression
                                                          fields:
                                                            text: "!ownerType.isNativeObjectType()"
                                                          children: []
                                                          pos: 44468
                                                          length: 31
                                                      children: []
                                                      pos: 44456
                                                      length: 43
                                                  children: []
                                                  pos: 44455
                                                  length: 45
                                                right:
                                                  type: unary_expression
                                                  fields:
                                                    text: "!ownerType.isInstanceType()"
                                                  children: []
                                                  pos: 44519
                                                  length: 27
                                              children: []
                                              pos: 44455
                                              length: 91
                                          children: []
                                          pos: 44454
                                          length: 93
                                      children: []
                                      pos: 44338
                                      length: 209
                                  children: []
                                  pos: 44337
                                  length: 211
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: ownerType.defineDeclaredProperty(propName,
                                      valueType, isExtern);
                                  children: []
                                  pos: 44637
                                  length: 64
                                pos: 44549
                                length: 164
                              pos: 44334
                              length: 379
                            pos: 44143
                            length: 580
                          pos: 44120
                          length: 603
                        - type: expression_statement
                          fields:
                            text: defineSlot(n, parent, valueType, inferred);
                          children: []
                          pos: 44865
                          length: 43
                        pos: 44053
                        length: 863
                      pos: 44038
                      length: 1605
                    pos: 41707
                    length: 3942
                children: []
                pos: 41599
                length: 4050
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getObjectSlot
                    children: []
                    pos: 45894
                    length: 13
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String slotName
                      children: []
                      pos: 45908
                      length: 15
                    pos: 45875
                    length: 328
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Var ownerVar = scope.getVar(slotName);
                      children: []
                      pos: 45933
                      length: 38
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ownerVar
                                  children: []
                                  pos: 45982
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 45994
                                  length: 4
                              children: []
                              pos: 45982
                              length: 16
                          children: []
                          pos: 45981
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: JSType ownerVarType = ownerVar.getType();
                          children: []
                          pos: 46010
                          length: 41
                        - type: return_statement
                          fields:
                            text: |-
                              return ObjectType.cast(ownerVarType == null ?
                                          null : ownerVarType.restrictByNotNullOrUndefined());
                          children: []
                          pos: 46060
                          length: 110
                        pos: 46000
                        length: 178
                      pos: 45978
                      length: 200
                    - type: return_statement
                      fields:
                        text: return null;
                      children: []
                      pos: 46185
                      length: 12
                    pos: 45925
                    length: 278
                children: []
                pos: 45875
                length: 328
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolveStubDeclarations
                    children: []
                    pos: 46345
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 46340
                    length: 1189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (StubDeclaration stub : stubDeclarations) {
                                  Node n = stub.node;
                                  Node parent = n.getParent();
                                  String qName = n.getQualifiedName();
                                  String propName = n.getLastChild().getString();
                                  String ownerName = stub.ownerName;
                                  boolean isExtern = stub.isExtern;

                                  if (scope.isDeclared(qName, false)) {
                                    continue;
                                  }

                                  // If we see a stub property, make sure to register this property
                                  // in the type registry.
                                  ObjectType ownerType = getObjectSlot(ownerName);
                                  ObjectType unknownType = typeRegistry.getNativeObjectType(UNKNOWN_TYPE);
                                  defineSlot(n, parent, unknownType, true);

                                  if (ownerType != null &&
                                      (isExtern || ownerType.isFunctionPrototypeType())) {
                                    // If this is a stub for a prototype, just declare it
                                    // as an unknown type. These are seen often in externs.
                                    ownerType.defineInferredProperty(
                                        propName, unknownType, isExtern);
                                  } else {
                                    typeRegistry.registerPropertyOnType(
                                        propName, ownerType == null ? unknownType : ownerType);
                                  }
                                }
                      children: []
                      pos: 46379
                      length: 1144
                    pos: 46371
                    length: 1158
                children: []
                pos: 46340
                length: 1189
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: CollectProperties
                    children: []
                    pos: 47681
                    length: 17
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: field_declaration
                      fields:
                        text: private final ObjectType thisType;
                      children: []
                      pos: 47756
                      length: 34
                    - type: constructor_declaration
                      fields:
                        text: |-
                          CollectProperties(ObjectType thisType) {
                                  this.thisType = thisType;
                                }
                      children: []
                      pos: 47798
                      length: 82
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: visit
                          children: []
                          pos: 47900
                          length: 5
                        parameters:
                          type: method_parameters
                          fields: {}
                          children:
                          - type: formal_parameter
                            fields:
                              text: NodeTraversal t
                            children: []
                            pos: 47906
                            length: 15
                          pos: 47888
                          length: 437
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: n.getType()
                                        children: []
                                        pos: 47958
                                        length: 11
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.EXPR_RESULT
                                        children: []
                                        pos: 47973
                                        length: 17
                                    children: []
                                    pos: 47958
                                    length: 32
                                children: []
                                pos: 47957
                                length: 34
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: local_variable_declaration
                                fields:
                                  text: Node child = n.getFirstChild();
                                children: []
                                pos: 48004
                                length: 31
                              - type: switch_expression
                                fields:
                                  condition:
                                    type: parenthesized_expression
                                    fields:
                                      expression:
                                        type: method_invocation
                                        fields:
                                          text: child.getType()
                                        children: []
                                        pos: 48054
                                        length: 15
                                    children: []
                                    pos: 48053
                                    length: 17
                                  body:
                                    type: switch_block
                                    fields:
                                      text: |-
                                        {
                                                    case Token.ASSIGN:
                                                      maybeCollectMember(t, child.getFirstChild(), child);
                                                      break;
                                                    case Token.GETPROP:
                                                      maybeCollectMember(t, child, child);
                                                      break;
                                                  }
                                    children: []
                                    pos: 48071
                                    length: 236
                                children: []
                                pos: 48046
                                length: 261
                              pos: 47992
                              length: 325
                            pos: 47954
                            length: 363
                          pos: 47944
                          length: 381
                      children: []
                      pos: 47888
                      length: 437
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: maybeCollectMember
                          children: []
                          pos: 48346
                          length: 18
                        parameters:
                          type: method_parameters
                          fields: {}
                          children:
                          - type: formal_parameter
                            fields:
                              text: NodeTraversal t
                            children: []
                            pos: 48365
                            length: 15
                          pos: 48333
                          length: 979
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: JSDocInfo info = nodeWithJsDocInfo.getJSDocInfo();
                            children: []
                            pos: 48439
                            length: 50
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: or
                                        fields:
                                          left:
                                            type: equals
                                            fields:
                                              left:
                                                type: identifier
                                                fields:
                                                  text: info
                                                children: []
                                                pos: 48689
                                                length: 4
                                              right:
                                                type: null_literal
                                                fields: {}
                                                children: []
                                                pos: 48697
                                                length: 4
                                            children: []
                                            pos: 48689
                                            length: 12
                                          right:
                                            type: not_equals
                                            fields:
                                              left:
                                                type: method_invocation
                                                fields:
                                                  text: member.getType()
                                                children: []
                                                pos: 48717
                                                length: 16
                                              right:
                                                type: field_access
                                                fields:
                                                  text: Token.GETPROP
                                                children: []
                                                pos: 48737
                                                length: 13
                                            children: []
                                            pos: 48717
                                            length: 33
                                        children: []
                                        pos: 48689
                                        length: 61
                                      right:
                                        type: not_equals
                                        fields:
                                          left:
                                            type: method_invocation
                                            fields:
                                              text: member.getFirstChild().getType()
                                            children: []
                                            pos: 48766
                                            length: 32
                                          right:
                                            type: field_access
                                            fields:
                                              text: Token.THIS
                                            children: []
                                            pos: 48802
                                            length: 10
                                        children: []
                                        pos: 48766
                                        length: 46
                                    children: []
                                    pos: 48689
                                    length: 123
                                children: []
                                pos: 48688
                                length: 125
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: return_statement
                                fields:
                                  text: return;
                                children: []
                                pos: 48826
                                length: 7
                              pos: 48814
                              length: 29
                            pos: 48685
                            length: 158
                          - type: expression_statement
                            fields:
                              text: member.getFirstChild().setJSType(thisType);
                            children: []
                            pos: 48853
                            length: 43
                          - type: local_variable_declaration
                            fields:
                              text: JSType jsType = getDeclaredTypeInAnnotation(t,
                                member, info);
                            children: []
                            pos: 48905
                            length: 61
                          - type: local_variable_declaration
                            fields:
                              text: Node name = member.getLastChild();
                            children: []
                            pos: 48975
                            length: 34
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: and
                                    fields:
                                      left:
                                        type: not_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: jsType
                                            children: []
                                            pos: 49022
                                            length: 6
                                          right:
                                            type: null_literal
                                            fields: {}
                                            children: []
                                            pos: 49032
                                            length: 4
                                        children: []
                                        pos: 49022
                                        length: 14
                                      right:
                                        type: parenthesized_expression
                                        fields:
                                          expression:
                                            type: or
                                            fields:
                                              left:
                                                type: equals
                                                fields:
                                                  left:
                                                    type: method_invocation
                                                    fields:
                                                      text: name.getType()
                                                    children: []
                                                    pos: 49053
                                                    length: 14
                                                  right:
                                                    type: field_access
                                                    fields:
                                                      text: Token.NAME
                                                    children: []
                                                    pos: 49071
                                                    length: 10
                                                children: []
                                                pos: 49053
                                                length: 28
                                              right:
                                                type: equals
                                                fields:
                                                  left:
                                                    type: method_invocation
                                                    fields:
                                                      text: name.getType()
                                                    children: []
                                                    pos: 49085
                                                    length: 14
                                                  right:
                                                    type: field_access
                                                    fields:
                                                      text: Token.STRING
                                                    children: []
                                                    pos: 49103
                                                    length: 12
                                                children: []
                                                pos: 49085
                                                length: 30
                                            children: []
                                            pos: 49053
                                            length: 62
                                        children: []
                                        pos: 49052
                                        length: 64
                                    children: []
                                    pos: 49022
                                    length: 94
                                children: []
                                pos: 49021
                                length: 96
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: |-
                                    thisType.defineDeclaredProperty(
                                                  name.getString(),
                                                  jsType,
                                                  false /* functions with implementations are not in externs */);
                                children: []
                                pos: 49130
                                length: 164
                              pos: 49118
                              length: 186
                            pos: 49018
                            length: 286
                          pos: 48429
                          length: 883
                      children: []
                      pos: 48333
                      length: 979
                    pos: 47661
                    length: 1657
                children: []
                pos: 47661
                length: 1657
              pos: 13913
              length: 35434
          children: []
          pos: 13913
          length: 35434
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: StubDeclaration
              children: []
              pos: 49444
              length: 15
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Node node;
                children: []
                pos: 49466
                length: 24
              - type: field_declaration
                fields:
                  text: private final boolean isExtern;
                children: []
                pos: 49495
                length: 31
              - type: field_declaration
                fields:
                  text: private final String ownerName;
                children: []
                pos: 49531
                length: 31
              - type: constructor_declaration
                fields:
                  text: |-
                    private StubDeclaration(Node node, boolean isExtern, String ownerName) {
                          this.node = node;
                          this.isExtern = isExtern;
                          this.ownerName = ownerName;
                        }
                children: []
                pos: 49568
                length: 168
              pos: 49417
              length: 323
          children: []
          pos: 49417
          length: 323
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: GlobalScopeBuilder
              children: []
              pos: 49875
              length: 18
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private GlobalScopeBuilder(Scope scope) {
                          super(scope);
                        }
                children: []
                pos: 49930
                length: 67
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 50269
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 50275
                      length: 15
                    pos: 50247
                    length: 489
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: super.visit(t, n, parent);
                      children: []
                      pos: 50321
                      length: 26
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.getType()
                              children: []
                              pos: 50363
                              length: 11
                          children: []
                          pos: 50362
                          length: 13
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {

                                      case Token.ASSIGN:
                                        // Handle typedefs.
                                        checkForOldStyleTypedef(t, n);
                                        break;

                                      case Token.VAR:
                                        // Handle typedefs.
                                        if (n.hasOneChild()) {
                                          checkForOldStyleTypedef(t, n);
                                          checkForTypedef(t, n.getFirstChild(), n.getJSDocInfo());
                                        }
                                        break;
                                    }
                          children: []
                          pos: 50376
                          length: 354
                      children: []
                      pos: 50355
                      length: 375
                    pos: 50313
                    length: 423
                children: []
                pos: 50247
                length: 489
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: maybeDeclareQualifiedName
                    children: []
                    pos: 50761
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 50796
                      length: 15
                    pos: 50742
                    length: 242
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: checkForTypedef(t, n, info);
                      children: []
                      pos: 50881
                      length: 28
                    - type: expression_statement
                      fields:
                        text: super.maybeDeclareQualifiedName(t, info, n, parent,
                          rhsValue);
                      children: []
                      pos: 50916
                      length: 62
                    pos: 50873
                    length: 111
                children: []
                pos: 50742
                length: 242
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForTypedef
                    children: []
                    pos: 51164
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 51189
                      length: 15
                    pos: 51151
                    length: 942
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 51250
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 51258
                                      length: 4
                                  children: []
                                  pos: 51250
                                  length: 12
                                right:
                                  type: unary_expression
                                  fields:
                                    text: "!info.hasTypedefType()"
                                  children: []
                                  pos: 51266
                                  length: 22
                              children: []
                              pos: 51250
                              length: 38
                          children: []
                          pos: 51249
                          length: 40
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 51300
                          length: 7
                        pos: 51290
                        length: 25
                      pos: 51246
                      length: 69
                    - type: local_variable_declaration
                      fields:
                        text: String typedef = candidate.getQualifiedName();
                      children: []
                      pos: 51323
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: typedef
                                  children: []
                                  pos: 51380
                                  length: 7
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 51391
                                  length: 4
                              children: []
                              pos: 51380
                              length: 15
                          children: []
                          pos: 51379
                          length: 17
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 51407
                          length: 7
                        pos: 51397
                        length: 25
                      pos: 51376
                      length: 46
                    - type: expression_statement
                      fields:
                        text: typeRegistry.forwardDeclareType(typedef);
                      children: []
                      pos: 51596
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: JSType realType = info.getTypedefType().evaluate(scope,
                          typeRegistry);
                      children: []
                      pos: 51645
                      length: 70
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: realType
                                  children: []
                                  pos: 51726
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 51738
                                  length: 4
                              children: []
                              pos: 51726
                              length: 16
                          children: []
                          pos: 51725
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              compiler.report(
                                          JSError.make(
                                              t.getSourceName(), candidate, MALFORMED_TYPEDEF, typedef));
                          children: []
                          pos: 51754
                          length: 118
                        pos: 51744
                        length: 136
                      pos: 51722
                      length: 158
                    - type: expression_statement
                      fields:
                        text: typeRegistry.declareType(typedef, realType);
                      children: []
                      pos: 51888
                      length: 44
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: candidate.getType()
                                  children: []
                                  pos: 51943
                                  length: 19
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.GETPROP
                                  children: []
                                  pos: 51966
                                  length: 13
                              children: []
                              pos: 51943
                              length: 36
                          children: []
                          pos: 51942
                          length: 38
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              defineSlot(candidate, candidate.getParent(),
                                          getNativeType(NO_TYPE), false);
                          children: []
                          pos: 51991
                          length: 88
                        pos: 51981
                        length: 106
                      pos: 51939
                      length: 148
                    pos: 51238
                    length: 855
                children: []
                pos: 51151
                length: 942
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForOldStyleTypedef
                    children: []
                    pos: 52274
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 52298
                      length: 15
                    pos: 52261
                    length: 988
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: String typedef = codingConvention.identifyTypeDefAssign(candidate);
                      children: []
                      pos: 52367
                      length: 67
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: typedef
                                  children: []
                                  pos: 52445
                                  length: 7
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 52456
                                  length: 4
                              children: []
                              pos: 52445
                              length: 15
                          children: []
                          pos: 52444
                          length: 17
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: typeRegistry.forwardDeclareType(typedef);
                          children: []
                          pos: 52644
                          length: 41
                        - type: local_variable_declaration
                          fields:
                            text: JSDocInfo info = candidate.getJSDocInfo();
                          children: []
                          pos: 52695
                          length: 42
                        - type: local_variable_declaration
                          fields:
                            text: JSType realType = null;
                          children: []
                          pos: 52746
                          length: 23
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 52782
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 52790
                                          length: 4
                                      children: []
                                      pos: 52782
                                      length: 12
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: method_invocation
                                          fields:
                                            text: info.getType()
                                          children: []
                                          pos: 52798
                                          length: 14
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 52816
                                          length: 4
                                      children: []
                                      pos: 52798
                                      length: 22
                                  children: []
                                  pos: 52782
                                  length: 38
                              children: []
                              pos: 52781
                              length: 40
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: realType = info.getType().evaluate(scope, typeRegistry);
                              children: []
                              pos: 52834
                              length: 56
                            pos: 52822
                            length: 78
                          pos: 52778
                          length: 122
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: realType
                                      children: []
                                      pos: 52914
                                      length: 8
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 52926
                                      length: 4
                                  children: []
                                  pos: 52914
                                  length: 16
                              children: []
                              pos: 52913
                              length: 18
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: |-
                                  compiler.report(
                                                JSError.make(
                                                    t.getSourceName(), candidate, MALFORMED_TYPEDEF, typedef));
                              children: []
                              pos: 52944
                              length: 122
                            pos: 52932
                            length: 144
                          pos: 52910
                          length: 166
                        - type: expression_statement
                          fields:
                            text: typeRegistry.declareType(typedef, realType);
                          children: []
                          pos: 53086
                          length: 44
                        pos: 52462
                        length: 781
                      pos: 52441
                      length: 802
                    pos: 52331
                    length: 918
                children: []
                pos: 52261
                length: 988
              pos: 49855
              length: 3398
          children: []
          pos: 49855
          length: 3398
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: LocalScopeBuilder
              children: []
              pos: 53405
              length: 17
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private LocalScopeBuilder(Scope scope) {
                          super(scope);
                        }
                children: []
                pos: 53525
                length: 66
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: build
                    children: []
                    pos: 53663
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 53658
                    length: 87
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: NodeTraversal.traverse(compiler, scope.getRootNode(),
                          this);
                      children: []
                      pos: 53679
                      length: 60
                    pos: 53671
                    length: 74
                children: []
                pos: 53658
                length: 87
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 54031
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 54037
                      length: 15
                    pos: 54009
                    length: 284
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: "n"
                                  children: []
                                  pos: 54087
                                  length: 1
                                right:
                                  type: method_invocation
                                  fields:
                                    text: scope.getRootNode()
                                  children: []
                                  pos: 54092
                                  length: 19
                              children: []
                              pos: 54087
                              length: 24
                          children: []
                          pos: 54086
                          length: 26
                      children:
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 54113
                        length: 7
                      pos: 54083
                      length: 37
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 54132
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.LP
                                      children: []
                                      pos: 54147
                                      length: 8
                                  children: []
                                  pos: 54132
                                  length: 23
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: parent
                                      children: []
                                      pos: 54159
                                      length: 6
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: scope.getRootNode()
                                      children: []
                                      pos: 54169
                                      length: 19
                                  children: []
                                  pos: 54159
                                  length: 29
                              children: []
                              pos: 54132
                              length: 56
                          children: []
                          pos: 54131
                          length: 58
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: handleFunctionInputs(parent);
                          children: []
                          pos: 54200
                          length: 29
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 54238
                          length: 7
                        pos: 54190
                        length: 63
                      pos: 54128
                      length: 125
                    - type: expression_statement
                      fields:
                        text: super.visit(t, n, parent);
                      children: []
                      pos: 54261
                      length: 26
                    pos: 54075
                    length: 218
                children: []
                pos: 54009
                length: 284
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: handleFunctionInputs
                    children: []
                    pos: 54374
                    length: 20
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node fnNode
                      children: []
                      pos: 54395
                      length: 11
                    pos: 54361
                    length: 803
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node fnNameNode = fnNode.getFirstChild();
                      children: []
                      pos: 54452
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: String fnName = fnNameNode.getString();
                      children: []
                      pos: 54500
                      length: 39
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: unary_expression
                              fields:
                                text: "!fnName.isEmpty()"
                              children: []
                              pos: 54550
                              length: 17
                          children: []
                          pos: 54549
                          length: 19
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Scope.Var fnVar = scope.getVar(fnName);
                          children: []
                          pos: 54579
                          length: 39
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: or
                                  fields:
                                    left:
                                      type: equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: fnVar
                                          children: []
                                          pos: 54631
                                          length: 5
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 54640
                                          length: 4
                                      children: []
                                      pos: 54631
                                      length: 13
                                    right:
                                      type: parenthesized_expression
                                      fields:
                                        expression:
                                          type: and
                                          fields:
                                            left:
                                              type: not_equals
                                              fields:
                                                left:
                                                  type: method_invocation
                                                  fields:
                                                    text: fnVar.getNameNode()
                                                  children: []
                                                  pos: 54825
                                                  length: 19
                                                right:
                                                  type: null_literal
                                                  fields: {}
                                                  children: []
                                                  pos: 54848
                                                  length: 4
                                              children: []
                                              pos: 54825
                                              length: 27
                                            right:
                                              type: not_equals
                                              fields:
                                                left:
                                                  type: method_invocation
                                                  fields:
                                                    text: fnVar.getInitialValue()
                                                  children: []
                                                  pos: 55001
                                                  length: 23
                                                right:
                                                  type: identifier
                                                  fields:
                                                    text: fnNode
                                                  children: []
                                                  pos: 55028
                                                  length: 6
                                              children: []
                                              pos: 55001
                                              length: 33
                                          children: []
                                          pos: 54825
                                          length: 209
                                      children: []
                                      pos: 54824
                                      length: 211
                                  children: []
                                  pos: 54631
                                  length: 404
                              children: []
                              pos: 54630
                              length: 406
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: defineSlot(fnNameNode, fnNode, fnNode.getJSType(),
                                  false);
                              children: []
                              pos: 55049
                              length: 58
                            pos: 55037
                            length: 80
                          pos: 54627
                          length: 490
                        pos: 54569
                        length: 556
                      pos: 54546
                      length: 579
                    - type: expression_statement
                      fields:
                        text: declareArguments(fnNode);
                      children: []
                      pos: 55133
                      length: 25
                    pos: 54408
                    length: 756
                children: []
                pos: 54361
                length: 803
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: declareArguments
                    children: []
                    pos: 55246
                    length: 16
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node functionNode
                      children: []
                      pos: 55263
                      length: 17
                    pos: 55233
                    length: 843
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node astParameters = functionNode.getFirstChild().getNext();
                      children: []
                      pos: 55290
                      length: 60
                    - type: local_variable_declaration
                      fields:
                        text: Node body = astParameters.getNext();
                      children: []
                      pos: 55357
                      length: 36
                    - type: local_variable_declaration
                      fields:
                        text: FunctionType functionType = (FunctionType) functionNode.getJSType();
                      children: []
                      pos: 55400
                      length: 68
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: functionType
                                  children: []
                                  pos: 55479
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 55495
                                  length: 4
                              children: []
                              pos: 55479
                              length: 20
                          children: []
                          pos: 55478
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Node jsDocParameters = functionType.getParametersNode();
                          children: []
                          pos: 55511
                          length: 56
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: jsDocParameters
                                      children: []
                                      pos: 55580
                                      length: 15
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 55599
                                      length: 4
                                  children: []
                                  pos: 55580
                                  length: 23
                              children: []
                              pos: 55579
                              length: 25
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: Node jsDocParameter = jsDocParameters.getFirstChild();
                              children: []
                              pos: 55617
                              length: 54
                            - type: enhanced_for_statement
                              fields:
                                text: |-
                                  for (Node astParameter : astParameters.children()) {
                                              if (jsDocParameter != null) {
                                                defineSlot(astParameter, functionNode,
                                                    jsDocParameter.getJSType(), true);
                                                jsDocParameter = jsDocParameter.getNext();
                                              } else {
                                                defineSlot(astParameter, functionNode, null, true);
                                              }
                                            }
                              children: []
                              pos: 55682
                              length: 370
                            pos: 55605
                            length: 457
                          pos: 55576
                          length: 486
                        pos: 55501
                        length: 569
                      pos: 55475
                      length: 595
                    pos: 55282
                    length: 794
                children: []
                pos: 55233
                length: 843
              pos: 53385
              length: 2719
          children: []
          pos: 53385
          length: 2719
        pos: 4648
        length: 51483
    children: []
    pos: 4648
    length: 51483
  pos: 0
  length: 56132
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: TypedScopeCreator
        children: []
        pos: 4660
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: static final String DELEGATE_PROXY_SUFFIX = "(Proxy)";
          children: []
          pos: 4789
          length: 54
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType MALFORMED_TYPEDEF =
                    DiagnosticType.warning(
                        "JSC_MALFORMED_TYPEDEF",
                        "Typedef for {0} does not have any type information");
          children: []
          pos: 4847
          length: 177
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType ENUM_INITIALIZER =
                    DiagnosticType.warning(
                        "JSC_ENUM_INITIALIZER_NOT_ENUM",
                        "enum initializer must be an object literal or an enum");
          children: []
          pos: 5028
          length: 187
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType CONSTRUCTOR_EXPECTED =
                    DiagnosticType.warning(
                        "JSC_REFLECT_CONSTRUCTOR_EXPECTED",
                        "Constructor expected as first argument");
          children: []
          pos: 5219
          length: 179
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 5402
          length: 40
        - type: field_declaration
          fields:
            text: private final ErrorReporter typeParsingErrorReporter;
          children: []
          pos: 5445
          length: 53
        - type: field_declaration
          fields:
            text: private final TypeValidator validator;
          children: []
          pos: 5501
          length: 38
        - type: field_declaration
          fields:
            text: private final CodingConvention codingConvention;
          children: []
          pos: 5542
          length: 48
        - type: field_declaration
          fields:
            text: private final JSTypeRegistry typeRegistry;
          children: []
          pos: 5593
          length: 42
        - type: field_declaration
          fields:
            text: private List<ObjectType> delegateProxyPrototypes = Lists.newArrayList();
          children: []
          pos: 5638
          length: 72
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DeferredSetType
              children: []
              pos: 5871
              length: 15
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final Node node;
                children: []
                pos: 5893
                length: 16
              - type: field_declaration
                fields:
                  text: final JSType type;
                children: []
                pos: 5914
                length: 18
              - type: constructor_declaration
                fields:
                  text: |-
                    DeferredSetType(Node node, JSType type) {
                          Preconditions.checkNotNull(node);
                          Preconditions.checkNotNull(type);
                          this.node = node;
                          this.type = type;

                          // Other parts of this pass may read off the node.
                          // (like when we set the LHS of an assign with a typed RHS function.)
                          node.setJSType(type);
                        }
                children: []
                pos: 5938
                length: 337
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolve
                    children: []
                    pos: 6286
                    length: 7
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Scope scope
                      children: []
                      pos: 6294
                      length: 11
                    pos: 6281
                    length: 102
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: node.setJSType(type.resolve(typeParsingErrorReporter,
                          scope));
                      children: []
                      pos: 6315
                      length: 62
                    pos: 6307
                    length: 76
                children: []
                pos: 6281
                length: 102
              pos: 5857
              length: 530
          children: []
          pos: 5857
          length: 530
        - type: constructor_declaration
          fields:
            text: |-
              TypedScopeCreator(AbstractCompiler compiler) {
                  this(compiler, compiler.getCodingConvention());
                }
          children: []
          pos: 6391
          length: 102
        - type: constructor_declaration
          fields:
            text: |-
              TypedScopeCreator(AbstractCompiler compiler,
                    CodingConvention codingConvention) {
                  this.compiler = compiler;
                  this.validator = compiler.getTypeValidator();
                  this.codingConvention = codingConvention;
                  this.typeRegistry = compiler.getTypeRegistry();
                  this.typeParsingErrorReporter = typeRegistry.getErrorReporter();
                }
          children: []
          pos: 6497
          length: 338
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createScope
              children: []
              pos: 6989
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node root
                children: []
                pos: 7001
                length: 9
              pos: 6976
              length: 1725
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Scope newScope = null;
                children: []
                pos: 7221
                length: 22
              - type: local_variable_declaration
                fields:
                  text: AbstractScopeBuilder scopeBuilder = null;
                children: []
                pos: 7248
                length: 41
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: parent
                            children: []
                            pos: 7298
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 7308
                            length: 4
                        children: []
                        pos: 7298
                        length: 14
                    children: []
                    pos: 7297
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: newScope = createInitialScope(root);
                    children: []
                    pos: 7373
                    length: 36
                  - type: local_variable_declaration
                    fields:
                      text: GlobalScopeBuilder globalScopeBuilder = new GlobalScopeBuilder(newScope);
                    children: []
                    pos: 7417
                    length: 73
                  - type: expression_statement
                    fields:
                      text: scopeBuilder = globalScopeBuilder;
                    children: []
                    pos: 7497
                    length: 34
                  - type: expression_statement
                    fields:
                      text: NodeTraversal.traverse(compiler, root, scopeBuilder);
                    children: []
                    pos: 7538
                    length: 53
                  pos: 7314
                  length: 283
                pos: 7294
                length: 508
              - type: expression_statement
                fields:
                  text: scopeBuilder.resolveStubDeclarations();
                children: []
                pos: 7808
                length: 39
              - type: expression_statement
                fields:
                  text: scopeBuilder.resolveTypes();
                children: []
                pos: 7852
                length: 28
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Node functionNode : scopeBuilder.nonExternFunctions) {
                          JSType type = functionNode.getJSType();
                          if (type != null && type instanceof FunctionType) {
                            FunctionType fnType = (FunctionType) type;
                            ObjectType fnThisType = fnType.getTypeOfThis();
                            if (!fnThisType.isUnknownType()) {
                              NodeTraversal.traverse(compiler, functionNode.getLastChild(),
                                  scopeBuilder.new CollectProperties(fnThisType));
                            }
                          }
                        }
                children: []
                pos: 8048
                length: 472
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: parent
                            children: []
                            pos: 8530
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8540
                            length: 4
                        children: []
                        pos: 8530
                        length: 14
                    children: []
                    pos: 8529
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        codingConvention.defineDelegateProxyPrototypeProperties(
                                  typeRegistry, newScope, delegateProxyPrototypes);
                    children: []
                    pos: 8554
                    length: 116
                  pos: 8546
                  length: 130
                pos: 8526
                length: 150
              - type: return_statement
                fields:
                  text: return newScope;
                children: []
                pos: 8681
                length: 16
              pos: 7026
              length: 1675
          children: []
          pos: 6976
          length: 1725
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createInitialScope
              children: []
              pos: 8860
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node root
                children: []
                pos: 8879
                length: 9
              pos: 8833
              length: 1616
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: NodeTraversal.traverse(compiler, root, new DiscoverEnums(typeRegistry));
                children: []
                pos: 8897
                length: 72
              - type: local_variable_declaration
                fields:
                  text: Scope s = new Scope(root, compiler);
                children: []
                pos: 8975
                length: 36
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, ARRAY_FUNCTION_TYPE);
                children: []
                pos: 9016
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, BOOLEAN_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9071
                length: 59
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, DATE_FUNCTION_TYPE);
                children: []
                pos: 9135
                length: 49
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, ERROR_FUNCTION_TYPE);
                children: []
                pos: 9189
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, EVAL_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9244
                length: 55
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, FUNCTION_FUNCTION_TYPE);
                children: []
                pos: 9304
                length: 53
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, NUMBER_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9362
                length: 58
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9425
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, RANGE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9481
                length: 56
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, REFERENCE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9542
                length: 60
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, REGEXP_FUNCTION_TYPE);
                children: []
                pos: 9607
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, STRING_OBJECT_FUNCTION_TYPE);
                children: []
                pos: 9663
                length: 58
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, SYNTAX_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9726
                length: 57
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, TYPE_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9788
                length: 55
              - type: expression_statement
                fields:
                  text: declareNativeFunctionType(s, URI_ERROR_FUNCTION_TYPE);
                children: []
                pos: 9848
                length: 54
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "undefined", VOID_TYPE);
                children: []
                pos: 9907
                length: 50
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "goog.typedef", NO_TYPE);
                children: []
                pos: 10142
                length: 51
              - type: expression_statement
                fields:
                  text: declareNativeValueType(s, "ActiveXObject", NO_OBJECT_TYPE);
                children: []
                pos: 10371
                length: 59
              - type: return_statement
                fields:
                  text: return s;
                children: []
                pos: 10436
                length: 9
              pos: 8890
              length: 1559
          children: []
          pos: 8833
          length: 1616
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeFunctionType
              children: []
              pos: 10466
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10492
                length: 11
              pos: 10453
              length: 304
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: FunctionType t = typeRegistry.getNativeFunctionType(tId);
                children: []
                pos: 10529
                length: 57
              - type: expression_statement
                fields:
                  text: declareNativeType(scope, t.getInstanceType().getReferenceName(),
                    t);
                children: []
                pos: 10591
                length: 68
              - type: expression_statement
                fields:
                  text: |-
                    declareNativeType(
                            scope, t.getPrototype().getReferenceName(), t.getPrototype());
                children: []
                pos: 10664
                length: 89
              pos: 10523
              length: 234
          children: []
          pos: 10453
          length: 304
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeValueType
              children: []
              pos: 10774
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10797
                length: 11
              pos: 10761
              length: 160
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: declareNativeType(scope, name, typeRegistry.getNativeType(tId));
                children: []
                pos: 10853
                length: 64
              pos: 10847
              length: 74
          children: []
          pos: 10761
          length: 160
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: declareNativeType
              children: []
              pos: 10938
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Scope scope
                children: []
                pos: 10956
                length: 11
              pos: 10925
              length: 119
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: scope.declare(name, null, t, null, false);
                children: []
                pos: 10998
                length: 42
              pos: 10992
              length: 52
          children: []
          pos: 10925
          length: 119
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DiscoverEnums
              children: []
              pos: 11069
              length: 13
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final JSTypeRegistry registry;
                children: []
                pos: 11130
                length: 38
              - type: constructor_declaration
                fields:
                  text: |-
                    DiscoverEnums(JSTypeRegistry registry) {
                          this.registry = registry;
                        }
                children: []
                pos: 11174
                length: 78
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 11284
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 11290
                      length: 15
                    pos: 11258
                    length: 681
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node nameNode = null;
                      children: []
                      pos: 11339
                      length: 21
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: node.getType()
                              children: []
                              pos: 11375
                              length: 14
                          children: []
                          pos: 11374
                          length: 16
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {
                                      case Token.VAR:
                                        for (Node child = node.getFirstChild();
                                             child != null; child = child.getNext()) {
                                          identifyEnumInNameNode(
                                              child, NodeUtil.getInfoForNameNode(child));
                                        }
                                        break;
                                      case Token.EXPR_RESULT:
                                        Node maybeAssign = node.getFirstChild();
                                        if (maybeAssign.getType() == Token.ASSIGN) {
                                          identifyEnumInNameNode(
                                              maybeAssign.getFirstChild(), maybeAssign.getJSDocInfo());
                                        }
                                        break;
                                    }
                          children: []
                          pos: 11391
                          length: 542
                      children: []
                      pos: 11367
                      length: 566
                    pos: 11331
                    length: 608
                children: []
                pos: 11258
                length: 681
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: identifyEnumInNameNode
                    children: []
                    pos: 11958
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node nameNode
                      children: []
                      pos: 11981
                      length: 13
                    pos: 11945
                    length: 203
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 12024
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 12032
                                      length: 4
                                  children: []
                                  pos: 12024
                                  length: 12
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasEnumParameterType()
                                  children: []
                                  pos: 12040
                                  length: 27
                              children: []
                              pos: 12024
                              length: 43
                          children: []
                          pos: 12023
                          length: 45
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: registry.identifyEnumName(nameNode.getQualifiedName());
                          children: []
                          pos: 12079
                          length: 55
                        pos: 12069
                        length: 73
                      pos: 12020
                      length: 122
                    pos: 12012
                    length: 136
                children: []
                pos: 11945
                length: 203
              pos: 11048
              length: 1104
          children: []
          pos: 11048
          length: 1104
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getPrototypePropertyOwner
              children: []
              pos: 12382
              length: 25
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 12408
                length: 6
              pos: 12362
              length: 432
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.getType()
                            children: []
                            pos: 12426
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Token.GETPROP
                            children: []
                            pos: 12441
                            length: 13
                        children: []
                        pos: 12426
                        length: 28
                    children: []
                    pos: 12425
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Node firstChild = n.getFirstChild();
                    children: []
                    pos: 12464
                    length: 36
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: firstChild.getType()
                                    children: []
                                    pos: 12511
                                    length: 20
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.GETPROP
                                    children: []
                                    pos: 12535
                                    length: 13
                                children: []
                                pos: 12511
                                length: 37
                              right:
                                type: method_invocation
                                fields:
                                  text: firstChild.getLastChild().getString().equals("prototype")
                                children: []
                                pos: 12562
                                length: 57
                            children: []
                            pos: 12511
                            length: 108
                        children: []
                        pos: 12510
                        length: 110
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: Node maybeOwner = firstChild.getFirstChild();
                        children: []
                        pos: 12631
                        length: 45
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: method_invocation
                                fields:
                                  text: maybeOwner.isQualifiedName()
                                children: []
                                pos: 12689
                                length: 28
                            children: []
                            pos: 12688
                            length: 30
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: return_statement
                            fields:
                              text: return maybeOwner;
                            children: []
                            pos: 12731
                            length: 18
                          pos: 12719
                          length: 40
                        pos: 12685
                        length: 74
                      pos: 12621
                      length: 146
                    pos: 12507
                    length: 260
                  pos: 12456
                  length: 317
                pos: 12422
                length: 351
              - type: return_statement
                fields:
                  text: return null;
                children: []
                pos: 12778
                length: 12
              pos: 12416
              length: 378
          children: []
          pos: 12362
          length: 432
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: attachLiteralTypes
              children: []
              pos: 12811
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 12830
                length: 6
              pos: 12798
              length: 997
            body:
              type: block
              fields: {}
              children:
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: n.getType()
                        children: []
                        pos: 12852
                        length: 11
                    children: []
                    pos: 12851
                    length: 13
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                              case Token.NULL:
                                n.setJSType(getNativeType(NULL_TYPE));
                                break;

                              case Token.VOID:
                                n.setJSType(getNativeType(VOID_TYPE));
                                break;

                              case Token.STRING:
                                n.setJSType(getNativeType(STRING_TYPE));
                                break;

                              case Token.NUMBER:
                                n.setJSType(getNativeType(NUMBER_TYPE));
                                break;

                              case Token.TRUE:
                              case Token.FALSE:
                                n.setJSType(getNativeType(BOOLEAN_TYPE));
                                break;

                              case Token.REGEXP:
                                n.setJSType(getNativeType(REGEXP_TYPE));
                                break;

                              case Token.REF_SPECIAL:
                                n.setJSType(getNativeType(UNKNOWN_TYPE));
                                break;

                              case Token.OBJECTLIT:
                                if (n.getJSType() == null) {
                                  n.setJSType(typeRegistry.createAnonymousObjectType());
                                }
                                break;

                              // NOTE(nicksantos): If we ever support Array tuples,
                              // we will need to put ARRAYLIT here as well.
                            }
                    children: []
                    pos: 12865
                    length: 926
                children: []
                pos: 12844
                length: 947
              pos: 12838
              length: 957
          children: []
          pos: 12798
          length: 997
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getNativeType
              children: []
              pos: 13814
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JSTypeNative nativeType
                children: []
                pos: 13828
                length: 23
              pos: 13799
              length: 110
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return typeRegistry.getNativeType(nativeType);
                children: []
                pos: 13859
                length: 46
              pos: 13853
              length: 56
          children: []
          pos: 13799
          length: 110
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: AbstractScopeBuilder
              children: []
              pos: 13936
              length: 20
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: final Scope scope;
                children: []
                pos: 14058
                length: 18
              - type: field_declaration
                fields:
                  text: |-
                    private final List<DeferredSetType> deferredSetTypes =
                            Lists.newArrayList();
                children: []
                pos: 14082
                length: 84
              - type: field_declaration
                fields:
                  text: private final List<Node> nonExternFunctions = Lists.newArrayList();
                children: []
                pos: 14259
                length: 67
              - type: field_declaration
                fields:
                  text: |-
                    private final List<StubDeclaration> stubDeclarations =
                            Lists.newArrayList();
                children: []
                pos: 14502
                length: 84
              - type: field_declaration
                fields:
                  text: private String sourceName = null;
                children: []
                pos: 14654
                length: 33
              - type: constructor_declaration
                fields:
                  text: |-
                    private AbstractScopeBuilder(Scope scope) {
                          this.scope = scope;
                        }
                children: []
                pos: 14693
                length: 75
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: setDeferredType
                    children: []
                    pos: 14779
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node node
                      children: []
                      pos: 14795
                      length: 9
                    pos: 14774
                    length: 113
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: deferredSetTypes.add(new DeferredSetType(node, type));
                      children: []
                      pos: 14827
                      length: 54
                    pos: 14819
                    length: 68
                children: []
                pos: 14774
                length: 113
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolveTypes
                    children: []
                    pos: 14898
                    length: 12
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 14893
                    length: 500
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (DeferredSetType deferred : deferredSetTypes) {
                                  deferred.resolve(scope);
                                }
                      children: []
                      pos: 14970
                      length: 92
                    - type: local_variable_declaration
                      fields:
                        text: Iterator<Var> vars = scope.getVars();
                      children: []
                      pos: 15125
                      length: 37
                    - type: while_statement
                      fields:
                        text: |-
                          while (vars.hasNext()) {
                                  vars.next().resolveType(typeParsingErrorReporter);
                                }
                      children: []
                      pos: 15169
                      length: 91
                    - type: expression_statement
                      fields:
                        text: typeRegistry.resolveTypesInScope(scope);
                      children: []
                      pos: 15347
                      length: 40
                    pos: 14913
                    length: 480
                children: []
                pos: 14893
                length: 500
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: shouldTraverse
                    children: []
                    pos: 15434
                    length: 14
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal nodeTraversal
                      children: []
                      pos: 15449
                      length: 27
                    pos: 15399
                    length: 536
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 15519
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 15534
                                      length: 14
                                  children: []
                                  pos: 15519
                                  length: 29
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 15562
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.SCRIPT
                                      children: []
                                      pos: 15577
                                      length: 12
                                  children: []
                                  pos: 15562
                                  length: 27
                              children: []
                              pos: 15519
                              length: 70
                          children: []
                          pos: 15518
                          length: 72
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: sourceName = (String) n.getProp(Node.SOURCENAME_PROP);
                          children: []
                          pos: 15601
                          length: 54
                        pos: 15591
                        length: 72
                      pos: 15515
                      length: 148
                    - type: return_statement
                      fields:
                        text: |-
                          return parent == null || parent.getType() != Token.FUNCTION ||
                                    n == parent.getFirstChild() || parent == scope.getRootNode();
                      children: []
                      pos: 15795
                      length: 134
                    pos: 15507
                    length: 428
                children: []
                pos: 15399
                length: 536
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 15967
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 15973
                      length: 15
                    pos: 15941
                    length: 1550
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: attachLiteralTypes(n);
                      children: []
                      pos: 16019
                      length: 22
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.getType()
                              children: []
                              pos: 16057
                              length: 11
                          children: []
                          pos: 16056
                          length: 13
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {
                                      case Token.CALL:
                                        checkForClassDefiningCalls(t, n, parent);
                                        break;

                                      case Token.FUNCTION:
                                        if (t.getInput() == null || !t.getInput().isExtern()) {
                                          nonExternFunctions.add(n);
                                        }

                                        // VARs and ASSIGNs are handled in different branches of this
                                        // switch statement.
                                        if (parent.getType() != Token.ASSIGN &&
                                            parent.getType() != Token.NAME) {
                                          defineDeclaredFunction(n, parent);
                                        }

                                        break;

                                      case Token.ASSIGN:
                                        // Handle constructor and enum definitions.
                                        defineNamedTypeAssign(n, parent);

                                        // Handle initialization of properties.
                                        Node firstChild = n.getFirstChild();
                                        if (firstChild.getType() == Token.GETPROP &&
                                            firstChild.isQualifiedName()) {
                                          maybeDeclareQualifiedName(t, n.getJSDocInfo(),
                                              firstChild, n, firstChild.getNext());
                                        }
                                        break;

                                      case Token.CATCH:
                                        defineCatch(n, parent);
                                        break;

                                      case Token.VAR:
                                        defineVar(n, parent);
                                        break;

                                      case Token.GETPROP:
                                        // Handle stubbed properties.
                                        if (parent.getType() == Token.EXPR_RESULT &&
                                            n.isQualifiedName()) {
                                          maybeDeclareQualifiedName(t, n.getJSDocInfo(), n, parent, null);
                                        }
                                        break;
                                    }
                          children: []
                          pos: 16070
                          length: 1415
                      children: []
                      pos: 16049
                      length: 1436
                    pos: 16011
                    length: 1480
                children: []
                pos: 15941
                length: 1550
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredTypeInAnnotation
                    children: []
                    pos: 17734
                    length: 27
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 17771
                      length: 15
                    pos: 17727
                    length: 168
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return getDeclaredTypeInAnnotation(t.getSourceName(),
                          node, info);
                      children: []
                      pos: 17823
                      length: 66
                    pos: 17815
                    length: 80
                children: []
                pos: 17727
                length: 168
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredTypeInAnnotation
                    children: []
                    pos: 17908
                    length: 27
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String sourceName
                      children: []
                      pos: 17936
                      length: 17
                    pos: 17901
                    length: 1675
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: JSType jsType = null;
                      children: []
                      pos: 17998
                      length: 21
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          Node objNode = node.getType() == Token.GETPROP ?
                                    node.getFirstChild() : null;
                      children: []
                      pos: 18026
                      length: 87
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: info
                                  children: []
                                  pos: 18124
                                  length: 4
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 18132
                                  length: 4
                              children: []
                              pos: 18124
                              length: 12
                          children: []
                          pos: 18123
                          length: 14
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 18152
                                  length: 14
                              children: []
                              pos: 18151
                              length: 16
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: jsType = info.getType().evaluate(scope, typeRegistry);
                              children: []
                              pos: 18180
                              length: 54
                            pos: 18168
                            length: 76
                          pos: 18148
                          length: 1393
                        pos: 18138
                        length: 1411
                      pos: 18120
                      length: 1429
                    - type: return_statement
                      fields:
                        text: return jsType;
                      children: []
                      pos: 19556
                      length: 14
                    pos: 17990
                    length: 1586
                children: []
                pos: 17901
                length: 1675
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: assertDefinitionNode
                    children: []
                    pos: 19731
                    length: 20
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 19752
                      length: 6
                    pos: 19726
                    length: 156
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkState(sourceName != null);
                      children: []
                      pos: 19778
                      length: 45
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkState(n.getType() == type);
                      children: []
                      pos: 19830
                      length: 46
                    pos: 19770
                    length: 112
                children: []
                pos: 19726
                length: 156
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineCatch
                    children: []
                    pos: 19943
                    length: 11
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 19955
                      length: 6
                    pos: 19938
                    length: 169
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.CATCH);
                      children: []
                      pos: 19984
                      length: 37
                    - type: local_variable_declaration
                      fields:
                        text: Node catchName = n.getFirstChild();
                      children: []
                      pos: 20028
                      length: 35
                    - type: expression_statement
                      fields:
                        text: defineSlot(catchName, n, null);
                      children: []
                      pos: 20070
                      length: 31
                    pos: 19976
                    length: 131
                children: []
                pos: 19938
                length: 169
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineVar
                    children: []
                    pos: 20171
                    length: 9
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 20181
                      length: 6
                    pos: 20166
                    length: 573
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.VAR);
                      children: []
                      pos: 20210
                      length: 35
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 20252
                      length: 34
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.hasMoreThanOneChild()
                              children: []
                              pos: 20297
                              length: 23
                          children: []
                          pos: 20296
                          length: 25
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 20336
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 20344
                                      length: 4
                                  children: []
                                  pos: 20336
                                  length: 12
                              children: []
                              pos: 20335
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: compiler.report(JSError.make(sourceName, n,
                                  MULTIPLE_VAR_DEF));
                              children: []
                              pos: 20393
                              length: 63
                            pos: 20350
                            length: 116
                          pos: 20332
                          length: 134
                        - type: enhanced_for_statement
                          fields:
                            text: |-
                              for (Node name : n.children()) {
                                        defineName(name, n, parent, name.getJSDocInfo());
                                      }
                          children: []
                          pos: 20475
                          length: 102
                        pos: 20322
                        length: 263
                      pos: 20293
                      length: 440
                    pos: 20202
                    length: 537
                children: []
                pos: 20166
                length: 573
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineDeclaredFunction
                    children: []
                    pos: 20802
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 20825
                      length: 6
                    pos: 20797
                    length: 670
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.FUNCTION);
                      children: []
                      pos: 20854
                      length: 40
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 20902
                      length: 34
                    - type: local_variable_declaration
                      fields:
                        text: int parentType = parent.getType();
                      children: []
                      pos: 20943
                      length: 34
                    - type: expression_statement
                      fields:
                        text: |-
                          Preconditions.checkState(
                                    (scope.isLocal() || parentType != Token.ASSIGN) &&
                                    parentType != Token.NAME,
                                    "function defined as standalone function when it is being " +
                                    "assigned");
                      children: []
                      pos: 20984
                      length: 217
                    - type: local_variable_declaration
                      fields:
                        text: String functionName = n.getFirstChild().getString();
                      children: []
                      pos: 21208
                      length: 52
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          FunctionType functionType = getFunctionType(functionName, n, info,
                                    null);
                      children: []
                      pos: 21267
                      length: 83
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: NodeUtil.isFunctionDeclaration(n)
                              children: []
                              pos: 21361
                              length: 33
                          children: []
                          pos: 21360
                          length: 35
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: defineSlot(n.getFirstChild(), n, functionType);
                          children: []
                          pos: 21406
                          length: 47
                        pos: 21396
                        length: 65
                      pos: 21357
                      length: 104
                    pos: 20846
                    length: 621
                children: []
                pos: 20797
                length: 670
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineNamedTypeAssign
                    children: []
                    pos: 21560
                    length: 21
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 21582
                      length: 6
                    pos: 21555
                    length: 1098
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: assertDefinitionNode(n, Token.ASSIGN);
                      children: []
                      pos: 21611
                      length: 38
                    - type: local_variable_declaration
                      fields:
                        text: JSDocInfo info = n.getJSDocInfo();
                      children: []
                      pos: 21656
                      length: 34
                    - type: local_variable_declaration
                      fields:
                        text: Node rvalue = n.getLastChild();
                      children: []
                      pos: 22038
                      length: 31
                    - type: local_variable_declaration
                      fields:
                        text: Node lvalue = n.getFirstChild();
                      children: []
                      pos: 22076
                      length: 32
                    - type: expression_statement
                      fields:
                        text: 'info = (info != null) ? info : rvalue.getJSDocInfo();'
                      children: []
                      pos: 22115
                      length: 53
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: rvalue.getType()
                                      children: []
                                      pos: 22179
                                      length: 16
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 22199
                                      length: 14
                                  children: []
                                  pos: 22179
                                  length: 34
                                right:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 22227
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 22235
                                          length: 4
                                      children: []
                                      pos: 22227
                                      length: 12
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: info.isConstructor()
                                      children: []
                                      pos: 22243
                                      length: 20
                                  children: []
                                  pos: 22227
                                  length: 36
                              children: []
                              pos: 22179
                              length: 84
                          children: []
                          pos: 22178
                          length: 86
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              getFunctionType(lvalue.getQualifiedName(), rvalue, info,
                                          lvalue);
                          children: []
                          pos: 22275
                          length: 77
                        pos: 22265
                        length: 95
                      pos: 22175
                      length: 472
                    pos: 21603
                    length: 1050
                children: []
                pos: 21555
                length: 1098
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineName
                    children: []
                    pos: 23056
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node name
                      children: []
                      pos: 23067
                      length: 9
                    pos: 23043
                    length: 1342
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node value = name.getFirstChild();
                      children: []
                      pos: 23125
                      length: 34
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: value
                                      children: []
                                      pos: 23171
                                      length: 5
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 23180
                                      length: 4
                                  children: []
                                  pos: 23171
                                  length: 13
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: value.getType()
                                      children: []
                                      pos: 23188
                                      length: 15
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.FUNCTION
                                      children: []
                                      pos: 23207
                                      length: 14
                                  children: []
                                  pos: 23188
                                  length: 33
                              children: []
                              pos: 23171
                              length: 50
                          children: []
                          pos: 23170
                          length: 52
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: String functionName = name.getString();
                          children: []
                          pos: 23253
                          length: 39
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              FunctionType functionType =
                                          getFunctionType(functionName, value, info, null);
                          children: []
                          pos: 23301
                          length: 89
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: functionType.isReturnTypeInferred()
                                      children: []
                                      pos: 23403
                                      length: 35
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: scope.isLocal()
                                      children: []
                                      pos: 23454
                                      length: 15
                                  children: []
                                  pos: 23403
                                  length: 66
                              children: []
                              pos: 23402
                              length: 68
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: defineSlot(name, var, null);
                              children: []
                              pos: 23483
                              length: 28
                            pos: 23471
                            length: 50
                          pos: 23399
                          length: 186
                        pos: 23223
                        length: 370
                      pos: 23167
                      length: 1212
                    pos: 23117
                    length: 1268
                children: []
                pos: 23043
                length: 1342
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getFunctionType
                    children: []
                    pos: 25017
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String name
                      children: []
                      pos: 25033
                      length: 11
                    pos: 24996
                    length: 2991
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: FunctionType functionType = null;
                      children: []
                      pos: 25118
                      length: 33
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: rValue
                                          children: []
                                          pos: 25241
                                          length: 6
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 25251
                                          length: 4
                                      children: []
                                      pos: 25241
                                      length: 14
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: rValue.isQualifiedName()
                                      children: []
                                      pos: 25259
                                      length: 24
                                  children: []
                                  pos: 25241
                                  length: 42
                                right:
                                  type: method_invocation
                                  fields:
                                    text: scope.isGlobal()
                                  children: []
                                  pos: 25287
                                  length: 16
                              children: []
                              pos: 25241
                              length: 62
                          children: []
                          pos: 25240
                          length: 64
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var var = scope.getVar(rValue.getQualifiedName());
                          children: []
                          pos: 25315
                          length: 50
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: var
                                          children: []
                                          pos: 25378
                                          length: 3
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 25385
                                          length: 4
                                      children: []
                                      pos: 25378
                                      length: 11
                                    right:
                                      type: instanceof_expression
                                      fields:
                                        text: var.getType() instanceof FunctionType
                                      children: []
                                      pos: 25393
                                      length: 37
                                  children: []
                                  pos: 25378
                                  length: 52
                              children: []
                              pos: 25377
                              length: 54
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: functionType = (FunctionType) var.getType();
                              children: []
                              pos: 25444
                              length: 44
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: functionType
                                              children: []
                                              pos: 25503
                                              length: 12
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 25519
                                              length: 4
                                          children: []
                                          pos: 25503
                                          length: 20
                                        right:
                                          type: method_invocation
                                          fields:
                                            text: functionType.isConstructor()
                                          children: []
                                          pos: 25527
                                          length: 28
                                      children: []
                                      pos: 25503
                                      length: 52
                                  children: []
                                  pos: 25502
                                  length: 54
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: typeRegistry.declareType(name, functionType.getInstanceType());
                                  children: []
                                  pos: 25571
                                  length: 63
                                pos: 25557
                                length: 89
                              pos: 25499
                              length: 147
                            pos: 25432
                            length: 224
                          pos: 25374
                          length: 282
                        - type: return_statement
                          fields:
                            text: return functionType;
                          children: []
                          pos: 25665
                          length: 20
                        pos: 25305
                        length: 388
                      pos: 25237
                      length: 456
                    - type: local_variable_declaration
                      fields:
                        text: Node owner = null;
                      children: []
                      pos: 25701
                      length: 18
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: lvalueNode
                                  children: []
                                  pos: 25730
                                  length: 10
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 25744
                                  length: 4
                              children: []
                              pos: 25730
                              length: 18
                          children: []
                          pos: 25729
                          length: 20
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: owner = getPrototypePropertyOwner(lvalueNode);
                          children: []
                          pos: 25760
                          length: 46
                        pos: 25750
                        length: 64
                      pos: 25726
                      length: 88
                    - type: local_variable_declaration
                      fields:
                        text: 'Node errorRoot = rValue == null ? lvalueNode : rValue;'
                      children: []
                      pos: 25822
                      length: 54
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          boolean isFnLiteral =
                                    rValue != null && rValue.getType() == Token.FUNCTION;
                      children: []
                      pos: 25883
                      length: 85
                    - type: local_variable_declaration
                      fields:
                        text: 'Node fnRoot = isFnLiteral ? rValue : null;'
                      children: []
                      pos: 25975
                      length: 42
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          Node parametersNode = isFnLiteral ?
                                    rValue.getFirstChild().getNext() : null;
                      children: []
                      pos: 26024
                      length: 86
                    - type: local_variable_declaration
                      fields:
                        text: 'Node fnBlock = isFnLiteral ? parametersNode.getNext()
                          : null;'
                      children: []
                      pos: 26117
                      length: 61
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: functionType
                                          children: []
                                          pos: 26190
                                          length: 12
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26206
                                          length: 4
                                      children: []
                                      pos: 26190
                                      length: 20
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 26214
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26222
                                          length: 4
                                      children: []
                                      pos: 26214
                                      length: 12
                                  children: []
                                  pos: 26190
                                  length: 36
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 26230
                                  length: 14
                              children: []
                              pos: 26190
                              length: 54
                          children: []
                          pos: 26189
                          length: 56
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: JSType type = info.getType().evaluate(scope, typeRegistry);
                          children: []
                          pos: 26256
                          length: 59
                        - type: expression_statement
                          fields:
                            text: type = type.restrictByNotNullOrUndefined();
                          children: []
                          pos: 26397
                          length: 43
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: method_invocation
                                  fields:
                                    text: type.isFunctionType()
                                  children: []
                                  pos: 26453
                                  length: 21
                              children: []
                              pos: 26452
                              length: 23
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: functionType = (FunctionType) type;
                              children: []
                              pos: 26488
                              length: 35
                            - type: expression_statement
                              fields:
                                text: functionType.setJSDocInfo(info);
                              children: []
                              pos: 26534
                              length: 32
                            pos: 26476
                            length: 100
                          pos: 26449
                          length: 127
                        pos: 26246
                        length: 338
                      pos: 26186
                      length: 398
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: functionType
                                  children: []
                                  pos: 26596
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 26612
                                  length: 4
                              children: []
                              pos: 26596
                              length: 20
                          children: []
                          pos: 26595
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType overriddenPropType = null;
                          children: []
                          pos: 26681
                          length: 39
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: lvalueNode
                                              children: []
                                              pos: 26733
                                              length: 10
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 26747
                                              length: 4
                                          children: []
                                          pos: 26733
                                          length: 18
                                        right:
                                          type: equals
                                          fields:
                                            left:
                                              type: method_invocation
                                              fields:
                                                text: lvalueNode.getType()
                                              children: []
                                              pos: 26755
                                              length: 20
                                            right:
                                              type: field_access
                                              fields:
                                                text: Token.GETPROP
                                              children: []
                                              pos: 26779
                                              length: 13
                                          children: []
                                          pos: 26755
                                          length: 37
                                      children: []
                                      pos: 26733
                                      length: 59
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: lvalueNode.isQualifiedName()
                                      children: []
                                      pos: 26808
                                      length: 28
                                  children: []
                                  pos: 26733
                                  length: 103
                              children: []
                              pos: 26732
                              length: 105
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  Var var = scope.getVar(
                                                lvalueNode.getFirstChild().getQualifiedName());
                              children: []
                              pos: 26850
                              length: 85
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: var
                                          children: []
                                          pos: 26950
                                          length: 3
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 26957
                                          length: 4
                                      children: []
                                      pos: 26950
                                      length: 11
                                  children: []
                                  pos: 26949
                                  length: 13
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: local_variable_declaration
                                  fields:
                                    text: ObjectType ownerType = ObjectType.cast(var.getType());
                                  children: []
                                  pos: 26977
                                  length: 54
                                - type: if_statement
                                  fields:
                                    condition:
                                      type: parenthesized_expression
                                      fields:
                                        expression:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: ownerType
                                              children: []
                                              pos: 27048
                                              length: 9
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 27061
                                              length: 4
                                          children: []
                                          pos: 27048
                                          length: 17
                                      children: []
                                      pos: 27047
                                      length: 19
                                  children:
                                  - type: block
                                    fields: {}
                                    children:
                                    - type: local_variable_declaration
                                      fields:
                                        text: String propName = lvalueNode.getLastChild().getString();
                                      children: []
                                      pos: 27083
                                      length: 56
                                    - type: expression_statement
                                      fields:
                                        text: overriddenPropType = findOverriddenFunction(ownerType,
                                          propName);
                                      children: []
                                      pos: 27154
                                      length: 65
                                    pos: 27067
                                    length: 166
                                  pos: 27044
                                  length: 189
                                pos: 26963
                                length: 282
                              pos: 26946
                              length: 299
                            pos: 26838
                            length: 417
                          pos: 26729
                          length: 526
                        - type: expression_statement
                          fields:
                            text: |-
                              functionType =
                                          new FunctionTypeBuilder(name, compiler, errorRoot, sourceName,
                                              scope)
                                          .setSourceNode(fnRoot)
                                          .inferFromOverriddenFunction(overriddenPropType, parametersNode)
                                          .inferTemplateTypeName(info)
                                          .inferReturnType(info)
                                          .inferInheritance(info)
                                          .inferThisType(info, owner)
                                          .inferParameterTypes(parametersNode, info)
                                          .inferReturnStatementsAsLastResort(fnBlock)
                                          .buildAndRegister();
                          children: []
                          pos: 27265
                          length: 520
                        pos: 26618
                        length: 1175
                      pos: 26592
                      length: 1201
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: rValue
                                  children: []
                                  pos: 27863
                                  length: 6
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 27873
                                  length: 4
                              children: []
                              pos: 27863
                              length: 14
                          children: []
                          pos: 27862
                          length: 16
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: setDeferredType(rValue, functionType);
                          children: []
                          pos: 27889
                          length: 38
                        pos: 27879
                        length: 56
                      pos: 27859
                      length: 76
                    - type: return_statement
                      fields:
                        text: return functionType;
                      children: []
                      pos: 27961
                      length: 20
                    pos: 25110
                    length: 2877
                children: []
                pos: 24996
                length: 2991
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: findOverriddenFunction
                    children: []
                    pos: 28101
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: ObjectType ownerType
                      children: []
                      pos: 28133
                      length: 20
                    pos: 28080
                    length: 740
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: JSType propType = ownerType.getPropertyType(propName);
                      children: []
                      pos: 28266
                      length: 54
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: propType instanceof FunctionType
                              children: []
                              pos: 28331
                              length: 32
                          children: []
                          pos: 28330
                          length: 34
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return (FunctionType) propType;
                          children: []
                          pos: 28375
                          length: 31
                        pos: 28365
                        length: 49
                      pos: 28327
                      length: 467
                    - type: return_statement
                      fields:
                        text: return null;
                      children: []
                      pos: 28802
                      length: 12
                    pos: 28172
                    length: 648
                children: []
                pos: 28080
                length: 740
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getEnumType
                    children: []
                    pos: 29489
                    length: 11
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String name
                      children: []
                      pos: 29501
                      length: 11
                    pos: 29472
                    length: 1569
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: EnumType enumType = null;
                      children: []
                      pos: 29576
                      length: 25
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 29642
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 29651
                                  length: 4
                              children: []
                              pos: 29642
                              length: 13
                          children: []
                          pos: 29641
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: value.getType()
                                      children: []
                                      pos: 29671
                                      length: 15
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.OBJECTLIT
                                      children: []
                                      pos: 29690
                                      length: 15
                                  children: []
                                  pos: 29671
                                  length: 34
                              children: []
                              pos: 29670
                              length: 36
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: enumType = typeRegistry.createEnumType(name,
                                  elementsType);
                              children: []
                              pos: 29754
                              length: 59
                            - type: local_variable_declaration
                              fields:
                                text: Node key = value.getFirstChild();
                              children: []
                              pos: 29862
                              length: 33
                            - type: while_statement
                              fields:
                                text: |-
                                  while (key != null) {
                                              String keyName = NodeUtil.getStringValue(key);

                                              if (enumType.hasOwnProperty(keyName)) {
                                                compiler.report(JSError.make(sourceName, key, ENUM_DUP, keyName));
                                              } else if (!codingConvention.isValidEnumKey(keyName)) {
                                                compiler.report(
                                                    JSError.make(sourceName, key, ENUM_NOT_CONSTANT, keyName));
                                              } else {
                                                enumType.defineElement(keyName);
                                              }
                                              key = key.getNext();
                                              key = (key == null) ? null : key.getNext();
                                            }
                              children: []
                              pos: 29906
                              length: 574
                            pos: 29707
                            length: 783
                          pos: 29667
                          length: 1056
                        pos: 29657
                        length: 1074
                      pos: 29638
                      length: 1093
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: enumType
                                  children: []
                                  pos: 30743
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 30755
                                  length: 4
                              children: []
                              pos: 30743
                              length: 16
                          children: []
                          pos: 30742
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: compiler.report(JSError.make(sourceName, parent,
                              ENUM_INITIALIZER));
                          children: []
                          pos: 30771
                          length: 68
                        pos: 30761
                        length: 86
                      pos: 30739
                      length: 272
                    - type: return_statement
                      fields:
                        text: return enumType;
                      children: []
                      pos: 31019
                      length: 16
                    pos: 29568
                    length: 1473
                children: []
                pos: 29472
                length: 1569
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineSlot
                    children: []
                    pos: 31464
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node name
                      children: []
                      pos: 31475
                      length: 9
                    pos: 31451
                    length: 120
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: defineSlot(name, parent, type, type == null);
                      children: []
                      pos: 31520
                      length: 45
                    pos: 31512
                    length: 59
                children: []
                pos: 31451
                length: 120
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: defineSlot
                    children: []
                    pos: 32065
                    length: 10
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 32076
                      length: 6
                    pos: 32060
                    length: 3114
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(inferred || type != null);
                      children: []
                      pos: 32136
                      length: 54
                    - type: local_variable_declaration
                      fields:
                        text: boolean shouldDeclareOnGlobalThis = false;
                      children: []
                      pos: 32260
                      length: 42
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: n.getType()
                                  children: []
                                  pos: 32313
                                  length: 11
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.NAME
                                  children: []
                                  pos: 32328
                                  length: 10
                              children: []
                              pos: 32313
                              length: 25
                          children: []
                          pos: 32312
                          length: 27
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              Preconditions.checkArgument(
                                          parent.getType() == Token.FUNCTION ||
                                          parent.getType() == Token.VAR ||
                                          parent.getType() == Token.LP ||
                                          parent.getType() == Token.CATCH);
                          children: []
                          pos: 32350
                          length: 213
                        - type: expression_statement
                          fields:
                            text: |-
                              shouldDeclareOnGlobalThis = scope.isGlobal() &&
                                          (parent.getType() == Token.VAR ||
                                           parent.getType() == Token.FUNCTION);
                          children: []
                          pos: 32572
                          length: 143
                        pos: 32340
                        length: 383
                      pos: 32309
                      length: 613
                    - type: local_variable_declaration
                      fields:
                        text: String variableName = n.getQualifiedName();
                      children: []
                      pos: 32929
                      length: 43
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(!variableName.isEmpty());
                      children: []
                      pos: 32979
                      length: 53
                    - type: local_variable_declaration
                      fields:
                        text: Scope scopeToDeclareIn = scope;
                      children: []
                      pos: 33240
                      length: 31
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: scopeToDeclareIn.isDeclared(variableName, false)
                              children: []
                              pos: 33433
                              length: 48
                          children: []
                          pos: 33432
                          length: 50
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var oldVar = scopeToDeclareIn.getVar(variableName);
                          children: []
                          pos: 33493
                          length: 51
                        - type: expression_statement
                          fields:
                            text: |-
                              validator.expectUndeclaredVariable(
                                          sourceName, n, parent, oldVar, variableName, type);
                          children: []
                          pos: 33553
                          length: 99
                        pos: 33483
                        length: 177
                      pos: 33429
                      length: 1739
                    pos: 32128
                    length: 3046
                children: []
                pos: 32060
                length: 3114
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: isQnameRootedInGlobalScope
                    children: []
                    pos: 35288
                    length: 26
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node n
                      children: []
                      pos: 35315
                      length: 6
                    pos: 35272
                    length: 302
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node root = NodeUtil.getRootOfQualifiedName(n);
                      children: []
                      pos: 35331
                      length: 47
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: root.getType()
                                  children: []
                                  pos: 35389
                                  length: 14
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.NAME
                                  children: []
                                  pos: 35407
                                  length: 10
                              children: []
                              pos: 35389
                              length: 28
                          children: []
                          pos: 35388
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var var = scope.getVar(root.getString());
                          children: []
                          pos: 35429
                          length: 41
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: var
                                      children: []
                                      pos: 35483
                                      length: 3
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 35490
                                      length: 4
                                  children: []
                                  pos: 35483
                                  length: 11
                              children: []
                              pos: 35482
                              length: 13
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: return_statement
                              fields:
                                text: return var.isGlobal();
                              children: []
                              pos: 35508
                              length: 22
                            pos: 35496
                            length: 44
                          pos: 35479
                          length: 61
                        pos: 35419
                        length: 129
                      pos: 35385
                      length: 163
                    - type: return_statement
                      fields:
                        text: return false;
                      children: []
                      pos: 35555
                      length: 13
                    pos: 35323
                    length: 251
                children: []
                pos: 35272
                length: 302
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getDeclaredGetPropType
                    children: []
                    pos: 35958
                    length: 22
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 35981
                      length: 15
                    pos: 35943
                    length: 506
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 36057
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 36065
                                      length: 4
                                  children: []
                                  pos: 36057
                                  length: 12
                                right:
                                  type: method_invocation
                                  fields:
                                    text: info.hasType()
                                  children: []
                                  pos: 36073
                                  length: 14
                              children: []
                              pos: 36057
                              length: 30
                          children: []
                          pos: 36056
                          length: 32
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return getDeclaredTypeInAnnotation(t, n, info);
                          children: []
                          pos: 36099
                          length: 47
                        pos: 36089
                        length: 65
                      pos: 36053
                      length: 390
                    pos: 36045
                    length: 404
                children: []
                pos: 35943
                length: 506
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForClassDefiningCalls
                    children: []
                    pos: 36665
                    length: 26
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 36701
                      length: 15
                    pos: 36652
                    length: 2312
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          SubclassRelationship relationship =
                                    codingConvention.getClassesDefinedByCall(n);
                      children: []
                      pos: 36747
                      length: 90
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: relationship
                                  children: []
                                  pos: 36848
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 36864
                                  length: 4
                              children: []
                              pos: 36848
                              length: 20
                          children: []
                          pos: 36847
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType superClass = ObjectType.cast(
                                          typeRegistry.getType(relationship.superclassName));
                          children: []
                          pos: 36880
                          length: 104
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType subClass = ObjectType.cast(
                                          typeRegistry.getType(relationship.subclassName));
                          children: []
                          pos: 36993
                          length: 100
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: superClass
                                          children: []
                                          pos: 37106
                                          length: 10
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 37120
                                          length: 4
                                      children: []
                                      pos: 37106
                                      length: 18
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: subClass
                                          children: []
                                          pos: 37128
                                          length: 8
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 37140
                                          length: 4
                                      children: []
                                      pos: 37128
                                      length: 16
                                  children: []
                                  pos: 37106
                                  length: 38
                              children: []
                              pos: 37105
                              length: 40
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType superCtor = superClass.getConstructor();
                              children: []
                              pos: 37158
                              length: 53
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType subCtor = subClass.getConstructor();
                              children: []
                              pos: 37222
                              length: 49
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: equals
                                      fields:
                                        left:
                                          type: field_access
                                          fields:
                                            text: relationship.type
                                          children: []
                                          pos: 37287
                                          length: 17
                                        right:
                                          type: field_access
                                          fields:
                                            text: SubclassType.INHERITS
                                          children: []
                                          pos: 37308
                                          length: 21
                                      children: []
                                      pos: 37287
                                      length: 42
                                  children: []
                                  pos: 37286
                                  length: 44
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: validator.expectSuperType(t, n, superClass,
                                      subClass);
                                  children: []
                                  pos: 37345
                                  length: 54
                                pos: 37331
                                length: 80
                              pos: 37283
                              length: 128
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: superCtor
                                              children: []
                                              pos: 37427
                                              length: 9
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 37440
                                              length: 4
                                          children: []
                                          pos: 37427
                                          length: 17
                                        right:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: subCtor
                                              children: []
                                              pos: 37448
                                              length: 7
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 37459
                                              length: 4
                                          children: []
                                          pos: 37448
                                          length: 15
                                      children: []
                                      pos: 37427
                                      length: 36
                                  children: []
                                  pos: 37426
                                  length: 38
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: |-
                                      codingConvention.applySubclassRelationship(
                                                      superCtor, subCtor, relationship.type);
                                  children: []
                                  pos: 37479
                                  length: 99
                                pos: 37465
                                length: 125
                              pos: 37423
                              length: 167
                            pos: 37146
                            length: 454
                          pos: 37102
                          length: 498
                        pos: 36870
                        length: 738
                      pos: 36844
                      length: 764
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          String singletonGetterClassName =
                                    codingConvention.getSingletonGetterClassName(n);
                      children: []
                      pos: 37616
                      length: 92
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: singletonGetterClassName
                                  children: []
                                  pos: 37719
                                  length: 24
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 37747
                                  length: 4
                              children: []
                              pos: 37719
                              length: 32
                          children: []
                          pos: 37718
                          length: 34
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType objectType = ObjectType.cast(
                                          typeRegistry.getType(singletonGetterClassName));
                          children: []
                          pos: 37763
                          length: 101
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: objectType
                                      children: []
                                      pos: 37877
                                      length: 10
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 37891
                                      length: 4
                                  children: []
                                  pos: 37877
                                  length: 18
                              children: []
                              pos: 37876
                              length: 20
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: FunctionType functionType = objectType.getConstructor();
                              children: []
                              pos: 37909
                              length: 56
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: functionType
                                          children: []
                                          pos: 37981
                                          length: 12
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 37997
                                          length: 4
                                      children: []
                                      pos: 37981
                                      length: 20
                                  children: []
                                  pos: 37980
                                  length: 22
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: local_variable_declaration
                                  fields:
                                    text: |-
                                      FunctionType getterType =
                                                      typeRegistry.createFunctionType(objectType);
                                  children: []
                                  pos: 38017
                                  length: 86
                                - type: expression_statement
                                  fields:
                                    text: |-
                                      codingConvention.applySingletonGetter(functionType, getterType,
                                                      objectType);
                                  children: []
                                  pos: 38116
                                  length: 92
                                pos: 38003
                                length: 217
                              pos: 37977
                              length: 243
                            pos: 37897
                            length: 333
                          pos: 37873
                          length: 357
                        pos: 37753
                        length: 485
                      pos: 37715
                      length: 523
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          DelegateRelationship delegateRelationship =
                                    codingConvention.getDelegateRelationship(n);
                      children: []
                      pos: 38246
                      length: 98
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: delegateRelationship
                                  children: []
                                  pos: 38355
                                  length: 20
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 38379
                                  length: 4
                              children: []
                              pos: 38355
                              length: 28
                          children: []
                          pos: 38354
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: applyDelegateRelationship(delegateRelationship);
                          children: []
                          pos: 38395
                          length: 48
                        pos: 38385
                        length: 66
                      pos: 38351
                      length: 100
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectLiteralCast objectLiteralCast =
                                    codingConvention.getObjectLiteralCast(t, n);
                      children: []
                      pos: 38459
                      length: 92
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: objectLiteralCast
                                  children: []
                                  pos: 38562
                                  length: 17
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 38583
                                  length: 4
                              children: []
                              pos: 38562
                              length: 25
                          children: []
                          pos: 38561
                          length: 27
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: |-
                              ObjectType type = ObjectType.cast(
                                          typeRegistry.getType(objectLiteralCast.typeName));
                          children: []
                          pos: 38599
                          length: 97
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: type
                                          children: []
                                          pos: 38709
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 38717
                                          length: 4
                                      children: []
                                      pos: 38709
                                      length: 12
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: method_invocation
                                          fields:
                                            text: type.getConstructor()
                                          children: []
                                          pos: 38725
                                          length: 21
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 38750
                                          length: 4
                                      children: []
                                      pos: 38725
                                      length: 29
                                  children: []
                                  pos: 38709
                                  length: 45
                              children: []
                              pos: 38708
                              length: 47
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: setDeferredType(objectLiteralCast.objectNode,
                                  type);
                              children: []
                              pos: 38768
                              length: 52
                            pos: 38756
                            length: 74
                          pos: 38705
                          length: 245
                        pos: 38589
                        length: 369
                      pos: 38558
                      length: 400
                    pos: 36739
                    length: 2225
                children: []
                pos: 36652
                length: 2312
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: applyDelegateRelationship
                    children: []
                    pos: 39061
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: DelegateRelationship delegateRelationship
                      children: []
                      pos: 39096
                      length: 41
                    pos: 39048
                    length: 1833
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegatorObject = ObjectType.cast(
                                    typeRegistry.getType(delegateRelationship.delegator));
                      children: []
                      pos: 39147
                      length: 110
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegateBaseObject = ObjectType.cast(
                                    typeRegistry.getType(delegateRelationship.delegateBase));
                      children: []
                      pos: 39264
                      length: 116
                    - type: local_variable_declaration
                      fields:
                        text: |-
                          ObjectType delegateSuperObject = ObjectType.cast(
                                    typeRegistry.getType(codingConvention.getDelegateSuperclassName()));
                      children: []
                      pos: 39387
                      length: 128
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegatorObject
                                          children: []
                                          pos: 39526
                                          length: 15
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39545
                                          length: 4
                                      children: []
                                      pos: 39526
                                      length: 23
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegateBaseObject
                                          children: []
                                          pos: 39563
                                          length: 18
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39585
                                          length: 4
                                      children: []
                                      pos: 39563
                                      length: 26
                                  children: []
                                  pos: 39526
                                  length: 63
                                right:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: delegateSuperObject
                                      children: []
                                      pos: 39603
                                      length: 19
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 39626
                                      length: 4
                                  children: []
                                  pos: 39603
                                  length: 27
                              children: []
                              pos: 39526
                              length: 104
                          children: []
                          pos: 39525
                          length: 106
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegatorCtor = delegatorObject.getConstructor();
                          children: []
                          pos: 39642
                          length: 62
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegateBaseCtor = delegateBaseObject.getConstructor();
                          children: []
                          pos: 39713
                          length: 68
                        - type: local_variable_declaration
                          fields:
                            text: FunctionType delegateSuperCtor = delegateSuperObject.getConstructor();
                          children: []
                          pos: 39790
                          length: 70
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: and
                                      fields:
                                        left:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: delegatorCtor
                                              children: []
                                              pos: 39874
                                              length: 13
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 39891
                                              length: 4
                                          children: []
                                          pos: 39874
                                          length: 21
                                        right:
                                          type: not_equals
                                          fields:
                                            left:
                                              type: identifier
                                              fields:
                                                text: delegateBaseCtor
                                              children: []
                                              pos: 39899
                                              length: 16
                                            right:
                                              type: null_literal
                                              fields: {}
                                              children: []
                                              pos: 39919
                                              length: 4
                                          children: []
                                          pos: 39899
                                          length: 24
                                      children: []
                                      pos: 39874
                                      length: 49
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: delegateSuperCtor
                                          children: []
                                          pos: 39939
                                          length: 17
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 39960
                                          length: 4
                                      children: []
                                      pos: 39939
                                      length: 25
                                  children: []
                                  pos: 39874
                                  length: 90
                              children: []
                              pos: 39873
                              length: 92
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionParamBuilder functionParamBuilder =
                                                new FunctionParamBuilder(typeRegistry);
                              children: []
                              pos: 39978
                              length: 97
                            - type: expression_statement
                              fields:
                                text: |-
                                  functionParamBuilder.addRequiredParams(
                                                getNativeType(U2U_CONSTRUCTOR_TYPE));
                              children: []
                              pos: 40086
                              length: 91
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionType findDelegate = typeRegistry.createFunctionType(
                                                typeRegistry.createDefaultObjectUnion(delegateBaseObject),
                                                functionParamBuilder.build());
                              children: []
                              pos: 40188
                              length: 178
                            - type: local_variable_declaration
                              fields:
                                text: |-
                                  FunctionType delegateProxy = typeRegistry.createConstructorType(
                                                delegateBaseObject.getReferenceName() + DELEGATE_PROXY_SUFFIX,
                                                null, null, null);
                              children: []
                              pos: 40378
                              length: 174
                            - type: expression_statement
                              fields:
                                text: delegateProxy.setPrototypeBasedOn(delegateBaseObject);
                              children: []
                              pos: 40563
                              length: 54
                            - type: expression_statement
                              fields:
                                text: |-
                                  codingConvention.applyDelegateRelationship(
                                                delegateSuperObject, delegateBaseObject, delegatorObject,
                                                delegateProxy, findDelegate);
                              children: []
                              pos: 40629
                              length: 159
                            - type: expression_statement
                              fields:
                                text: delegateProxyPrototypes.add(delegateProxy.getPrototype());
                              children: []
                              pos: 40799
                              length: 58
                            pos: 39966
                            length: 901
                          pos: 39870
                          length: 997
                        pos: 39632
                        length: 1243
                      pos: 39522
                      length: 1353
                    pos: 39139
                    length: 1742
                children: []
                pos: 39048
                length: 1833
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: maybeDeclareQualifiedName
                    children: []
                    pos: 41315
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 41341
                      length: 15
                    pos: 41310
                    length: 4050
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node ownerNode = n.getFirstChild();
                      children: []
                      pos: 41426
                      length: 35
                    - type: local_variable_declaration
                      fields:
                        text: String ownerName = ownerNode.getQualifiedName();
                      children: []
                      pos: 41468
                      length: 48
                    - type: local_variable_declaration
                      fields:
                        text: String qName = n.getQualifiedName();
                      children: []
                      pos: 41523
                      length: 36
                    - type: local_variable_declaration
                      fields:
                        text: String propName = n.getLastChild().getString();
                      children: []
                      pos: 41566
                      length: 47
                    - type: expression_statement
                      fields:
                        text: Preconditions.checkArgument(qName != null && ownerName
                          != null);
                      children: []
                      pos: 41620
                      length: 64
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: '"prototype".equals(propName)'
                              children: []
                              pos: 41931
                              length: 28
                          children: []
                          pos: 41930
                          length: 30
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Var qVar = scope.getVar(qName);
                          children: []
                          pos: 41971
                          length: 31
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: qVar
                                      children: []
                                      pos: 42015
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 42023
                                      length: 4
                                  children: []
                                  pos: 42015
                                  length: 12
                              children: []
                              pos: 42014
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: unary_expression
                                      fields:
                                        text: "!qVar.isTypeInferred()"
                                      children: []
                                      pos: 42045
                                      length: 22
                                  children: []
                                  pos: 42044
                                  length: 24
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: return_statement
                                  fields:
                                    text: return;
                                  children: []
                                  pos: 42142
                                  length: 7
                                pos: 42069
                                length: 92
                              pos: 42041
                              length: 120
                            - type: expression_statement
                              fields:
                                text: scope.undeclare(qVar);
                              children: []
                              pos: 42172
                              length: 22
                            pos: 42029
                            length: 175
                          pos: 42011
                          length: 193
                        pos: 41961
                        length: 251
                      pos: 41927
                      length: 285
                    - type: local_variable_declaration
                      fields:
                        text: JSType valueType = getDeclaredGetPropType(t, info, n,
                          rhsValue);
                      children: []
                      pos: 42801
                      length: 64
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: valueType
                                      children: []
                                      pos: 42876
                                      length: 9
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 42889
                                      length: 4
                                  children: []
                                  pos: 42876
                                  length: 17
                                right:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: rhsValue
                                      children: []
                                      pos: 42897
                                      length: 8
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 42909
                                      length: 4
                                  children: []
                                  pos: 42897
                                  length: 16
                              children: []
                              pos: 42876
                              length: 37
                          children: []
                          pos: 42875
                          length: 39
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: valueType = rhsValue.getJSType();
                          children: []
                          pos: 42960
                          length: 33
                        pos: 42915
                        length: 86
                      pos: 42872
                      length: 129
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: valueType
                                  children: []
                                  pos: 43013
                                  length: 9
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 43026
                                  length: 4
                              children: []
                              pos: 43013
                              length: 17
                          children: []
                          pos: 43012
                          length: 19
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: parent.getType()
                                      children: []
                                      pos: 43046
                                      length: 16
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.EXPR_RESULT
                                      children: []
                                      pos: 43066
                                      length: 17
                                  children: []
                                  pos: 43046
                                  length: 37
                              children: []
                              pos: 43045
                              length: 39
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: |-
                                  stubDeclarations.add(new StubDeclaration(
                                                n,
                                                t.getInput() != null && t.getInput().isExtern(),
                                                ownerName));
                              children: []
                              pos: 43097
                              length: 148
                            pos: 43085
                            length: 170
                          pos: 43042
                          length: 213
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 43265
                          length: 7
                        pos: 43032
                        length: 248
                      pos: 43009
                      length: 271
                    - type: local_variable_declaration
                      fields:
                        text: boolean inferred = true;
                      children: []
                      pos: 43288
                      length: 24
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: info
                                  children: []
                                  pos: 43323
                                  length: 4
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 43331
                                  length: 4
                              children: []
                              pos: 43323
                              length: 12
                          children: []
                          pos: 43322
                          length: 14
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              inferred = !(info.hasType() || info.hasEnumParameterType() ||
                                          FunctionTypeBuilder.isFunctionTypeDeclaration(info));
                          children: []
                          pos: 43394
                          length: 127
                        pos: 43337
                        length: 192
                      pos: 43319
                      length: 210
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: identifier
                              fields:
                                text: inferred
                              children: []
                              pos: 43541
                              length: 8
                          children: []
                          pos: 43540
                          length: 10
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              inferred = !(rhsValue != null &&
                                          rhsValue.getType() == Token.FUNCTION &&
                                          !scope.isDeclared(qName, false));
                          children: []
                          pos: 43603
                          length: 130
                        pos: 43551
                        length: 190
                      pos: 43537
                      length: 204
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: unary_expression
                              fields:
                                text: "!inferred"
                              children: []
                              pos: 43753
                              length: 9
                          children: []
                          pos: 43752
                          length: 11
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: ObjectType ownerType = getObjectSlot(ownerName);
                          children: []
                          pos: 43774
                          length: 48
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: ownerType
                                      children: []
                                      pos: 43835
                                      length: 9
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 43848
                                      length: 4
                                  children: []
                                  pos: 43835
                                  length: 17
                              children: []
                              pos: 43834
                              length: 19
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: boolean isExtern = t.getInput() != null && t.getInput().isExtern();
                              children: []
                              pos: 43967
                              length: 67
                            - type: if_statement
                              fields:
                                condition:
                                  type: parenthesized_expression
                                  fields:
                                    expression:
                                      type: and
                                      fields:
                                        left:
                                          type: parenthesized_expression
                                          fields:
                                            expression:
                                              type: or
                                              fields:
                                                left:
                                                  type: unary_expression
                                                  fields:
                                                    text: "!ownerType.hasOwnProperty(propName)"
                                                  children: []
                                                  pos: 44050
                                                  length: 35
                                                right:
                                                  type: method_invocation
                                                  fields:
                                                    text: ownerType.isPropertyTypeInferred(propName)
                                                  children: []
                                                  pos: 44104
                                                  length: 42
                                              children: []
                                              pos: 44050
                                              length: 96
                                          children: []
                                          pos: 44049
                                          length: 98
                                        right:
                                          type: parenthesized_expression
                                          fields:
                                            expression:
                                              type: or
                                              fields:
                                                left:
                                                  type: parenthesized_expression
                                                  fields:
                                                    expression:
                                                      type: and
                                                      fields:
                                                        left:
                                                          type: identifier
                                                          fields:
                                                            text: isExtern
                                                          children: []
                                                          pos: 44167
                                                          length: 8
                                                        right:
                                                          type: unary_expression
                                                          fields:
                                                            text: "!ownerType.isNativeObjectType()"
                                                          children: []
                                                          pos: 44179
                                                          length: 31
                                                      children: []
                                                      pos: 44167
                                                      length: 43
                                                  children: []
                                                  pos: 44166
                                                  length: 45
                                                right:
                                                  type: unary_expression
                                                  fields:
                                                    text: "!ownerType.isInstanceType()"
                                                  children: []
                                                  pos: 44230
                                                  length: 27
                                              children: []
                                              pos: 44166
                                              length: 91
                                          children: []
                                          pos: 44165
                                          length: 93
                                      children: []
                                      pos: 44049
                                      length: 209
                                  children: []
                                  pos: 44048
                                  length: 211
                              children:
                              - type: block
                                fields: {}
                                children:
                                - type: expression_statement
                                  fields:
                                    text: ownerType.defineDeclaredProperty(propName,
                                      valueType, isExtern);
                                  children: []
                                  pos: 44348
                                  length: 64
                                pos: 44260
                                length: 164
                              pos: 44045
                              length: 379
                            pos: 43854
                            length: 580
                          pos: 43831
                          length: 603
                        - type: expression_statement
                          fields:
                            text: defineSlot(n, parent, valueType, inferred);
                          children: []
                          pos: 44576
                          length: 43
                        pos: 43764
                        length: 863
                      pos: 43749
                      length: 1605
                    pos: 41418
                    length: 3942
                children: []
                pos: 41310
                length: 4050
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getObjectSlot
                    children: []
                    pos: 45605
                    length: 13
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: String slotName
                      children: []
                      pos: 45619
                      length: 15
                    pos: 45586
                    length: 328
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Var ownerVar = scope.getVar(slotName);
                      children: []
                      pos: 45644
                      length: 38
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ownerVar
                                  children: []
                                  pos: 45693
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 45705
                                  length: 4
                              children: []
                              pos: 45693
                              length: 16
                          children: []
                          pos: 45692
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: JSType ownerVarType = ownerVar.getType();
                          children: []
                          pos: 45721
                          length: 41
                        - type: return_statement
                          fields:
                            text: |-
                              return ObjectType.cast(ownerVarType == null ?
                                          null : ownerVarType.restrictByNotNullOrUndefined());
                          children: []
                          pos: 45771
                          length: 110
                        pos: 45711
                        length: 178
                      pos: 45689
                      length: 200
                    - type: return_statement
                      fields:
                        text: return null;
                      children: []
                      pos: 45896
                      length: 12
                    pos: 45636
                    length: 278
                children: []
                pos: 45586
                length: 328
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: resolveStubDeclarations
                    children: []
                    pos: 46056
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 46051
                    length: 1189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (StubDeclaration stub : stubDeclarations) {
                                  Node n = stub.node;
                                  Node parent = n.getParent();
                                  String qName = n.getQualifiedName();
                                  String propName = n.getLastChild().getString();
                                  String ownerName = stub.ownerName;
                                  boolean isExtern = stub.isExtern;

                                  if (scope.isDeclared(qName, false)) {
                                    continue;
                                  }

                                  // If we see a stub property, make sure to register this property
                                  // in the type registry.
                                  ObjectType ownerType = getObjectSlot(ownerName);
                                  ObjectType unknownType = typeRegistry.getNativeObjectType(UNKNOWN_TYPE);
                                  defineSlot(n, parent, unknownType, true);

                                  if (ownerType != null &&
                                      (isExtern || ownerType.isFunctionPrototypeType())) {
                                    // If this is a stub for a prototype, just declare it
                                    // as an unknown type. These are seen often in externs.
                                    ownerType.defineInferredProperty(
                                        propName, unknownType, isExtern);
                                  } else {
                                    typeRegistry.registerPropertyOnType(
                                        propName, ownerType == null ? unknownType : ownerType);
                                  }
                                }
                      children: []
                      pos: 46090
                      length: 1144
                    pos: 46082
                    length: 1158
                children: []
                pos: 46051
                length: 1189
              - type: class_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: CollectProperties
                    children: []
                    pos: 47392
                    length: 17
                  body:
                    type: class_body
                    fields: {}
                    children:
                    - type: field_declaration
                      fields:
                        text: private final ObjectType thisType;
                      children: []
                      pos: 47467
                      length: 34
                    - type: constructor_declaration
                      fields:
                        text: |-
                          CollectProperties(ObjectType thisType) {
                                  this.thisType = thisType;
                                }
                      children: []
                      pos: 47509
                      length: 82
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: visit
                          children: []
                          pos: 47611
                          length: 5
                        parameters:
                          type: method_parameters
                          fields: {}
                          children:
                          - type: formal_parameter
                            fields:
                              text: NodeTraversal t
                            children: []
                            pos: 47617
                            length: 15
                          pos: 47599
                          length: 437
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: n.getType()
                                        children: []
                                        pos: 47669
                                        length: 11
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.EXPR_RESULT
                                        children: []
                                        pos: 47684
                                        length: 17
                                    children: []
                                    pos: 47669
                                    length: 32
                                children: []
                                pos: 47668
                                length: 34
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: local_variable_declaration
                                fields:
                                  text: Node child = n.getFirstChild();
                                children: []
                                pos: 47715
                                length: 31
                              - type: switch_expression
                                fields:
                                  condition:
                                    type: parenthesized_expression
                                    fields:
                                      expression:
                                        type: method_invocation
                                        fields:
                                          text: child.getType()
                                        children: []
                                        pos: 47765
                                        length: 15
                                    children: []
                                    pos: 47764
                                    length: 17
                                  body:
                                    type: switch_block
                                    fields:
                                      text: |-
                                        {
                                                    case Token.ASSIGN:
                                                      maybeCollectMember(t, child.getFirstChild(), child);
                                                      break;
                                                    case Token.GETPROP:
                                                      maybeCollectMember(t, child, child);
                                                      break;
                                                  }
                                    children: []
                                    pos: 47782
                                    length: 236
                                children: []
                                pos: 47757
                                length: 261
                              pos: 47703
                              length: 325
                            pos: 47665
                            length: 363
                          pos: 47655
                          length: 381
                      children: []
                      pos: 47599
                      length: 437
                    - type: method_declaration
                      fields:
                        name:
                          type: identifier
                          fields:
                            text: maybeCollectMember
                          children: []
                          pos: 48057
                          length: 18
                        parameters:
                          type: method_parameters
                          fields: {}
                          children:
                          - type: formal_parameter
                            fields:
                              text: NodeTraversal t
                            children: []
                            pos: 48076
                            length: 15
                          pos: 48044
                          length: 979
                        body:
                          type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: JSDocInfo info = nodeWithJsDocInfo.getJSDocInfo();
                            children: []
                            pos: 48150
                            length: 50
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: or
                                        fields:
                                          left:
                                            type: equals
                                            fields:
                                              left:
                                                type: identifier
                                                fields:
                                                  text: info
                                                children: []
                                                pos: 48400
                                                length: 4
                                              right:
                                                type: null_literal
                                                fields: {}
                                                children: []
                                                pos: 48408
                                                length: 4
                                            children: []
                                            pos: 48400
                                            length: 12
                                          right:
                                            type: not_equals
                                            fields:
                                              left:
                                                type: method_invocation
                                                fields:
                                                  text: member.getType()
                                                children: []
                                                pos: 48428
                                                length: 16
                                              right:
                                                type: field_access
                                                fields:
                                                  text: Token.GETPROP
                                                children: []
                                                pos: 48448
                                                length: 13
                                            children: []
                                            pos: 48428
                                            length: 33
                                        children: []
                                        pos: 48400
                                        length: 61
                                      right:
                                        type: not_equals
                                        fields:
                                          left:
                                            type: method_invocation
                                            fields:
                                              text: member.getFirstChild().getType()
                                            children: []
                                            pos: 48477
                                            length: 32
                                          right:
                                            type: field_access
                                            fields:
                                              text: Token.THIS
                                            children: []
                                            pos: 48513
                                            length: 10
                                        children: []
                                        pos: 48477
                                        length: 46
                                    children: []
                                    pos: 48400
                                    length: 123
                                children: []
                                pos: 48399
                                length: 125
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: return_statement
                                fields:
                                  text: return;
                                children: []
                                pos: 48537
                                length: 7
                              pos: 48525
                              length: 29
                            pos: 48396
                            length: 158
                          - type: expression_statement
                            fields:
                              text: member.getFirstChild().setJSType(thisType);
                            children: []
                            pos: 48564
                            length: 43
                          - type: local_variable_declaration
                            fields:
                              text: JSType jsType = getDeclaredTypeInAnnotation(t,
                                member, info);
                            children: []
                            pos: 48616
                            length: 61
                          - type: local_variable_declaration
                            fields:
                              text: Node name = member.getLastChild();
                            children: []
                            pos: 48686
                            length: 34
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: and
                                    fields:
                                      left:
                                        type: not_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: jsType
                                            children: []
                                            pos: 48733
                                            length: 6
                                          right:
                                            type: null_literal
                                            fields: {}
                                            children: []
                                            pos: 48743
                                            length: 4
                                        children: []
                                        pos: 48733
                                        length: 14
                                      right:
                                        type: parenthesized_expression
                                        fields:
                                          expression:
                                            type: or
                                            fields:
                                              left:
                                                type: equals
                                                fields:
                                                  left:
                                                    type: method_invocation
                                                    fields:
                                                      text: name.getType()
                                                    children: []
                                                    pos: 48764
                                                    length: 14
                                                  right:
                                                    type: field_access
                                                    fields:
                                                      text: Token.NAME
                                                    children: []
                                                    pos: 48782
                                                    length: 10
                                                children: []
                                                pos: 48764
                                                length: 28
                                              right:
                                                type: equals
                                                fields:
                                                  left:
                                                    type: method_invocation
                                                    fields:
                                                      text: name.getType()
                                                    children: []
                                                    pos: 48796
                                                    length: 14
                                                  right:
                                                    type: field_access
                                                    fields:
                                                      text: Token.STRING
                                                    children: []
                                                    pos: 48814
                                                    length: 12
                                                children: []
                                                pos: 48796
                                                length: 30
                                            children: []
                                            pos: 48764
                                            length: 62
                                        children: []
                                        pos: 48763
                                        length: 64
                                    children: []
                                    pos: 48733
                                    length: 94
                                children: []
                                pos: 48732
                                length: 96
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: |-
                                    thisType.defineDeclaredProperty(
                                                  name.getString(),
                                                  jsType,
                                                  false /* functions with implementations are not in externs */);
                                children: []
                                pos: 48841
                                length: 164
                              pos: 48829
                              length: 186
                            pos: 48729
                            length: 286
                          pos: 48140
                          length: 883
                      children: []
                      pos: 48044
                      length: 979
                    pos: 47372
                    length: 1657
                children: []
                pos: 47372
                length: 1657
              pos: 13913
              length: 35145
          children: []
          pos: 13913
          length: 35145
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: StubDeclaration
              children: []
              pos: 49155
              length: 15
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Node node;
                children: []
                pos: 49177
                length: 24
              - type: field_declaration
                fields:
                  text: private final boolean isExtern;
                children: []
                pos: 49206
                length: 31
              - type: field_declaration
                fields:
                  text: private final String ownerName;
                children: []
                pos: 49242
                length: 31
              - type: constructor_declaration
                fields:
                  text: |-
                    private StubDeclaration(Node node, boolean isExtern, String ownerName) {
                          this.node = node;
                          this.isExtern = isExtern;
                          this.ownerName = ownerName;
                        }
                children: []
                pos: 49279
                length: 168
              pos: 49128
              length: 323
          children: []
          pos: 49128
          length: 323
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: GlobalScopeBuilder
              children: []
              pos: 49586
              length: 18
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private GlobalScopeBuilder(Scope scope) {
                          super(scope);
                        }
                children: []
                pos: 49641
                length: 67
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 49980
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 49986
                      length: 15
                    pos: 49958
                    length: 489
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: super.visit(t, n, parent);
                      children: []
                      pos: 50032
                      length: 26
                    - type: switch_expression
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: n.getType()
                              children: []
                              pos: 50074
                              length: 11
                          children: []
                          pos: 50073
                          length: 13
                        body:
                          type: switch_block
                          fields:
                            text: |-
                              {

                                      case Token.ASSIGN:
                                        // Handle typedefs.
                                        checkForOldStyleTypedef(t, n);
                                        break;

                                      case Token.VAR:
                                        // Handle typedefs.
                                        if (n.hasOneChild()) {
                                          checkForOldStyleTypedef(t, n);
                                          checkForTypedef(t, n.getFirstChild(), n.getJSDocInfo());
                                        }
                                        break;
                                    }
                          children: []
                          pos: 50087
                          length: 354
                      children: []
                      pos: 50066
                      length: 375
                    pos: 50024
                    length: 423
                children: []
                pos: 49958
                length: 489
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: maybeDeclareQualifiedName
                    children: []
                    pos: 50472
                    length: 25
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 50507
                      length: 15
                    pos: 50453
                    length: 242
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: checkForTypedef(t, n, info);
                      children: []
                      pos: 50592
                      length: 28
                    - type: expression_statement
                      fields:
                        text: super.maybeDeclareQualifiedName(t, info, n, parent,
                          rhsValue);
                      children: []
                      pos: 50627
                      length: 62
                    pos: 50584
                    length: 111
                children: []
                pos: 50453
                length: 242
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForTypedef
                    children: []
                    pos: 50875
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 50900
                      length: 15
                    pos: 50862
                    length: 942
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: or
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: info
                                      children: []
                                      pos: 50961
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 50969
                                      length: 4
                                  children: []
                                  pos: 50961
                                  length: 12
                                right:
                                  type: unary_expression
                                  fields:
                                    text: "!info.hasTypedefType()"
                                  children: []
                                  pos: 50977
                                  length: 22
                              children: []
                              pos: 50961
                              length: 38
                          children: []
                          pos: 50960
                          length: 40
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 51011
                          length: 7
                        pos: 51001
                        length: 25
                      pos: 50957
                      length: 69
                    - type: local_variable_declaration
                      fields:
                        text: String typedef = candidate.getQualifiedName();
                      children: []
                      pos: 51034
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: typedef
                                  children: []
                                  pos: 51091
                                  length: 7
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 51102
                                  length: 4
                              children: []
                              pos: 51091
                              length: 15
                          children: []
                          pos: 51090
                          length: 17
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 51118
                          length: 7
                        pos: 51108
                        length: 25
                      pos: 51087
                      length: 46
                    - type: expression_statement
                      fields:
                        text: typeRegistry.forwardDeclareType(typedef);
                      children: []
                      pos: 51307
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: JSType realType = info.getTypedefType().evaluate(scope,
                          typeRegistry);
                      children: []
                      pos: 51356
                      length: 70
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: realType
                                  children: []
                                  pos: 51437
                                  length: 8
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 51449
                                  length: 4
                              children: []
                              pos: 51437
                              length: 16
                          children: []
                          pos: 51436
                          length: 18
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              compiler.report(
                                          JSError.make(
                                              t.getSourceName(), candidate, MALFORMED_TYPEDEF, typedef));
                          children: []
                          pos: 51465
                          length: 118
                        pos: 51455
                        length: 136
                      pos: 51433
                      length: 158
                    - type: expression_statement
                      fields:
                        text: typeRegistry.declareType(typedef, realType);
                      children: []
                      pos: 51599
                      length: 44
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: method_invocation
                                  fields:
                                    text: candidate.getType()
                                  children: []
                                  pos: 51654
                                  length: 19
                                right:
                                  type: field_access
                                  fields:
                                    text: Token.GETPROP
                                  children: []
                                  pos: 51677
                                  length: 13
                              children: []
                              pos: 51654
                              length: 36
                          children: []
                          pos: 51653
                          length: 38
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: |-
                              defineSlot(candidate, candidate.getParent(),
                                          getNativeType(NO_TYPE), false);
                          children: []
                          pos: 51702
                          length: 88
                        pos: 51692
                        length: 106
                      pos: 51650
                      length: 148
                    pos: 50949
                    length: 855
                children: []
                pos: 50862
                length: 942
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: checkForOldStyleTypedef
                    children: []
                    pos: 51985
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 52009
                      length: 15
                    pos: 51972
                    length: 988
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: String typedef = codingConvention.identifyTypeDefAssign(candidate);
                      children: []
                      pos: 52078
                      length: 67
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: typedef
                                  children: []
                                  pos: 52156
                                  length: 7
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 52167
                                  length: 4
                              children: []
                              pos: 52156
                              length: 15
                          children: []
                          pos: 52155
                          length: 17
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: typeRegistry.forwardDeclareType(typedef);
                          children: []
                          pos: 52355
                          length: 41
                        - type: local_variable_declaration
                          fields:
                            text: JSDocInfo info = candidate.getJSDocInfo();
                          children: []
                          pos: 52406
                          length: 42
                        - type: local_variable_declaration
                          fields:
                            text: JSType realType = null;
                          children: []
                          pos: 52457
                          length: 23
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: and
                                  fields:
                                    left:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: info
                                          children: []
                                          pos: 52493
                                          length: 4
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 52501
                                          length: 4
                                      children: []
                                      pos: 52493
                                      length: 12
                                    right:
                                      type: not_equals
                                      fields:
                                        left:
                                          type: method_invocation
                                          fields:
                                            text: info.getType()
                                          children: []
                                          pos: 52509
                                          length: 14
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 52527
                                          length: 4
                                      children: []
                                      pos: 52509
                                      length: 22
                                  children: []
                                  pos: 52493
                                  length: 38
                              children: []
                              pos: 52492
                              length: 40
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: realType = info.getType().evaluate(scope, typeRegistry);
                              children: []
                              pos: 52545
                              length: 56
                            pos: 52533
                            length: 78
                          pos: 52489
                          length: 122
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: realType
                                      children: []
                                      pos: 52625
                                      length: 8
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 52637
                                      length: 4
                                  children: []
                                  pos: 52625
                                  length: 16
                              children: []
                              pos: 52624
                              length: 18
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: |-
                                  compiler.report(
                                                JSError.make(
                                                    t.getSourceName(), candidate, MALFORMED_TYPEDEF, typedef));
                              children: []
                              pos: 52655
                              length: 122
                            pos: 52643
                            length: 144
                          pos: 52621
                          length: 166
                        - type: expression_statement
                          fields:
                            text: typeRegistry.declareType(typedef, realType);
                          children: []
                          pos: 52797
                          length: 44
                        pos: 52173
                        length: 781
                      pos: 52152
                      length: 802
                    pos: 52042
                    length: 918
                children: []
                pos: 51972
                length: 988
              pos: 49566
              length: 3398
          children: []
          pos: 49566
          length: 3398
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: LocalScopeBuilder
              children: []
              pos: 53116
              length: 17
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private LocalScopeBuilder(Scope scope) {
                          super(scope);
                        }
                children: []
                pos: 53236
                length: 66
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: build
                    children: []
                    pos: 53374
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 53369
                    length: 87
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: NodeTraversal.traverse(compiler, scope.getRootNode(),
                          this);
                      children: []
                      pos: 53390
                      length: 60
                    pos: 53382
                    length: 74
                children: []
                pos: 53369
                length: 87
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: visit
                    children: []
                    pos: 53742
                    length: 5
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: NodeTraversal t
                      children: []
                      pos: 53748
                      length: 15
                    pos: 53720
                    length: 284
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: "n"
                                  children: []
                                  pos: 53798
                                  length: 1
                                right:
                                  type: method_invocation
                                  fields:
                                    text: scope.getRootNode()
                                  children: []
                                  pos: 53803
                                  length: 19
                              children: []
                              pos: 53798
                              length: 24
                          children: []
                          pos: 53797
                          length: 26
                      children:
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 53824
                        length: 7
                      pos: 53794
                      length: 37
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: equals
                                  fields:
                                    left:
                                      type: method_invocation
                                      fields:
                                        text: n.getType()
                                      children: []
                                      pos: 53843
                                      length: 11
                                    right:
                                      type: field_access
                                      fields:
                                        text: Token.LP
                                      children: []
                                      pos: 53858
                                      length: 8
                                  children: []
                                  pos: 53843
                                  length: 23
                                right:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: parent
                                      children: []
                                      pos: 53870
                                      length: 6
                                    right:
                                      type: method_invocation
                                      fields:
                                        text: scope.getRootNode()
                                      children: []
                                      pos: 53880
                                      length: 19
                                  children: []
                                  pos: 53870
                                  length: 29
                              children: []
                              pos: 53843
                              length: 56
                          children: []
                          pos: 53842
                          length: 58
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: handleFunctionInputs(parent);
                          children: []
                          pos: 53911
                          length: 29
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 53949
                          length: 7
                        pos: 53901
                        length: 63
                      pos: 53839
                      length: 125
                    - type: expression_statement
                      fields:
                        text: super.visit(t, n, parent);
                      children: []
                      pos: 53972
                      length: 26
                    pos: 53786
                    length: 218
                children: []
                pos: 53720
                length: 284
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: handleFunctionInputs
                    children: []
                    pos: 54085
                    length: 20
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node fnNode
                      children: []
                      pos: 54106
                      length: 11
                    pos: 54072
                    length: 803
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node fnNameNode = fnNode.getFirstChild();
                      children: []
                      pos: 54163
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: String fnName = fnNameNode.getString();
                      children: []
                      pos: 54211
                      length: 39
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: unary_expression
                              fields:
                                text: "!fnName.isEmpty()"
                              children: []
                              pos: 54261
                              length: 17
                          children: []
                          pos: 54260
                          length: 19
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Scope.Var fnVar = scope.getVar(fnName);
                          children: []
                          pos: 54290
                          length: 39
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: or
                                  fields:
                                    left:
                                      type: equals
                                      fields:
                                        left:
                                          type: identifier
                                          fields:
                                            text: fnVar
                                          children: []
                                          pos: 54342
                                          length: 5
                                        right:
                                          type: null_literal
                                          fields: {}
                                          children: []
                                          pos: 54351
                                          length: 4
                                      children: []
                                      pos: 54342
                                      length: 13
                                    right:
                                      type: parenthesized_expression
                                      fields:
                                        expression:
                                          type: and
                                          fields:
                                            left:
                                              type: not_equals
                                              fields:
                                                left:
                                                  type: method_invocation
                                                  fields:
                                                    text: fnVar.getNameNode()
                                                  children: []
                                                  pos: 54536
                                                  length: 19
                                                right:
                                                  type: null_literal
                                                  fields: {}
                                                  children: []
                                                  pos: 54559
                                                  length: 4
                                              children: []
                                              pos: 54536
                                              length: 27
                                            right:
                                              type: not_equals
                                              fields:
                                                left:
                                                  type: method_invocation
                                                  fields:
                                                    text: fnVar.getInitialValue()
                                                  children: []
                                                  pos: 54712
                                                  length: 23
                                                right:
                                                  type: identifier
                                                  fields:
                                                    text: fnNode
                                                  children: []
                                                  pos: 54739
                                                  length: 6
                                              children: []
                                              pos: 54712
                                              length: 33
                                          children: []
                                          pos: 54536
                                          length: 209
                                      children: []
                                      pos: 54535
                                      length: 211
                                  children: []
                                  pos: 54342
                                  length: 404
                              children: []
                              pos: 54341
                              length: 406
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: defineSlot(fnNameNode, fnNode, fnNode.getJSType(),
                                  false);
                              children: []
                              pos: 54760
                              length: 58
                            pos: 54748
                            length: 80
                          pos: 54338
                          length: 490
                        pos: 54280
                        length: 556
                      pos: 54257
                      length: 579
                    - type: expression_statement
                      fields:
                        text: declareArguments(fnNode);
                      children: []
                      pos: 54844
                      length: 25
                    pos: 54119
                    length: 756
                children: []
                pos: 54072
                length: 803
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: declareArguments
                    children: []
                    pos: 54957
                    length: 16
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Node functionNode
                      children: []
                      pos: 54974
                      length: 17
                    pos: 54944
                    length: 843
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Node astParameters = functionNode.getFirstChild().getNext();
                      children: []
                      pos: 55001
                      length: 60
                    - type: local_variable_declaration
                      fields:
                        text: Node body = astParameters.getNext();
                      children: []
                      pos: 55068
                      length: 36
                    - type: local_variable_declaration
                      fields:
                        text: FunctionType functionType = (FunctionType) functionNode.getJSType();
                      children: []
                      pos: 55111
                      length: 68
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: not_equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: functionType
                                  children: []
                                  pos: 55190
                                  length: 12
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 55206
                                  length: 4
                              children: []
                              pos: 55190
                              length: 20
                          children: []
                          pos: 55189
                          length: 22
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Node jsDocParameters = functionType.getParametersNode();
                          children: []
                          pos: 55222
                          length: 56
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: not_equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: jsDocParameters
                                      children: []
                                      pos: 55291
                                      length: 15
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 55310
                                      length: 4
                                  children: []
                                  pos: 55291
                                  length: 23
                              children: []
                              pos: 55290
                              length: 25
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: local_variable_declaration
                              fields:
                                text: Node jsDocParameter = jsDocParameters.getFirstChild();
                              children: []
                              pos: 55328
                              length: 54
                            - type: enhanced_for_statement
                              fields:
                                text: |-
                                  for (Node astParameter : astParameters.children()) {
                                              if (jsDocParameter != null) {
                                                defineSlot(astParameter, functionNode,
                                                    jsDocParameter.getJSType(), true);
                                                jsDocParameter = jsDocParameter.getNext();
                                              } else {
                                                defineSlot(astParameter, functionNode, null, true);
                                              }
                                            }
                              children: []
                              pos: 55393
                              length: 370
                            pos: 55316
                            length: 457
                          pos: 55287
                          length: 486
                        pos: 55212
                        length: 569
                      pos: 55186
                      length: 595
                    pos: 54993
                    length: 794
                children: []
                pos: 54944
                length: 843
              pos: 53096
              length: 2719
          children: []
          pos: 53096
          length: 2719
        pos: 4648
        length: 51194
    children: []
    pos: 4648
    length: 51194
  pos: 0
  length: 55843
text_diff: "--- before\n+++ after\n@@ -896,16 +896,9 @@\n       // scope where the
  root object appears. This helps out people\n       // who declare \"global\" names
  in an anonymous namespace.\n       Scope scopeToDeclareIn = scope;\n-      if (n.getType()
  == Token.GETPROP && !scope.isGlobal() &&\n-          isQnameRootedInGlobalScope(n))
  {\n-        Scope globalScope = scope.getGlobalScope();\n \n         // don't try
  to declare in the global scope if there's\n         // already a symbol there with
  this name.\n-        if (!globalScope.isDeclared(variableName, false)) {\n-          scopeToDeclareIn
  = scope.getGlobalScope();\n-        }\n-      }\n \n       // declared in closest
  scope?\n       if (scopeToDeclareIn.isDeclared(variableName, false)) {\n"
tree_diff: |+
  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  if_statement [33278,33674]
      parenthesized_expression [33281,33375]
          and [33282,33374]
              and [33282,33331]
                  equals [33282,33310]
                      method_invocation: n.getType() [33282,33293]
                      field_access: Token.GETPROP [33297,33310]
                  unary_expression: !scope.isGlobal() [33314,33331]
              method_invocation: isQnameRootedInGlobalScope(n) [33345,33374]
      block [33376,33674]
          local_variable_declaration: Scope globalScope = scope.getGlobalScope(); [33386,33429]
          if_statement [33552,33666]
              parenthesized_expression [33555,33601]
                  unary_expression: !globalScope.isDeclared(variableName, false) [33556,33600]
              block [33602,33666]
                  expression_statement: scopeToDeclareIn = scope.getGlobalScope(); [33614,33656]

...
