---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ZipArchiveOutputStream
        children: []
        pos: 3853
        length: 22
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: static final int BUFFER_SIZE = 512;
          children: []
          pos: 3911
          length: 35
        - type: field_declaration
          fields:
            text: private static final int LFH_SIG_OFFSET = 0;
          children: []
          pos: 3951
          length: 44
        - type: field_declaration
          fields:
            text: private static final int LFH_VERSION_NEEDED_OFFSET = 4;
          children: []
          pos: 4000
          length: 55
        - type: field_declaration
          fields:
            text: private static final int LFH_GPB_OFFSET = 6;
          children: []
          pos: 4060
          length: 44
        - type: field_declaration
          fields:
            text: private static final int LFH_METHOD_OFFSET = 8;
          children: []
          pos: 4109
          length: 47
        - type: field_declaration
          fields:
            text: private static final int LFH_TIME_OFFSET = 10;
          children: []
          pos: 4161
          length: 46
        - type: field_declaration
          fields:
            text: private static final int LFH_CRC_OFFSET = 14;
          children: []
          pos: 4212
          length: 45
        - type: field_declaration
          fields:
            text: private static final int LFH_COMPRESSED_SIZE_OFFSET = 18;
          children: []
          pos: 4262
          length: 57
        - type: field_declaration
          fields:
            text: private static final int LFH_ORIGINAL_SIZE_OFFSET = 22;
          children: []
          pos: 4324
          length: 55
        - type: field_declaration
          fields:
            text: private static final int LFH_FILENAME_LENGTH_OFFSET = 26;
          children: []
          pos: 4384
          length: 57
        - type: field_declaration
          fields:
            text: private static final int LFH_EXTRA_LENGTH_OFFSET = 28;
          children: []
          pos: 4446
          length: 54
        - type: field_declaration
          fields:
            text: private static final int LFH_FILENAME_OFFSET = 30;
          children: []
          pos: 4505
          length: 50
        - type: field_declaration
          fields:
            text: private static final int CFH_SIG_OFFSET = 0;
          children: []
          pos: 4560
          length: 44
        - type: field_declaration
          fields:
            text: private static final int CFH_VERSION_MADE_BY_OFFSET = 4;
          children: []
          pos: 4609
          length: 56
        - type: field_declaration
          fields:
            text: private static final int CFH_VERSION_NEEDED_OFFSET = 6;
          children: []
          pos: 4670
          length: 55
        - type: field_declaration
          fields:
            text: private static final int CFH_GPB_OFFSET = 8;
          children: []
          pos: 4730
          length: 44
        - type: field_declaration
          fields:
            text: private static final int CFH_METHOD_OFFSET = 10;
          children: []
          pos: 4779
          length: 48
        - type: field_declaration
          fields:
            text: private static final int CFH_TIME_OFFSET = 12;
          children: []
          pos: 4832
          length: 46
        - type: field_declaration
          fields:
            text: private static final int CFH_CRC_OFFSET = 16;
          children: []
          pos: 4883
          length: 45
        - type: field_declaration
          fields:
            text: private static final int CFH_COMPRESSED_SIZE_OFFSET = 20;
          children: []
          pos: 4933
          length: 57
        - type: field_declaration
          fields:
            text: private static final int CFH_ORIGINAL_SIZE_OFFSET = 24;
          children: []
          pos: 4995
          length: 55
        - type: field_declaration
          fields:
            text: private static final int CFH_FILENAME_LENGTH_OFFSET = 28;
          children: []
          pos: 5055
          length: 57
        - type: field_declaration
          fields:
            text: private static final int CFH_EXTRA_LENGTH_OFFSET = 30;
          children: []
          pos: 5117
          length: 54
        - type: field_declaration
          fields:
            text: private static final int CFH_COMMENT_LENGTH_OFFSET = 32;
          children: []
          pos: 5176
          length: 56
        - type: field_declaration
          fields:
            text: private static final int CFH_DISK_NUMBER_OFFSET = 34;
          children: []
          pos: 5237
          length: 53
        - type: field_declaration
          fields:
            text: private static final int CFH_INTERNAL_ATTRIBUTES_OFFSET = 36;
          children: []
          pos: 5295
          length: 61
        - type: field_declaration
          fields:
            text: private static final int CFH_EXTERNAL_ATTRIBUTES_OFFSET = 38;
          children: []
          pos: 5361
          length: 61
        - type: field_declaration
          fields:
            text: private static final int CFH_LFH_OFFSET = 42;
          children: []
          pos: 5427
          length: 45
        - type: field_declaration
          fields:
            text: private static final int CFH_FILENAME_OFFSET = 46;
          children: []
          pos: 5477
          length: 50
        - type: field_declaration
          fields:
            text: protected boolean finished = false;
          children: []
          pos: 5623
          length: 35
        - type: field_declaration
          fields:
            text: public static final int DEFLATED = java.util.zip.ZipEntry.DEFLATED;
          children: []
          pos: 5728
          length: 67
        - type: field_declaration
          fields:
            text: public static final int DEFAULT_COMPRESSION = Deflater.DEFAULT_COMPRESSION;
          children: []
          pos: 5872
          length: 75
        - type: field_declaration
          fields:
            text: public static final int STORED = java.util.zip.ZipEntry.STORED;
          children: []
          pos: 6015
          length: 63
        - type: field_declaration
          fields:
            text: static final String DEFAULT_ENCODING = ZipEncodingHelper.UTF8;
          children: []
          pos: 6152
          length: 62
        - type: field_declaration
          fields:
            text: |-
              @Deprecated
                  public static final int EFS_FLAG = GeneralPurposeBit.UFT8_NAMES_FLAG;
          children: []
          pos: 6398
          length: 85
        - type: field_declaration
          fields:
            text: private static final byte[] EMPTY = new byte[0];
          children: []
          pos: 6489
          length: 48
        - type: field_declaration
          fields:
            text: private CurrentEntry entry;
          children: []
          pos: 6581
          length: 27
        - type: field_declaration
          fields:
            text: private String comment = "";
          children: []
          pos: 6655
          length: 28
        - type: field_declaration
          fields:
            text: private int level = DEFAULT_COMPRESSION;
          children: []
          pos: 6746
          length: 40
        - type: field_declaration
          fields:
            text: private boolean hasCompressionLevelChanged = false;
          children: []
          pos: 6889
          length: 51
        - type: field_declaration
          fields:
            text: private int method = java.util.zip.ZipEntry.DEFLATED;
          children: []
          pos: 7012
          length: 53
        - type: field_declaration
          fields:
            text: |-
              private final List<ZipArchiveEntry> entries =
                      new LinkedList<>();
          children: []
          pos: 7136
          length: 73
        - type: field_declaration
          fields:
            text: private final StreamCompressor streamCompressor;
          children: []
          pos: 7215
          length: 48
        - type: field_declaration
          fields:
            text: private long cdOffset = 0;
          children: []
          pos: 7320
          length: 26
        - type: field_declaration
          fields:
            text: private long cdLength = 0;
          children: []
          pos: 7404
          length: 26
        - type: field_declaration
          fields:
            text: private static final byte[] ZERO = {0, 0};
          children: []
          pos: 7484
          length: 42
        - type: field_declaration
          fields:
            text: private static final byte[] LZERO = {0, 0, 0, 0};
          children: []
          pos: 7579
          length: 49
        - type: field_declaration
          fields:
            text: private static final byte[] ONE = ZipLong.getBytes(1L);
          children: []
          pos: 7634
          length: 55
        - type: field_declaration
          fields:
            text: |-
              private final Map<ZipArchiveEntry, EntryMetaData> metaData =
                      new HashMap<>();
          children: []
          pos: 7763
          length: 85
        - type: field_declaration
          fields:
            text: private String encoding = DEFAULT_ENCODING;
          children: []
          pos: 8166
          length: 43
        - type: field_declaration
          fields:
            text: |-
              private ZipEncoding zipEncoding =
                      ZipEncodingHelper.getZipEncoding(DEFAULT_ENCODING);
          children: []
          pos: 8398
          length: 93
        - type: field_declaration
          fields:
            text: protected final Deflater def;
          children: []
          pos: 8569
          length: 29
        - type: field_declaration
          fields:
            text: private final SeekableByteChannel channel;
          children: []
          pos: 8657
          length: 42
        - type: field_declaration
          fields:
            text: private final OutputStream out;
          children: []
          pos: 8705
          length: 31
        - type: field_declaration
          fields:
            text: private boolean useUTF8Flag = true;
          children: []
          pos: 8853
          length: 35
        - type: field_declaration
          fields:
            text: private boolean fallbackToUTF8 = false;
          children: []
          pos: 8971
          length: 39
        - type: field_declaration
          fields:
            text: private UnicodeExtraFieldPolicy createUnicodeExtraFields = UnicodeExtraFieldPolicy.NEVER;
          children: []
          pos: 9097
          length: 89
        - type: field_declaration
          fields:
            text: private boolean hasUsedZip64 = false;
          children: []
          pos: 9303
          length: 37
        - type: field_declaration
          fields:
            text: private Zip64Mode zip64Mode = Zip64Mode.AsNeeded;
          children: []
          pos: 9346
          length: 49
        - type: field_declaration
          fields:
            text: private final byte[] copyBuffer = new byte[32768];
          children: []
          pos: 9401
          length: 50
        - type: field_declaration
          fields:
            text: private final Calendar calendarInstance = Calendar.getInstance();
          children: []
          pos: 9456
          length: 65
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(final OutputStream out) {
                      this.out = out;
                      this.channel = null;
                      def = new Deflater(level, true);
                      streamCompressor = StreamCompressor.create(out, def);
                  }
          children: []
          pos: 9656
          length: 217
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(final File file) throws IOException {
                      def = new Deflater(level, true);
                      OutputStream o = null;
                      SeekableByteChannel _channel = null;
                      StreamCompressor _streamCompressor = null;
                      try {
                          _channel = Files.newByteChannel(file.toPath(),
                              EnumSet.of(StandardOpenOption.CREATE, StandardOpenOption.WRITE,
                                         StandardOpenOption.READ,
                                         StandardOpenOption.TRUNCATE_EXISTING));
                          // will never get opened properly when an exception is thrown so doesn't need to get closed
                          _streamCompressor = StreamCompressor.create(_channel, def); //NOSONAR
                      } catch (final IOException e) {
                          IOUtils.closeQuietly(_channel);
                          _channel = null;
                          o = new FileOutputStream(file);
                          _streamCompressor = StreamCompressor.create(o, def);
                      }
                      out = o;
                      channel = _channel;
                      streamCompressor = _streamCompressor;
                  }
          children: []
          pos: 10070
          length: 1022
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(SeekableByteChannel channel) throws IOException {
                      this.channel = channel;
                      def = new Deflater(level, true);
                      streamCompressor = StreamCompressor.create(channel, def);
                      out = null;
                  }
          children: []
          pos: 11469
          length: 244
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSeekable
              children: []
              pos: 12098
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 12083
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return channel != null;
                children: []
                pos: 12121
                length: 23
              pos: 12111
              length: 39
          children: []
          pos: 12083
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setEncoding
              children: []
              pos: 12591
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String encoding
                children: []
                pos: 12603
                length: 21
              pos: 12579
              length: 268
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.encoding = encoding;
                children: []
                pos: 12636
                length: 25
              - type: expression_statement
                fields:
                  text: this.zipEncoding = ZipEncodingHelper.getZipEncoding(encoding);
                children: []
                pos: 12670
                length: 62
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: useUTF8Flag
                            children: []
                            pos: 12745
                            length: 11
                          right:
                            type: unary_expression
                            fields:
                              text: "!ZipEncodingHelper.isUTF8(encoding)"
                            children: []
                            pos: 12760
                            length: 35
                        children: []
                        pos: 12745
                        length: 50
                    children: []
                    pos: 12744
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: useUTF8Flag = false;
                    children: []
                    pos: 12811
                    length: 20
                  pos: 12797
                  length: 44
                pos: 12741
                length: 100
              pos: 12626
              length: 221
          children: []
          pos: 12579
          length: 268
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEncoding
              children: []
              pos: 13025
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 13011
              length: 60
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return encoding;
                children: []
                pos: 13049
                length: 16
              pos: 13039
              length: 32
          children: []
          pos: 13011
          length: 60
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setUseLanguageEncodingFlag
              children: []
              pos: 13343
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean b
                children: []
                pos: 13370
                length: 15
              pos: 13331
              length: 126
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: useUTF8Flag = b && ZipEncodingHelper.isUTF8(encoding);
                children: []
                pos: 13397
                length: 54
              pos: 13387
              length: 70
          children: []
          pos: 13331
          length: 126
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setCreateUnicodeExtraFields
              children: []
              pos: 13641
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnicodeExtraFieldPolicy b
                children: []
                pos: 13669
                length: 31
              pos: 13629
              length: 118
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: createUnicodeExtraFields = b;
                children: []
                pos: 13712
                length: 29
              pos: 13702
              length: 45
          children: []
          pos: 13629
          length: 118
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setFallbackToUTF8
              children: []
              pos: 14120
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean b
                children: []
                pos: 14138
                length: 15
              pos: 14108
              length: 82
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: fallbackToUTF8 = b;
                children: []
                pos: 14165
                length: 19
              pos: 14155
              length: 35
          children: []
          pos: 14108
          length: 82
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setUseZip64
              children: []
              pos: 16592
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode mode
                children: []
                pos: 16604
                length: 20
              pos: 16580
              length: 79
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: zip64Mode = mode;
                children: []
                pos: 16636
                length: 17
              pos: 16626
              length: 33
          children: []
          pos: 16580
          length: 79
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: finish
              children: []
              pos: 16927
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 16901
              length: 648
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 16969
                        length: 8
                    children: []
                    pos: 16968
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("This archive has already been finished");
                    children: []
                    pos: 16993
                    length: 64
                  pos: 16979
                  length: 88
                pos: 16965
                length: 102
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 17081
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17090
                            length: 4
                        children: []
                        pos: 17081
                        length: 13
                    children: []
                    pos: 17080
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("This archive contains unclosed
                        entries.");
                    children: []
                    pos: 17110
                    length: 65
                  pos: 17096
                  length: 89
                pos: 17077
                length: 108
              - type: expression_statement
                fields:
                  text: cdOffset = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 17195
                length: 51
              - type: expression_statement
                fields:
                  text: writeCentralDirectoryInChunks();
                children: []
                pos: 17255
                length: 32
              - type: expression_statement
                fields:
                  text: cdLength = streamCompressor.getTotalBytesWritten() - cdOffset;
                children: []
                pos: 17297
                length: 62
              - type: expression_statement
                fields:
                  text: writeZip64CentralDirectory();
                children: []
                pos: 17368
                length: 29
              - type: expression_statement
                fields:
                  text: writeCentralDirectoryEnd();
                children: []
                pos: 17406
                length: 27
              - type: expression_statement
                fields:
                  text: metaData.clear();
                children: []
                pos: 17442
                length: 17
              - type: expression_statement
                fields:
                  text: entries.clear();
                children: []
                pos: 17468
                length: 16
              - type: expression_statement
                fields:
                  text: streamCompressor.close();
                children: []
                pos: 17493
                length: 25
              - type: expression_statement
                fields:
                  text: finished = true;
                children: []
                pos: 17527
                length: 16
              pos: 16955
              length: 594
          children: []
          pos: 16901
          length: 648
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralDirectoryInChunks
              children: []
              pos: 17568
              length: 29
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 17555
              length: 628
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int NUM_PER_WRITE = 1000;
                children: []
                pos: 17629
                length: 31
              - type: local_variable_declaration
                fields:
                  text: final ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(70
                    * NUM_PER_WRITE);
                children: []
                pos: 17669
                length: 98
              - type: local_variable_declaration
                fields:
                  text: int count = 0;
                children: []
                pos: 17776
                length: 14
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (final ZipArchiveEntry ze : entries) {
                                byteArrayOutputStream.write(createCentralFileHeader(ze));
                                if (++count > NUM_PER_WRITE){
                                    writeCounted(byteArrayOutputStream.toByteArray());
                                    byteArrayOutputStream.reset();
                                    count = 0;
                                }
                            }
                children: []
                pos: 17799
                length: 319
              - type: expression_statement
                fields:
                  text: writeCounted(byteArrayOutputStream.toByteArray());
                children: []
                pos: 18127
                length: 50
              pos: 17619
              length: 564
          children: []
          pos: 17555
          length: 628
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeArchiveEntry
              children: []
              pos: 18485
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 18459
              length: 586
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: preClose();
                children: []
                pos: 18534
                length: 11
              - type: expression_statement
                fields:
                  text: flushDeflater();
                children: []
                pos: 18555
                length: 16
              - type: local_variable_declaration
                fields:
                  text: final long bytesWritten = streamCompressor.getTotalBytesWritten()
                    - entry.dataStart;
                children: []
                pos: 18581
                length: 84
              - type: local_variable_declaration
                fields:
                  text: final long realCrc = streamCompressor.getCrc32();
                children: []
                pos: 18674
                length: 49
              - type: expression_statement
                fields:
                  text: entry.bytesRead = streamCompressor.getBytesRead();
                children: []
                pos: 18732
                length: 50
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 18791
                length: 67
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = handleSizesAndCrc(bytesWritten,
                    realCrc, effectiveMode);
                children: []
                pos: 18867
                length: 91
              - type: expression_statement
                fields:
                  text: closeEntry(actuallyNeedsZip64, false);
                children: []
                pos: 18967
                length: 38
              - type: expression_statement
                fields:
                  text: streamCompressor.reset();
                children: []
                pos: 19014
                length: 25
              pos: 18524
              length: 521
          children: []
          pos: 18459
          length: 586
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeCopiedEntry
              children: []
              pos: 19594
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean phased
                children: []
                pos: 19611
                length: 20
              pos: 19581
              length: 348
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: preClose();
                children: []
                pos: 19662
                length: 11
              - type: expression_statement
                fields:
                  text: entry.bytesRead = entry.entry.getSize();
                children: []
                pos: 19682
                length: 40
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 19731
                length: 67
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = checkIfNeedsZip64(effectiveMode);
                children: []
                pos: 19807
                length: 68
              - type: expression_statement
                fields:
                  text: closeEntry(actuallyNeedsZip64, phased);
                children: []
                pos: 19884
                length: 39
              pos: 19652
              length: 277
          children: []
          pos: 19581
          length: 348
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeEntry
              children: []
              pos: 19948
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean actuallyNeedsZip64
                children: []
                pos: 19959
                length: 32
              pos: 19935
              length: 312
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!phased"
                            children: []
                            pos: 20048
                            length: 7
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: channel
                                children: []
                                pos: 20059
                                length: 7
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 20070
                                length: 4
                            children: []
                            pos: 20059
                            length: 15
                        children: []
                        pos: 20048
                        length: 26
                    children: []
                    pos: 20047
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: rewriteSizesAndCrc(actuallyNeedsZip64);
                    children: []
                    pos: 20090
                    length: 39
                  pos: 20076
                  length: 63
                pos: 20044
                length: 95
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!phased"
                        children: []
                        pos: 20153
                        length: 7
                    children: []
                    pos: 20152
                    length: 9
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeDataDescriptor(entry.entry);
                    children: []
                    pos: 20176
                    length: 33
                  pos: 20162
                  length: 57
                pos: 20149
                length: 70
              - type: expression_statement
                fields:
                  text: entry = null;
                children: []
                pos: 20228
                length: 13
              pos: 20034
              length: 213
          children: []
          pos: 19935
          length: 312
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: preClose
              children: []
              pos: 20266
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 20253
              length: 335
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 20310
                        length: 8
                    children: []
                    pos: 20309
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 20334
                    length: 58
                  pos: 20320
                  length: 82
                pos: 20306
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 20416
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20425
                            length: 4
                        children: []
                        pos: 20416
                        length: 13
                    children: []
                    pos: 20415
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("No current entry to close");
                    children: []
                    pos: 20445
                    length: 51
                  pos: 20431
                  length: 75
                pos: 20412
                length: 94
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!entry.hasWritten"
                        children: []
                        pos: 20520
                        length: 17
                    children: []
                    pos: 20519
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: write(EMPTY, 0, 0);
                    children: []
                    pos: 20553
                    length: 19
                  pos: 20539
                  length: 43
                pos: 20516
                length: 66
              pos: 20296
              length: 292
          children: []
          pos: 20253
          length: 335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addRawArchiveEntry
              children: []
              pos: 21148
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 21167
                length: 27
              pos: 21136
              length: 878
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final ZipArchiveEntry ae = new ZipArchiveEntry(entry);
                children: []
                pos: 21266
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(ae)
                        children: []
                        pos: 21333
                        length: 17
                    children: []
                    pos: 21332
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ae.removeExtraField(Zip64ExtendedInformationExtraField.HEADER_ID);
                    children: []
                    pos: 21587
                    length: 66
                  pos: 21352
                  length: 311
                pos: 21329
                length: 334
              - type: local_variable_declaration
                fields:
                  text: |-
                    final boolean is2PhaseSource = ae.getCrc() != ZipArchiveEntry.CRC_UNKNOWN
                                    && ae.getSize() != ArchiveEntry.SIZE_UNKNOWN
                                    && ae.getCompressedSize() != ArchiveEntry.SIZE_UNKNOWN;
                children: []
                pos: 21672
                length: 206
              - type: expression_statement
                fields:
                  text: putArchiveEntry(ae, is2PhaseSource);
                children: []
                pos: 21887
                length: 36
              - type: expression_statement
                fields:
                  text: copyFromZipInputStream(rawStream);
                children: []
                pos: 21932
                length: 34
              - type: expression_statement
                fields:
                  text: closeCopiedEntry(is2PhaseSource);
                children: []
                pos: 21975
                length: 33
              pos: 21256
              length: 758
          children: []
          pos: 21136
          length: 878
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flushDeflater
              children: []
              pos: 22122
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 22109
              length: 162
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.entry.getMethod()
                            children: []
                            pos: 22171
                            length: 23
                          right:
                            type: identifier
                            fields:
                              text: DEFLATED
                            children: []
                            pos: 22198
                            length: 8
                        children: []
                        pos: 22171
                        length: 35
                    children: []
                    pos: 22170
                    length: 37
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: streamCompressor.flushDeflater();
                    children: []
                    pos: 22222
                    length: 33
                  pos: 22208
                  length: 57
                pos: 22167
                length: 98
              pos: 22157
              length: 114
          children: []
          pos: 22109
          length: 162
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: handleSizesAndCrc
              children: []
              pos: 22544
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final long bytesWritten
                children: []
                pos: 22562
                length: 23
              pos: 22528
              length: 1657
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.entry.getMethod()
                            children: []
                            pos: 22714
                            length: 23
                          right:
                            type: identifier
                            fields:
                              text: DEFLATED
                            children: []
                            pos: 22741
                            length: 8
                        children: []
                        pos: 22714
                        length: 35
                    children: []
                    pos: 22713
                    length: 37
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.entry.setSize(entry.bytesRead);
                    children: []
                    pos: 22957
                    length: 37
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCompressedSize(bytesWritten);
                    children: []
                    pos: 23007
                    length: 44
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCrc(crc);
                    children: []
                    pos: 23064
                    length: 24
                  pos: 22751
                  length: 348
                pos: 22710
                length: 1419
              - type: return_statement
                fields:
                  text: return checkIfNeedsZip64(effectiveMode);
                children: []
                pos: 24139
                length: 40
              pos: 22700
              length: 1485
          children: []
          pos: 22528
          length: 1657
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkIfNeedsZip64
              children: []
              pos: 24371
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode effectiveMode
                children: []
                pos: 24389
                length: 29
              pos: 24355
              length: 412
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = isZip64Required(entry.entry,
                    effectiveMode);
                children: []
                pos: 24462
                length: 79
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: actuallyNeedsZip64
                            children: []
                            pos: 24554
                            length: 18
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: effectiveMode
                                children: []
                                pos: 24576
                                length: 13
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 24593
                                length: 15
                            children: []
                            pos: 24576
                            length: 32
                        children: []
                        pos: 24554
                        length: 54
                    children: []
                    pos: 24553
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new Zip64RequiredException(Zip64RequiredException.getEntryTooBigMessage(entry.entry));
                    children: []
                    pos: 24624
                    length: 92
                  pos: 24610
                  length: 116
                pos: 24550
                length: 176
              - type: return_statement
                fields:
                  text: return actuallyNeedsZip64;
                children: []
                pos: 24735
                length: 26
              pos: 24452
              length: 315
          children: []
          pos: 24355
          length: 412
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isZip64Required
              children: []
              pos: 24789
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry1
                children: []
                pos: 24805
                length: 28
              pos: 24773
              length: 179
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return requestedMode == Zip64Mode.Always || isTooLageForZip32(entry1);
                children: []
                pos: 24876
                length: 70
              pos: 24866
              length: 86
          children: []
          pos: 24773
          length: 179
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isTooLageForZip32
              children: []
              pos: 24974
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry zipArchiveEntry
                children: []
                pos: 24992
                length: 37
              pos: 24958
              length: 190
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return zipArchiveEntry.getSize() >= ZIP64_MAGIC || zipArchiveEntry.getCompressedSize()
                    >= ZIP64_MAGIC;
                children: []
                pos: 25040
                length: 102
              pos: 25030
              length: 118
          children: []
          pos: 24958
          length: 190
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: rewriteSizesAndCrc
              children: []
              pos: 25358
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean actuallyNeedsZip64
                children: []
                pos: 25377
                length: 32
              pos: 25345
              length: 2096
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final long save = channel.position();
                children: []
                pos: 25448
                length: 37
              - type: expression_statement
                fields:
                  text: channel.position(entry.localDataStart);
                children: []
                pos: 25495
                length: 39
              - type: expression_statement
                fields:
                  text: writeOut(ZipLong.getBytes(entry.entry.getCrc()));
                children: []
                pos: 25543
                length: 49
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!hasZip64Extra(entry.entry)"
                            children: []
                            pos: 25605
                            length: 27
                          right:
                            type: unary_expression
                            fields:
                              text: "!actuallyNeedsZip64"
                            children: []
                            pos: 25636
                            length: 19
                        children: []
                        pos: 25605
                        length: 50
                    children: []
                    pos: 25604
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipLong.getBytes(entry.entry.getCompressedSize()));
                    children: []
                    pos: 25671
                    length: 60
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipLong.getBytes(entry.entry.getSize()));
                    children: []
                    pos: 25744
                    length: 50
                  pos: 25657
                  length: 147
                pos: 25601
                length: 328
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(entry.entry)
                        children: []
                        pos: 25943
                        length: 26
                    children: []
                    pos: 25942
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final ByteBuffer name = getName(entry.entry);
                    children: []
                    pos: 25985
                    length: 45
                  - type: local_variable_declaration
                    fields:
                      text: final int nameLen = name.limit() - name.position();
                    children: []
                    pos: 26043
                    length: 51
                  - type: expression_statement
                    fields:
                      text: |-
                        channel.position(entry.localDataStart + 3 * WORD + 2 * SHORT
                                                     + nameLen + 2 * SHORT);
                    children: []
                    pos: 26176
                    length: 113
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipEightByteInteger.getBytes(entry.entry.getSize()));
                    children: []
                    pos: 26424
                    length: 62
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipEightByteInteger.getBytes(entry.entry.getCompressedSize()));
                    children: []
                    pos: 26499
                    length: 72
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!actuallyNeedsZip64"
                            children: []
                            pos: 26589
                            length: 19
                        children: []
                        pos: 26588
                        length: 21
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: channel.position(entry.localDataStart  - 5 * SHORT);
                        children: []
                        pos: 26719
                        length: 52
                      - type: expression_statement
                        fields:
                          text: writeOut(ZipShort.getBytes(versionNeededToExtract(entry.entry.getMethod(),
                            false, false)));
                        children: []
                        pos: 26788
                        length: 91
                      - type: expression_statement
                        fields:
                          text: |-
                            entry.entry.removeExtraField(Zip64ExtendedInformationExtraField
                                                                         .HEADER_ID);
                        children: []
                        pos: 27009
                        length: 121
                      - type: expression_statement
                        fields:
                          text: entry.entry.setExtra();
                        children: []
                        pos: 27147
                        length: 23
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: field_access
                                fields:
                                  text: entry.causedUseOfZip64
                                children: []
                                pos: 27294
                                length: 22
                            children: []
                            pos: 27293
                            length: 24
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: hasUsedZip64 = false;
                            children: []
                            pos: 27340
                            length: 21
                          pos: 27318
                          length: 61
                        pos: 27290
                        length: 89
                      pos: 26610
                      length: 783
                    pos: 26585
                    length: 808
                  pos: 25971
                  length: 1432
                pos: 25939
                length: 1464
              - type: expression_statement
                fields:
                  text: channel.position(save);
                children: []
                pos: 27412
                length: 23
              pos: 25438
              length: 2003
          children: []
          pos: 25345
          length: 2096
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putArchiveEntry
              children: []
              pos: 27772
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry archiveEntry
                children: []
                pos: 27788
                length: 31
              pos: 27746
              length: 147
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: putArchiveEntry(archiveEntry, false);
                children: []
                pos: 27850
                length: 37
              pos: 27840
              length: 53
          children: []
          pos: 27746
          length: 147
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putArchiveEntry
              children: []
              pos: 28540
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry archiveEntry
                children: []
                pos: 28556
                length: 31
              pos: 28527
              length: 1873
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 28644
                        length: 8
                    children: []
                    pos: 28643
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 28668
                    length: 58
                  pos: 28654
                  length: 82
                pos: 28640
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 28750
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 28759
                            length: 4
                        children: []
                        pos: 28750
                        length: 13
                    children: []
                    pos: 28749
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: closeArchiveEntry();
                    children: []
                    pos: 28779
                    length: 20
                  pos: 28765
                  length: 44
                pos: 28746
                length: 63
              - type: expression_statement
                fields:
                  text: entry = new CurrentEntry((ZipArchiveEntry) archiveEntry);
                children: []
                pos: 28819
                length: 57
              - type: expression_statement
                fields:
                  text: entries.add(entry.entry);
                children: []
                pos: 28885
                length: 25
              - type: expression_statement
                fields:
                  text: setDefaults(entry.entry);
                children: []
                pos: 28920
                length: 25
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 28955
                length: 67
              - type: expression_statement
                fields:
                  text: validateSizeInformation(effectiveMode);
                children: []
                pos: 29031
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: shouldAddZip64Extra(entry.entry, effectiveMode)
                        children: []
                        pos: 29084
                        length: 47
                    children: []
                    pos: 29083
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final Zip64ExtendedInformationExtraField z64 = getZip64Extra(entry.entry);
                    children: []
                    pos: 29148
                    length: 74
                  - type: local_variable_declaration
                    fields:
                      text: ZipEightByteInteger size, compressedSize;
                    children: []
                    pos: 29236
                    length: 41
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: identifier
                            fields:
                              text: phased
                            children: []
                            pos: 29294
                            length: 6
                        children: []
                        pos: 29293
                        length: 8
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: size = new ZipEightByteInteger(entry.entry.getSize());
                        children: []
                        pos: 29363
                        length: 54
                      - type: expression_statement
                        fields:
                          text: compressedSize = new ZipEightByteInteger(entry.entry.getCompressedSize());
                        children: []
                        pos: 29434
                        length: 74
                      pos: 29302
                      length: 220
                    pos: 29290
                    length: 733
                  - type: expression_statement
                    fields:
                      text: z64.setSize(size);
                    children: []
                    pos: 30036
                    length: 18
                  - type: expression_statement
                    fields:
                      text: z64.setCompressedSize(compressedSize);
                    children: []
                    pos: 30067
                    length: 38
                  - type: expression_statement
                    fields:
                      text: entry.entry.setExtra();
                    children: []
                    pos: 30118
                    length: 23
                  pos: 29133
                  length: 1018
                pos: 29080
                length: 1071
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getMethod()
                                children: []
                                pos: 30165
                                length: 23
                              right:
                                type: identifier
                                fields:
                                  text: DEFLATED
                                children: []
                                pos: 30192
                                length: 8
                            children: []
                            pos: 30165
                            length: 35
                          right:
                            type: identifier
                            fields:
                              text: hasCompressionLevelChanged
                            children: []
                            pos: 30204
                            length: 26
                        children: []
                        pos: 30165
                        length: 65
                    children: []
                    pos: 30164
                    length: 67
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: def.setLevel(level);
                    children: []
                    pos: 30246
                    length: 20
                  - type: expression_statement
                    fields:
                      text: hasCompressionLevelChanged = false;
                    children: []
                    pos: 30279
                    length: 35
                  pos: 30232
                  length: 92
                pos: 30161
                length: 163
              - type: expression_statement
                fields:
                  text: writeLocalFileHeader((ZipArchiveEntry) archiveEntry, phased);
                children: []
                pos: 30333
                length: 61
              pos: 28630
              length: 1770
          children: []
          pos: 28527
          length: 1873
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setDefaults
              children: []
              pos: 30524
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 30536
                length: 27
              pos: 30511
              length: 284
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.getMethod()
                            children: []
                            pos: 30579
                            length: 17
                          right:
                            type: unary_expression
                            fields:
                              text: "-1"
                            children: []
                            pos: 30600
                            length: 2
                        children: []
                        pos: 30579
                        length: 23
                    children: []
                    pos: 30578
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.setMethod(method);
                    children: []
                    pos: 30635
                    length: 24
                  pos: 30604
                  length: 65
                pos: 30575
                length: 94
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.getTime()
                            children: []
                            pos: 30683
                            length: 15
                          right:
                            type: unary_expression
                            fields:
                              text: "-1"
                            children: []
                            pos: 30702
                            length: 2
                        children: []
                        pos: 30683
                        length: 21
                    children: []
                    pos: 30682
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.setTime(System.currentTimeMillis());
                    children: []
                    pos: 30737
                    length: 42
                  pos: 30706
                  length: 83
                pos: 30679
                length: 110
              pos: 30565
              length: 230
          children: []
          pos: 30511
          length: 284
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: validateSizeInformation
              children: []
              pos: 31055
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode effectiveMode
                children: []
                pos: 31079
                length: 29
              pos: 31042
              length: 1170
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getMethod()
                                children: []
                                pos: 31216
                                length: 23
                              right:
                                type: identifier
                                fields:
                                  text: STORED
                                children: []
                                pos: 31243
                                length: 6
                            children: []
                            pos: 31216
                            length: 33
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: channel
                                children: []
                                pos: 31253
                                length: 7
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 31264
                                length: 4
                            children: []
                            pos: 31253
                            length: 15
                        children: []
                        pos: 31216
                        length: 52
                    children: []
                    pos: 31215
                    length: 54
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getSize()
                                children: []
                                pos: 31288
                                length: 21
                              right:
                                type: field_access
                                fields:
                                  text: ArchiveEntry.SIZE_UNKNOWN
                                children: []
                                pos: 31313
                                length: 25
                            children: []
                            pos: 31288
                            length: 50
                        children: []
                        pos: 31287
                        length: 52
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: throw_statement
                        fields:
                          text: |-
                            throw new ZipException("uncompressed size is required for"
                                                                   + " STORED method when not writing to a"
                                                                   + " file");
                        children: []
                        pos: 31358
                        length: 189
                      pos: 31340
                      length: 221
                    pos: 31284
                    length: 277
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getCrc()
                                children: []
                                pos: 31578
                                length: 20
                              right:
                                type: field_access
                                fields:
                                  text: ZipArchiveEntry.CRC_UNKNOWN
                                children: []
                                pos: 31602
                                length: 27
                            children: []
                            pos: 31578
                            length: 51
                        children: []
                        pos: 31577
                        length: 53
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: throw_statement
                        fields:
                          text: |-
                            throw new ZipException("crc checksum is required for STORED"
                                                                   + " method when not writing to a file");
                        children: []
                        pos: 31649
                        length: 140
                      pos: 31631
                      length: 172
                    pos: 31574
                    length: 229
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCompressedSize(entry.entry.getSize());
                    children: []
                    pos: 31816
                    length: 53
                  pos: 31270
                  length: 609
                pos: 31212
                length: 667
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entry.entry.getSize()
                                        children: []
                                        pos: 31894
                                        length: 21
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 31919
                                        length: 11
                                    children: []
                                    pos: 31894
                                    length: 36
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entry.entry.getCompressedSize()
                                        children: []
                                        pos: 31947
                                        length: 31
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 31982
                                        length: 11
                                    children: []
                                    pos: 31947
                                    length: 46
                                children: []
                                pos: 31894
                                length: 99
                            children: []
                            pos: 31893
                            length: 101
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: effectiveMode
                                children: []
                                pos: 32010
                                length: 13
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 32027
                                length: 15
                            children: []
                            pos: 32010
                            length: 32
                        children: []
                        pos: 31893
                        length: 149
                    children: []
                    pos: 31892
                    length: 151
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .getEntryTooBigMessage(entry.entry));
                    children: []
                    pos: 32058
                    length: 138
                  pos: 32044
                  length: 162
                pos: 31889
                length: 317
              pos: 31138
              length: 1074
          children: []
          pos: 31042
          length: 1170
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldAddZip64Extra
              children: []
              pos: 32656
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 32676
                length: 27
              pos: 32640
              length: 361
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return mode == Zip64Mode.Always
                                || entry.getSize() >= ZIP64_MAGIC
                                || entry.getCompressedSize() >= ZIP64_MAGIC
                                || (entry.getSize() == ArchiveEntry.SIZE_UNKNOWN
                                    && channel != null && mode != Zip64Mode.Never);
                children: []
                pos: 32737
                length: 258
              pos: 32727
              length: 274
          children: []
          pos: 32640
          length: 361
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setComment
              children: []
              pos: 33098
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String comment
                children: []
                pos: 33109
                length: 20
              pos: 33086
              length: 84
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.comment = comment;
                children: []
                pos: 33141
                length: 23
              pos: 33131
              length: 39
          children: []
          pos: 33086
          length: 84
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setLevel
              children: []
              pos: 33460
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int level
                children: []
                pos: 33469
                length: 15
              pos: 33448
              length: 378
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: less_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: level
                                children: []
                                pos: 33500
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Deflater.DEFAULT_COMPRESSION
                                children: []
                                pos: 33508
                                length: 28
                            children: []
                            pos: 33500
                            length: 36
                          right:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: level
                                children: []
                                pos: 33552
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Deflater.BEST_COMPRESSION
                                children: []
                                pos: 33560
                                length: 25
                            children: []
                            pos: 33552
                            length: 33
                        children: []
                        pos: 33500
                        length: 85
                    children: []
                    pos: 33499
                    length: 87
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new IllegalArgumentException("Invalid compression level: "
                                                                       + level);
                    children: []
                    pos: 33601
                    length: 121
                  pos: 33587
                  length: 145
                pos: 33496
                length: 236
              - type: expression_statement
                fields:
                  text: hasCompressionLevelChanged = (this.level != level);
                children: []
                pos: 33741
                length: 51
              - type: expression_statement
                fields:
                  text: this.level = level;
                children: []
                pos: 33801
                length: 19
              pos: 33486
              length: 340
          children: []
          pos: 33448
          length: 378
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMethod
              children: []
              pos: 34038
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int method
                children: []
                pos: 34048
                length: 16
              pos: 34026
              length: 77
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.method = method;
                children: []
                pos: 34076
                length: 21
              pos: 34066
              length: 37
          children: []
          pos: 34026
          length: 77
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: canWriteEntryData
              children: []
              pos: 34370
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry ae
                children: []
                pos: 34388
                length: 21
              pos: 34341
              length: 406
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: ae instanceof ZipArchiveEntry
                        children: []
                        pos: 34425
                        length: 29
                    children: []
                    pos: 34424
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final ZipArchiveEntry zae = (ZipArchiveEntry) ae;
                    children: []
                    pos: 34470
                    length: 49
                  - type: return_statement
                    fields:
                      text: |-
                        return zae.getMethod() != ZipMethod.IMPLODING.getCode()
                                        && zae.getMethod() != ZipMethod.UNSHRINKING.getCode()
                                        && ZipUtil.canHandleEntryData(zae);
                    children: []
                    pos: 34532
                    length: 177
                  pos: 34456
                  length: 263
                pos: 34421
                length: 298
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 34728
                length: 13
              pos: 34411
              length: 336
          children: []
          pos: 34341
          length: 406
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: write
              children: []
              pos: 35009
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] b
                children: []
                pos: 35015
                length: 14
              pos: 34983
              length: 404
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 35100
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 35109
                            length: 4
                        children: []
                        pos: 35100
                        length: 13
                    children: []
                    pos: 35099
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalStateException("No current entry");
                    children: []
                    pos: 35129
                    length: 52
                  pos: 35115
                  length: 76
                pos: 35096
                length: 95
              - type: expression_statement
                fields:
                  text: ZipUtil.checkRequestedFeatures(entry.entry);
                children: []
                pos: 35200
                length: 44
              - type: local_variable_declaration
                fields:
                  text: final long writtenThisTime = streamCompressor.write(b, offset,
                    length, entry.entry.getMethod());
                children: []
                pos: 35253
                length: 96
              - type: expression_statement
                fields:
                  text: count(writtenThisTime);
                children: []
                pos: 35358
                length: 23
              pos: 35086
              length: 301
          children: []
          pos: 34983
          length: 404
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCounted
              children: []
              pos: 35553
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 35566
                length: 17
              pos: 35540
              length: 116
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeCounted(data);
                children: []
                pos: 35614
                length: 36
              pos: 35604
              length: 52
          children: []
          pos: 35540
          length: 116
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: copyFromZipInputStream
              children: []
              pos: 35675
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final InputStream src
                children: []
                pos: 35698
                length: 21
              pos: 35662
              length: 464
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 35754
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 35763
                            length: 4
                        children: []
                        pos: 35754
                        length: 13
                    children: []
                    pos: 35753
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalStateException("No current entry");
                    children: []
                    pos: 35783
                    length: 52
                  pos: 35769
                  length: 76
                pos: 35750
                length: 95
              - type: expression_statement
                fields:
                  text: ZipUtil.checkRequestedFeatures(entry.entry);
                children: []
                pos: 35854
                length: 44
              - type: expression_statement
                fields:
                  text: entry.hasWritten = true;
                children: []
                pos: 35907
                length: 24
              - type: local_variable_declaration
                fields:
                  text: int length;
                children: []
                pos: 35940
                length: 11
              - type: while_statement
                fields:
                  text: |-
                    while ((length = src.read(copyBuffer)) >= 0 )
                            {
                                streamCompressor.writeCounted(copyBuffer, 0, length);
                                count( length );
                            }
                children: []
                pos: 35960
                length: 160
              pos: 35740
              length: 386
          children: []
          pos: 35662
          length: 464
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: close
              children: []
              pos: 36535
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 36509
              length: 136
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!finished"
                        children: []
                        pos: 36576
                        length: 9
                    children: []
                    pos: 36575
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: finish();
                    children: []
                    pos: 36601
                    length: 9
                  pos: 36587
                  length: 33
                pos: 36572
                length: 48
              - type: expression_statement
                fields:
                  text: destroy();
                children: []
                pos: 36629
                length: 10
              pos: 36562
              length: 83
          children: []
          pos: 36509
          length: 136
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flush
              children: []
              pos: 36864
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 36838
              length: 122
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 36905
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 36912
                            length: 4
                        children: []
                        pos: 36905
                        length: 11
                    children: []
                    pos: 36904
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.flush();
                    children: []
                    pos: 36932
                    length: 12
                  pos: 36918
                  length: 36
                pos: 36901
                length: 53
              pos: 36891
              length: 69
          children: []
          pos: 36838
          length: 122
        - type: field_declaration
          fields:
            text: static final byte[] LFH_SIG = ZipLong.LFH_SIG.getBytes();
          children: []
          pos: 37122
          length: 57
        - type: field_declaration
          fields:
            text: static final byte[] DD_SIG = ZipLong.DD_SIG.getBytes();
          children: []
          pos: 37243
          length: 55
        - type: field_declaration
          fields:
            text: static final byte[] CFH_SIG = ZipLong.CFH_SIG.getBytes();
          children: []
          pos: 37366
          length: 57
        - type: field_declaration
          fields:
            text: static final byte[] EOCD_SIG = ZipLong.getBytes(0X06054B50L);
          children: []
          pos: 37490
          length: 61
        - type: field_declaration
          fields:
            text: static final byte[] ZIP64_EOCD_SIG = ZipLong.getBytes(0X06064B50L);
          children: []
          pos: 37624
          length: 67
        - type: field_declaration
          fields:
            text: static final byte[] ZIP64_EOCD_LOC_SIG = ZipLong.getBytes(0X07064B50L);
          children: []
          pos: 37772
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deflate
              children: []
              pos: 37998
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 37977
              length: 93
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.deflate();
                children: []
                pos: 38037
                length: 27
              pos: 38027
              length: 43
          children: []
          pos: 37977
          length: 93
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeLocalFileHeader
              children: []
              pos: 38221
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 38242
                length: 24
              pos: 38206
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: writeLocalFileHeader(ze, false);
                children: []
                pos: 38297
                length: 32
              pos: 38287
              length: 48
          children: []
          pos: 38206
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeLocalFileHeader
              children: []
              pos: 38354
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 38375
                length: 24
              pos: 38341
              length: 841
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 38452
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer name = getName(ze);
                children: []
                pos: 38523
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: createUnicodeExtraFields
                            children: []
                            pos: 38573
                            length: 24
                          right:
                            type: field_access
                            fields:
                              text: UnicodeExtraFieldPolicy.NEVER
                            children: []
                            pos: 38601
                            length: 29
                        children: []
                        pos: 38573
                        length: 57
                    children: []
                    pos: 38572
                    length: 59
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: addUnicodeExtraFields(ze, encodable, name);
                    children: []
                    pos: 38646
                    length: 43
                  pos: 38632
                  length: 67
                pos: 38569
                length: 130
              - type: local_variable_declaration
                fields:
                  text: final long localHeaderStart = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 38709
                length: 70
              - type: local_variable_declaration
                fields:
                  text: final byte[] localHeader = createLocalFileHeader(ze, name,
                    encodable, phased, localHeaderStart);
                children: []
                pos: 38788
                length: 96
              - type: expression_statement
                fields:
                  text: metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod(),
                    phased)));
                children: []
                pos: 38893
                length: 98
              - type: expression_statement
                fields:
                  text: entry.localDataStart = localHeaderStart + LFH_CRC_OFFSET;
                children: []
                pos: 39000
                length: 57
              - type: expression_statement
                fields:
                  text: writeCounted(localHeader);
                children: []
                pos: 39083
                length: 26
              - type: expression_statement
                fields:
                  text: entry.dataStart = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 39118
                length: 58
              pos: 38442
              length: 740
          children: []
          pos: 38341
          length: 841
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createLocalFileHeader
              children: []
              pos: 39204
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 39226
                length: 24
              pos: 39189
              length: 3986
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: |-
                    ResourceAlignmentExtraField oldAlignmentEx =
                                (ResourceAlignmentExtraField) ze.getExtraField(ResourceAlignmentExtraField.ID);
                children: []
                pos: 39412
                length: 136
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: oldAlignmentEx
                            children: []
                            pos: 39561
                            length: 14
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 39579
                            length: 4
                        children: []
                        pos: 39561
                        length: 22
                    children: []
                    pos: 39560
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ze.removeExtraField(ResourceAlignmentExtraField.ID);
                    children: []
                    pos: 39599
                    length: 52
                  pos: 39585
                  length: 76
                pos: 39557
                length: 104
              - type: local_variable_declaration
                fields:
                  text: int alignment = ze.getAlignment();
                children: []
                pos: 39671
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: less_or_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: alignment
                                children: []
                                pos: 39718
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 39731
                                length: 1
                            children: []
                            pos: 39718
                            length: 14
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: oldAlignmentEx
                                children: []
                                pos: 39736
                                length: 14
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 39754
                                length: 4
                            children: []
                            pos: 39736
                            length: 22
                        children: []
                        pos: 39718
                        length: 40
                    children: []
                    pos: 39717
                    length: 42
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: alignment = oldAlignmentEx.getAlignment();
                    children: []
                    pos: 39774
                    length: 42
                  pos: 39760
                  length: 66
                pos: 39714
                length: 112
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: alignment
                                children: []
                                pos: 39840
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '1'
                                children: []
                                pos: 39852
                                length: 1
                            children: []
                            pos: 39840
                            length: 13
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: oldAlignmentEx
                                        children: []
                                        pos: 39858
                                        length: 14
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 39876
                                        length: 4
                                    children: []
                                    pos: 39858
                                    length: 22
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!oldAlignmentEx.allowMethodChange()"
                                    children: []
                                    pos: 39884
                                    length: 35
                                children: []
                                pos: 39858
                                length: 61
                            children: []
                            pos: 39857
                            length: 63
                        children: []
                        pos: 39840
                        length: 80
                    children: []
                    pos: 39839
                    length: 82
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: |-
                        int oldLength = LFH_FILENAME_OFFSET +
                                                    name.limit() - name.position() +
                                                    ze.getLocalFileDataExtra().length;
                    children: []
                    pos: 39936
                    length: 161
                  - type: local_variable_declaration
                    fields:
                      text: |-
                        int padding = (int) ((-archiveOffset - oldLength - ZipExtraField.EXTRAFIELD_HEADER_SIZE
                                                    - ResourceAlignmentExtraField.BASE_SIZE) &
                                                    (alignment - 1));
                    children: []
                    pos: 40111
                    length: 204
                  - type: expression_statement
                    fields:
                      text: |-
                        ze.addExtraField(new ResourceAlignmentExtraField(alignment,
                                                    oldAlignmentEx != null && oldAlignmentEx.allowMethodChange(), padding));
                    children: []
                    pos: 40328
                    length: 160
                  pos: 39922
                  length: 576
                pos: 39836
                length: 662
              - type: local_variable_declaration
                fields:
                  text: final byte[] extra = ze.getLocalFileDataExtra();
                children: []
                pos: 40508
                length: 48
              - type: local_variable_declaration
                fields:
                  text: final int nameLen = name.limit() - name.position();
                children: []
                pos: 40565
                length: 51
              - type: local_variable_declaration
                fields:
                  text: final int len = LFH_FILENAME_OFFSET + nameLen + extra.length;
                children: []
                pos: 40625
                length: 61
              - type: local_variable_declaration
                fields:
                  text: final byte[] buf = new byte[len];
                children: []
                pos: 40695
                length: 33
              - type: expression_statement
                fields:
                  text: System.arraycopy(LFH_SIG,  0, buf, LFH_SIG_OFFSET, WORD);
                children: []
                pos: 40738
                length: 57
              - type: local_variable_declaration
                fields:
                  text: final int zipMethod = ze.getMethod();
                children: []
                pos: 40879
                length: 37
              - type: local_variable_declaration
                fields:
                  text: final boolean dataDescriptor = usesDataDescriptor(zipMethod,
                    phased);
                children: []
                pos: 40925
                length: 69
              - type: expression_statement
                fields:
                  text: putShort(versionNeededToExtract(zipMethod, hasZip64Extra(ze),
                    dataDescriptor), buf, LFH_VERSION_NEEDED_OFFSET);
                children: []
                pos: 41004
                length: 111
              - type: local_variable_declaration
                fields:
                  text: final GeneralPurposeBit generalPurposeBit = getGeneralPurposeBits(!encodable
                    && fallbackToUTF8, dataDescriptor);
                children: []
                pos: 41125
                length: 112
              - type: expression_statement
                fields:
                  text: generalPurposeBit.encode(buf, LFH_GPB_OFFSET);
                children: []
                pos: 41246
                length: 46
              - type: expression_statement
                fields:
                  text: putShort(zipMethod, buf, LFH_METHOD_OFFSET);
                children: []
                pos: 41332
                length: 44
              - type: expression_statement
                fields:
                  text: ZipUtil.toDosTime(calendarInstance, ze.getTime(), buf, LFH_TIME_OFFSET);
                children: []
                pos: 41386
                length: 72
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: phased
                        children: []
                        pos: 41487
                        length: 6
                    children: []
                    pos: 41486
                    length: 8
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: putLong(ze.getCrc(), buf, LFH_CRC_OFFSET);
                    children: []
                    pos: 41508
                    length: 42
                  pos: 41494
                  length: 66
                pos: 41483
                length: 279
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(entry.entry)
                        children: []
                        pos: 41836
                        length: 26
                    children: []
                    pos: 41835
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, LFH_COMPRESSED_SIZE_OFFSET);
                    children: []
                    pos: 42042
                    length: 61
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, LFH_ORIGINAL_SIZE_OFFSET);
                    children: []
                    pos: 42116
                    length: 59
                  pos: 41863
                  length: 322
                pos: 41832
                length: 906
              - type: expression_statement
                fields:
                  text: putShort(nameLen, buf, LFH_FILENAME_LENGTH_OFFSET);
                children: []
                pos: 42775
                length: 51
              - type: expression_statement
                fields:
                  text: putShort(extra.length, buf, LFH_EXTRA_LENGTH_OFFSET);
                children: []
                pos: 42866
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy( name.array(), name.arrayOffset(), buf, LFH_FILENAME_OFFSET,
                    nameLen);
                children: []
                pos: 42950
                length: 87
              - type: expression_statement
                fields:
                  text: System.arraycopy(extra, 0, buf, LFH_FILENAME_OFFSET + nameLen,
                    extra.length);
                children: []
                pos: 43071
                length: 77
              - type: return_statement
                fields:
                  text: return buf;
                children: []
                pos: 43158
                length: 11
              pos: 39402
              length: 3773
          children: []
          pos: 39189
          length: 3986
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addUnicodeExtraFields
              children: []
              pos: 43362
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 43384
                length: 24
              pos: 43349
              length: 1471
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: createUnicodeExtraFields
                                children: []
                                pos: 43538
                                length: 24
                              right:
                                type: field_access
                                fields:
                                  text: UnicodeExtraFieldPolicy.ALWAYS
                                children: []
                                pos: 43566
                                length: 30
                            children: []
                            pos: 43538
                            length: 58
                          right:
                            type: unary_expression
                            fields:
                              text: "!encodable"
                            children: []
                            pos: 43612
                            length: 10
                        children: []
                        pos: 43538
                        length: 84
                    children: []
                    pos: 43537
                    length: 86
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        ze.addExtraField(new UnicodePathExtraField(ze.getName(),
                                                                               name.array(),
                                                                               name.arrayOffset(),
                                                                               name.limit()
                                                                               - name.position()));
                    children: []
                    pos: 43638
                    length: 344
                  pos: 43624
                  length: 368
                pos: 43534
                length: 458
              - type: local_variable_declaration
                fields:
                  text: final String comm = ze.getComment();
                children: []
                pos: 44002
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: comm
                                children: []
                                pos: 44051
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 44059
                                length: 4
                            children: []
                            pos: 44051
                            length: 12
                          right:
                            type: unary_expression
                            fields:
                              text: '!"".equals(comm)'
                            children: []
                            pos: 44067
                            length: 16
                        children: []
                        pos: 44051
                        length: 32
                    children: []
                    pos: 44050
                    length: 34
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final boolean commentEncodable = zipEncoding.canEncode(comm);
                    children: []
                    pos: 44100
                    length: 61
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: createUnicodeExtraFields
                                    children: []
                                    pos: 44179
                                    length: 24
                                  right:
                                    type: field_access
                                    fields:
                                      text: UnicodeExtraFieldPolicy.ALWAYS
                                    children: []
                                    pos: 44207
                                    length: 30
                                children: []
                                pos: 44179
                                length: 58
                              right:
                                type: unary_expression
                                fields:
                                  text: "!commentEncodable"
                                children: []
                                pos: 44257
                                length: 17
                            children: []
                            pos: 44179
                            length: 95
                        children: []
                        pos: 44178
                        length: 97
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: final ByteBuffer commentB = getEntryEncoding(ze).encode(comm);
                        children: []
                        pos: 44294
                        length: 62
                      - type: expression_statement
                        fields:
                          text: |-
                            ze.addExtraField(new UnicodeCommentExtraField(comm,
                                                                                          commentB.array(),
                                                                                          commentB.arrayOffset(),
                                                                                          commentB.limit()
                                                                                          - commentB.position())
                                                             );
                        children: []
                        pos: 44373
                        length: 417
                      pos: 44276
                      length: 528
                    pos: 44175
                    length: 629
                  pos: 44085
                  length: 729
                pos: 44047
                length: 767
              pos: 43524
              length: 1296
          children: []
          pos: 43349
          length: 1471
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeDataDescriptor
              children: []
              pos: 44970
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 44990
                length: 24
              pos: 44955
              length: 595
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!usesDataDescriptor(ze.getMethod(), false)"
                        children: []
                        pos: 45049
                        length: 42
                    children: []
                    pos: 45048
                    length: 44
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 45107
                    length: 7
                  pos: 45093
                  length: 31
                pos: 45045
                length: 79
              - type: expression_statement
                fields:
                  text: writeCounted(DD_SIG);
                children: []
                pos: 45133
                length: 21
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(ze.getCrc()));
                children: []
                pos: 45163
                length: 44
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasZip64Extra(ze)"
                        children: []
                        pos: 45220
                        length: 18
                    children: []
                    pos: 45219
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeCounted(ZipLong.getBytes(ze.getCompressedSize()));
                    children: []
                    pos: 45254
                    length: 55
                  - type: expression_statement
                    fields:
                      text: writeCounted(ZipLong.getBytes(ze.getSize()));
                    children: []
                    pos: 45322
                    length: 45
                  pos: 45240
                  length: 137
                pos: 45216
                length: 328
              pos: 45035
              length: 515
          children: []
          pos: 44955
          length: 595
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralFileHeader
              children: []
              pos: 45857
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 45880
                length: 24
              pos: 45842
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final byte[] centralFileHeader = createCentralFileHeader(ze);
                children: []
                pos: 45935
                length: 61
              - type: expression_statement
                fields:
                  text: writeCounted(centralFileHeader);
                children: []
                pos: 46005
                length: 32
              pos: 45925
              length: 118
          children: []
          pos: 45842
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createCentralFileHeader
              children: []
              pos: 46064
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 46088
                length: 24
              pos: 46049
              length: 937
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final EntryMetaData entryMetaData = metaData.get(ze);
                children: []
                pos: 46144
                length: 53
              - type: local_variable_declaration
                fields:
                  text: |-
                    final boolean needsZip64Extra = hasZip64Extra(ze)
                                    || ze.getCompressedSize() >= ZIP64_MAGIC
                                    || ze.getSize() >= ZIP64_MAGIC
                                    || entryMetaData.offset >= ZIP64_MAGIC
                                    || zip64Mode == Zip64Mode.Always;
                children: []
                pos: 46206
                length: 258
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: needsZip64Extra
                            children: []
                            pos: 46478
                            length: 15
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 46497
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 46510
                                length: 15
                            children: []
                            pos: 46497
                            length: 28
                        children: []
                        pos: 46478
                        length: 47
                    children: []
                    pos: 46477
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                            .ARCHIVE_TOO_BIG_MESSAGE);
                    children: []
                    pos: 46707
                    length: 102
                  pos: 46527
                  length: 292
                pos: 46474
                length: 345
              - type: expression_statement
                fields:
                  text: handleZip64Extra(ze, entryMetaData.offset, needsZip64Extra);
                children: []
                pos: 46830
                length: 60
              - type: return_statement
                fields:
                  text: return createCentralFileHeader(ze, getName(ze), entryMetaData,
                    needsZip64Extra);
                children: []
                pos: 46900
                length: 80
              pos: 46133
              length: 853
          children: []
          pos: 46049
          length: 937
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createCentralFileHeader
              children: []
              pos: 47228
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 47252
                length: 24
              pos: 47213
              length: 3559
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final byte[] extra = ze.getCentralDirectoryExtra();
                children: []
                pos: 47482
                length: 51
              - type: local_variable_declaration
                fields:
                  text: String comm = ze.getComment();
                children: []
                pos: 47574
                length: 30
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: comm
                            children: []
                            pos: 47617
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 47625
                            length: 4
                        children: []
                        pos: 47617
                        length: 12
                    children: []
                    pos: 47616
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: comm = "";
                    children: []
                    pos: 47645
                    length: 10
                  pos: 47631
                  length: 34
                pos: 47613
                length: 52
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer commentB = getEntryEncoding(ze).encode(comm);
                children: []
                pos: 47675
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final int nameLen = name.limit() - name.position();
                children: []
                pos: 47746
                length: 51
              - type: local_variable_declaration
                fields:
                  text: final int commentLen = commentB.limit() - commentB.position();
                children: []
                pos: 47806
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final int len= CFH_FILENAME_OFFSET + nameLen + extra.length
                    + commentLen;
                children: []
                pos: 47877
                length: 73
              - type: local_variable_declaration
                fields:
                  text: final byte[] buf = new byte[len];
                children: []
                pos: 47959
                length: 33
              - type: expression_statement
                fields:
                  text: System.arraycopy(CFH_SIG,  0, buf, CFH_SIG_OFFSET, WORD);
                children: []
                pos: 48002
                length: 57
              - type: expression_statement
                fields:
                  text: |-
                    putShort((ze.getPlatform() << 8) | (!hasUsedZip64 ? DATA_DESCRIPTOR_MIN_VERSION : ZIP64_MIN_VERSION),
                                    buf, CFH_VERSION_MADE_BY_OFFSET);
                children: []
                pos: 48134
                length: 151
              - type: local_variable_declaration
                fields:
                  text: final int zipMethod = ze.getMethod();
                children: []
                pos: 48295
                length: 37
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 48341
                length: 62
              - type: expression_statement
                fields:
                  text: |-
                    putShort(versionNeededToExtract(zipMethod, needsZip64Extra, entryMetaData.usesDataDescriptor),
                                buf, CFH_VERSION_NEEDED_OFFSET);
                children: []
                pos: 48412
                length: 139
              - type: expression_statement
                fields:
                  text: getGeneralPurposeBits(!encodable && fallbackToUTF8, entryMetaData.usesDataDescriptor).encode(buf,
                    CFH_GPB_OFFSET);
                children: []
                pos: 48560
                length: 114
              - type: expression_statement
                fields:
                  text: putShort(zipMethod, buf, CFH_METHOD_OFFSET);
                children: []
                pos: 48714
                length: 44
              - type: expression_statement
                fields:
                  text: ZipUtil.toDosTime(calendarInstance, ze.getTime(), buf, CFH_TIME_OFFSET);
                children: []
                pos: 48804
                length: 72
              - type: expression_statement
                fields:
                  text: putLong(ze.getCrc(), buf, CFH_CRC_OFFSET);
                children: []
                pos: 48961
                length: 42
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getCompressedSize()
                                    children: []
                                    pos: 49016
                                    length: 22
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 49042
                                    length: 11
                                children: []
                                pos: 49016
                                length: 37
                              right:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getSize()
                                    children: []
                                    pos: 49073
                                    length: 12
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 49089
                                    length: 11
                                children: []
                                pos: 49073
                                length: 27
                            children: []
                            pos: 49016
                            length: 84
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 49120
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Always
                                children: []
                                pos: 49133
                                length: 16
                            children: []
                            pos: 49120
                            length: 29
                        children: []
                        pos: 49016
                        length: 133
                    children: []
                    pos: 49015
                    length: 135
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, CFH_COMPRESSED_SIZE_OFFSET);
                    children: []
                    pos: 49165
                    length: 61
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, CFH_ORIGINAL_SIZE_OFFSET);
                    children: []
                    pos: 49239
                    length: 59
                  pos: 49151
                  length: 157
                pos: 49012
                length: 457
              - type: expression_statement
                fields:
                  text: putShort(nameLen, buf, CFH_FILENAME_LENGTH_OFFSET);
                children: []
                pos: 49479
                length: 51
              - type: expression_statement
                fields:
                  text: putShort(extra.length, buf, CFH_EXTRA_LENGTH_OFFSET);
                children: []
                pos: 49570
                length: 53
              - type: expression_statement
                fields:
                  text: putShort(commentLen, buf, CFH_COMMENT_LENGTH_OFFSET);
                children: []
                pos: 49633
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy(ZERO, 0, buf, CFH_DISK_NUMBER_OFFSET, SHORT);
                children: []
                pos: 49725
                length: 62
              - type: expression_statement
                fields:
                  text: putShort(ze.getInternalAttributes(), buf, CFH_INTERNAL_ATTRIBUTES_OFFSET);
                children: []
                pos: 49833
                length: 74
              - type: expression_statement
                fields:
                  text: putLong(ze.getExternalAttributes(), buf, CFH_EXTERNAL_ATTRIBUTES_OFFSET);
                children: []
                pos: 49953
                length: 73
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: greater_or_equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: entryMetaData.offset
                                children: []
                                pos: 50074
                                length: 20
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC
                                children: []
                                pos: 50098
                                length: 11
                            children: []
                            pos: 50074
                            length: 35
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 50113
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Always
                                children: []
                                pos: 50126
                                length: 16
                            children: []
                            pos: 50113
                            length: 29
                        children: []
                        pos: 50074
                        length: 68
                    children: []
                    pos: 50073
                    length: 70
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: putLong(ZIP64_MAGIC, buf, CFH_LFH_OFFSET);
                    children: []
                    pos: 50158
                    length: 42
                  pos: 50144
                  length: 66
                pos: 50070
                length: 244
              - type: expression_statement
                fields:
                  text: System.arraycopy(name.array(), name.arrayOffset(), buf, CFH_FILENAME_OFFSET,
                    nameLen);
                children: []
                pos: 50345
                length: 86
              - type: local_variable_declaration
                fields:
                  text: final int extraStart = CFH_FILENAME_OFFSET + nameLen;
                children: []
                pos: 50441
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy(extra, 0, buf, extraStart, extra.length);
                children: []
                pos: 50503
                length: 58
              - type: local_variable_declaration
                fields:
                  text: final int commentStart = extraStart + extra.length;
                children: []
                pos: 50571
                length: 51
              - type: expression_statement
                fields:
                  text: System.arraycopy(commentB.array(), commentB.arrayOffset(),
                    buf, commentStart, commentLen);
                children: []
                pos: 50656
                length: 90
              - type: return_statement
                fields:
                  text: return buf;
                children: []
                pos: 50755
                length: 11
              pos: 47472
              length: 3300
          children: []
          pos: 47213
          length: 3559
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: handleZip64Extra
              children: []
              pos: 50918
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 50935
                length: 24
              pos: 50905
              length: 954
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: needsZip64Extra
                        children: []
                        pos: 51062
                        length: 15
                    children: []
                    pos: 51061
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final Zip64ExtendedInformationExtraField z64 = getZip64Extra(ze);
                    children: []
                    pos: 51093
                    length: 65
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: or
                                fields:
                                  left:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: ze.getCompressedSize()
                                        children: []
                                        pos: 51175
                                        length: 22
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 51201
                                        length: 11
                                    children: []
                                    pos: 51175
                                    length: 37
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: ze.getSize()
                                        children: []
                                        pos: 51232
                                        length: 12
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 51248
                                        length: 11
                                    children: []
                                    pos: 51232
                                    length: 27
                                children: []
                                pos: 51175
                                length: 84
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: zip64Mode
                                    children: []
                                    pos: 51279
                                    length: 9
                                  right:
                                    type: field_access
                                    fields:
                                      text: Zip64Mode.Always
                                    children: []
                                    pos: 51292
                                    length: 16
                                children: []
                                pos: 51279
                                length: 29
                            children: []
                            pos: 51175
                            length: 133
                        children: []
                        pos: 51174
                        length: 135
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: z64.setCompressedSize(new ZipEightByteInteger(ze.getCompressedSize()));
                        children: []
                        pos: 51328
                        length: 71
                      - type: expression_statement
                        fields:
                          text: z64.setSize(new ZipEightByteInteger(ze.getSize()));
                        children: []
                        pos: 51416
                        length: 51
                      pos: 51310
                      length: 171
                    pos: 51171
                    length: 473
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: lfhOffset
                                    children: []
                                    pos: 51661
                                    length: 9
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 51674
                                    length: 11
                                children: []
                                pos: 51661
                                length: 24
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: zip64Mode
                                    children: []
                                    pos: 51689
                                    length: 9
                                  right:
                                    type: field_access
                                    fields:
                                      text: Zip64Mode.Always
                                    children: []
                                    pos: 51702
                                    length: 16
                                children: []
                                pos: 51689
                                length: 29
                            children: []
                            pos: 51661
                            length: 57
                        children: []
                        pos: 51660
                        length: 59
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: z64.setRelativeHeaderOffset(new ZipEightByteInteger(lfhOffset));
                        children: []
                        pos: 51738
                        length: 64
                      pos: 51720
                      length: 96
                    pos: 51657
                    length: 159
                  - type: expression_statement
                    fields:
                      text: ze.setExtra();
                    children: []
                    pos: 51829
                    length: 14
                  pos: 51079
                  length: 774
                pos: 51058
                length: 795
              pos: 51048
              length: 811
          children: []
          pos: 50905
          length: 954
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralDirectoryEnd
              children: []
              pos: 52198
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 52183
              length: 1395
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: writeCounted(EOCD_SIG);
                children: []
                pos: 52254
                length: 23
              - type: expression_statement
                fields:
                  text: writeCounted(ZERO);
                children: []
                pos: 52311
                length: 19
              - type: expression_statement
                fields:
                  text: writeCounted(ZERO);
                children: []
                pos: 52339
                length: 19
              - type: local_variable_declaration
                fields:
                  text: final int numberOfEntries = entries.size();
                children: []
                pos: 52397
                length: 43
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: numberOfEntries
                                children: []
                                pos: 52453
                                length: 15
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC_SHORT
                                children: []
                                pos: 52471
                                length: 17
                            children: []
                            pos: 52453
                            length: 35
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 52504
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 52517
                                length: 15
                            children: []
                            pos: 52504
                            length: 28
                        children: []
                        pos: 52453
                        length: 79
                    children: []
                    pos: 52452
                    length: 81
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .TOO_MANY_ENTRIES_MESSAGE);
                    children: []
                    pos: 52548
                    length: 128
                  pos: 52534
                  length: 152
                pos: 52449
                length: 237
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cdOffset
                                children: []
                                pos: 52699
                                length: 8
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC
                                children: []
                                pos: 52710
                                length: 11
                            children: []
                            pos: 52699
                            length: 22
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 52725
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 52738
                                length: 15
                            children: []
                            pos: 52725
                            length: 28
                        children: []
                        pos: 52699
                        length: 54
                    children: []
                    pos: 52698
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .ARCHIVE_TOO_BIG_MESSAGE);
                    children: []
                    pos: 52769
                    length: 127
                  pos: 52755
                  length: 151
                pos: 52695
                length: 211
              - type: local_variable_declaration
                fields:
                  text: |-
                    final byte[] num = ZipShort.getBytes(Math.min(numberOfEntries,
                                                                    ZIP64_MAGIC_SHORT));
                children: []
                pos: 52916
                length: 131
              - type: expression_statement
                fields:
                  text: writeCounted(num);
                children: []
                pos: 53056
                length: 18
              - type: expression_statement
                fields:
                  text: writeCounted(num);
                children: []
                pos: 53083
                length: 18
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(Math.min(cdLength, ZIP64_MAGIC)));
                children: []
                pos: 53148
                length: 64
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(Math.min(cdOffset, ZIP64_MAGIC)));
                children: []
                pos: 53221
                length: 64
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer data = this.zipEncoding.encode(comment);
                children: []
                pos: 53323
                length: 57
              - type: local_variable_declaration
                fields:
                  text: final int dataLen = data.limit() - data.position();
                children: []
                pos: 53389
                length: 51
              - type: expression_statement
                fields:
                  text: writeCounted(ZipShort.getBytes(dataLen));
                children: []
                pos: 53449
                length: 41
              - type: expression_statement
                fields:
                  text: streamCompressor.writeCounted(data.array(), data.arrayOffset(),
                    dataLen);
                children: []
                pos: 53499
                length: 73
              pos: 52244
              length: 1334
          children: []
          pos: 52183
          length: 1395
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeZip64CentralDirectory
              children: []
              pos: 53788
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 53773
              length: 2191
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: zip64Mode
                            children: []
                            pos: 53850
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Zip64Mode.Never
                            children: []
                            pos: 53863
                            length: 15
                        children: []
                        pos: 53850
                        length: 28
                    children: []
                    pos: 53849
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 53894
                    length: 7
                  pos: 53880
                  length: 31
                pos: 53846
                length: 65
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!hasUsedZip64"
                            children: []
                            pos: 53925
                            length: 13
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: or
                                    fields:
                                      left:
                                        type: greater_or_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: cdOffset
                                            children: []
                                            pos: 53955
                                            length: 8
                                          right:
                                            type: identifier
                                            fields:
                                              text: ZIP64_MAGIC
                                            children: []
                                            pos: 53967
                                            length: 11
                                        children: []
                                        pos: 53955
                                        length: 23
                                      right:
                                        type: greater_or_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: cdLength
                                            children: []
                                            pos: 53982
                                            length: 8
                                          right:
                                            type: identifier
                                            fields:
                                              text: ZIP64_MAGIC
                                            children: []
                                            pos: 53994
                                            length: 11
                                        children: []
                                        pos: 53982
                                        length: 23
                                    children: []
                                    pos: 53955
                                    length: 50
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entries.size()
                                        children: []
                                        pos: 54025
                                        length: 14
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC_SHORT
                                        children: []
                                        pos: 54043
                                        length: 17
                                    children: []
                                    pos: 54025
                                    length: 35
                                children: []
                                pos: 53955
                                length: 105
                            children: []
                            pos: 53954
                            length: 107
                        children: []
                        pos: 53925
                        length: 136
                    children: []
                    pos: 53924
                    length: 138
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: hasUsedZip64 = true;
                    children: []
                    pos: 54112
                    length: 20
                  pos: 54063
                  length: 79
                pos: 53921
                length: 221
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasUsedZip64"
                        children: []
                        pos: 54156
                        length: 13
                    children: []
                    pos: 54155
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 54185
                    length: 7
                  pos: 54171
                  length: 31
                pos: 54152
                length: 50
              - type: local_variable_declaration
                fields:
                  text: final long offset = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 54212
                length: 60
              - type: expression_statement
                fields:
                  text: writeOut(ZIP64_EOCD_SIG);
                children: []
                pos: 54282
                length: 25
              - type: expression_statement
                fields:
                  text: |-
                    writeOut(ZipEightByteInteger
                                     .getBytes(SHORT   /* version made by */
                                               + SHORT /* version needed to extract */
                                               + WORD  /* disk number */
                                               + WORD  /* disk with central directory */
                                               + DWORD /* number of entries in CD on this disk */
                                               + DWORD /* total number of entries */
                                               + DWORD /* size of CD */
                                               + (long) DWORD /* offset of CD */
                                               ));
                children: []
                pos: 54430
                length: 561
              - type: expression_statement
                fields:
                  text: writeOut(ZipShort.getBytes(ZIP64_MIN_VERSION));
                children: []
                pos: 55058
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(ZipShort.getBytes(ZIP64_MIN_VERSION));
                children: []
                pos: 55114
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55218
                length: 16
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55243
                length: 16
              - type: local_variable_declaration
                fields:
                  text: final byte[] num = ZipEightByteInteger.getBytes(entries.size());
                children: []
                pos: 55298
                length: 64
              - type: expression_statement
                fields:
                  text: writeOut(num);
                children: []
                pos: 55371
                length: 14
              - type: expression_statement
                fields:
                  text: writeOut(num);
                children: []
                pos: 55394
                length: 14
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(cdLength));
                children: []
                pos: 55455
                length: 49
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(cdOffset));
                children: []
                pos: 55513
                length: 49
              - type: expression_statement
                fields:
                  text: writeOut(ZIP64_EOCD_LOC_SIG);
                children: []
                pos: 55690
                length: 29
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55782
                length: 16
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(offset));
                children: []
                pos: 55855
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(ONE);
                children: []
                pos: 55944
                length: 14
              pos: 53836
              length: 2128
          children: []
          pos: 53773
          length: 2191
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeOut
              children: []
              pos: 56138
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 56147
                length: 17
              pos: 56117
              length: 132
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeOut(data, 0, data.length);
                children: []
                pos: 56195
                length: 48
              pos: 56185
              length: 64
          children: []
          pos: 56117
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeOut
              children: []
              pos: 56528
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 56537
                length: 17
              pos: 56507
              length: 180
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeOut(data, offset, length);
                children: []
                pos: 56633
                length: 48
              pos: 56623
              length: 64
          children: []
          pos: 56507
          length: 180
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGeneralPurposeBits
              children: []
              pos: 56720
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean utfFallback
                children: []
                pos: 56742
                length: 25
              pos: 56694
              length: 327
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final GeneralPurposeBit b = new GeneralPurposeBit();
                children: []
                pos: 56807
                length: 52
              - type: expression_statement
                fields:
                  text: b.useUTF8ForNames(useUTF8Flag || utfFallback);
                children: []
                pos: 56868
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: usesDataDescriptor
                        children: []
                        pos: 56927
                        length: 18
                    children: []
                    pos: 56926
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: b.useDataDescriptor(true);
                    children: []
                    pos: 56961
                    length: 26
                  pos: 56947
                  length: 50
                pos: 56923
                length: 74
              - type: return_statement
                fields:
                  text: return b;
                children: []
                pos: 57006
                length: 9
              pos: 56797
              length: 224
          children: []
          pos: 56694
          length: 327
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: versionNeededToExtract
              children: []
              pos: 57039
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int zipMethod
                children: []
                pos: 57062
                length: 19
              pos: 57027
              length: 335
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: zip64
                        children: []
                        pos: 57152
                        length: 5
                    children: []
                    pos: 57151
                    length: 7
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return ZIP64_MIN_VERSION;
                    children: []
                    pos: 57173
                    length: 25
                  pos: 57159
                  length: 49
                pos: 57148
                length: 60
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: usedDataDescriptor
                        children: []
                        pos: 57221
                        length: 18
                    children: []
                    pos: 57220
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return DATA_DESCRIPTOR_MIN_VERSION;
                    children: []
                    pos: 57255
                    length: 35
                  pos: 57241
                  length: 59
                pos: 57217
                length: 83
              - type: return_statement
                fields:
                  text: return versionNeededToExtractMethod(zipMethod);
                children: []
                pos: 57309
                length: 47
              pos: 57138
              length: 224
          children: []
          pos: 57027
          length: 335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: usesDataDescriptor
              children: []
              pos: 57384
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int zipMethod
                children: []
                pos: 57403
                length: 19
              pos: 57368
              length: 147
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return !phased && zipMethod == DEFLATED && channel == null;
                children: []
                pos: 57450
                length: 59
              pos: 57440
              length: 75
          children: []
          pos: 57368
          length: 147
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: versionNeededToExtractMethod
              children: []
              pos: 57533
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int zipMethod
                children: []
                pos: 57562
                length: 13
              pos: 57521
              length: 141
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return zipMethod == DEFLATED ? DEFLATE_MIN_VERSION : INITIAL_VERSION;'
                children: []
                pos: 57587
                length: 69
              pos: 57577
              length: 85
          children: []
          pos: 57521
          length: 141
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createArchiveEntry
              children: []
              pos: 58139
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final File inputFile
                children: []
                pos: 58158
                length: 20
              pos: 58105
              length: 296
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 58245
                        length: 8
                    children: []
                    pos: 58244
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 58269
                    length: 58
                  pos: 58255
                  length: 82
                pos: 58241
                length: 96
              - type: return_statement
                fields:
                  text: return new ZipArchiveEntry(inputFile, entryName);
                children: []
                pos: 58346
                length: 49
              pos: 58231
              length: 170
          children: []
          pos: 58105
          length: 296
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getZip64Extra
              children: []
              pos: 58614
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 58628
                length: 24
              pos: 58563
              length: 906
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 58668
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 58677
                            length: 4
                        children: []
                        pos: 58668
                        length: 13
                    children: []
                    pos: 58667
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.causedUseOfZip64 = !hasUsedZip64;
                    children: []
                    pos: 58697
                    length: 39
                  pos: 58683
                  length: 63
                pos: 58664
                length: 82
              - type: expression_statement
                fields:
                  text: hasUsedZip64 = true;
                children: []
                pos: 58755
                length: 20
              - type: local_variable_declaration
                fields:
                  text: |-
                    Zip64ExtendedInformationExtraField z64 =
                                (Zip64ExtendedInformationExtraField)
                                ze.getExtraField(Zip64ExtendedInformationExtraField
                                                 .HEADER_ID);
                children: []
                pos: 58784
                length: 195
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: z64
                            children: []
                            pos: 58992
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 58999
                            length: 4
                        children: []
                        pos: 58992
                        length: 11
                    children: []
                    pos: 58991
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: z64 = new Zip64ExtendedInformationExtraField();
                    children: []
                    pos: 59269
                    length: 47
                  pos: 59005
                  length: 321
                pos: 58988
                length: 338
              - type: expression_statement
                fields:
                  text: ze.addAsFirstExtraField(z64);
                children: []
                pos: 59413
                length: 29
              - type: return_statement
                fields:
                  text: return z64;
                children: []
                pos: 59452
                length: 11
              pos: 58654
              length: 815
          children: []
          pos: 58563
          length: 906
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasZip64Extra
              children: []
              pos: 59611
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 59625
                length: 24
              pos: 59595
              length: 195
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return ze.getExtraField(Zip64ExtendedInformationExtraField
                                                    .HEADER_ID)
                                != null;
                children: []
                pos: 59661
                length: 123
              pos: 59651
              length: 139
          children: []
          pos: 59595
          length: 195
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEffectiveZip64Mode
              children: []
              pos: 60029
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60051
                length: 24
              pos: 60011
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: or
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: zip64Mode
                                        children: []
                                        pos: 60091
                                        length: 9
                                      right:
                                        type: field_access
                                        fields:
                                          text: Zip64Mode.AsNeeded
                                        children: []
                                        pos: 60104
                                        length: 18
                                    children: []
                                    pos: 60091
                                    length: 31
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: channel
                                        children: []
                                        pos: 60138
                                        length: 7
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 60149
                                        length: 4
                                    children: []
                                    pos: 60138
                                    length: 15
                                children: []
                                pos: 60091
                                length: 62
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getMethod()
                                    children: []
                                    pos: 60169
                                    length: 14
                                  right:
                                    type: identifier
                                    fields:
                                      text: DEFLATED
                                    children: []
                                    pos: 60187
                                    length: 8
                                children: []
                                pos: 60169
                                length: 26
                            children: []
                            pos: 60091
                            length: 104
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: ze.getSize()
                                children: []
                                pos: 60211
                                length: 12
                              right:
                                type: field_access
                                fields:
                                  text: ArchiveEntry.SIZE_UNKNOWN
                                children: []
                                pos: 60227
                                length: 25
                            children: []
                            pos: 60211
                            length: 41
                        children: []
                        pos: 60091
                        length: 161
                    children: []
                    pos: 60090
                    length: 163
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return zip64Mode;
                    children: []
                    pos: 60268
                    length: 17
                  pos: 60254
                  length: 41
                pos: 60087
                length: 208
              - type: return_statement
                fields:
                  text: return Zip64Mode.Never;
                children: []
                pos: 60304
                length: 23
              pos: 60077
              length: 256
          children: []
          pos: 60011
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEntryEncoding
              children: []
              pos: 60359
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60376
                length: 24
              pos: 60339
              length: 250
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 60412
                length: 62
              - type: return_statement
                fields:
                  text: |-
                    return !encodable && fallbackToUTF8
                                ? ZipEncodingHelper.UTF8_ZIP_ENCODING : zipEncoding;
                children: []
                pos: 60483
                length: 100
              pos: 60402
              length: 187
          children: []
          pos: 60339
          length: 250
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getName
              children: []
              pos: 60614
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60622
                length: 24
              pos: 60595
              length: 137
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return getEntryEncoding(ze).encode(ze.getName());
                children: []
                pos: 60677
                length: 49
              pos: 60667
              length: 65
          children: []
          pos: 60595
          length: 137
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: destroy
              children: []
              pos: 61025
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 61020
              length: 173
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: channel
                            children: []
                            pos: 61068
                            length: 7
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 61079
                            length: 4
                        children: []
                        pos: 61068
                        length: 15
                    children: []
                    pos: 61067
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: channel.close();
                    children: []
                    pos: 61099
                    length: 16
                  pos: 61085
                  length: 40
                pos: 61064
                length: 61
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 61138
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 61145
                            length: 4
                        children: []
                        pos: 61138
                        length: 11
                    children: []
                    pos: 61137
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.close();
                    children: []
                    pos: 61165
                    length: 12
                  pos: 61151
                  length: 36
                pos: 61134
                length: 53
              pos: 61054
              length: 139
          children: []
          pos: 61020
          length: 173
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: UnicodeExtraFieldPolicy
              children: []
              pos: 61333
              length: 23
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: public static final UnicodeExtraFieldPolicy ALWAYS = new UnicodeExtraFieldPolicy("always");
                children: []
                pos: 61438
                length: 91
              - type: field_declaration
                fields:
                  text: public static final UnicodeExtraFieldPolicy NEVER = new UnicodeExtraFieldPolicy("never");
                children: []
                pos: 61608
                length: 89
              - type: field_declaration
                fields:
                  text: |-
                    public static final UnicodeExtraFieldPolicy NOT_ENCODEABLE =
                                new UnicodeExtraFieldPolicy("not encodeable");
                children: []
                pos: 61847
                length: 119
              - type: field_declaration
                fields:
                  text: private final String name;
                children: []
                pos: 61976
                length: 26
              - type: constructor_declaration
                fields:
                  text: |-
                    private UnicodeExtraFieldPolicy(final String n) {
                                name = n;
                            }
                children: []
                pos: 62011
                length: 81
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: toString
                    children: []
                    pos: 62133
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 62101
                    length: 79
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return name;
                      children: []
                      pos: 62158
                      length: 12
                    pos: 62144
                    length: 36
                children: []
                pos: 62101
                length: 79
              pos: 61307
              length: 879
          children: []
          pos: 61307
          length: 879
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: CurrentEntry
              children: []
              pos: 62329
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private CurrentEntry(final ZipArchiveEntry entry) {
                                this.entry = entry;
                            }
                children: []
                pos: 62352
                length: 93
              - type: field_declaration
                fields:
                  text: private final ZipArchiveEntry entry;
                children: []
                pos: 62508
                length: 36
              - type: field_declaration
                fields:
                  text: private long localDataStart = 0;
                children: []
                pos: 62685
                length: 32
              - type: field_declaration
                fields:
                  text: private long dataStart = 0;
                children: []
                pos: 62788
                length: 27
              - type: field_declaration
                fields:
                  text: private long bytesRead = 0;
                children: []
                pos: 62972
                length: 27
              - type: field_declaration
                fields:
                  text: private boolean causedUseOfZip64 = false;
                children: []
                pos: 63105
                length: 41
              - type: field_declaration
                fields:
                  text: private boolean hasWritten;
                children: []
                pos: 63469
                length: 27
              pos: 62302
              length: 1200
          children: []
          pos: 62302
          length: 1200
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: EntryMetaData
              children: []
              pos: 63535
              length: 13
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final long offset;
                children: []
                pos: 63559
                length: 26
              - type: field_declaration
                fields:
                  text: private final boolean usesDataDescriptor;
                children: []
                pos: 63594
                length: 41
              - type: constructor_declaration
                fields:
                  text: |-
                    private EntryMetaData(long offset, boolean usesDataDescriptor) {
                                this.offset = offset;
                                this.usesDataDescriptor = usesDataDescriptor;
                            }
                children: []
                pos: 63644
                length: 166
              pos: 63508
              length: 308
          children: []
          pos: 63508
          length: 308
        pos: 3840
        length: 59978
    children: []
    pos: 3840
    length: 59978
  pos: 0
  length: 63819
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ZipArchiveOutputStream
        children: []
        pos: 3853
        length: 22
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: static final int BUFFER_SIZE = 512;
          children: []
          pos: 3911
          length: 35
        - type: field_declaration
          fields:
            text: private static final int LFH_SIG_OFFSET = 0;
          children: []
          pos: 3951
          length: 44
        - type: field_declaration
          fields:
            text: private static final int LFH_VERSION_NEEDED_OFFSET = 4;
          children: []
          pos: 4000
          length: 55
        - type: field_declaration
          fields:
            text: private static final int LFH_GPB_OFFSET = 6;
          children: []
          pos: 4060
          length: 44
        - type: field_declaration
          fields:
            text: private static final int LFH_METHOD_OFFSET = 8;
          children: []
          pos: 4109
          length: 47
        - type: field_declaration
          fields:
            text: private static final int LFH_TIME_OFFSET = 10;
          children: []
          pos: 4161
          length: 46
        - type: field_declaration
          fields:
            text: private static final int LFH_CRC_OFFSET = 14;
          children: []
          pos: 4212
          length: 45
        - type: field_declaration
          fields:
            text: private static final int LFH_COMPRESSED_SIZE_OFFSET = 18;
          children: []
          pos: 4262
          length: 57
        - type: field_declaration
          fields:
            text: private static final int LFH_ORIGINAL_SIZE_OFFSET = 22;
          children: []
          pos: 4324
          length: 55
        - type: field_declaration
          fields:
            text: private static final int LFH_FILENAME_LENGTH_OFFSET = 26;
          children: []
          pos: 4384
          length: 57
        - type: field_declaration
          fields:
            text: private static final int LFH_EXTRA_LENGTH_OFFSET = 28;
          children: []
          pos: 4446
          length: 54
        - type: field_declaration
          fields:
            text: private static final int LFH_FILENAME_OFFSET = 30;
          children: []
          pos: 4505
          length: 50
        - type: field_declaration
          fields:
            text: private static final int CFH_SIG_OFFSET = 0;
          children: []
          pos: 4560
          length: 44
        - type: field_declaration
          fields:
            text: private static final int CFH_VERSION_MADE_BY_OFFSET = 4;
          children: []
          pos: 4609
          length: 56
        - type: field_declaration
          fields:
            text: private static final int CFH_VERSION_NEEDED_OFFSET = 6;
          children: []
          pos: 4670
          length: 55
        - type: field_declaration
          fields:
            text: private static final int CFH_GPB_OFFSET = 8;
          children: []
          pos: 4730
          length: 44
        - type: field_declaration
          fields:
            text: private static final int CFH_METHOD_OFFSET = 10;
          children: []
          pos: 4779
          length: 48
        - type: field_declaration
          fields:
            text: private static final int CFH_TIME_OFFSET = 12;
          children: []
          pos: 4832
          length: 46
        - type: field_declaration
          fields:
            text: private static final int CFH_CRC_OFFSET = 16;
          children: []
          pos: 4883
          length: 45
        - type: field_declaration
          fields:
            text: private static final int CFH_COMPRESSED_SIZE_OFFSET = 20;
          children: []
          pos: 4933
          length: 57
        - type: field_declaration
          fields:
            text: private static final int CFH_ORIGINAL_SIZE_OFFSET = 24;
          children: []
          pos: 4995
          length: 55
        - type: field_declaration
          fields:
            text: private static final int CFH_FILENAME_LENGTH_OFFSET = 28;
          children: []
          pos: 5055
          length: 57
        - type: field_declaration
          fields:
            text: private static final int CFH_EXTRA_LENGTH_OFFSET = 30;
          children: []
          pos: 5117
          length: 54
        - type: field_declaration
          fields:
            text: private static final int CFH_COMMENT_LENGTH_OFFSET = 32;
          children: []
          pos: 5176
          length: 56
        - type: field_declaration
          fields:
            text: private static final int CFH_DISK_NUMBER_OFFSET = 34;
          children: []
          pos: 5237
          length: 53
        - type: field_declaration
          fields:
            text: private static final int CFH_INTERNAL_ATTRIBUTES_OFFSET = 36;
          children: []
          pos: 5295
          length: 61
        - type: field_declaration
          fields:
            text: private static final int CFH_EXTERNAL_ATTRIBUTES_OFFSET = 38;
          children: []
          pos: 5361
          length: 61
        - type: field_declaration
          fields:
            text: private static final int CFH_LFH_OFFSET = 42;
          children: []
          pos: 5427
          length: 45
        - type: field_declaration
          fields:
            text: private static final int CFH_FILENAME_OFFSET = 46;
          children: []
          pos: 5477
          length: 50
        - type: field_declaration
          fields:
            text: protected boolean finished = false;
          children: []
          pos: 5623
          length: 35
        - type: field_declaration
          fields:
            text: public static final int DEFLATED = java.util.zip.ZipEntry.DEFLATED;
          children: []
          pos: 5728
          length: 67
        - type: field_declaration
          fields:
            text: public static final int DEFAULT_COMPRESSION = Deflater.DEFAULT_COMPRESSION;
          children: []
          pos: 5872
          length: 75
        - type: field_declaration
          fields:
            text: public static final int STORED = java.util.zip.ZipEntry.STORED;
          children: []
          pos: 6015
          length: 63
        - type: field_declaration
          fields:
            text: static final String DEFAULT_ENCODING = ZipEncodingHelper.UTF8;
          children: []
          pos: 6152
          length: 62
        - type: field_declaration
          fields:
            text: |-
              @Deprecated
                  public static final int EFS_FLAG = GeneralPurposeBit.UFT8_NAMES_FLAG;
          children: []
          pos: 6398
          length: 85
        - type: field_declaration
          fields:
            text: private static final byte[] EMPTY = new byte[0];
          children: []
          pos: 6489
          length: 48
        - type: field_declaration
          fields:
            text: private CurrentEntry entry;
          children: []
          pos: 6581
          length: 27
        - type: field_declaration
          fields:
            text: private String comment = "";
          children: []
          pos: 6655
          length: 28
        - type: field_declaration
          fields:
            text: private int level = DEFAULT_COMPRESSION;
          children: []
          pos: 6746
          length: 40
        - type: field_declaration
          fields:
            text: private boolean hasCompressionLevelChanged = false;
          children: []
          pos: 6889
          length: 51
        - type: field_declaration
          fields:
            text: private int method = java.util.zip.ZipEntry.DEFLATED;
          children: []
          pos: 7012
          length: 53
        - type: field_declaration
          fields:
            text: |-
              private final List<ZipArchiveEntry> entries =
                      new LinkedList<>();
          children: []
          pos: 7136
          length: 73
        - type: field_declaration
          fields:
            text: private final StreamCompressor streamCompressor;
          children: []
          pos: 7215
          length: 48
        - type: field_declaration
          fields:
            text: private long cdOffset = 0;
          children: []
          pos: 7320
          length: 26
        - type: field_declaration
          fields:
            text: private long cdLength = 0;
          children: []
          pos: 7404
          length: 26
        - type: field_declaration
          fields:
            text: private static final byte[] ZERO = {0, 0};
          children: []
          pos: 7484
          length: 42
        - type: field_declaration
          fields:
            text: private static final byte[] LZERO = {0, 0, 0, 0};
          children: []
          pos: 7579
          length: 49
        - type: field_declaration
          fields:
            text: private static final byte[] ONE = ZipLong.getBytes(1L);
          children: []
          pos: 7634
          length: 55
        - type: field_declaration
          fields:
            text: |-
              private final Map<ZipArchiveEntry, EntryMetaData> metaData =
                      new HashMap<>();
          children: []
          pos: 7763
          length: 85
        - type: field_declaration
          fields:
            text: private String encoding = DEFAULT_ENCODING;
          children: []
          pos: 8166
          length: 43
        - type: field_declaration
          fields:
            text: |-
              private ZipEncoding zipEncoding =
                      ZipEncodingHelper.getZipEncoding(DEFAULT_ENCODING);
          children: []
          pos: 8398
          length: 93
        - type: field_declaration
          fields:
            text: protected final Deflater def;
          children: []
          pos: 8569
          length: 29
        - type: field_declaration
          fields:
            text: private final SeekableByteChannel channel;
          children: []
          pos: 8657
          length: 42
        - type: field_declaration
          fields:
            text: private final OutputStream out;
          children: []
          pos: 8705
          length: 31
        - type: field_declaration
          fields:
            text: private boolean useUTF8Flag = true;
          children: []
          pos: 8853
          length: 35
        - type: field_declaration
          fields:
            text: private boolean fallbackToUTF8 = false;
          children: []
          pos: 8971
          length: 39
        - type: field_declaration
          fields:
            text: private UnicodeExtraFieldPolicy createUnicodeExtraFields = UnicodeExtraFieldPolicy.NEVER;
          children: []
          pos: 9097
          length: 89
        - type: field_declaration
          fields:
            text: private boolean hasUsedZip64 = false;
          children: []
          pos: 9303
          length: 37
        - type: field_declaration
          fields:
            text: private Zip64Mode zip64Mode = Zip64Mode.AsNeeded;
          children: []
          pos: 9346
          length: 49
        - type: field_declaration
          fields:
            text: private final byte[] copyBuffer = new byte[32768];
          children: []
          pos: 9401
          length: 50
        - type: field_declaration
          fields:
            text: private final Calendar calendarInstance = Calendar.getInstance();
          children: []
          pos: 9456
          length: 65
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(final OutputStream out) {
                      this.out = out;
                      this.channel = null;
                      def = new Deflater(level, true);
                      streamCompressor = StreamCompressor.create(out, def);
                  }
          children: []
          pos: 9656
          length: 217
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(final File file) throws IOException {
                      def = new Deflater(level, true);
                      OutputStream o = null;
                      SeekableByteChannel _channel = null;
                      StreamCompressor _streamCompressor = null;
                      try {
                          _channel = Files.newByteChannel(file.toPath(),
                              EnumSet.of(StandardOpenOption.CREATE, StandardOpenOption.WRITE,
                                         StandardOpenOption.READ,
                                         StandardOpenOption.TRUNCATE_EXISTING));
                          // will never get opened properly when an exception is thrown so doesn't need to get closed
                          _streamCompressor = StreamCompressor.create(_channel, def); //NOSONAR
                      } catch (final IOException e) {
                          IOUtils.closeQuietly(_channel);
                          _channel = null;
                          o = new FileOutputStream(file);
                          _streamCompressor = StreamCompressor.create(o, def);
                      }
                      out = o;
                      channel = _channel;
                      streamCompressor = _streamCompressor;
                  }
          children: []
          pos: 10070
          length: 1022
        - type: constructor_declaration
          fields:
            text: |-
              public ZipArchiveOutputStream(SeekableByteChannel channel) throws IOException {
                      this.channel = channel;
                      def = new Deflater(level, true);
                      streamCompressor = StreamCompressor.create(channel, def);
                      out = null;
                  }
          children: []
          pos: 11469
          length: 244
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSeekable
              children: []
              pos: 12098
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 12083
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return channel != null;
                children: []
                pos: 12121
                length: 23
              pos: 12111
              length: 39
          children: []
          pos: 12083
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setEncoding
              children: []
              pos: 12591
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String encoding
                children: []
                pos: 12603
                length: 21
              pos: 12579
              length: 268
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.encoding = encoding;
                children: []
                pos: 12636
                length: 25
              - type: expression_statement
                fields:
                  text: this.zipEncoding = ZipEncodingHelper.getZipEncoding(encoding);
                children: []
                pos: 12670
                length: 62
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: useUTF8Flag
                            children: []
                            pos: 12745
                            length: 11
                          right:
                            type: unary_expression
                            fields:
                              text: "!ZipEncodingHelper.isUTF8(encoding)"
                            children: []
                            pos: 12760
                            length: 35
                        children: []
                        pos: 12745
                        length: 50
                    children: []
                    pos: 12744
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: useUTF8Flag = false;
                    children: []
                    pos: 12811
                    length: 20
                  pos: 12797
                  length: 44
                pos: 12741
                length: 100
              pos: 12626
              length: 221
          children: []
          pos: 12579
          length: 268
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEncoding
              children: []
              pos: 13025
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 13011
              length: 60
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return encoding;
                children: []
                pos: 13049
                length: 16
              pos: 13039
              length: 32
          children: []
          pos: 13011
          length: 60
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setUseLanguageEncodingFlag
              children: []
              pos: 13343
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean b
                children: []
                pos: 13370
                length: 15
              pos: 13331
              length: 126
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: useUTF8Flag = b && ZipEncodingHelper.isUTF8(encoding);
                children: []
                pos: 13397
                length: 54
              pos: 13387
              length: 70
          children: []
          pos: 13331
          length: 126
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setCreateUnicodeExtraFields
              children: []
              pos: 13641
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnicodeExtraFieldPolicy b
                children: []
                pos: 13669
                length: 31
              pos: 13629
              length: 118
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: createUnicodeExtraFields = b;
                children: []
                pos: 13712
                length: 29
              pos: 13702
              length: 45
          children: []
          pos: 13629
          length: 118
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setFallbackToUTF8
              children: []
              pos: 14120
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean b
                children: []
                pos: 14138
                length: 15
              pos: 14108
              length: 82
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: fallbackToUTF8 = b;
                children: []
                pos: 14165
                length: 19
              pos: 14155
              length: 35
          children: []
          pos: 14108
          length: 82
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setUseZip64
              children: []
              pos: 16592
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode mode
                children: []
                pos: 16604
                length: 20
              pos: 16580
              length: 79
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: zip64Mode = mode;
                children: []
                pos: 16636
                length: 17
              pos: 16626
              length: 33
          children: []
          pos: 16580
          length: 79
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: finish
              children: []
              pos: 16927
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 16901
              length: 648
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 16969
                        length: 8
                    children: []
                    pos: 16968
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("This archive has already been finished");
                    children: []
                    pos: 16993
                    length: 64
                  pos: 16979
                  length: 88
                pos: 16965
                length: 102
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 17081
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17090
                            length: 4
                        children: []
                        pos: 17081
                        length: 13
                    children: []
                    pos: 17080
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("This archive contains unclosed
                        entries.");
                    children: []
                    pos: 17110
                    length: 65
                  pos: 17096
                  length: 89
                pos: 17077
                length: 108
              - type: expression_statement
                fields:
                  text: cdOffset = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 17195
                length: 51
              - type: expression_statement
                fields:
                  text: writeCentralDirectoryInChunks();
                children: []
                pos: 17255
                length: 32
              - type: expression_statement
                fields:
                  text: cdLength = streamCompressor.getTotalBytesWritten() - cdOffset;
                children: []
                pos: 17297
                length: 62
              - type: expression_statement
                fields:
                  text: writeZip64CentralDirectory();
                children: []
                pos: 17368
                length: 29
              - type: expression_statement
                fields:
                  text: writeCentralDirectoryEnd();
                children: []
                pos: 17406
                length: 27
              - type: expression_statement
                fields:
                  text: metaData.clear();
                children: []
                pos: 17442
                length: 17
              - type: expression_statement
                fields:
                  text: entries.clear();
                children: []
                pos: 17468
                length: 16
              - type: expression_statement
                fields:
                  text: streamCompressor.close();
                children: []
                pos: 17493
                length: 25
              - type: expression_statement
                fields:
                  text: finished = true;
                children: []
                pos: 17527
                length: 16
              pos: 16955
              length: 594
          children: []
          pos: 16901
          length: 648
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralDirectoryInChunks
              children: []
              pos: 17568
              length: 29
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 17555
              length: 628
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int NUM_PER_WRITE = 1000;
                children: []
                pos: 17629
                length: 31
              - type: local_variable_declaration
                fields:
                  text: final ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(70
                    * NUM_PER_WRITE);
                children: []
                pos: 17669
                length: 98
              - type: local_variable_declaration
                fields:
                  text: int count = 0;
                children: []
                pos: 17776
                length: 14
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (final ZipArchiveEntry ze : entries) {
                                byteArrayOutputStream.write(createCentralFileHeader(ze));
                                if (++count > NUM_PER_WRITE){
                                    writeCounted(byteArrayOutputStream.toByteArray());
                                    byteArrayOutputStream.reset();
                                    count = 0;
                                }
                            }
                children: []
                pos: 17799
                length: 319
              - type: expression_statement
                fields:
                  text: writeCounted(byteArrayOutputStream.toByteArray());
                children: []
                pos: 18127
                length: 50
              pos: 17619
              length: 564
          children: []
          pos: 17555
          length: 628
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeArchiveEntry
              children: []
              pos: 18485
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 18459
              length: 586
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: preClose();
                children: []
                pos: 18534
                length: 11
              - type: expression_statement
                fields:
                  text: flushDeflater();
                children: []
                pos: 18555
                length: 16
              - type: local_variable_declaration
                fields:
                  text: final long bytesWritten = streamCompressor.getTotalBytesWritten()
                    - entry.dataStart;
                children: []
                pos: 18581
                length: 84
              - type: local_variable_declaration
                fields:
                  text: final long realCrc = streamCompressor.getCrc32();
                children: []
                pos: 18674
                length: 49
              - type: expression_statement
                fields:
                  text: entry.bytesRead = streamCompressor.getBytesRead();
                children: []
                pos: 18732
                length: 50
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 18791
                length: 67
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = handleSizesAndCrc(bytesWritten,
                    realCrc, effectiveMode);
                children: []
                pos: 18867
                length: 91
              - type: expression_statement
                fields:
                  text: closeEntry(actuallyNeedsZip64, false);
                children: []
                pos: 18967
                length: 38
              - type: expression_statement
                fields:
                  text: streamCompressor.reset();
                children: []
                pos: 19014
                length: 25
              pos: 18524
              length: 521
          children: []
          pos: 18459
          length: 586
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeCopiedEntry
              children: []
              pos: 19594
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean phased
                children: []
                pos: 19611
                length: 20
              pos: 19581
              length: 348
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: preClose();
                children: []
                pos: 19662
                length: 11
              - type: expression_statement
                fields:
                  text: entry.bytesRead = entry.entry.getSize();
                children: []
                pos: 19682
                length: 40
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 19731
                length: 67
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = checkIfNeedsZip64(effectiveMode);
                children: []
                pos: 19807
                length: 68
              - type: expression_statement
                fields:
                  text: closeEntry(actuallyNeedsZip64, phased);
                children: []
                pos: 19884
                length: 39
              pos: 19652
              length: 277
          children: []
          pos: 19581
          length: 348
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: closeEntry
              children: []
              pos: 19948
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean actuallyNeedsZip64
                children: []
                pos: 19959
                length: 32
              pos: 19935
              length: 312
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!phased"
                            children: []
                            pos: 20048
                            length: 7
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: channel
                                children: []
                                pos: 20059
                                length: 7
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 20070
                                length: 4
                            children: []
                            pos: 20059
                            length: 15
                        children: []
                        pos: 20048
                        length: 26
                    children: []
                    pos: 20047
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: rewriteSizesAndCrc(actuallyNeedsZip64);
                    children: []
                    pos: 20090
                    length: 39
                  pos: 20076
                  length: 63
                pos: 20044
                length: 95
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!phased"
                        children: []
                        pos: 20153
                        length: 7
                    children: []
                    pos: 20152
                    length: 9
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeDataDescriptor(entry.entry);
                    children: []
                    pos: 20176
                    length: 33
                  pos: 20162
                  length: 57
                pos: 20149
                length: 70
              - type: expression_statement
                fields:
                  text: entry = null;
                children: []
                pos: 20228
                length: 13
              pos: 20034
              length: 213
          children: []
          pos: 19935
          length: 312
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: preClose
              children: []
              pos: 20266
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 20253
              length: 335
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 20310
                        length: 8
                    children: []
                    pos: 20309
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 20334
                    length: 58
                  pos: 20320
                  length: 82
                pos: 20306
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 20416
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20425
                            length: 4
                        children: []
                        pos: 20416
                        length: 13
                    children: []
                    pos: 20415
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("No current entry to close");
                    children: []
                    pos: 20445
                    length: 51
                  pos: 20431
                  length: 75
                pos: 20412
                length: 94
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!entry.hasWritten"
                        children: []
                        pos: 20520
                        length: 17
                    children: []
                    pos: 20519
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: write(EMPTY, 0, 0);
                    children: []
                    pos: 20553
                    length: 19
                  pos: 20539
                  length: 43
                pos: 20516
                length: 66
              pos: 20296
              length: 292
          children: []
          pos: 20253
          length: 335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addRawArchiveEntry
              children: []
              pos: 21148
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 21167
                length: 27
              pos: 21136
              length: 878
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final ZipArchiveEntry ae = new ZipArchiveEntry(entry);
                children: []
                pos: 21266
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(ae)
                        children: []
                        pos: 21333
                        length: 17
                    children: []
                    pos: 21332
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ae.removeExtraField(Zip64ExtendedInformationExtraField.HEADER_ID);
                    children: []
                    pos: 21587
                    length: 66
                  pos: 21352
                  length: 311
                pos: 21329
                length: 334
              - type: local_variable_declaration
                fields:
                  text: |-
                    final boolean is2PhaseSource = ae.getCrc() != ZipArchiveEntry.CRC_UNKNOWN
                                    && ae.getSize() != ArchiveEntry.SIZE_UNKNOWN
                                    && ae.getCompressedSize() != ArchiveEntry.SIZE_UNKNOWN;
                children: []
                pos: 21672
                length: 206
              - type: expression_statement
                fields:
                  text: putArchiveEntry(ae, is2PhaseSource);
                children: []
                pos: 21887
                length: 36
              - type: expression_statement
                fields:
                  text: copyFromZipInputStream(rawStream);
                children: []
                pos: 21932
                length: 34
              - type: expression_statement
                fields:
                  text: closeCopiedEntry(is2PhaseSource);
                children: []
                pos: 21975
                length: 33
              pos: 21256
              length: 758
          children: []
          pos: 21136
          length: 878
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flushDeflater
              children: []
              pos: 22122
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 22109
              length: 162
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.entry.getMethod()
                            children: []
                            pos: 22171
                            length: 23
                          right:
                            type: identifier
                            fields:
                              text: DEFLATED
                            children: []
                            pos: 22198
                            length: 8
                        children: []
                        pos: 22171
                        length: 35
                    children: []
                    pos: 22170
                    length: 37
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: streamCompressor.flushDeflater();
                    children: []
                    pos: 22222
                    length: 33
                  pos: 22208
                  length: 57
                pos: 22167
                length: 98
              pos: 22157
              length: 114
          children: []
          pos: 22109
          length: 162
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: handleSizesAndCrc
              children: []
              pos: 22544
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final long bytesWritten
                children: []
                pos: 22562
                length: 23
              pos: 22528
              length: 1657
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.entry.getMethod()
                            children: []
                            pos: 22714
                            length: 23
                          right:
                            type: identifier
                            fields:
                              text: DEFLATED
                            children: []
                            pos: 22741
                            length: 8
                        children: []
                        pos: 22714
                        length: 35
                    children: []
                    pos: 22713
                    length: 37
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.entry.setSize(entry.bytesRead);
                    children: []
                    pos: 22957
                    length: 37
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCompressedSize(bytesWritten);
                    children: []
                    pos: 23007
                    length: 44
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCrc(crc);
                    children: []
                    pos: 23064
                    length: 24
                  pos: 22751
                  length: 348
                pos: 22710
                length: 1419
              - type: return_statement
                fields:
                  text: return checkIfNeedsZip64(effectiveMode);
                children: []
                pos: 24139
                length: 40
              pos: 22700
              length: 1485
          children: []
          pos: 22528
          length: 1657
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkIfNeedsZip64
              children: []
              pos: 24371
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode effectiveMode
                children: []
                pos: 24389
                length: 29
              pos: 24355
              length: 412
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean actuallyNeedsZip64 = isZip64Required(entry.entry,
                    effectiveMode);
                children: []
                pos: 24462
                length: 79
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: actuallyNeedsZip64
                            children: []
                            pos: 24554
                            length: 18
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: effectiveMode
                                children: []
                                pos: 24576
                                length: 13
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 24593
                                length: 15
                            children: []
                            pos: 24576
                            length: 32
                        children: []
                        pos: 24554
                        length: 54
                    children: []
                    pos: 24553
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new Zip64RequiredException(Zip64RequiredException.getEntryTooBigMessage(entry.entry));
                    children: []
                    pos: 24624
                    length: 92
                  pos: 24610
                  length: 116
                pos: 24550
                length: 176
              - type: return_statement
                fields:
                  text: return actuallyNeedsZip64;
                children: []
                pos: 24735
                length: 26
              pos: 24452
              length: 315
          children: []
          pos: 24355
          length: 412
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isZip64Required
              children: []
              pos: 24789
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry1
                children: []
                pos: 24805
                length: 28
              pos: 24773
              length: 179
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return requestedMode == Zip64Mode.Always || isTooLageForZip32(entry1);
                children: []
                pos: 24876
                length: 70
              pos: 24866
              length: 86
          children: []
          pos: 24773
          length: 179
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isTooLageForZip32
              children: []
              pos: 24974
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry zipArchiveEntry
                children: []
                pos: 24992
                length: 37
              pos: 24958
              length: 190
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return zipArchiveEntry.getSize() >= ZIP64_MAGIC || zipArchiveEntry.getCompressedSize()
                    >= ZIP64_MAGIC;
                children: []
                pos: 25040
                length: 102
              pos: 25030
              length: 118
          children: []
          pos: 24958
          length: 190
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: rewriteSizesAndCrc
              children: []
              pos: 25358
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean actuallyNeedsZip64
                children: []
                pos: 25377
                length: 32
              pos: 25345
              length: 2096
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final long save = channel.position();
                children: []
                pos: 25448
                length: 37
              - type: expression_statement
                fields:
                  text: channel.position(entry.localDataStart);
                children: []
                pos: 25495
                length: 39
              - type: expression_statement
                fields:
                  text: writeOut(ZipLong.getBytes(entry.entry.getCrc()));
                children: []
                pos: 25543
                length: 49
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!hasZip64Extra(entry.entry)"
                            children: []
                            pos: 25605
                            length: 27
                          right:
                            type: unary_expression
                            fields:
                              text: "!actuallyNeedsZip64"
                            children: []
                            pos: 25636
                            length: 19
                        children: []
                        pos: 25605
                        length: 50
                    children: []
                    pos: 25604
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipLong.getBytes(entry.entry.getCompressedSize()));
                    children: []
                    pos: 25671
                    length: 60
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipLong.getBytes(entry.entry.getSize()));
                    children: []
                    pos: 25744
                    length: 50
                  pos: 25657
                  length: 147
                pos: 25601
                length: 328
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(entry.entry)
                        children: []
                        pos: 25943
                        length: 26
                    children: []
                    pos: 25942
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final ByteBuffer name = getName(entry.entry);
                    children: []
                    pos: 25985
                    length: 45
                  - type: local_variable_declaration
                    fields:
                      text: final int nameLen = name.limit() - name.position();
                    children: []
                    pos: 26043
                    length: 51
                  - type: expression_statement
                    fields:
                      text: |-
                        channel.position(entry.localDataStart + 3 * WORD + 2 * SHORT
                                                     + nameLen + 2 * SHORT);
                    children: []
                    pos: 26176
                    length: 113
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipEightByteInteger.getBytes(entry.entry.getSize()));
                    children: []
                    pos: 26424
                    length: 62
                  - type: expression_statement
                    fields:
                      text: writeOut(ZipEightByteInteger.getBytes(entry.entry.getCompressedSize()));
                    children: []
                    pos: 26499
                    length: 72
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: "!actuallyNeedsZip64"
                            children: []
                            pos: 26589
                            length: 19
                        children: []
                        pos: 26588
                        length: 21
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: channel.position(entry.localDataStart  - 5 * SHORT);
                        children: []
                        pos: 26719
                        length: 52
                      - type: expression_statement
                        fields:
                          text: writeOut(ZipShort.getBytes(versionNeededToExtract(entry.entry.getMethod(),
                            false, false)));
                        children: []
                        pos: 26788
                        length: 91
                      - type: expression_statement
                        fields:
                          text: |-
                            entry.entry.removeExtraField(Zip64ExtendedInformationExtraField
                                                                         .HEADER_ID);
                        children: []
                        pos: 27009
                        length: 121
                      - type: expression_statement
                        fields:
                          text: entry.entry.setExtra();
                        children: []
                        pos: 27147
                        length: 23
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: field_access
                                fields:
                                  text: entry.causedUseOfZip64
                                children: []
                                pos: 27294
                                length: 22
                            children: []
                            pos: 27293
                            length: 24
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: hasUsedZip64 = false;
                            children: []
                            pos: 27340
                            length: 21
                          pos: 27318
                          length: 61
                        pos: 27290
                        length: 89
                      pos: 26610
                      length: 783
                    pos: 26585
                    length: 808
                  pos: 25971
                  length: 1432
                pos: 25939
                length: 1464
              - type: expression_statement
                fields:
                  text: channel.position(save);
                children: []
                pos: 27412
                length: 23
              pos: 25438
              length: 2003
          children: []
          pos: 25345
          length: 2096
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putArchiveEntry
              children: []
              pos: 27772
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry archiveEntry
                children: []
                pos: 27788
                length: 31
              pos: 27746
              length: 147
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: putArchiveEntry(archiveEntry, false);
                children: []
                pos: 27850
                length: 37
              pos: 27840
              length: 53
          children: []
          pos: 27746
          length: 147
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: putArchiveEntry
              children: []
              pos: 28540
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry archiveEntry
                children: []
                pos: 28556
                length: 31
              pos: 28527
              length: 1873
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 28644
                        length: 8
                    children: []
                    pos: 28643
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 28668
                    length: 58
                  pos: 28654
                  length: 82
                pos: 28640
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 28750
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 28759
                            length: 4
                        children: []
                        pos: 28750
                        length: 13
                    children: []
                    pos: 28749
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: closeArchiveEntry();
                    children: []
                    pos: 28779
                    length: 20
                  pos: 28765
                  length: 44
                pos: 28746
                length: 63
              - type: expression_statement
                fields:
                  text: entry = new CurrentEntry((ZipArchiveEntry) archiveEntry);
                children: []
                pos: 28819
                length: 57
              - type: expression_statement
                fields:
                  text: entries.add(entry.entry);
                children: []
                pos: 28885
                length: 25
              - type: expression_statement
                fields:
                  text: setDefaults(entry.entry);
                children: []
                pos: 28920
                length: 25
              - type: local_variable_declaration
                fields:
                  text: final Zip64Mode effectiveMode = getEffectiveZip64Mode(entry.entry);
                children: []
                pos: 28955
                length: 67
              - type: expression_statement
                fields:
                  text: validateSizeInformation(effectiveMode);
                children: []
                pos: 29031
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: shouldAddZip64Extra(entry.entry, effectiveMode)
                        children: []
                        pos: 29084
                        length: 47
                    children: []
                    pos: 29083
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final Zip64ExtendedInformationExtraField z64 = getZip64Extra(entry.entry);
                    children: []
                    pos: 29148
                    length: 74
                  - type: local_variable_declaration
                    fields:
                      text: ZipEightByteInteger size, compressedSize;
                    children: []
                    pos: 29236
                    length: 41
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: identifier
                            fields:
                              text: phased
                            children: []
                            pos: 29294
                            length: 6
                        children: []
                        pos: 29293
                        length: 8
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: size = new ZipEightByteInteger(entry.entry.getSize());
                        children: []
                        pos: 29363
                        length: 54
                      - type: expression_statement
                        fields:
                          text: compressedSize = new ZipEightByteInteger(entry.entry.getCompressedSize());
                        children: []
                        pos: 29434
                        length: 74
                      pos: 29302
                      length: 220
                    pos: 29290
                    length: 733
                  - type: expression_statement
                    fields:
                      text: z64.setSize(size);
                    children: []
                    pos: 30036
                    length: 18
                  - type: expression_statement
                    fields:
                      text: z64.setCompressedSize(compressedSize);
                    children: []
                    pos: 30067
                    length: 38
                  - type: expression_statement
                    fields:
                      text: entry.entry.setExtra();
                    children: []
                    pos: 30118
                    length: 23
                  pos: 29133
                  length: 1018
                pos: 29080
                length: 1071
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getMethod()
                                children: []
                                pos: 30165
                                length: 23
                              right:
                                type: identifier
                                fields:
                                  text: DEFLATED
                                children: []
                                pos: 30192
                                length: 8
                            children: []
                            pos: 30165
                            length: 35
                          right:
                            type: identifier
                            fields:
                              text: hasCompressionLevelChanged
                            children: []
                            pos: 30204
                            length: 26
                        children: []
                        pos: 30165
                        length: 65
                    children: []
                    pos: 30164
                    length: 67
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: def.setLevel(level);
                    children: []
                    pos: 30246
                    length: 20
                  - type: expression_statement
                    fields:
                      text: hasCompressionLevelChanged = false;
                    children: []
                    pos: 30279
                    length: 35
                  pos: 30232
                  length: 92
                pos: 30161
                length: 163
              - type: expression_statement
                fields:
                  text: writeLocalFileHeader((ZipArchiveEntry) archiveEntry, phased);
                children: []
                pos: 30333
                length: 61
              pos: 28630
              length: 1770
          children: []
          pos: 28527
          length: 1873
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setDefaults
              children: []
              pos: 30524
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 30536
                length: 27
              pos: 30511
              length: 284
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.getMethod()
                            children: []
                            pos: 30579
                            length: 17
                          right:
                            type: unary_expression
                            fields:
                              text: "-1"
                            children: []
                            pos: 30600
                            length: 2
                        children: []
                        pos: 30579
                        length: 23
                    children: []
                    pos: 30578
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.setMethod(method);
                    children: []
                    pos: 30635
                    length: 24
                  pos: 30604
                  length: 65
                pos: 30575
                length: 94
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: entry.getTime()
                            children: []
                            pos: 30683
                            length: 15
                          right:
                            type: unary_expression
                            fields:
                              text: "-1"
                            children: []
                            pos: 30702
                            length: 2
                        children: []
                        pos: 30683
                        length: 21
                    children: []
                    pos: 30682
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.setTime(System.currentTimeMillis());
                    children: []
                    pos: 30737
                    length: 42
                  pos: 30706
                  length: 83
                pos: 30679
                length: 110
              pos: 30565
              length: 230
          children: []
          pos: 30511
          length: 284
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: validateSizeInformation
              children: []
              pos: 31055
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Zip64Mode effectiveMode
                children: []
                pos: 31079
                length: 29
              pos: 31042
              length: 1170
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getMethod()
                                children: []
                                pos: 31216
                                length: 23
                              right:
                                type: identifier
                                fields:
                                  text: STORED
                                children: []
                                pos: 31243
                                length: 6
                            children: []
                            pos: 31216
                            length: 33
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: channel
                                children: []
                                pos: 31253
                                length: 7
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 31264
                                length: 4
                            children: []
                            pos: 31253
                            length: 15
                        children: []
                        pos: 31216
                        length: 52
                    children: []
                    pos: 31215
                    length: 54
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getSize()
                                children: []
                                pos: 31288
                                length: 21
                              right:
                                type: field_access
                                fields:
                                  text: ArchiveEntry.SIZE_UNKNOWN
                                children: []
                                pos: 31313
                                length: 25
                            children: []
                            pos: 31288
                            length: 50
                        children: []
                        pos: 31287
                        length: 52
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: throw_statement
                        fields:
                          text: |-
                            throw new ZipException("uncompressed size is required for"
                                                                   + " STORED method when not writing to a"
                                                                   + " file");
                        children: []
                        pos: 31358
                        length: 189
                      pos: 31340
                      length: 221
                    pos: 31284
                    length: 277
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: entry.entry.getCrc()
                                children: []
                                pos: 31578
                                length: 20
                              right:
                                type: field_access
                                fields:
                                  text: ZipArchiveEntry.CRC_UNKNOWN
                                children: []
                                pos: 31602
                                length: 27
                            children: []
                            pos: 31578
                            length: 51
                        children: []
                        pos: 31577
                        length: 53
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: throw_statement
                        fields:
                          text: |-
                            throw new ZipException("crc checksum is required for STORED"
                                                                   + " method when not writing to a file");
                        children: []
                        pos: 31649
                        length: 140
                      pos: 31631
                      length: 172
                    pos: 31574
                    length: 229
                  - type: expression_statement
                    fields:
                      text: entry.entry.setCompressedSize(entry.entry.getSize());
                    children: []
                    pos: 31816
                    length: 53
                  pos: 31270
                  length: 609
                pos: 31212
                length: 667
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entry.entry.getSize()
                                        children: []
                                        pos: 31894
                                        length: 21
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 31919
                                        length: 11
                                    children: []
                                    pos: 31894
                                    length: 36
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entry.entry.getCompressedSize()
                                        children: []
                                        pos: 31947
                                        length: 31
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 31982
                                        length: 11
                                    children: []
                                    pos: 31947
                                    length: 46
                                children: []
                                pos: 31894
                                length: 99
                            children: []
                            pos: 31893
                            length: 101
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: effectiveMode
                                children: []
                                pos: 32010
                                length: 13
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 32027
                                length: 15
                            children: []
                            pos: 32010
                            length: 32
                        children: []
                        pos: 31893
                        length: 149
                    children: []
                    pos: 31892
                    length: 151
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .getEntryTooBigMessage(entry.entry));
                    children: []
                    pos: 32058
                    length: 138
                  pos: 32044
                  length: 162
                pos: 31889
                length: 317
              pos: 31138
              length: 1074
          children: []
          pos: 31042
          length: 1170
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldAddZip64Extra
              children: []
              pos: 32656
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry entry
                children: []
                pos: 32676
                length: 27
              pos: 32640
              length: 361
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return mode == Zip64Mode.Always
                                || entry.getSize() >= ZIP64_MAGIC
                                || entry.getCompressedSize() >= ZIP64_MAGIC
                                || (entry.getSize() == ArchiveEntry.SIZE_UNKNOWN
                                    && channel != null && mode != Zip64Mode.Never);
                children: []
                pos: 32737
                length: 258
              pos: 32727
              length: 274
          children: []
          pos: 32640
          length: 361
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setComment
              children: []
              pos: 33098
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String comment
                children: []
                pos: 33109
                length: 20
              pos: 33086
              length: 84
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.comment = comment;
                children: []
                pos: 33141
                length: 23
              pos: 33131
              length: 39
          children: []
          pos: 33086
          length: 84
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setLevel
              children: []
              pos: 33460
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int level
                children: []
                pos: 33469
                length: 15
              pos: 33448
              length: 378
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: less_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: level
                                children: []
                                pos: 33500
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Deflater.DEFAULT_COMPRESSION
                                children: []
                                pos: 33508
                                length: 28
                            children: []
                            pos: 33500
                            length: 36
                          right:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: level
                                children: []
                                pos: 33552
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Deflater.BEST_COMPRESSION
                                children: []
                                pos: 33560
                                length: 25
                            children: []
                            pos: 33552
                            length: 33
                        children: []
                        pos: 33500
                        length: 85
                    children: []
                    pos: 33499
                    length: 87
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new IllegalArgumentException("Invalid compression level: "
                                                                       + level);
                    children: []
                    pos: 33601
                    length: 121
                  pos: 33587
                  length: 145
                pos: 33496
                length: 236
              - type: expression_statement
                fields:
                  text: hasCompressionLevelChanged = (this.level != level);
                children: []
                pos: 33741
                length: 51
              - type: expression_statement
                fields:
                  text: this.level = level;
                children: []
                pos: 33801
                length: 19
              pos: 33486
              length: 340
          children: []
          pos: 33448
          length: 378
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMethod
              children: []
              pos: 34038
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int method
                children: []
                pos: 34048
                length: 16
              pos: 34026
              length: 77
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.method = method;
                children: []
                pos: 34076
                length: 21
              pos: 34066
              length: 37
          children: []
          pos: 34026
          length: 77
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: canWriteEntryData
              children: []
              pos: 34370
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ArchiveEntry ae
                children: []
                pos: 34388
                length: 21
              pos: 34341
              length: 406
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: ae instanceof ZipArchiveEntry
                        children: []
                        pos: 34425
                        length: 29
                    children: []
                    pos: 34424
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final ZipArchiveEntry zae = (ZipArchiveEntry) ae;
                    children: []
                    pos: 34470
                    length: 49
                  - type: return_statement
                    fields:
                      text: |-
                        return zae.getMethod() != ZipMethod.IMPLODING.getCode()
                                        && zae.getMethod() != ZipMethod.UNSHRINKING.getCode()
                                        && ZipUtil.canHandleEntryData(zae);
                    children: []
                    pos: 34532
                    length: 177
                  pos: 34456
                  length: 263
                pos: 34421
                length: 298
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 34728
                length: 13
              pos: 34411
              length: 336
          children: []
          pos: 34341
          length: 406
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: write
              children: []
              pos: 35009
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] b
                children: []
                pos: 35015
                length: 14
              pos: 34983
              length: 404
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 35100
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 35109
                            length: 4
                        children: []
                        pos: 35100
                        length: 13
                    children: []
                    pos: 35099
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalStateException("No current entry");
                    children: []
                    pos: 35129
                    length: 52
                  pos: 35115
                  length: 76
                pos: 35096
                length: 95
              - type: expression_statement
                fields:
                  text: ZipUtil.checkRequestedFeatures(entry.entry);
                children: []
                pos: 35200
                length: 44
              - type: local_variable_declaration
                fields:
                  text: final long writtenThisTime = streamCompressor.write(b, offset,
                    length, entry.entry.getMethod());
                children: []
                pos: 35253
                length: 96
              - type: expression_statement
                fields:
                  text: count(writtenThisTime);
                children: []
                pos: 35358
                length: 23
              pos: 35086
              length: 301
          children: []
          pos: 34983
          length: 404
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCounted
              children: []
              pos: 35553
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 35566
                length: 17
              pos: 35540
              length: 116
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeCounted(data);
                children: []
                pos: 35614
                length: 36
              pos: 35604
              length: 52
          children: []
          pos: 35540
          length: 116
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: copyFromZipInputStream
              children: []
              pos: 35675
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final InputStream src
                children: []
                pos: 35698
                length: 21
              pos: 35662
              length: 464
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 35754
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 35763
                            length: 4
                        children: []
                        pos: 35754
                        length: 13
                    children: []
                    pos: 35753
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalStateException("No current entry");
                    children: []
                    pos: 35783
                    length: 52
                  pos: 35769
                  length: 76
                pos: 35750
                length: 95
              - type: expression_statement
                fields:
                  text: ZipUtil.checkRequestedFeatures(entry.entry);
                children: []
                pos: 35854
                length: 44
              - type: expression_statement
                fields:
                  text: entry.hasWritten = true;
                children: []
                pos: 35907
                length: 24
              - type: local_variable_declaration
                fields:
                  text: int length;
                children: []
                pos: 35940
                length: 11
              - type: while_statement
                fields:
                  text: |-
                    while ((length = src.read(copyBuffer)) >= 0 )
                            {
                                streamCompressor.writeCounted(copyBuffer, 0, length);
                                count( length );
                            }
                children: []
                pos: 35960
                length: 160
              pos: 35740
              length: 386
          children: []
          pos: 35662
          length: 464
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: close
              children: []
              pos: 36535
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 36509
              length: 136
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!finished"
                        children: []
                        pos: 36576
                        length: 9
                    children: []
                    pos: 36575
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: finish();
                    children: []
                    pos: 36601
                    length: 9
                  pos: 36587
                  length: 33
                pos: 36572
                length: 48
              - type: expression_statement
                fields:
                  text: destroy();
                children: []
                pos: 36629
                length: 10
              pos: 36562
              length: 83
          children: []
          pos: 36509
          length: 136
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flush
              children: []
              pos: 36864
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 36838
              length: 122
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 36905
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 36912
                            length: 4
                        children: []
                        pos: 36905
                        length: 11
                    children: []
                    pos: 36904
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.flush();
                    children: []
                    pos: 36932
                    length: 12
                  pos: 36918
                  length: 36
                pos: 36901
                length: 53
              pos: 36891
              length: 69
          children: []
          pos: 36838
          length: 122
        - type: field_declaration
          fields:
            text: static final byte[] LFH_SIG = ZipLong.LFH_SIG.getBytes();
          children: []
          pos: 37122
          length: 57
        - type: field_declaration
          fields:
            text: static final byte[] DD_SIG = ZipLong.DD_SIG.getBytes();
          children: []
          pos: 37243
          length: 55
        - type: field_declaration
          fields:
            text: static final byte[] CFH_SIG = ZipLong.CFH_SIG.getBytes();
          children: []
          pos: 37366
          length: 57
        - type: field_declaration
          fields:
            text: static final byte[] EOCD_SIG = ZipLong.getBytes(0X06054B50L);
          children: []
          pos: 37490
          length: 61
        - type: field_declaration
          fields:
            text: static final byte[] ZIP64_EOCD_SIG = ZipLong.getBytes(0X06064B50L);
          children: []
          pos: 37624
          length: 67
        - type: field_declaration
          fields:
            text: static final byte[] ZIP64_EOCD_LOC_SIG = ZipLong.getBytes(0X07064B50L);
          children: []
          pos: 37772
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: deflate
              children: []
              pos: 37998
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 37977
              length: 93
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.deflate();
                children: []
                pos: 38037
                length: 27
              pos: 38027
              length: 43
          children: []
          pos: 37977
          length: 93
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeLocalFileHeader
              children: []
              pos: 38221
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 38242
                length: 24
              pos: 38206
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: writeLocalFileHeader(ze, false);
                children: []
                pos: 38297
                length: 32
              pos: 38287
              length: 48
          children: []
          pos: 38206
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeLocalFileHeader
              children: []
              pos: 38354
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 38375
                length: 24
              pos: 38341
              length: 833
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 38452
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer name = getName(ze);
                children: []
                pos: 38523
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: createUnicodeExtraFields
                            children: []
                            pos: 38573
                            length: 24
                          right:
                            type: field_access
                            fields:
                              text: UnicodeExtraFieldPolicy.NEVER
                            children: []
                            pos: 38601
                            length: 29
                        children: []
                        pos: 38573
                        length: 57
                    children: []
                    pos: 38572
                    length: 59
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: addUnicodeExtraFields(ze, encodable, name);
                    children: []
                    pos: 38646
                    length: 43
                  pos: 38632
                  length: 67
                pos: 38569
                length: 130
              - type: local_variable_declaration
                fields:
                  text: final long localHeaderStart = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 38709
                length: 70
              - type: local_variable_declaration
                fields:
                  text: final byte[] localHeader = createLocalFileHeader(ze, name,
                    encodable, phased, localHeaderStart);
                children: []
                pos: 38788
                length: 96
              - type: expression_statement
                fields:
                  text: metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod())));
                children: []
                pos: 38893
                length: 90
              - type: expression_statement
                fields:
                  text: entry.localDataStart = localHeaderStart + LFH_CRC_OFFSET;
                children: []
                pos: 38992
                length: 57
              - type: expression_statement
                fields:
                  text: writeCounted(localHeader);
                children: []
                pos: 39075
                length: 26
              - type: expression_statement
                fields:
                  text: entry.dataStart = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 39110
                length: 58
              pos: 38442
              length: 732
          children: []
          pos: 38341
          length: 833
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createLocalFileHeader
              children: []
              pos: 39196
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 39218
                length: 24
              pos: 39181
              length: 3978
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: |-
                    ResourceAlignmentExtraField oldAlignmentEx =
                                (ResourceAlignmentExtraField) ze.getExtraField(ResourceAlignmentExtraField.ID);
                children: []
                pos: 39404
                length: 136
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: oldAlignmentEx
                            children: []
                            pos: 39553
                            length: 14
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 39571
                            length: 4
                        children: []
                        pos: 39553
                        length: 22
                    children: []
                    pos: 39552
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ze.removeExtraField(ResourceAlignmentExtraField.ID);
                    children: []
                    pos: 39591
                    length: 52
                  pos: 39577
                  length: 76
                pos: 39549
                length: 104
              - type: local_variable_declaration
                fields:
                  text: int alignment = ze.getAlignment();
                children: []
                pos: 39663
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: less_or_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: alignment
                                children: []
                                pos: 39710
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 39723
                                length: 1
                            children: []
                            pos: 39710
                            length: 14
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: oldAlignmentEx
                                children: []
                                pos: 39728
                                length: 14
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 39746
                                length: 4
                            children: []
                            pos: 39728
                            length: 22
                        children: []
                        pos: 39710
                        length: 40
                    children: []
                    pos: 39709
                    length: 42
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: alignment = oldAlignmentEx.getAlignment();
                    children: []
                    pos: 39766
                    length: 42
                  pos: 39752
                  length: 66
                pos: 39706
                length: 112
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: alignment
                                children: []
                                pos: 39832
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '1'
                                children: []
                                pos: 39844
                                length: 1
                            children: []
                            pos: 39832
                            length: 13
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: oldAlignmentEx
                                        children: []
                                        pos: 39850
                                        length: 14
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 39868
                                        length: 4
                                    children: []
                                    pos: 39850
                                    length: 22
                                  right:
                                    type: unary_expression
                                    fields:
                                      text: "!oldAlignmentEx.allowMethodChange()"
                                    children: []
                                    pos: 39876
                                    length: 35
                                children: []
                                pos: 39850
                                length: 61
                            children: []
                            pos: 39849
                            length: 63
                        children: []
                        pos: 39832
                        length: 80
                    children: []
                    pos: 39831
                    length: 82
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: |-
                        int oldLength = LFH_FILENAME_OFFSET +
                                                    name.limit() - name.position() +
                                                    ze.getLocalFileDataExtra().length;
                    children: []
                    pos: 39928
                    length: 161
                  - type: local_variable_declaration
                    fields:
                      text: |-
                        int padding = (int) ((-archiveOffset - oldLength - ZipExtraField.EXTRAFIELD_HEADER_SIZE
                                                    - ResourceAlignmentExtraField.BASE_SIZE) &
                                                    (alignment - 1));
                    children: []
                    pos: 40103
                    length: 204
                  - type: expression_statement
                    fields:
                      text: |-
                        ze.addExtraField(new ResourceAlignmentExtraField(alignment,
                                                    oldAlignmentEx != null && oldAlignmentEx.allowMethodChange(), padding));
                    children: []
                    pos: 40320
                    length: 160
                  pos: 39914
                  length: 576
                pos: 39828
                length: 662
              - type: local_variable_declaration
                fields:
                  text: final byte[] extra = ze.getLocalFileDataExtra();
                children: []
                pos: 40500
                length: 48
              - type: local_variable_declaration
                fields:
                  text: final int nameLen = name.limit() - name.position();
                children: []
                pos: 40557
                length: 51
              - type: local_variable_declaration
                fields:
                  text: final int len = LFH_FILENAME_OFFSET + nameLen + extra.length;
                children: []
                pos: 40617
                length: 61
              - type: local_variable_declaration
                fields:
                  text: final byte[] buf = new byte[len];
                children: []
                pos: 40687
                length: 33
              - type: expression_statement
                fields:
                  text: System.arraycopy(LFH_SIG,  0, buf, LFH_SIG_OFFSET, WORD);
                children: []
                pos: 40730
                length: 57
              - type: local_variable_declaration
                fields:
                  text: final int zipMethod = ze.getMethod();
                children: []
                pos: 40871
                length: 37
              - type: local_variable_declaration
                fields:
                  text: final boolean dataDescriptor = usesDataDescriptor(zipMethod);
                children: []
                pos: 40917
                length: 61
              - type: expression_statement
                fields:
                  text: putShort(versionNeededToExtract(zipMethod, hasZip64Extra(ze),
                    dataDescriptor), buf, LFH_VERSION_NEEDED_OFFSET);
                children: []
                pos: 40988
                length: 111
              - type: local_variable_declaration
                fields:
                  text: final GeneralPurposeBit generalPurposeBit = getGeneralPurposeBits(!encodable
                    && fallbackToUTF8, dataDescriptor);
                children: []
                pos: 41109
                length: 112
              - type: expression_statement
                fields:
                  text: generalPurposeBit.encode(buf, LFH_GPB_OFFSET);
                children: []
                pos: 41230
                length: 46
              - type: expression_statement
                fields:
                  text: putShort(zipMethod, buf, LFH_METHOD_OFFSET);
                children: []
                pos: 41316
                length: 44
              - type: expression_statement
                fields:
                  text: ZipUtil.toDosTime(calendarInstance, ze.getTime(), buf, LFH_TIME_OFFSET);
                children: []
                pos: 41370
                length: 72
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: phased
                        children: []
                        pos: 41471
                        length: 6
                    children: []
                    pos: 41470
                    length: 8
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: putLong(ze.getCrc(), buf, LFH_CRC_OFFSET);
                    children: []
                    pos: 41492
                    length: 42
                  pos: 41478
                  length: 66
                pos: 41467
                length: 279
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: hasZip64Extra(entry.entry)
                        children: []
                        pos: 41820
                        length: 26
                    children: []
                    pos: 41819
                    length: 28
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, LFH_COMPRESSED_SIZE_OFFSET);
                    children: []
                    pos: 42026
                    length: 61
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, LFH_ORIGINAL_SIZE_OFFSET);
                    children: []
                    pos: 42100
                    length: 59
                  pos: 41847
                  length: 322
                pos: 41816
                length: 906
              - type: expression_statement
                fields:
                  text: putShort(nameLen, buf, LFH_FILENAME_LENGTH_OFFSET);
                children: []
                pos: 42759
                length: 51
              - type: expression_statement
                fields:
                  text: putShort(extra.length, buf, LFH_EXTRA_LENGTH_OFFSET);
                children: []
                pos: 42850
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy( name.array(), name.arrayOffset(), buf, LFH_FILENAME_OFFSET,
                    nameLen);
                children: []
                pos: 42934
                length: 87
              - type: expression_statement
                fields:
                  text: System.arraycopy(extra, 0, buf, LFH_FILENAME_OFFSET + nameLen,
                    extra.length);
                children: []
                pos: 43055
                length: 77
              - type: return_statement
                fields:
                  text: return buf;
                children: []
                pos: 43142
                length: 11
              pos: 39394
              length: 3765
          children: []
          pos: 39181
          length: 3978
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addUnicodeExtraFields
              children: []
              pos: 43346
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 43368
                length: 24
              pos: 43333
              length: 1471
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: createUnicodeExtraFields
                                children: []
                                pos: 43522
                                length: 24
                              right:
                                type: field_access
                                fields:
                                  text: UnicodeExtraFieldPolicy.ALWAYS
                                children: []
                                pos: 43550
                                length: 30
                            children: []
                            pos: 43522
                            length: 58
                          right:
                            type: unary_expression
                            fields:
                              text: "!encodable"
                            children: []
                            pos: 43596
                            length: 10
                        children: []
                        pos: 43522
                        length: 84
                    children: []
                    pos: 43521
                    length: 86
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: |-
                        ze.addExtraField(new UnicodePathExtraField(ze.getName(),
                                                                               name.array(),
                                                                               name.arrayOffset(),
                                                                               name.limit()
                                                                               - name.position()));
                    children: []
                    pos: 43622
                    length: 344
                  pos: 43608
                  length: 368
                pos: 43518
                length: 458
              - type: local_variable_declaration
                fields:
                  text: final String comm = ze.getComment();
                children: []
                pos: 43986
                length: 36
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: comm
                                children: []
                                pos: 44035
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 44043
                                length: 4
                            children: []
                            pos: 44035
                            length: 12
                          right:
                            type: unary_expression
                            fields:
                              text: '!"".equals(comm)'
                            children: []
                            pos: 44051
                            length: 16
                        children: []
                        pos: 44035
                        length: 32
                    children: []
                    pos: 44034
                    length: 34
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final boolean commentEncodable = zipEncoding.canEncode(comm);
                    children: []
                    pos: 44084
                    length: 61
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: createUnicodeExtraFields
                                    children: []
                                    pos: 44163
                                    length: 24
                                  right:
                                    type: field_access
                                    fields:
                                      text: UnicodeExtraFieldPolicy.ALWAYS
                                    children: []
                                    pos: 44191
                                    length: 30
                                children: []
                                pos: 44163
                                length: 58
                              right:
                                type: unary_expression
                                fields:
                                  text: "!commentEncodable"
                                children: []
                                pos: 44241
                                length: 17
                            children: []
                            pos: 44163
                            length: 95
                        children: []
                        pos: 44162
                        length: 97
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: local_variable_declaration
                        fields:
                          text: final ByteBuffer commentB = getEntryEncoding(ze).encode(comm);
                        children: []
                        pos: 44278
                        length: 62
                      - type: expression_statement
                        fields:
                          text: |-
                            ze.addExtraField(new UnicodeCommentExtraField(comm,
                                                                                          commentB.array(),
                                                                                          commentB.arrayOffset(),
                                                                                          commentB.limit()
                                                                                          - commentB.position())
                                                             );
                        children: []
                        pos: 44357
                        length: 417
                      pos: 44260
                      length: 528
                    pos: 44159
                    length: 629
                  pos: 44069
                  length: 729
                pos: 44031
                length: 767
              pos: 43508
              length: 1296
          children: []
          pos: 43333
          length: 1471
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeDataDescriptor
              children: []
              pos: 44954
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 44974
                length: 24
              pos: 44939
              length: 598
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: ze.getMethod()
                                children: []
                                pos: 45033
                                length: 14
                              right:
                                type: identifier
                                fields:
                                  text: DEFLATED
                                children: []
                                pos: 45051
                                length: 8
                            children: []
                            pos: 45033
                            length: 26
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: channel
                                children: []
                                pos: 45063
                                length: 7
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 45074
                                length: 4
                            children: []
                            pos: 45063
                            length: 15
                        children: []
                        pos: 45033
                        length: 45
                    children: []
                    pos: 45032
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 45094
                    length: 7
                  pos: 45080
                  length: 31
                pos: 45029
                length: 82
              - type: expression_statement
                fields:
                  text: writeCounted(DD_SIG);
                children: []
                pos: 45120
                length: 21
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(ze.getCrc()));
                children: []
                pos: 45150
                length: 44
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasZip64Extra(ze)"
                        children: []
                        pos: 45207
                        length: 18
                    children: []
                    pos: 45206
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: writeCounted(ZipLong.getBytes(ze.getCompressedSize()));
                    children: []
                    pos: 45241
                    length: 55
                  - type: expression_statement
                    fields:
                      text: writeCounted(ZipLong.getBytes(ze.getSize()));
                    children: []
                    pos: 45309
                    length: 45
                  pos: 45227
                  length: 137
                pos: 45203
                length: 328
              pos: 45019
              length: 518
          children: []
          pos: 44939
          length: 598
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralFileHeader
              children: []
              pos: 45844
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 45867
                length: 24
              pos: 45829
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final byte[] centralFileHeader = createCentralFileHeader(ze);
                children: []
                pos: 45922
                length: 61
              - type: expression_statement
                fields:
                  text: writeCounted(centralFileHeader);
                children: []
                pos: 45992
                length: 32
              pos: 45912
              length: 118
          children: []
          pos: 45829
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createCentralFileHeader
              children: []
              pos: 46051
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 46075
                length: 24
              pos: 46036
              length: 937
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final EntryMetaData entryMetaData = metaData.get(ze);
                children: []
                pos: 46131
                length: 53
              - type: local_variable_declaration
                fields:
                  text: |-
                    final boolean needsZip64Extra = hasZip64Extra(ze)
                                    || ze.getCompressedSize() >= ZIP64_MAGIC
                                    || ze.getSize() >= ZIP64_MAGIC
                                    || entryMetaData.offset >= ZIP64_MAGIC
                                    || zip64Mode == Zip64Mode.Always;
                children: []
                pos: 46193
                length: 258
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: needsZip64Extra
                            children: []
                            pos: 46465
                            length: 15
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 46484
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 46497
                                length: 15
                            children: []
                            pos: 46484
                            length: 28
                        children: []
                        pos: 46465
                        length: 47
                    children: []
                    pos: 46464
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                            .ARCHIVE_TOO_BIG_MESSAGE);
                    children: []
                    pos: 46694
                    length: 102
                  pos: 46514
                  length: 292
                pos: 46461
                length: 345
              - type: expression_statement
                fields:
                  text: handleZip64Extra(ze, entryMetaData.offset, needsZip64Extra);
                children: []
                pos: 46817
                length: 60
              - type: return_statement
                fields:
                  text: return createCentralFileHeader(ze, getName(ze), entryMetaData,
                    needsZip64Extra);
                children: []
                pos: 46887
                length: 80
              pos: 46120
              length: 853
          children: []
          pos: 46036
          length: 937
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createCentralFileHeader
              children: []
              pos: 47215
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 47239
                length: 24
              pos: 47200
              length: 3559
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final byte[] extra = ze.getCentralDirectoryExtra();
                children: []
                pos: 47469
                length: 51
              - type: local_variable_declaration
                fields:
                  text: String comm = ze.getComment();
                children: []
                pos: 47561
                length: 30
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: comm
                            children: []
                            pos: 47604
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 47612
                            length: 4
                        children: []
                        pos: 47604
                        length: 12
                    children: []
                    pos: 47603
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: comm = "";
                    children: []
                    pos: 47632
                    length: 10
                  pos: 47618
                  length: 34
                pos: 47600
                length: 52
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer commentB = getEntryEncoding(ze).encode(comm);
                children: []
                pos: 47662
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final int nameLen = name.limit() - name.position();
                children: []
                pos: 47733
                length: 51
              - type: local_variable_declaration
                fields:
                  text: final int commentLen = commentB.limit() - commentB.position();
                children: []
                pos: 47793
                length: 62
              - type: local_variable_declaration
                fields:
                  text: final int len= CFH_FILENAME_OFFSET + nameLen + extra.length
                    + commentLen;
                children: []
                pos: 47864
                length: 73
              - type: local_variable_declaration
                fields:
                  text: final byte[] buf = new byte[len];
                children: []
                pos: 47946
                length: 33
              - type: expression_statement
                fields:
                  text: System.arraycopy(CFH_SIG,  0, buf, CFH_SIG_OFFSET, WORD);
                children: []
                pos: 47989
                length: 57
              - type: expression_statement
                fields:
                  text: |-
                    putShort((ze.getPlatform() << 8) | (!hasUsedZip64 ? DATA_DESCRIPTOR_MIN_VERSION : ZIP64_MIN_VERSION),
                                    buf, CFH_VERSION_MADE_BY_OFFSET);
                children: []
                pos: 48121
                length: 151
              - type: local_variable_declaration
                fields:
                  text: final int zipMethod = ze.getMethod();
                children: []
                pos: 48282
                length: 37
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 48328
                length: 62
              - type: expression_statement
                fields:
                  text: |-
                    putShort(versionNeededToExtract(zipMethod, needsZip64Extra, entryMetaData.usesDataDescriptor),
                                buf, CFH_VERSION_NEEDED_OFFSET);
                children: []
                pos: 48399
                length: 139
              - type: expression_statement
                fields:
                  text: getGeneralPurposeBits(!encodable && fallbackToUTF8, entryMetaData.usesDataDescriptor).encode(buf,
                    CFH_GPB_OFFSET);
                children: []
                pos: 48547
                length: 114
              - type: expression_statement
                fields:
                  text: putShort(zipMethod, buf, CFH_METHOD_OFFSET);
                children: []
                pos: 48701
                length: 44
              - type: expression_statement
                fields:
                  text: ZipUtil.toDosTime(calendarInstance, ze.getTime(), buf, CFH_TIME_OFFSET);
                children: []
                pos: 48791
                length: 72
              - type: expression_statement
                fields:
                  text: putLong(ze.getCrc(), buf, CFH_CRC_OFFSET);
                children: []
                pos: 48948
                length: 42
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getCompressedSize()
                                    children: []
                                    pos: 49003
                                    length: 22
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 49029
                                    length: 11
                                children: []
                                pos: 49003
                                length: 37
                              right:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getSize()
                                    children: []
                                    pos: 49060
                                    length: 12
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 49076
                                    length: 11
                                children: []
                                pos: 49060
                                length: 27
                            children: []
                            pos: 49003
                            length: 84
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 49107
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Always
                                children: []
                                pos: 49120
                                length: 16
                            children: []
                            pos: 49107
                            length: 29
                        children: []
                        pos: 49003
                        length: 133
                    children: []
                    pos: 49002
                    length: 135
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, CFH_COMPRESSED_SIZE_OFFSET);
                    children: []
                    pos: 49152
                    length: 61
                  - type: expression_statement
                    fields:
                      text: ZipLong.ZIP64_MAGIC.putLong(buf, CFH_ORIGINAL_SIZE_OFFSET);
                    children: []
                    pos: 49226
                    length: 59
                  pos: 49138
                  length: 157
                pos: 48999
                length: 457
              - type: expression_statement
                fields:
                  text: putShort(nameLen, buf, CFH_FILENAME_LENGTH_OFFSET);
                children: []
                pos: 49466
                length: 51
              - type: expression_statement
                fields:
                  text: putShort(extra.length, buf, CFH_EXTRA_LENGTH_OFFSET);
                children: []
                pos: 49557
                length: 53
              - type: expression_statement
                fields:
                  text: putShort(commentLen, buf, CFH_COMMENT_LENGTH_OFFSET);
                children: []
                pos: 49620
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy(ZERO, 0, buf, CFH_DISK_NUMBER_OFFSET, SHORT);
                children: []
                pos: 49712
                length: 62
              - type: expression_statement
                fields:
                  text: putShort(ze.getInternalAttributes(), buf, CFH_INTERNAL_ATTRIBUTES_OFFSET);
                children: []
                pos: 49820
                length: 74
              - type: expression_statement
                fields:
                  text: putLong(ze.getExternalAttributes(), buf, CFH_EXTERNAL_ATTRIBUTES_OFFSET);
                children: []
                pos: 49940
                length: 73
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: greater_or_equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: entryMetaData.offset
                                children: []
                                pos: 50061
                                length: 20
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC
                                children: []
                                pos: 50085
                                length: 11
                            children: []
                            pos: 50061
                            length: 35
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 50100
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Always
                                children: []
                                pos: 50113
                                length: 16
                            children: []
                            pos: 50100
                            length: 29
                        children: []
                        pos: 50061
                        length: 68
                    children: []
                    pos: 50060
                    length: 70
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: putLong(ZIP64_MAGIC, buf, CFH_LFH_OFFSET);
                    children: []
                    pos: 50145
                    length: 42
                  pos: 50131
                  length: 66
                pos: 50057
                length: 244
              - type: expression_statement
                fields:
                  text: System.arraycopy(name.array(), name.arrayOffset(), buf, CFH_FILENAME_OFFSET,
                    nameLen);
                children: []
                pos: 50332
                length: 86
              - type: local_variable_declaration
                fields:
                  text: final int extraStart = CFH_FILENAME_OFFSET + nameLen;
                children: []
                pos: 50428
                length: 53
              - type: expression_statement
                fields:
                  text: System.arraycopy(extra, 0, buf, extraStart, extra.length);
                children: []
                pos: 50490
                length: 58
              - type: local_variable_declaration
                fields:
                  text: final int commentStart = extraStart + extra.length;
                children: []
                pos: 50558
                length: 51
              - type: expression_statement
                fields:
                  text: System.arraycopy(commentB.array(), commentB.arrayOffset(),
                    buf, commentStart, commentLen);
                children: []
                pos: 50643
                length: 90
              - type: return_statement
                fields:
                  text: return buf;
                children: []
                pos: 50742
                length: 11
              pos: 47459
              length: 3300
          children: []
          pos: 47200
          length: 3559
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: handleZip64Extra
              children: []
              pos: 50905
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 50922
                length: 24
              pos: 50892
              length: 954
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: needsZip64Extra
                        children: []
                        pos: 51049
                        length: 15
                    children: []
                    pos: 51048
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: final Zip64ExtendedInformationExtraField z64 = getZip64Extra(ze);
                    children: []
                    pos: 51080
                    length: 65
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: or
                                fields:
                                  left:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: ze.getCompressedSize()
                                        children: []
                                        pos: 51162
                                        length: 22
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 51188
                                        length: 11
                                    children: []
                                    pos: 51162
                                    length: 37
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: ze.getSize()
                                        children: []
                                        pos: 51219
                                        length: 12
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC
                                        children: []
                                        pos: 51235
                                        length: 11
                                    children: []
                                    pos: 51219
                                    length: 27
                                children: []
                                pos: 51162
                                length: 84
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: zip64Mode
                                    children: []
                                    pos: 51266
                                    length: 9
                                  right:
                                    type: field_access
                                    fields:
                                      text: Zip64Mode.Always
                                    children: []
                                    pos: 51279
                                    length: 16
                                children: []
                                pos: 51266
                                length: 29
                            children: []
                            pos: 51162
                            length: 133
                        children: []
                        pos: 51161
                        length: 135
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: z64.setCompressedSize(new ZipEightByteInteger(ze.getCompressedSize()));
                        children: []
                        pos: 51315
                        length: 71
                      - type: expression_statement
                        fields:
                          text: z64.setSize(new ZipEightByteInteger(ze.getSize()));
                        children: []
                        pos: 51403
                        length: 51
                      pos: 51297
                      length: 171
                    pos: 51158
                    length: 473
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: greater_or_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: lfhOffset
                                    children: []
                                    pos: 51648
                                    length: 9
                                  right:
                                    type: identifier
                                    fields:
                                      text: ZIP64_MAGIC
                                    children: []
                                    pos: 51661
                                    length: 11
                                children: []
                                pos: 51648
                                length: 24
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: zip64Mode
                                    children: []
                                    pos: 51676
                                    length: 9
                                  right:
                                    type: field_access
                                    fields:
                                      text: Zip64Mode.Always
                                    children: []
                                    pos: 51689
                                    length: 16
                                children: []
                                pos: 51676
                                length: 29
                            children: []
                            pos: 51648
                            length: 57
                        children: []
                        pos: 51647
                        length: 59
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: z64.setRelativeHeaderOffset(new ZipEightByteInteger(lfhOffset));
                        children: []
                        pos: 51725
                        length: 64
                      pos: 51707
                      length: 96
                    pos: 51644
                    length: 159
                  - type: expression_statement
                    fields:
                      text: ze.setExtra();
                    children: []
                    pos: 51816
                    length: 14
                  pos: 51066
                  length: 774
                pos: 51045
                length: 795
              pos: 51035
              length: 811
          children: []
          pos: 50892
          length: 954
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeCentralDirectoryEnd
              children: []
              pos: 52185
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 52170
              length: 1395
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: writeCounted(EOCD_SIG);
                children: []
                pos: 52241
                length: 23
              - type: expression_statement
                fields:
                  text: writeCounted(ZERO);
                children: []
                pos: 52298
                length: 19
              - type: expression_statement
                fields:
                  text: writeCounted(ZERO);
                children: []
                pos: 52326
                length: 19
              - type: local_variable_declaration
                fields:
                  text: final int numberOfEntries = entries.size();
                children: []
                pos: 52384
                length: 43
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: numberOfEntries
                                children: []
                                pos: 52440
                                length: 15
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC_SHORT
                                children: []
                                pos: 52458
                                length: 17
                            children: []
                            pos: 52440
                            length: 35
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 52491
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 52504
                                length: 15
                            children: []
                            pos: 52491
                            length: 28
                        children: []
                        pos: 52440
                        length: 79
                    children: []
                    pos: 52439
                    length: 81
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .TOO_MANY_ENTRIES_MESSAGE);
                    children: []
                    pos: 52535
                    length: 128
                  pos: 52521
                  length: 152
                pos: 52436
                length: 237
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cdOffset
                                children: []
                                pos: 52686
                                length: 8
                              right:
                                type: identifier
                                fields:
                                  text: ZIP64_MAGIC
                                children: []
                                pos: 52697
                                length: 11
                            children: []
                            pos: 52686
                            length: 22
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: zip64Mode
                                children: []
                                pos: 52712
                                length: 9
                              right:
                                type: field_access
                                fields:
                                  text: Zip64Mode.Never
                                children: []
                                pos: 52725
                                length: 15
                            children: []
                            pos: 52712
                            length: 28
                        children: []
                        pos: 52686
                        length: 54
                    children: []
                    pos: 52685
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new Zip64RequiredException(Zip64RequiredException
                                                                     .ARCHIVE_TOO_BIG_MESSAGE);
                    children: []
                    pos: 52756
                    length: 127
                  pos: 52742
                  length: 151
                pos: 52682
                length: 211
              - type: local_variable_declaration
                fields:
                  text: |-
                    final byte[] num = ZipShort.getBytes(Math.min(numberOfEntries,
                                                                    ZIP64_MAGIC_SHORT));
                children: []
                pos: 52903
                length: 131
              - type: expression_statement
                fields:
                  text: writeCounted(num);
                children: []
                pos: 53043
                length: 18
              - type: expression_statement
                fields:
                  text: writeCounted(num);
                children: []
                pos: 53070
                length: 18
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(Math.min(cdLength, ZIP64_MAGIC)));
                children: []
                pos: 53135
                length: 64
              - type: expression_statement
                fields:
                  text: writeCounted(ZipLong.getBytes(Math.min(cdOffset, ZIP64_MAGIC)));
                children: []
                pos: 53208
                length: 64
              - type: local_variable_declaration
                fields:
                  text: final ByteBuffer data = this.zipEncoding.encode(comment);
                children: []
                pos: 53310
                length: 57
              - type: local_variable_declaration
                fields:
                  text: final int dataLen = data.limit() - data.position();
                children: []
                pos: 53376
                length: 51
              - type: expression_statement
                fields:
                  text: writeCounted(ZipShort.getBytes(dataLen));
                children: []
                pos: 53436
                length: 41
              - type: expression_statement
                fields:
                  text: streamCompressor.writeCounted(data.array(), data.arrayOffset(),
                    dataLen);
                children: []
                pos: 53486
                length: 73
              pos: 52231
              length: 1334
          children: []
          pos: 52170
          length: 1395
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeZip64CentralDirectory
              children: []
              pos: 53775
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 53760
              length: 2191
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: zip64Mode
                            children: []
                            pos: 53837
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Zip64Mode.Never
                            children: []
                            pos: 53850
                            length: 15
                        children: []
                        pos: 53837
                        length: 28
                    children: []
                    pos: 53836
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 53881
                    length: 7
                  pos: 53867
                  length: 31
                pos: 53833
                length: 65
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!hasUsedZip64"
                            children: []
                            pos: 53912
                            length: 13
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: or
                                    fields:
                                      left:
                                        type: greater_or_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: cdOffset
                                            children: []
                                            pos: 53942
                                            length: 8
                                          right:
                                            type: identifier
                                            fields:
                                              text: ZIP64_MAGIC
                                            children: []
                                            pos: 53954
                                            length: 11
                                        children: []
                                        pos: 53942
                                        length: 23
                                      right:
                                        type: greater_or_equals
                                        fields:
                                          left:
                                            type: identifier
                                            fields:
                                              text: cdLength
                                            children: []
                                            pos: 53969
                                            length: 8
                                          right:
                                            type: identifier
                                            fields:
                                              text: ZIP64_MAGIC
                                            children: []
                                            pos: 53981
                                            length: 11
                                        children: []
                                        pos: 53969
                                        length: 23
                                    children: []
                                    pos: 53942
                                    length: 50
                                  right:
                                    type: greater_or_equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: entries.size()
                                        children: []
                                        pos: 54012
                                        length: 14
                                      right:
                                        type: identifier
                                        fields:
                                          text: ZIP64_MAGIC_SHORT
                                        children: []
                                        pos: 54030
                                        length: 17
                                    children: []
                                    pos: 54012
                                    length: 35
                                children: []
                                pos: 53942
                                length: 105
                            children: []
                            pos: 53941
                            length: 107
                        children: []
                        pos: 53912
                        length: 136
                    children: []
                    pos: 53911
                    length: 138
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: hasUsedZip64 = true;
                    children: []
                    pos: 54099
                    length: 20
                  pos: 54050
                  length: 79
                pos: 53908
                length: 221
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasUsedZip64"
                        children: []
                        pos: 54143
                        length: 13
                    children: []
                    pos: 54142
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 54172
                    length: 7
                  pos: 54158
                  length: 31
                pos: 54139
                length: 50
              - type: local_variable_declaration
                fields:
                  text: final long offset = streamCompressor.getTotalBytesWritten();
                children: []
                pos: 54199
                length: 60
              - type: expression_statement
                fields:
                  text: writeOut(ZIP64_EOCD_SIG);
                children: []
                pos: 54269
                length: 25
              - type: expression_statement
                fields:
                  text: |-
                    writeOut(ZipEightByteInteger
                                     .getBytes(SHORT   /* version made by */
                                               + SHORT /* version needed to extract */
                                               + WORD  /* disk number */
                                               + WORD  /* disk with central directory */
                                               + DWORD /* number of entries in CD on this disk */
                                               + DWORD /* total number of entries */
                                               + DWORD /* size of CD */
                                               + (long) DWORD /* offset of CD */
                                               ));
                children: []
                pos: 54417
                length: 561
              - type: expression_statement
                fields:
                  text: writeOut(ZipShort.getBytes(ZIP64_MIN_VERSION));
                children: []
                pos: 55045
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(ZipShort.getBytes(ZIP64_MIN_VERSION));
                children: []
                pos: 55101
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55205
                length: 16
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55230
                length: 16
              - type: local_variable_declaration
                fields:
                  text: final byte[] num = ZipEightByteInteger.getBytes(entries.size());
                children: []
                pos: 55285
                length: 64
              - type: expression_statement
                fields:
                  text: writeOut(num);
                children: []
                pos: 55358
                length: 14
              - type: expression_statement
                fields:
                  text: writeOut(num);
                children: []
                pos: 55381
                length: 14
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(cdLength));
                children: []
                pos: 55442
                length: 49
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(cdOffset));
                children: []
                pos: 55500
                length: 49
              - type: expression_statement
                fields:
                  text: writeOut(ZIP64_EOCD_LOC_SIG);
                children: []
                pos: 55677
                length: 29
              - type: expression_statement
                fields:
                  text: writeOut(LZERO);
                children: []
                pos: 55769
                length: 16
              - type: expression_statement
                fields:
                  text: writeOut(ZipEightByteInteger.getBytes(offset));
                children: []
                pos: 55842
                length: 47
              - type: expression_statement
                fields:
                  text: writeOut(ONE);
                children: []
                pos: 55931
                length: 14
              pos: 53823
              length: 2128
          children: []
          pos: 53760
          length: 2191
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeOut
              children: []
              pos: 56125
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 56134
                length: 17
              pos: 56104
              length: 132
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeOut(data, 0, data.length);
                children: []
                pos: 56182
                length: 48
              pos: 56172
              length: 64
          children: []
          pos: 56104
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: writeOut
              children: []
              pos: 56515
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final byte[] data
                children: []
                pos: 56524
                length: 17
              pos: 56494
              length: 180
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: streamCompressor.writeOut(data, offset, length);
                children: []
                pos: 56620
                length: 48
              pos: 56610
              length: 64
          children: []
          pos: 56494
          length: 180
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGeneralPurposeBits
              children: []
              pos: 56707
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final boolean utfFallback
                children: []
                pos: 56729
                length: 25
              pos: 56681
              length: 327
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final GeneralPurposeBit b = new GeneralPurposeBit();
                children: []
                pos: 56794
                length: 52
              - type: expression_statement
                fields:
                  text: b.useUTF8ForNames(useUTF8Flag || utfFallback);
                children: []
                pos: 56855
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: usesDataDescriptor
                        children: []
                        pos: 56914
                        length: 18
                    children: []
                    pos: 56913
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: b.useDataDescriptor(true);
                    children: []
                    pos: 56948
                    length: 26
                  pos: 56934
                  length: 50
                pos: 56910
                length: 74
              - type: return_statement
                fields:
                  text: return b;
                children: []
                pos: 56993
                length: 9
              pos: 56784
              length: 224
          children: []
          pos: 56681
          length: 327
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: versionNeededToExtract
              children: []
              pos: 57026
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int zipMethod
                children: []
                pos: 57049
                length: 19
              pos: 57014
              length: 335
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: zip64
                        children: []
                        pos: 57139
                        length: 5
                    children: []
                    pos: 57138
                    length: 7
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return ZIP64_MIN_VERSION;
                    children: []
                    pos: 57160
                    length: 25
                  pos: 57146
                  length: 49
                pos: 57135
                length: 60
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: usedDataDescriptor
                        children: []
                        pos: 57208
                        length: 18
                    children: []
                    pos: 57207
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return DATA_DESCRIPTOR_MIN_VERSION;
                    children: []
                    pos: 57242
                    length: 35
                  pos: 57228
                  length: 59
                pos: 57204
                length: 83
              - type: return_statement
                fields:
                  text: return versionNeededToExtractMethod(zipMethod);
                children: []
                pos: 57296
                length: 47
              pos: 57125
              length: 224
          children: []
          pos: 57014
          length: 335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: usesDataDescriptor
              children: []
              pos: 57371
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final int zipMethod
                children: []
                pos: 57390
                length: 19
              pos: 57355
              length: 120
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return zipMethod == DEFLATED && channel == null;
                children: []
                pos: 57421
                length: 48
              pos: 57411
              length: 64
          children: []
          pos: 57355
          length: 120
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: versionNeededToExtractMethod
              children: []
              pos: 57493
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int zipMethod
                children: []
                pos: 57522
                length: 13
              pos: 57481
              length: 141
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return zipMethod == DEFLATED ? DEFLATE_MIN_VERSION : INITIAL_VERSION;'
                children: []
                pos: 57547
                length: 69
              pos: 57537
              length: 85
          children: []
          pos: 57481
          length: 141
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createArchiveEntry
              children: []
              pos: 58099
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final File inputFile
                children: []
                pos: 58118
                length: 20
              pos: 58065
              length: 296
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: finished
                        children: []
                        pos: 58205
                        length: 8
                    children: []
                    pos: 58204
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IOException("Stream has already been finished");
                    children: []
                    pos: 58229
                    length: 58
                  pos: 58215
                  length: 82
                pos: 58201
                length: 96
              - type: return_statement
                fields:
                  text: return new ZipArchiveEntry(inputFile, entryName);
                children: []
                pos: 58306
                length: 49
              pos: 58191
              length: 170
          children: []
          pos: 58065
          length: 296
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getZip64Extra
              children: []
              pos: 58574
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 58588
                length: 24
              pos: 58523
              length: 906
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: entry
                            children: []
                            pos: 58628
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 58637
                            length: 4
                        children: []
                        pos: 58628
                        length: 13
                    children: []
                    pos: 58627
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: entry.causedUseOfZip64 = !hasUsedZip64;
                    children: []
                    pos: 58657
                    length: 39
                  pos: 58643
                  length: 63
                pos: 58624
                length: 82
              - type: expression_statement
                fields:
                  text: hasUsedZip64 = true;
                children: []
                pos: 58715
                length: 20
              - type: local_variable_declaration
                fields:
                  text: |-
                    Zip64ExtendedInformationExtraField z64 =
                                (Zip64ExtendedInformationExtraField)
                                ze.getExtraField(Zip64ExtendedInformationExtraField
                                                 .HEADER_ID);
                children: []
                pos: 58744
                length: 195
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: z64
                            children: []
                            pos: 58952
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 58959
                            length: 4
                        children: []
                        pos: 58952
                        length: 11
                    children: []
                    pos: 58951
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: z64 = new Zip64ExtendedInformationExtraField();
                    children: []
                    pos: 59229
                    length: 47
                  pos: 58965
                  length: 321
                pos: 58948
                length: 338
              - type: expression_statement
                fields:
                  text: ze.addAsFirstExtraField(z64);
                children: []
                pos: 59373
                length: 29
              - type: return_statement
                fields:
                  text: return z64;
                children: []
                pos: 59412
                length: 11
              pos: 58614
              length: 815
          children: []
          pos: 58523
          length: 906
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasZip64Extra
              children: []
              pos: 59571
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 59585
                length: 24
              pos: 59555
              length: 195
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return ze.getExtraField(Zip64ExtendedInformationExtraField
                                                    .HEADER_ID)
                                != null;
                children: []
                pos: 59621
                length: 123
              pos: 59611
              length: 139
          children: []
          pos: 59555
          length: 195
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEffectiveZip64Mode
              children: []
              pos: 59989
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60011
                length: 24
              pos: 59971
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: or
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: zip64Mode
                                        children: []
                                        pos: 60051
                                        length: 9
                                      right:
                                        type: field_access
                                        fields:
                                          text: Zip64Mode.AsNeeded
                                        children: []
                                        pos: 60064
                                        length: 18
                                    children: []
                                    pos: 60051
                                    length: 31
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: channel
                                        children: []
                                        pos: 60098
                                        length: 7
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 60109
                                        length: 4
                                    children: []
                                    pos: 60098
                                    length: 15
                                children: []
                                pos: 60051
                                length: 62
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: ze.getMethod()
                                    children: []
                                    pos: 60129
                                    length: 14
                                  right:
                                    type: identifier
                                    fields:
                                      text: DEFLATED
                                    children: []
                                    pos: 60147
                                    length: 8
                                children: []
                                pos: 60129
                                length: 26
                            children: []
                            pos: 60051
                            length: 104
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: ze.getSize()
                                children: []
                                pos: 60171
                                length: 12
                              right:
                                type: field_access
                                fields:
                                  text: ArchiveEntry.SIZE_UNKNOWN
                                children: []
                                pos: 60187
                                length: 25
                            children: []
                            pos: 60171
                            length: 41
                        children: []
                        pos: 60051
                        length: 161
                    children: []
                    pos: 60050
                    length: 163
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return zip64Mode;
                    children: []
                    pos: 60228
                    length: 17
                  pos: 60214
                  length: 41
                pos: 60047
                length: 208
              - type: return_statement
                fields:
                  text: return Zip64Mode.Never;
                children: []
                pos: 60264
                length: 23
              pos: 60037
              length: 256
          children: []
          pos: 59971
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEntryEncoding
              children: []
              pos: 60319
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60336
                length: 24
              pos: 60299
              length: 250
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final boolean encodable = zipEncoding.canEncode(ze.getName());
                children: []
                pos: 60372
                length: 62
              - type: return_statement
                fields:
                  text: |-
                    return !encodable && fallbackToUTF8
                                ? ZipEncodingHelper.UTF8_ZIP_ENCODING : zipEncoding;
                children: []
                pos: 60443
                length: 100
              pos: 60362
              length: 187
          children: []
          pos: 60299
          length: 250
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getName
              children: []
              pos: 60574
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final ZipArchiveEntry ze
                children: []
                pos: 60582
                length: 24
              pos: 60555
              length: 137
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return getEntryEncoding(ze).encode(ze.getName());
                children: []
                pos: 60637
                length: 49
              pos: 60627
              length: 65
          children: []
          pos: 60555
          length: 137
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: destroy
              children: []
              pos: 60985
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 60980
              length: 173
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: channel
                            children: []
                            pos: 61028
                            length: 7
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 61039
                            length: 4
                        children: []
                        pos: 61028
                        length: 15
                    children: []
                    pos: 61027
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: channel.close();
                    children: []
                    pos: 61059
                    length: 16
                  pos: 61045
                  length: 40
                pos: 61024
                length: 61
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 61098
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 61105
                            length: 4
                        children: []
                        pos: 61098
                        length: 11
                    children: []
                    pos: 61097
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.close();
                    children: []
                    pos: 61125
                    length: 12
                  pos: 61111
                  length: 36
                pos: 61094
                length: 53
              pos: 61014
              length: 139
          children: []
          pos: 60980
          length: 173
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: UnicodeExtraFieldPolicy
              children: []
              pos: 61293
              length: 23
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: public static final UnicodeExtraFieldPolicy ALWAYS = new UnicodeExtraFieldPolicy("always");
                children: []
                pos: 61398
                length: 91
              - type: field_declaration
                fields:
                  text: public static final UnicodeExtraFieldPolicy NEVER = new UnicodeExtraFieldPolicy("never");
                children: []
                pos: 61568
                length: 89
              - type: field_declaration
                fields:
                  text: |-
                    public static final UnicodeExtraFieldPolicy NOT_ENCODEABLE =
                                new UnicodeExtraFieldPolicy("not encodeable");
                children: []
                pos: 61807
                length: 119
              - type: field_declaration
                fields:
                  text: private final String name;
                children: []
                pos: 61936
                length: 26
              - type: constructor_declaration
                fields:
                  text: |-
                    private UnicodeExtraFieldPolicy(final String n) {
                                name = n;
                            }
                children: []
                pos: 61971
                length: 81
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: toString
                    children: []
                    pos: 62093
                    length: 8
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 62061
                    length: 79
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return name;
                      children: []
                      pos: 62118
                      length: 12
                    pos: 62104
                    length: 36
                children: []
                pos: 62061
                length: 79
              pos: 61267
              length: 879
          children: []
          pos: 61267
          length: 879
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: CurrentEntry
              children: []
              pos: 62289
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: constructor_declaration
                fields:
                  text: |-
                    private CurrentEntry(final ZipArchiveEntry entry) {
                                this.entry = entry;
                            }
                children: []
                pos: 62312
                length: 93
              - type: field_declaration
                fields:
                  text: private final ZipArchiveEntry entry;
                children: []
                pos: 62468
                length: 36
              - type: field_declaration
                fields:
                  text: private long localDataStart = 0;
                children: []
                pos: 62645
                length: 32
              - type: field_declaration
                fields:
                  text: private long dataStart = 0;
                children: []
                pos: 62748
                length: 27
              - type: field_declaration
                fields:
                  text: private long bytesRead = 0;
                children: []
                pos: 62932
                length: 27
              - type: field_declaration
                fields:
                  text: private boolean causedUseOfZip64 = false;
                children: []
                pos: 63065
                length: 41
              - type: field_declaration
                fields:
                  text: private boolean hasWritten;
                children: []
                pos: 63429
                length: 27
              pos: 62262
              length: 1200
          children: []
          pos: 62262
          length: 1200
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: EntryMetaData
              children: []
              pos: 63495
              length: 13
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final long offset;
                children: []
                pos: 63519
                length: 26
              - type: field_declaration
                fields:
                  text: private final boolean usesDataDescriptor;
                children: []
                pos: 63554
                length: 41
              - type: constructor_declaration
                fields:
                  text: |-
                    private EntryMetaData(long offset, boolean usesDataDescriptor) {
                                this.offset = offset;
                                this.usesDataDescriptor = usesDataDescriptor;
                            }
                children: []
                pos: 63604
                length: 166
              pos: 63468
              length: 308
          children: []
          pos: 63468
          length: 308
        pos: 3840
        length: 59938
    children: []
    pos: 3840
    length: 59938
  pos: 0
  length: 63779
text_diff: "--- before\n+++ after\n@@ -1031,7 +1031,7 @@\n \n         final long localHeaderStart
  = streamCompressor.getTotalBytesWritten();\n         final byte[] localHeader =
  createLocalFileHeader(ze, name, encodable, phased, localHeaderStart);\n-        metaData.put(ze,
  new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod(), phased)));\n+
  \       metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod())));\n
  \        entry.localDataStart = localHeaderStart + LFH_CRC_OFFSET; // At crc offset\n
  \        writeCounted(localHeader);\n         entry.dataStart = streamCompressor.getTotalBytesWritten();\n@@
  -1072,7 +1072,7 @@\n \n         //store method in local variable to prevent multiple
  method calls\n         final int zipMethod = ze.getMethod();\n-        final boolean
  dataDescriptor = usesDataDescriptor(zipMethod, phased);\n+        final boolean
  dataDescriptor = usesDataDescriptor(zipMethod);\n \n         putShort(versionNeededToExtract(zipMethod,
  hasZip64Extra(ze), dataDescriptor), buf, LFH_VERSION_NEEDED_OFFSET);\n \n@@ -1168,7
  +1168,7 @@\n      * @throws IOException on error\n      */\n     protected void
  writeDataDescriptor(final ZipArchiveEntry ze) throws IOException {\n-        if
  (!usesDataDescriptor(ze.getMethod(), false)) {\n+        if (ze.getMethod() != DEFLATED
  || channel != null) {\n             return;\n         }\n         writeCounted(DD_SIG);\n@@
  -1489,8 +1489,8 @@\n         return versionNeededToExtractMethod(zipMethod);\n     }\n
  \n-    private boolean usesDataDescriptor(final int zipMethod, boolean phased) {\n-
  \       return !phased && zipMethod == DEFLATED && channel == null;\n+    private
  boolean usesDataDescriptor(final int zipMethod) {\n+        return zipMethod ==
  DEFLATED && channel == null;\n     }\n \n     private int versionNeededToExtractMethod(int
  zipMethod) {\n"
tree_diff: |+
  New cluster:
  UPDATE from metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod(), phased))); to metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod())));
  ------------
  ===
  update-node
  ---
  expression_statement: metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod(), phased))); [38893,38991]
  replace metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod(), phased))); by metaData.put(ze, new EntryMetaData(localHeaderStart, usesDataDescriptor(ze.getMethod())));

  New cluster:
  UPDATE from final boolean dataDescriptor = usesDataDescriptor(zipMethod, phased); to final boolean dataDescriptor = usesDataDescriptor(zipMethod);
  ------------
  ===
  update-node
  ---
  local_variable_declaration: final boolean dataDescriptor = usesDataDescriptor(zipMethod, phased); [40925,40994]
  replace final boolean dataDescriptor = usesDataDescriptor(zipMethod, phased); by final boolean dataDescriptor = usesDataDescriptor(zipMethod);

  New cluster:
  UPDATE from return !phased && zipMethod == DEFLATED && channel == null; to return zipMethod == DEFLATED && channel == null;
  ------------
  ===
  update-node
  ---
  return_statement: return !phased && zipMethod == DEFLATED && channel == null; [57450,57509]
  replace return !phased && zipMethod == DEFLATED && channel == null; by return zipMethod == DEFLATED && channel == null;

  New cluster:
  Unknown cluster type
  ------------
  ===
  insert-tree
  ---
  or [45033,45078]
      not_equals [45033,45059]
          method_invocation: ze.getMethod() [45033,45047]
          identifier: DEFLATED [45051,45059]
      not_equals [45063,45078]
          identifier: channel [45063,45070]
          null_literal [45074,45078]
  to
  parenthesized_expression [45048,45092]
  at 0

  New cluster:
  ===
  delete-node
  ---
  unary_expression: !usesDataDescriptor(ze.getMethod(), false) [45049,45091]
  ===
  ------------
  ===
  delete-node
  ---
  unary_expression: !usesDataDescriptor(ze.getMethod(), false) [45049,45091]
  ===

...
