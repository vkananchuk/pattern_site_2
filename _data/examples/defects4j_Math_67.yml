---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: MultiStartUnivariateRealOptimizer
        children: []
        pos: 1599
        length: 33
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 5983375963110961019L;
          children: []
          pos: 1719
          length: 66
        - type: field_declaration
          fields:
            text: private final UnivariateRealOptimizer optimizer;
          children: []
          pos: 1834
          length: 48
        - type: field_declaration
          fields:
            text: private int maxIterations;
          children: []
          pos: 1937
          length: 26
        - type: field_declaration
          fields:
            text: private int maxEvaluations;
          children: []
          pos: 2019
          length: 27
        - type: field_declaration
          fields:
            text: private int totalIterations;
          children: []
          pos: 2118
          length: 28
        - type: field_declaration
          fields:
            text: private int totalEvaluations;
          children: []
          pos: 2219
          length: 29
        - type: field_declaration
          fields:
            text: private int starts;
          children: []
          pos: 2289
          length: 19
        - type: field_declaration
          fields:
            text: private RandomGenerator generator;
          children: []
          pos: 2359
          length: 34
        - type: field_declaration
          fields:
            text: private double[] optima;
          children: []
          pos: 2424
          length: 24
        - type: field_declaration
          fields:
            text: private double[] optimaValues;
          children: []
          pos: 2498
          length: 30
        - type: constructor_declaration
          fields:
            text: |-
              public MultiStartUnivariateRealOptimizer(final UnivariateRealOptimizer optimizer,
                                                           final int starts,
                                                           final RandomGenerator generator) {
                      this.optimizer        = optimizer;
                      this.totalIterations  = 0;
                      this.starts           = starts;
                      this.generator        = generator;
                      this.optima           = null;
                      setMaximalIterationCount(Integer.MAX_VALUE);
                      setMaxEvaluations(Integer.MAX_VALUE);
                  }
          children: []
          pos: 2884
          length: 528
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getFunctionValue
              children: []
              pos: 3457
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3443
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimaValues[0];
                children: []
                pos: 3486
                length: 23
              pos: 3476
              length: 39
          children: []
          pos: 3443
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getResult
              children: []
              pos: 3560
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3546
              length: 59
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optima[0];
                children: []
                pos: 3582
                length: 17
              pos: 3572
              length: 33
          children: []
          pos: 3546
          length: 59
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getAbsoluteAccuracy
              children: []
              pos: 3650
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3636
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getAbsoluteAccuracy();
                children: []
                pos: 3682
                length: 39
              pos: 3672
              length: 55
          children: []
          pos: 3636
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getIterationCount
              children: []
              pos: 3769
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3758
              length: 70
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return totalIterations;
                children: []
                pos: 3799
                length: 23
              pos: 3789
              length: 39
          children: []
          pos: 3758
          length: 70
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMaximalIterationCount
              children: []
              pos: 3870
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3859
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return maxIterations;
                children: []
                pos: 3907
                length: 21
              pos: 3897
              length: 37
          children: []
          pos: 3859
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMaxEvaluations
              children: []
              pos: 3976
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3965
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return maxEvaluations;
                children: []
                pos: 4006
                length: 22
              pos: 3996
              length: 38
          children: []
          pos: 3965
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEvaluations
              children: []
              pos: 4076
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4065
              length: 68
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return totalEvaluations;
                children: []
                pos: 4103
                length: 24
              pos: 4093
              length: 40
          children: []
          pos: 4065
          length: 68
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getRelativeAccuracy
              children: []
              pos: 4178
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4164
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getRelativeAccuracy();
                children: []
                pos: 4210
                length: 39
              pos: 4200
              length: 55
          children: []
          pos: 4164
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetAbsoluteAccuracy
              children: []
              pos: 4298
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4286
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetAbsoluteAccuracy();
                children: []
                pos: 4332
                length: 34
              pos: 4322
              length: 50
          children: []
          pos: 4286
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetMaximalIterationCount
              children: []
              pos: 4415
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4403
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetMaximalIterationCount();
                children: []
                pos: 4454
                length: 39
              pos: 4444
              length: 55
          children: []
          pos: 4403
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetRelativeAccuracy
              children: []
              pos: 4542
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4530
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetRelativeAccuracy();
                children: []
                pos: 4576
                length: 34
              pos: 4566
              length: 50
          children: []
          pos: 4530
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setAbsoluteAccuracy
              children: []
              pos: 4659
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: double accuracy
                children: []
                pos: 4679
                length: 15
              pos: 4647
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.setAbsoluteAccuracy(accuracy);
                children: []
                pos: 4706
                length: 40
              pos: 4696
              length: 56
          children: []
          pos: 4647
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMaximalIterationCount
              children: []
              pos: 4795
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int count
                children: []
                pos: 4820
                length: 9
              pos: 4783
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.maxIterations = count;
                children: []
                pos: 4841
                length: 27
              pos: 4831
              length: 43
          children: []
          pos: 4783
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMaxEvaluations
              children: []
              pos: 4917
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int maxEvaluations
                children: []
                pos: 4935
                length: 18
              pos: 4905
              length: 103
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.maxEvaluations = maxEvaluations;
                children: []
                pos: 4965
                length: 37
              pos: 4955
              length: 53
          children: []
          pos: 4905
          length: 103
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setRelativeAccuracy
              children: []
              pos: 5051
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: double accuracy
                children: []
                pos: 5071
                length: 15
              pos: 5039
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.setRelativeAccuracy(accuracy);
                children: []
                pos: 5098
                length: 40
              pos: 5088
              length: 56
          children: []
          pos: 5039
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptima
              children: []
              pos: 6722
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6706
              length: 245
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: optima
                            children: []
                            pos: 6777
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 6787
                            length: 4
                        children: []
                        pos: 6777
                        length: 14
                    children: []
                    pos: 6776
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw MathRuntimeException.createIllegalStateException(LocalizedFormats.NO_OPTIMUM_COMPUTED_YET);
                    children: []
                    pos: 6807
                    length: 97
                  pos: 6793
                  length: 121
                pos: 6773
                length: 141
              - type: return_statement
                fields:
                  text: return optima.clone();
                children: []
                pos: 6923
                length: 22
              pos: 6763
              length: 188
          children: []
          pos: 6706
          length: 245
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptimaValues
              children: []
              pos: 8093
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8077
              length: 263
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: optimaValues
                            children: []
                            pos: 8154
                            length: 12
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8170
                            length: 4
                        children: []
                        pos: 8154
                        length: 20
                    children: []
                    pos: 8153
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw MathRuntimeException.createIllegalStateException(LocalizedFormats.NO_OPTIMUM_COMPUTED_YET);
                    children: []
                    pos: 8190
                    length: 97
                  pos: 8176
                  length: 121
                pos: 8150
                length: 147
              - type: return_statement
                fields:
                  text: return optimaValues.clone();
                children: []
                pos: 8306
                length: 28
              pos: 8140
              length: 200
          children: []
          pos: 8077
          length: 263
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: optimize
              children: []
              pos: 8385
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnivariateRealFunction f
                children: []
                pos: 8394
                length: 30
              pos: 8371
              length: 3439
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optima           = new double[starts];
                children: []
                pos: 8602
                length: 38
              - type: expression_statement
                fields:
                  text: optimaValues     = new double[starts];
                children: []
                pos: 8649
                length: 38
              - type: expression_statement
                fields:
                  text: totalIterations  = 0;
                children: []
                pos: 8696
                length: 21
              - type: expression_statement
                fields:
                  text: totalEvaluations = 0;
                children: []
                pos: 8726
                length: 21
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < starts; ++i) {

                                try {
                                    optimizer.setMaximalIterationCount(maxIterations - totalIterations);
                                    optimizer.setMaxEvaluations(maxEvaluations - totalEvaluations);
                                    final double bound1 = (i == 0) ? min : min + generator.nextDouble() * (max - min);
                                    final double bound2 = (i == 0) ? max : min + generator.nextDouble() * (max - min);
                                    optima[i]       = optimizer.optimize(f, goalType,
                                                                         Math.min(bound1, bound2),
                                                                         Math.max(bound1, bound2));
                                    optimaValues[i] = optimizer.getFunctionValue();
                                } catch (FunctionEvaluationException fee) {
                                    optima[i]       = Double.NaN;
                                    optimaValues[i] = Double.NaN;
                                } catch (ConvergenceException ce) {
                                    optima[i]       = Double.NaN;
                                    optimaValues[i] = Double.NaN;
                                }

                                totalIterations  += optimizer.getIterationCount();
                                totalEvaluations += optimizer.getEvaluations();

                            }
                children: []
                pos: 8785
                length: 1142
              - type: local_variable_declaration
                fields:
                  text: int lastNaN = optima.length;
                children: []
                pos: 10009
                length: 28
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < lastNaN; ++i) {
                                if (Double.isNaN(optima[i])) {
                                    optima[i] = optima[--lastNaN];
                                    optima[lastNaN + 1] = Double.NaN;
                                    optimaValues[i] = optimaValues[--lastNaN];
                                    optimaValues[lastNaN + 1] = Double.NaN;
                                }
                            }
                children: []
                pos: 10046
                length: 314
              - type: local_variable_declaration
                fields:
                  text: double currX = optima[0];
                children: []
                pos: 10370
                length: 25
              - type: local_variable_declaration
                fields:
                  text: double currY = optimaValues[0];
                children: []
                pos: 10404
                length: 31
              - type: for_statement
                fields:
                  text: |-
                    for (int j = 1; j < lastNaN; ++j) {
                                final double prevY = currY;
                                currX = optima[j];
                                currY = optimaValues[j];
                                if ((goalType == GoalType.MAXIMIZE) ^ (currY < prevY)) {
                                    // the current element should be inserted closer to the beginning
                                    int i = j - 1;
                                    double mIX = optima[i];
                                    double mIY = optimaValues[i];
                                    while ((i >= 0) && ((goalType == GoalType.MAXIMIZE) ^ (currY < mIY))) {
                                        optima[i + 1]       = mIX;
                                        optimaValues[i + 1] = mIY;
                                        if (i-- != 0) {
                                            mIX = optima[i];
                                            mIY = optimaValues[i];
                                        } else {
                                            mIX = Double.NaN;
                                            mIY = Double.NaN;
                                        }
                                    }
                                    optima[i + 1]       = currX;
                                    optimaValues[i + 1] = currY;
                                    currX = optima[j];
                                    currY = optimaValues[j];
                                }
                            }
                children: []
                pos: 10444
                length: 1060
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: Double.isNaN(optima[0])
                        children: []
                        pos: 11518
                        length: 23
                    children: []
                    pos: 11517
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new OptimizationException(
                                            LocalizedFormats.NO_CONVERGENCE_WITH_ANY_START_POINT,
                                            starts);
                    children: []
                    pos: 11557
                    length: 135
                  pos: 11543
                  length: 159
                pos: 11514
                length: 188
              - type: return_statement
                fields:
                  text: return optima[0];
                children: []
                pos: 11786
                length: 17
              pos: 8591
              length: 3219
          children: []
          pos: 8371
          length: 3439
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: optimize
              children: []
              pos: 11855
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnivariateRealFunction f
                children: []
                pos: 11864
                length: 30
              pos: 11841
              length: 292
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimize(f, goalType, min, max);
                children: []
                pos: 12088
                length: 39
              pos: 12078
              length: 55
          children: []
          pos: 11841
          length: 292
        pos: 1586
        length: 10549
    children: []
    pos: 1586
    length: 10549
  pos: 0
  length: 12136
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: MultiStartUnivariateRealOptimizer
        children: []
        pos: 1599
        length: 33
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 5983375963110961019L;
          children: []
          pos: 1719
          length: 66
        - type: field_declaration
          fields:
            text: private final UnivariateRealOptimizer optimizer;
          children: []
          pos: 1834
          length: 48
        - type: field_declaration
          fields:
            text: private int maxIterations;
          children: []
          pos: 1937
          length: 26
        - type: field_declaration
          fields:
            text: private int maxEvaluations;
          children: []
          pos: 2019
          length: 27
        - type: field_declaration
          fields:
            text: private int totalIterations;
          children: []
          pos: 2118
          length: 28
        - type: field_declaration
          fields:
            text: private int totalEvaluations;
          children: []
          pos: 2219
          length: 29
        - type: field_declaration
          fields:
            text: private int starts;
          children: []
          pos: 2289
          length: 19
        - type: field_declaration
          fields:
            text: private RandomGenerator generator;
          children: []
          pos: 2359
          length: 34
        - type: field_declaration
          fields:
            text: private double[] optima;
          children: []
          pos: 2424
          length: 24
        - type: field_declaration
          fields:
            text: private double[] optimaValues;
          children: []
          pos: 2498
          length: 30
        - type: constructor_declaration
          fields:
            text: |-
              public MultiStartUnivariateRealOptimizer(final UnivariateRealOptimizer optimizer,
                                                           final int starts,
                                                           final RandomGenerator generator) {
                      this.optimizer        = optimizer;
                      this.totalIterations  = 0;
                      this.starts           = starts;
                      this.generator        = generator;
                      this.optima           = null;
                      setMaximalIterationCount(Integer.MAX_VALUE);
                      setMaxEvaluations(Integer.MAX_VALUE);
                  }
          children: []
          pos: 2884
          length: 528
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getFunctionValue
              children: []
              pos: 3457
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3443
              length: 85
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getFunctionValue();
                children: []
                pos: 3486
                length: 36
              pos: 3476
              length: 52
          children: []
          pos: 3443
          length: 85
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getResult
              children: []
              pos: 3573
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3559
              length: 71
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getResult();
                children: []
                pos: 3595
                length: 29
              pos: 3585
              length: 45
          children: []
          pos: 3559
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getAbsoluteAccuracy
              children: []
              pos: 3675
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3661
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getAbsoluteAccuracy();
                children: []
                pos: 3707
                length: 39
              pos: 3697
              length: 55
          children: []
          pos: 3661
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getIterationCount
              children: []
              pos: 3794
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3783
              length: 70
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return totalIterations;
                children: []
                pos: 3824
                length: 23
              pos: 3814
              length: 39
          children: []
          pos: 3783
          length: 70
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMaximalIterationCount
              children: []
              pos: 3895
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3884
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return maxIterations;
                children: []
                pos: 3932
                length: 21
              pos: 3922
              length: 37
          children: []
          pos: 3884
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMaxEvaluations
              children: []
              pos: 4001
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3990
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return maxEvaluations;
                children: []
                pos: 4031
                length: 22
              pos: 4021
              length: 38
          children: []
          pos: 3990
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getEvaluations
              children: []
              pos: 4101
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4090
              length: 68
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return totalEvaluations;
                children: []
                pos: 4128
                length: 24
              pos: 4118
              length: 40
          children: []
          pos: 4090
          length: 68
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getRelativeAccuracy
              children: []
              pos: 4203
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4189
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimizer.getRelativeAccuracy();
                children: []
                pos: 4235
                length: 39
              pos: 4225
              length: 55
          children: []
          pos: 4189
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetAbsoluteAccuracy
              children: []
              pos: 4323
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4311
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetAbsoluteAccuracy();
                children: []
                pos: 4357
                length: 34
              pos: 4347
              length: 50
          children: []
          pos: 4311
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetMaximalIterationCount
              children: []
              pos: 4440
              length: 26
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4428
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetMaximalIterationCount();
                children: []
                pos: 4479
                length: 39
              pos: 4469
              length: 55
          children: []
          pos: 4428
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetRelativeAccuracy
              children: []
              pos: 4567
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4555
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.resetRelativeAccuracy();
                children: []
                pos: 4601
                length: 34
              pos: 4591
              length: 50
          children: []
          pos: 4555
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setAbsoluteAccuracy
              children: []
              pos: 4684
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: double accuracy
                children: []
                pos: 4704
                length: 15
              pos: 4672
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.setAbsoluteAccuracy(accuracy);
                children: []
                pos: 4731
                length: 40
              pos: 4721
              length: 56
          children: []
          pos: 4672
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMaximalIterationCount
              children: []
              pos: 4820
              length: 24
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int count
                children: []
                pos: 4845
                length: 9
              pos: 4808
              length: 91
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.maxIterations = count;
                children: []
                pos: 4866
                length: 27
              pos: 4856
              length: 43
          children: []
          pos: 4808
          length: 91
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setMaxEvaluations
              children: []
              pos: 4942
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int maxEvaluations
                children: []
                pos: 4960
                length: 18
              pos: 4930
              length: 103
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.maxEvaluations = maxEvaluations;
                children: []
                pos: 4990
                length: 37
              pos: 4980
              length: 53
          children: []
          pos: 4930
          length: 103
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setRelativeAccuracy
              children: []
              pos: 5076
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: double accuracy
                children: []
                pos: 5096
                length: 15
              pos: 5064
              length: 105
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optimizer.setRelativeAccuracy(accuracy);
                children: []
                pos: 5123
                length: 40
              pos: 5113
              length: 56
          children: []
          pos: 5064
          length: 105
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptima
              children: []
              pos: 6747
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6731
              length: 245
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: optima
                            children: []
                            pos: 6802
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 6812
                            length: 4
                        children: []
                        pos: 6802
                        length: 14
                    children: []
                    pos: 6801
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw MathRuntimeException.createIllegalStateException(LocalizedFormats.NO_OPTIMUM_COMPUTED_YET);
                    children: []
                    pos: 6832
                    length: 97
                  pos: 6818
                  length: 121
                pos: 6798
                length: 141
              - type: return_statement
                fields:
                  text: return optima.clone();
                children: []
                pos: 6948
                length: 22
              pos: 6788
              length: 188
          children: []
          pos: 6731
          length: 245
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptimaValues
              children: []
              pos: 8118
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8102
              length: 263
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: optimaValues
                            children: []
                            pos: 8179
                            length: 12
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8195
                            length: 4
                        children: []
                        pos: 8179
                        length: 20
                    children: []
                    pos: 8178
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw MathRuntimeException.createIllegalStateException(LocalizedFormats.NO_OPTIMUM_COMPUTED_YET);
                    children: []
                    pos: 8215
                    length: 97
                  pos: 8201
                  length: 121
                pos: 8175
                length: 147
              - type: return_statement
                fields:
                  text: return optimaValues.clone();
                children: []
                pos: 8331
                length: 28
              pos: 8165
              length: 200
          children: []
          pos: 8102
          length: 263
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: optimize
              children: []
              pos: 8410
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnivariateRealFunction f
                children: []
                pos: 8419
                length: 30
              pos: 8396
              length: 3439
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: optima           = new double[starts];
                children: []
                pos: 8627
                length: 38
              - type: expression_statement
                fields:
                  text: optimaValues     = new double[starts];
                children: []
                pos: 8674
                length: 38
              - type: expression_statement
                fields:
                  text: totalIterations  = 0;
                children: []
                pos: 8721
                length: 21
              - type: expression_statement
                fields:
                  text: totalEvaluations = 0;
                children: []
                pos: 8751
                length: 21
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < starts; ++i) {

                                try {
                                    optimizer.setMaximalIterationCount(maxIterations - totalIterations);
                                    optimizer.setMaxEvaluations(maxEvaluations - totalEvaluations);
                                    final double bound1 = (i == 0) ? min : min + generator.nextDouble() * (max - min);
                                    final double bound2 = (i == 0) ? max : min + generator.nextDouble() * (max - min);
                                    optima[i]       = optimizer.optimize(f, goalType,
                                                                         Math.min(bound1, bound2),
                                                                         Math.max(bound1, bound2));
                                    optimaValues[i] = optimizer.getFunctionValue();
                                } catch (FunctionEvaluationException fee) {
                                    optima[i]       = Double.NaN;
                                    optimaValues[i] = Double.NaN;
                                } catch (ConvergenceException ce) {
                                    optima[i]       = Double.NaN;
                                    optimaValues[i] = Double.NaN;
                                }

                                totalIterations  += optimizer.getIterationCount();
                                totalEvaluations += optimizer.getEvaluations();

                            }
                children: []
                pos: 8810
                length: 1142
              - type: local_variable_declaration
                fields:
                  text: int lastNaN = optima.length;
                children: []
                pos: 10034
                length: 28
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < lastNaN; ++i) {
                                if (Double.isNaN(optima[i])) {
                                    optima[i] = optima[--lastNaN];
                                    optima[lastNaN + 1] = Double.NaN;
                                    optimaValues[i] = optimaValues[--lastNaN];
                                    optimaValues[lastNaN + 1] = Double.NaN;
                                }
                            }
                children: []
                pos: 10071
                length: 314
              - type: local_variable_declaration
                fields:
                  text: double currX = optima[0];
                children: []
                pos: 10395
                length: 25
              - type: local_variable_declaration
                fields:
                  text: double currY = optimaValues[0];
                children: []
                pos: 10429
                length: 31
              - type: for_statement
                fields:
                  text: |-
                    for (int j = 1; j < lastNaN; ++j) {
                                final double prevY = currY;
                                currX = optima[j];
                                currY = optimaValues[j];
                                if ((goalType == GoalType.MAXIMIZE) ^ (currY < prevY)) {
                                    // the current element should be inserted closer to the beginning
                                    int i = j - 1;
                                    double mIX = optima[i];
                                    double mIY = optimaValues[i];
                                    while ((i >= 0) && ((goalType == GoalType.MAXIMIZE) ^ (currY < mIY))) {
                                        optima[i + 1]       = mIX;
                                        optimaValues[i + 1] = mIY;
                                        if (i-- != 0) {
                                            mIX = optima[i];
                                            mIY = optimaValues[i];
                                        } else {
                                            mIX = Double.NaN;
                                            mIY = Double.NaN;
                                        }
                                    }
                                    optima[i + 1]       = currX;
                                    optimaValues[i + 1] = currY;
                                    currX = optima[j];
                                    currY = optimaValues[j];
                                }
                            }
                children: []
                pos: 10469
                length: 1060
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: Double.isNaN(optima[0])
                        children: []
                        pos: 11543
                        length: 23
                    children: []
                    pos: 11542
                    length: 25
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new OptimizationException(
                                            LocalizedFormats.NO_CONVERGENCE_WITH_ANY_START_POINT,
                                            starts);
                    children: []
                    pos: 11582
                    length: 135
                  pos: 11568
                  length: 159
                pos: 11539
                length: 188
              - type: return_statement
                fields:
                  text: return optima[0];
                children: []
                pos: 11811
                length: 17
              pos: 8616
              length: 3219
          children: []
          pos: 8396
          length: 3439
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: optimize
              children: []
              pos: 11880
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final UnivariateRealFunction f
                children: []
                pos: 11889
                length: 30
              pos: 11866
              length: 292
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return optimize(f, goalType, min, max);
                children: []
                pos: 12113
                length: 39
              pos: 12103
              length: 55
          children: []
          pos: 11866
          length: 292
        pos: 1586
        length: 10574
    children: []
    pos: 1586
    length: 10574
  pos: 0
  length: 12161
text_diff: "--- before\n+++ after\n@@ -89,12 +89,12 @@\n \n     /** {@inheritDoc}
  */\n     public double getFunctionValue() {\n-        return optimaValues[0];\n+
  \       return optimizer.getFunctionValue();\n     }\n \n     /** {@inheritDoc}
  */\n     public double getResult() {\n-        return optima[0];\n+        return
  optimizer.getResult();\n     }\n \n     /** {@inheritDoc} */\n"
tree_diff: |+
  New cluster:
  UPDATE from return optimaValues[0]; to return optimizer.getFunctionValue();
  ------------
  ===
  update-node
  ---
  return_statement: return optimaValues[0]; [3486,3509]
  replace return optimaValues[0]; by return optimizer.getFunctionValue();

  New cluster:
  UPDATE from return optima[0]; to return optimizer.getResult();
  ------------
  ===
  update-node
  ---
  return_statement: return optima[0]; [3582,3599]
  replace return optima[0]; by return optimizer.getResult();

...
