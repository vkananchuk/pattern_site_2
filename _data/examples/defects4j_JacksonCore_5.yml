---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: JsonPointer
        children: []
        pos: 587
        length: 11
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final static JsonPointer EMPTY = new JsonPointer();
          children: []
          pos: 716
          length: 61
        - type: field_declaration
          fields:
            text: protected final JsonPointer _nextSegment;
          children: []
          pos: 952
          length: 41
        - type: field_declaration
          fields:
            text: protected final String _asString;
          children: []
          pos: 1154
          length: 33
        - type: field_declaration
          fields:
            text: protected final String _matchingPropertyName;
          children: []
          pos: 1197
          length: 45
        - type: field_declaration
          fields:
            text: protected final int _matchingElementIndex;
          children: []
          pos: 1248
          length: 42
        - type: constructor_declaration
          fields:
            text: |-
              protected JsonPointer() {
                      _nextSegment = null;
                      _matchingPropertyName = "";
                      _matchingElementIndex = -1;
                      _asString = "";
                  }
          children: []
          pos: 1593
          length: 156
        - type: constructor_declaration
          fields:
            text: |-
              protected JsonPointer(String fullString, String segment, JsonPointer next) {
                      _asString = fullString;
                      _nextSegment = next;
                      // Ok; may always be a property
                      _matchingPropertyName = segment;
                      _matchingElementIndex = _parseIndex(segment);
                  }
          children: []
          pos: 1827
          length: 278
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: compile
              children: []
              pos: 2740
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 2748
                length: 12
              pos: 2714
              length: 494
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: input
                                    children: []
                                    pos: 2874
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 2883
                                    length: 4
                                children: []
                                pos: 2874
                                length: 13
                            children: []
                            pos: 2873
                            length: 15
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: input.length()
                                children: []
                                pos: 2892
                                length: 14
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 2910
                                length: 1
                            children: []
                            pos: 2892
                            length: 19
                        children: []
                        pos: 2873
                        length: 38
                    children: []
                    pos: 2872
                    length: 40
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return EMPTY;
                    children: []
                    pos: 2927
                    length: 13
                  pos: 2913
                  length: 37
                pos: 2869
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: input.charAt(0)
                            children: []
                            pos: 3005
                            length: 15
                          right:
                            type: character_literal
                            fields:
                              text: "'/'"
                            children: []
                            pos: 3024
                            length: 3
                        children: []
                        pos: 3005
                        length: 22
                    children: []
                    pos: 3004
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: 'throw new IllegalArgumentException("Invalid input: JSON
                        Pointer expression must start with ''/'': "+"\""+input+"\"");'
                    children: []
                    pos: 3043
                    length: 115
                  pos: 3029
                  length: 139
                pos: 3001
                length: 167
              - type: return_statement
                fields:
                  text: return _parseTail(input);
                children: []
                pos: 3177
                length: 25
              pos: 2798
              length: 410
          children: []
          pos: 2714
          length: 494
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: valueOf
              children: []
              pos: 3372
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 3380
                length: 12
              pos: 3346
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return compile(input);
                children: []
                pos: 3396
                length: 22
              pos: 3394
              length: 26
          children: []
          pos: 3346
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matches
              children: []
              pos: 4187
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4172
              length: 57
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _nextSegment == null;
                children: []
                pos: 4199
                length: 28
              pos: 4197
              length: 32
          children: []
          pos: 4172
          length: 57
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchingProperty
              children: []
              pos: 4248
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4234
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingPropertyName;
                children: []
                pos: 4272
                length: 29
              pos: 4270
              length: 33
          children: []
          pos: 4234
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchingIndex
              children: []
              pos: 4319
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4308
              length: 63
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingElementIndex;
                children: []
                pos: 4340
                length: 29
              pos: 4338
              length: 33
          children: []
          pos: 4308
          length: 63
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mayMatchProperty
              children: []
              pos: 4391
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4376
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingPropertyName != null;
                children: []
                pos: 4412
                length: 37
              pos: 4410
              length: 41
          children: []
          pos: 4376
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mayMatchElement
              children: []
              pos: 4471
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4456
              length: 71
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingElementIndex >= 0;
                children: []
                pos: 4491
                length: 34
              pos: 4489
              length: 38
          children: []
          pos: 4456
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matchProperty
              children: []
              pos: 4552
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String name
                children: []
                pos: 4566
                length: 11
              pos: 4533
              length: 192
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: _nextSegment
                                children: []
                                pos: 4593
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4609
                                length: 4
                            children: []
                            pos: 4593
                            length: 20
                          right:
                            type: unary_expression
                            fields:
                              text: "!_matchingPropertyName.equals(name)"
                            children: []
                            pos: 4617
                            length: 35
                        children: []
                        pos: 4593
                        length: 59
                    children: []
                    pos: 4592
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 4668
                    length: 12
                  pos: 4654
                  length: 36
                pos: 4589
                length: 101
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 4699
                length: 20
              pos: 4579
              length: 146
          children: []
          pos: 4533
          length: 192
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matchElement
              children: []
              pos: 4750
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 4764
                length: 9
              pos: 4731
              length: 178
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: index
                                    children: []
                                    pos: 4790
                                    length: 5
                                  right:
                                    type: identifier
                                    fields:
                                      text: _matchingElementIndex
                                    children: []
                                    pos: 4799
                                    length: 21
                                children: []
                                pos: 4790
                                length: 30
                            children: []
                            pos: 4789
                            length: 32
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: less_than
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: index
                                    children: []
                                    pos: 4826
                                    length: 5
                                  right:
                                    type: decimal_integer_literal
                                    fields:
                                      text: '0'
                                    children: []
                                    pos: 4834
                                    length: 1
                                children: []
                                pos: 4826
                                length: 9
                            children: []
                            pos: 4825
                            length: 11
                        children: []
                        pos: 4789
                        length: 47
                    children: []
                    pos: 4788
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 4852
                    length: 12
                  pos: 4838
                  length: 36
                pos: 4785
                length: 89
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 4883
                length: 20
              pos: 4775
              length: 134
          children: []
          pos: 4731
          length: 178
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: tail
              children: []
              pos: 5089
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5070
              length: 62
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 5106
                length: 20
              pos: 5096
              length: 36
          children: []
          pos: 5070
          length: 62
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 5343
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5319
              length: 56
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _asString;
                children: []
                pos: 5356
                length: 17
              pos: 5354
              length: 21
          children: []
          pos: 5319
          length: 56
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hashCode
              children: []
              pos: 5401
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5380
              length: 64
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _asString.hashCode();
                children: []
                pos: 5414
                length: 28
              pos: 5412
              length: 32
          children: []
          pos: 5380
          length: 64
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 5475
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 5482
                length: 8
              pos: 5450
              length: 239
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5506
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 5511
                            length: 4
                        children: []
                        pos: 5506
                        length: 9
                    children: []
                    pos: 5505
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 5517
                  length: 12
                pos: 5502
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5542
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5547
                            length: 4
                        children: []
                        pos: 5542
                        length: 9
                    children: []
                    pos: 5541
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5553
                  length: 13
                pos: 5538
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(o instanceof JsonPointer)"
                        children: []
                        pos: 5579
                        length: 27
                    children: []
                    pos: 5578
                    length: 29
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5608
                  length: 13
                pos: 5575
                length: 46
              - type: return_statement
                fields:
                  text: return _asString.equals(((JsonPointer) o)._asString);
                children: []
                pos: 5630
                length: 53
              pos: 5492
              length: 197
          children: []
          pos: 5450
          length: 239
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseIndex
              children: []
              pos: 5892
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 5904
                length: 10
              pos: 5867
              length: 670
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int len = str.length();
                children: []
                pos: 5926
                length: 29
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: len
                                children: []
                                pos: 6102
                                length: 3
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 6109
                                length: 1
                            children: []
                            pos: 6102
                            length: 8
                          right:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: len
                                children: []
                                pos: 6114
                                length: 3
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '10'
                                children: []
                                pos: 6120
                                length: 2
                            children: []
                            pos: 6114
                            length: 8
                        children: []
                        pos: 6102
                        length: 20
                    children: []
                    pos: 6101
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return -1;
                    children: []
                    pos: 6138
                    length: 10
                  pos: 6124
                  length: 34
                pos: 6098
                length: 60
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < len; ++i) {
                                char c = str.charAt(i);
                                if (c > '9' || c < '0') {
                                    return -1;
                                }
                            }
                children: []
                pos: 6167
                length: 156
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: len
                            children: []
                            pos: 6336
                            length: 3
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '10'
                            children: []
                            pos: 6343
                            length: 2
                        children: []
                        pos: 6336
                        length: 9
                    children: []
                    pos: 6335
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: long l = NumberInput.parseLong(str);
                    children: []
                    pos: 6361
                    length: 36
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: l
                                children: []
                                pos: 6414
                                length: 1
                              right:
                                type: field_access
                                fields:
                                  text: Integer.MAX_VALUE
                                children: []
                                pos: 6418
                                length: 17
                            children: []
                            pos: 6414
                            length: 21
                        children: []
                        pos: 6413
                        length: 23
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return -1;
                        children: []
                        pos: 6455
                        length: 10
                      pos: 6437
                      length: 42
                    pos: 6410
                    length: 69
                  pos: 6347
                  length: 142
                pos: 6332
                length: 157
              - type: return_statement
                fields:
                  text: return NumberInput.parseInt(str);
                children: []
                pos: 6498
                length: 33
              pos: 5916
              length: 621
          children: []
          pos: 5867
          length: 670
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseTail
              children: []
              pos: 6576
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 6587
                length: 12
              pos: 6547
              length: 771
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int end = input.length();
                children: []
                pos: 6611
                length: 31
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 1; i < end; ) {
                                char c = input.charAt(i);
                                if (c == '/') { // common case, got a segment
                                    return new JsonPointer(input, input.substring(1, i),
                                            _parseTail(input.substring(i)));
                                }
                                ++i;
                                // quoting is different; offline this case
                                if (c == '~' && i < end) { // possibly, quote
                                    return _parseQuotedTail(input, i);
                                }
                                // otherwise, loop on
                            }
                children: []
                pos: 6704
                length: 503
              - type: return_statement
                fields:
                  text: return new JsonPointer(input, input.substring(1), EMPTY);
                children: []
                pos: 7255
                length: 57
              pos: 6601
              length: 717
          children: []
          pos: 6547
          length: 771
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseQuotedTail
              children: []
              pos: 7593
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 7610
                length: 12
              pos: 7564
              length: 849
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int end = input.length();
                children: []
                pos: 7641
                length: 31
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder(Math.max(16, end));
                children: []
                pos: 7681
                length: 56
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 7750
                            length: 1
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '2'
                            children: []
                            pos: 7754
                            length: 1
                        children: []
                        pos: 7750
                        length: 5
                    children: []
                    pos: 7749
                    length: 7
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: sb.append(input, 1, i-1);
                    children: []
                    pos: 7771
                    length: 25
                  pos: 7757
                  length: 49
                pos: 7746
                length: 60
              - type: expression_statement
                fields:
                  text: _appendEscape(sb, input.charAt(i++));
                children: []
                pos: 7815
                length: 37
              - type: while_statement
                fields:
                  text: |-
                    while (i < end) {
                                char c = input.charAt(i);
                                if (c == '/') { // end is nigh!
                                    return new JsonPointer(input, sb.toString(),
                                            _parseTail(input.substring(i))); // need to push back slash
                                }
                                ++i;
                                if (c == '~' && i < end) {
                                    _appendEscape(sb, input.charAt(i++));
                                    continue;
                                }
                                sb.append(c);
                            }
                children: []
                pos: 7861
                length: 444
              - type: return_statement
                fields:
                  text: return new JsonPointer(input, sb.toString(), EMPTY);
                children: []
                pos: 8355
                length: 52
              pos: 7631
              length: 782
          children: []
          pos: 7564
          length: 849
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _appendEscape
              children: []
              pos: 8443
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 8457
                length: 16
              pos: 8423
              length: 241
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: c
                            children: []
                            pos: 8497
                            length: 1
                          right:
                            type: character_literal
                            fields:
                              text: "'0'"
                            children: []
                            pos: 8502
                            length: 3
                        children: []
                        pos: 8497
                        length: 8
                    children: []
                    pos: 8496
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: c = '~';
                    children: []
                    pos: 8521
                    length: 8
                  pos: 8507
                  length: 32
                pos: 8493
                length: 143
              - type: expression_statement
                fields:
                  text: sb.append(c);
                children: []
                pos: 8645
                length: 13
              pos: 8483
              length: 181
          children: []
          pos: 8423
          length: 241
        pos: 574
        length: 8092
    children: []
    pos: 574
    length: 8092
  pos: 0
  length: 8667
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: JsonPointer
        children: []
        pos: 587
        length: 11
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final static JsonPointer EMPTY = new JsonPointer();
          children: []
          pos: 716
          length: 61
        - type: field_declaration
          fields:
            text: protected final JsonPointer _nextSegment;
          children: []
          pos: 952
          length: 41
        - type: field_declaration
          fields:
            text: protected final String _asString;
          children: []
          pos: 1154
          length: 33
        - type: field_declaration
          fields:
            text: protected final String _matchingPropertyName;
          children: []
          pos: 1197
          length: 45
        - type: field_declaration
          fields:
            text: protected final int _matchingElementIndex;
          children: []
          pos: 1248
          length: 42
        - type: constructor_declaration
          fields:
            text: |-
              protected JsonPointer() {
                      _nextSegment = null;
                      _matchingPropertyName = "";
                      _matchingElementIndex = -1;
                      _asString = "";
                  }
          children: []
          pos: 1593
          length: 156
        - type: constructor_declaration
          fields:
            text: |-
              protected JsonPointer(String fullString, String segment, JsonPointer next) {
                      _asString = fullString;
                      _nextSegment = next;
                      // Ok; may always be a property
                      _matchingPropertyName = segment;
                      _matchingElementIndex = _parseIndex(segment);
                  }
          children: []
          pos: 1827
          length: 278
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: compile
              children: []
              pos: 2740
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 2748
                length: 12
              pos: 2714
              length: 494
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: input
                                    children: []
                                    pos: 2874
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 2883
                                    length: 4
                                children: []
                                pos: 2874
                                length: 13
                            children: []
                            pos: 2873
                            length: 15
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: input.length()
                                children: []
                                pos: 2892
                                length: 14
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 2910
                                length: 1
                            children: []
                            pos: 2892
                            length: 19
                        children: []
                        pos: 2873
                        length: 38
                    children: []
                    pos: 2872
                    length: 40
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return EMPTY;
                    children: []
                    pos: 2927
                    length: 13
                  pos: 2913
                  length: 37
                pos: 2869
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: input.charAt(0)
                            children: []
                            pos: 3005
                            length: 15
                          right:
                            type: character_literal
                            fields:
                              text: "'/'"
                            children: []
                            pos: 3024
                            length: 3
                        children: []
                        pos: 3005
                        length: 22
                    children: []
                    pos: 3004
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: 'throw new IllegalArgumentException("Invalid input: JSON
                        Pointer expression must start with ''/'': "+"\""+input+"\"");'
                    children: []
                    pos: 3043
                    length: 115
                  pos: 3029
                  length: 139
                pos: 3001
                length: 167
              - type: return_statement
                fields:
                  text: return _parseTail(input);
                children: []
                pos: 3177
                length: 25
              pos: 2798
              length: 410
          children: []
          pos: 2714
          length: 494
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: valueOf
              children: []
              pos: 3372
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 3380
                length: 12
              pos: 3346
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return compile(input);
                children: []
                pos: 3396
                length: 22
              pos: 3394
              length: 26
          children: []
          pos: 3346
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matches
              children: []
              pos: 4187
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4172
              length: 57
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _nextSegment == null;
                children: []
                pos: 4199
                length: 28
              pos: 4197
              length: 32
          children: []
          pos: 4172
          length: 57
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchingProperty
              children: []
              pos: 4248
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4234
              length: 69
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingPropertyName;
                children: []
                pos: 4272
                length: 29
              pos: 4270
              length: 33
          children: []
          pos: 4234
          length: 69
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchingIndex
              children: []
              pos: 4319
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4308
              length: 63
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingElementIndex;
                children: []
                pos: 4340
                length: 29
              pos: 4338
              length: 33
          children: []
          pos: 4308
          length: 63
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mayMatchProperty
              children: []
              pos: 4391
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4376
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingPropertyName != null;
                children: []
                pos: 4412
                length: 37
              pos: 4410
              length: 41
          children: []
          pos: 4376
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: mayMatchElement
              children: []
              pos: 4471
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4456
              length: 71
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _matchingElementIndex >= 0;
                children: []
                pos: 4491
                length: 34
              pos: 4489
              length: 38
          children: []
          pos: 4456
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matchProperty
              children: []
              pos: 4552
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String name
                children: []
                pos: 4566
                length: 11
              pos: 4533
              length: 192
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: _nextSegment
                                children: []
                                pos: 4593
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4609
                                length: 4
                            children: []
                            pos: 4593
                            length: 20
                          right:
                            type: unary_expression
                            fields:
                              text: "!_matchingPropertyName.equals(name)"
                            children: []
                            pos: 4617
                            length: 35
                        children: []
                        pos: 4593
                        length: 59
                    children: []
                    pos: 4592
                    length: 61
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 4668
                    length: 12
                  pos: 4654
                  length: 36
                pos: 4589
                length: 101
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 4699
                length: 20
              pos: 4579
              length: 146
          children: []
          pos: 4533
          length: 192
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matchElement
              children: []
              pos: 4750
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 4764
                length: 9
              pos: 4731
              length: 178
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: index
                                    children: []
                                    pos: 4790
                                    length: 5
                                  right:
                                    type: identifier
                                    fields:
                                      text: _matchingElementIndex
                                    children: []
                                    pos: 4799
                                    length: 21
                                children: []
                                pos: 4790
                                length: 30
                            children: []
                            pos: 4789
                            length: 32
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: less_than
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: index
                                    children: []
                                    pos: 4826
                                    length: 5
                                  right:
                                    type: decimal_integer_literal
                                    fields:
                                      text: '0'
                                    children: []
                                    pos: 4834
                                    length: 1
                                children: []
                                pos: 4826
                                length: 9
                            children: []
                            pos: 4825
                            length: 11
                        children: []
                        pos: 4789
                        length: 47
                    children: []
                    pos: 4788
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 4852
                    length: 12
                  pos: 4838
                  length: 36
                pos: 4785
                length: 89
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 4883
                length: 20
              pos: 4775
              length: 134
          children: []
          pos: 4731
          length: 178
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: tail
              children: []
              pos: 5089
              length: 4
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5070
              length: 62
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _nextSegment;
                children: []
                pos: 5106
                length: 20
              pos: 5096
              length: 36
          children: []
          pos: 5070
          length: 62
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 5343
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5319
              length: 56
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _asString;
                children: []
                pos: 5356
                length: 17
              pos: 5354
              length: 21
          children: []
          pos: 5319
          length: 56
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hashCode
              children: []
              pos: 5401
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5380
              length: 64
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _asString.hashCode();
                children: []
                pos: 5414
                length: 28
              pos: 5412
              length: 32
          children: []
          pos: 5380
          length: 64
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 5475
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 5482
                length: 8
              pos: 5450
              length: 239
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5506
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 5511
                            length: 4
                        children: []
                        pos: 5506
                        length: 9
                    children: []
                    pos: 5505
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 5517
                  length: 12
                pos: 5502
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5542
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5547
                            length: 4
                        children: []
                        pos: 5542
                        length: 9
                    children: []
                    pos: 5541
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5553
                  length: 13
                pos: 5538
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(o instanceof JsonPointer)"
                        children: []
                        pos: 5579
                        length: 27
                    children: []
                    pos: 5578
                    length: 29
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5608
                  length: 13
                pos: 5575
                length: 46
              - type: return_statement
                fields:
                  text: return _asString.equals(((JsonPointer) o)._asString);
                children: []
                pos: 5630
                length: 53
              pos: 5492
              length: 197
          children: []
          pos: 5450
          length: 239
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseIndex
              children: []
              pos: 5892
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 5904
                length: 10
              pos: 5867
              length: 672
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int len = str.length();
                children: []
                pos: 5926
                length: 29
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: len
                                children: []
                                pos: 6102
                                length: 3
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '0'
                                children: []
                                pos: 6109
                                length: 1
                            children: []
                            pos: 6102
                            length: 8
                          right:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: len
                                children: []
                                pos: 6114
                                length: 3
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '10'
                                children: []
                                pos: 6120
                                length: 2
                            children: []
                            pos: 6114
                            length: 8
                        children: []
                        pos: 6102
                        length: 20
                    children: []
                    pos: 6101
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return -1;
                    children: []
                    pos: 6138
                    length: 10
                  pos: 6124
                  length: 34
                pos: 6098
                length: 60
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < len; ++i) {
                                char c = str.charAt(i++);
                                if (c > '9' || c < '0') {
                                    return -1;
                                }
                            }
                children: []
                pos: 6167
                length: 158
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: len
                            children: []
                            pos: 6338
                            length: 3
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '10'
                            children: []
                            pos: 6345
                            length: 2
                        children: []
                        pos: 6338
                        length: 9
                    children: []
                    pos: 6337
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: long l = NumberInput.parseLong(str);
                    children: []
                    pos: 6363
                    length: 36
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: greater_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: l
                                children: []
                                pos: 6416
                                length: 1
                              right:
                                type: field_access
                                fields:
                                  text: Integer.MAX_VALUE
                                children: []
                                pos: 6420
                                length: 17
                            children: []
                            pos: 6416
                            length: 21
                        children: []
                        pos: 6415
                        length: 23
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return -1;
                        children: []
                        pos: 6457
                        length: 10
                      pos: 6439
                      length: 42
                    pos: 6412
                    length: 69
                  pos: 6349
                  length: 142
                pos: 6334
                length: 157
              - type: return_statement
                fields:
                  text: return NumberInput.parseInt(str);
                children: []
                pos: 6500
                length: 33
              pos: 5916
              length: 623
          children: []
          pos: 5867
          length: 672
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseTail
              children: []
              pos: 6578
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 6589
                length: 12
              pos: 6549
              length: 771
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int end = input.length();
                children: []
                pos: 6613
                length: 31
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 1; i < end; ) {
                                char c = input.charAt(i);
                                if (c == '/') { // common case, got a segment
                                    return new JsonPointer(input, input.substring(1, i),
                                            _parseTail(input.substring(i)));
                                }
                                ++i;
                                // quoting is different; offline this case
                                if (c == '~' && i < end) { // possibly, quote
                                    return _parseQuotedTail(input, i);
                                }
                                // otherwise, loop on
                            }
                children: []
                pos: 6706
                length: 503
              - type: return_statement
                fields:
                  text: return new JsonPointer(input, input.substring(1), EMPTY);
                children: []
                pos: 7257
                length: 57
              pos: 6603
              length: 717
          children: []
          pos: 6549
          length: 771
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _parseQuotedTail
              children: []
              pos: 7595
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String input
                children: []
                pos: 7612
                length: 12
              pos: 7566
              length: 849
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final int end = input.length();
                children: []
                pos: 7643
                length: 31
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder(Math.max(16, end));
                children: []
                pos: 7683
                length: 56
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: i
                            children: []
                            pos: 7752
                            length: 1
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '2'
                            children: []
                            pos: 7756
                            length: 1
                        children: []
                        pos: 7752
                        length: 5
                    children: []
                    pos: 7751
                    length: 7
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: sb.append(input, 1, i-1);
                    children: []
                    pos: 7773
                    length: 25
                  pos: 7759
                  length: 49
                pos: 7748
                length: 60
              - type: expression_statement
                fields:
                  text: _appendEscape(sb, input.charAt(i++));
                children: []
                pos: 7817
                length: 37
              - type: while_statement
                fields:
                  text: |-
                    while (i < end) {
                                char c = input.charAt(i);
                                if (c == '/') { // end is nigh!
                                    return new JsonPointer(input, sb.toString(),
                                            _parseTail(input.substring(i))); // need to push back slash
                                }
                                ++i;
                                if (c == '~' && i < end) {
                                    _appendEscape(sb, input.charAt(i++));
                                    continue;
                                }
                                sb.append(c);
                            }
                children: []
                pos: 7863
                length: 444
              - type: return_statement
                fields:
                  text: return new JsonPointer(input, sb.toString(), EMPTY);
                children: []
                pos: 8357
                length: 52
              pos: 7633
              length: 782
          children: []
          pos: 7566
          length: 849
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _appendEscape
              children: []
              pos: 8445
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 8459
                length: 16
              pos: 8425
              length: 241
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: c
                            children: []
                            pos: 8499
                            length: 1
                          right:
                            type: character_literal
                            fields:
                              text: "'0'"
                            children: []
                            pos: 8504
                            length: 3
                        children: []
                        pos: 8499
                        length: 8
                    children: []
                    pos: 8498
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: c = '~';
                    children: []
                    pos: 8523
                    length: 8
                  pos: 8509
                  length: 32
                pos: 8495
                length: 143
              - type: expression_statement
                fields:
                  text: sb.append(c);
                children: []
                pos: 8647
                length: 13
              pos: 8485
              length: 181
          children: []
          pos: 8425
          length: 241
        pos: 574
        length: 8094
    children: []
    pos: 574
    length: 8094
  pos: 0
  length: 8669
text_diff: |
  --- before
  +++ after
  @@ -190,7 +190,7 @@
               return -1;
           }
           for (int i = 0; i < len; ++i) {
  -            char c = str.charAt(i);
  +            char c = str.charAt(i++);
               if (c > '9' || c < '0') {
                   return -1;
               }
tree_diff: |+
  New cluster:
  UPDATE from for (int i = 0; i < len; ++i) {
              char c = str.charAt(i);
              if (c > '9' || c < '0') {
                  return -1;
              }
          } to for (int i = 0; i < len; ++i) {
              char c = str.charAt(i++);
              if (c > '9' || c < '0') {
                  return -1;
              }
          }
  ------------
  ===
  update-node
  ---
  for_statement: for (int i = 0; i < len; ++i) {
              char c = str.charAt(i);
              if (c > '9' || c < '0') {
                  return -1;
              }
          } [6167,6323]
  replace for (int i = 0; i < len; ++i) {
              char c = str.charAt(i);
              if (c > '9' || c < '0') {
                  return -1;
              }
          } by for (int i = 0; i < len; ++i) {
              char c = str.charAt(i++);
              if (c > '9' || c < '0') {
                  return -1;
              }
          }

...
