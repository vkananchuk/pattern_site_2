---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: DateUtils
        children: []
        pos: 1483
        length: 9
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: public static final TimeZone UTC_TIME_ZONE = TimeZone.getTimeZone("GMT");
          children: []
          pos: 1574
          length: 73
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_SECOND = 1000;
          children: []
          pos: 1738
          length: 50
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_MINUTE = 60 * MILLIS_PER_SECOND;
          children: []
          pos: 1879
          length: 68
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_HOUR = 60 * MILLIS_PER_MINUTE;
          children: []
          pos: 2036
          length: 66
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_DAY = 24 * MILLIS_PER_HOUR;
          children: []
          pos: 2190
          length: 63
        - type: field_declaration
          fields:
            text: public final static int SEMI_MONTH = 1001;
          children: []
          pos: 2388
          length: 42
        - type: field_declaration
          fields:
            text: "private static final int[][] fields = {\n            {Calendar.MILLISECOND},\n
              \           {Calendar.SECOND},\n            {Calendar.MINUTE},\n            {Calendar.HOUR_OF_DAY,
              Calendar.HOUR},\n            {Calendar.DATE, Calendar.DAY_OF_MONTH,
              Calendar.AM_PM \n                /* Calendar.DAY_OF_YEAR, Calendar.DAY_OF_WEEK,
              Calendar.DAY_OF_WEEK_IN_MONTH */\n            },\n            {Calendar.MONTH,
              DateUtils.SEMI_MONTH},\n            {Calendar.YEAR},\n            {Calendar.ERA}};"
          children: []
          pos: 2436
          length: 476
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_SUNDAY = 1;
          children: []
          pos: 2975
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_MONDAY = 2;
          children: []
          pos: 3084
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_RELATIVE = 3;
          children: []
          pos: 3202
          length: 48
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_CENTER = 4;
          children: []
          pos: 3326
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_MONTH_SUNDAY = 5;
          children: []
          pos: 3445
          length: 47
        - type: field_declaration
          fields:
            text: public final static int RANGE_MONTH_MONDAY = 6;
          children: []
          pos: 3565
          length: 47
        - type: constructor_declaration
          fields:
            text: |-
              public DateUtils() {
                      super();
                  }
          children: []
          pos: 3935
          length: 43
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameDay
              children: []
              pos: 4603
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date1
                children: []
                pos: 4613
                length: 10
              pos: 4581
              length: 388
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date1
                                children: []
                                pos: 4651
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4660
                                length: 4
                            children: []
                            pos: 4651
                            length: 13
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date2
                                children: []
                                pos: 4668
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4677
                                length: 4
                            children: []
                            pos: 4668
                            length: 13
                        children: []
                        pos: 4651
                        length: 30
                    children: []
                    pos: 4650
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 4697
                    length: 64
                  pos: 4683
                  length: 88
                pos: 4647
                length: 124
              - type: local_variable_declaration
                fields:
                  text: Calendar cal1 = Calendar.getInstance();
                children: []
                pos: 4780
                length: 39
              - type: expression_statement
                fields:
                  text: cal1.setTime(date1);
                children: []
                pos: 4828
                length: 20
              - type: local_variable_declaration
                fields:
                  text: Calendar cal2 = Calendar.getInstance();
                children: []
                pos: 4857
                length: 39
              - type: expression_statement
                fields:
                  text: cal2.setTime(date2);
                children: []
                pos: 4905
                length: 20
              - type: return_statement
                fields:
                  text: return isSameDay(cal1, cal2);
                children: []
                pos: 4934
                length: 29
              pos: 4637
              length: 332
          children: []
          pos: 4581
          length: 388
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameDay
              children: []
              pos: 5530
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 5540
                length: 13
              pos: 5508
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 5584
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 5592
                                length: 4
                            children: []
                            pos: 5584
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 5600
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 5608
                                length: 4
                            children: []
                            pos: 5600
                            length: 12
                        children: []
                        pos: 5584
                        length: 28
                    children: []
                    pos: 5583
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 5628
                    length: 64
                  pos: 5614
                  length: 88
                pos: 5580
                length: 122
              - type: return_statement
                fields:
                  text: |-
                    return (cal1.get(Calendar.ERA) == cal2.get(Calendar.ERA) &&
                                    cal1.get(Calendar.YEAR) == cal2.get(Calendar.YEAR) &&
                                    cal1.get(Calendar.DAY_OF_YEAR) == cal2.get(Calendar.DAY_OF_YEAR));
                children: []
                pos: 5711
                length: 212
              pos: 5570
              length: 359
          children: []
          pos: 5508
          length: 421
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameInstant
              children: []
              pos: 6504
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date1
                children: []
                pos: 6518
                length: 10
              pos: 6482
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date1
                                children: []
                                pos: 6556
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 6565
                                length: 4
                            children: []
                            pos: 6556
                            length: 13
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date2
                                children: []
                                pos: 6573
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 6582
                                length: 4
                            children: []
                            pos: 6573
                            length: 13
                        children: []
                        pos: 6556
                        length: 30
                    children: []
                    pos: 6555
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 6602
                    length: 64
                  pos: 6588
                  length: 88
                pos: 6552
                length: 124
              - type: return_statement
                fields:
                  text: return date1.getTime() == date2.getTime();
                children: []
                pos: 6685
                length: 42
              pos: 6542
              length: 191
          children: []
          pos: 6482
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameInstant
              children: []
              pos: 7240
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 7254
                length: 13
              pos: 7218
              length: 273
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 7298
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 7306
                                length: 4
                            children: []
                            pos: 7298
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 7314
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 7322
                                length: 4
                            children: []
                            pos: 7314
                            length: 12
                        children: []
                        pos: 7298
                        length: 28
                    children: []
                    pos: 7297
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 7342
                    length: 64
                  pos: 7328
                  length: 88
                pos: 7294
                length: 122
              - type: return_statement
                fields:
                  text: return cal1.getTime().getTime() == cal2.getTime().getTime();
                children: []
                pos: 7425
                length: 60
              pos: 7284
              length: 207
          children: []
          pos: 7218
          length: 273
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameLocalTime
              children: []
              pos: 8140
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 8156
                length: 13
              pos: 8118
              length: 783
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 8200
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 8208
                                length: 4
                            children: []
                            pos: 8200
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 8216
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 8224
                                length: 4
                            children: []
                            pos: 8216
                            length: 12
                        children: []
                        pos: 8200
                        length: 28
                    children: []
                    pos: 8199
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 8244
                    length: 64
                  pos: 8230
                  length: 88
                pos: 8196
                length: 122
              - type: return_statement
                fields:
                  text: |-
                    return (cal1.get(Calendar.MILLISECOND) == cal2.get(Calendar.MILLISECOND) &&
                                    cal1.get(Calendar.SECOND) == cal2.get(Calendar.SECOND) &&
                                    cal1.get(Calendar.MINUTE) == cal2.get(Calendar.MINUTE) &&
                                    cal1.get(Calendar.HOUR) == cal2.get(Calendar.HOUR) &&
                                    cal1.get(Calendar.DAY_OF_YEAR) == cal2.get(Calendar.DAY_OF_YEAR) &&
                                    cal1.get(Calendar.YEAR) == cal2.get(Calendar.YEAR) &&
                                    cal1.get(Calendar.ERA) == cal2.get(Calendar.ERA) &&
                                    cal1.getClass() == cal2.getClass());
                children: []
                pos: 8327
                length: 568
              pos: 8186
              length: 715
          children: []
          pos: 8118
          length: 783
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parseDate
              children: []
              pos: 9664
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 9674
                length: 10
              pos: 9645
              length: 849
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: str
                                children: []
                                pos: 9746
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 9753
                                length: 4
                            children: []
                            pos: 9746
                            length: 11
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: parsePatterns
                                children: []
                                pos: 9761
                                length: 13
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 9778
                                length: 4
                            children: []
                            pos: 9761
                            length: 21
                        children: []
                        pos: 9746
                        length: 36
                    children: []
                    pos: 9745
                    length: 38
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Date and Patterns
                        must not be null");
                    children: []
                    pos: 9798
                    length: 73
                  pos: 9784
                  length: 97
                pos: 9742
                length: 139
              - type: local_variable_declaration
                fields:
                  text: SimpleDateFormat parser = null;
                children: []
                pos: 9899
                length: 31
              - type: local_variable_declaration
                fields:
                  text: ParsePosition pos = new ParsePosition(0);
                children: []
                pos: 9939
                length: 41
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < parsePatterns.length; i++) {
                                if (i == 0) {
                                    parser = new SimpleDateFormat(parsePatterns[0]);
                                } else {
                                    parser.applyPattern(parsePatterns[i]);
                                }
                                pos.setIndex(0);
                                Date date = parser.parse(str, pos);
                                if (date != null && pos.getIndex() == str.length()) {
                                    return date;
                                }
                            }
                children: []
                pos: 9989
                length: 425
              - type: throw_statement
                fields:
                  text: 'throw new ParseException("Unable to parse the date: " + str,
                    -1);'
                children: []
                pos: 10423
                length: 65
              pos: 9732
              length: 762
          children: []
          pos: 9645
          length: 849
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addYears
              children: []
              pos: 10943
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 10952
                length: 9
              pos: 10924
              length: 107
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.YEAR, amount);
                children: []
                pos: 10985
                length: 40
              pos: 10975
              length: 56
          children: []
          pos: 10924
          length: 107
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMonths
              children: []
              pos: 11481
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 11491
                length: 9
              pos: 11462
              length: 109
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MONTH, amount);
                children: []
                pos: 11524
                length: 41
              pos: 11514
              length: 57
          children: []
          pos: 11462
          length: 109
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addWeeks
              children: []
              pos: 12020
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 12029
                length: 9
              pos: 12001
              length: 115
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.WEEK_OF_YEAR, amount);
                children: []
                pos: 12062
                length: 48
              pos: 12052
              length: 64
          children: []
          pos: 12001
          length: 115
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addDays
              children: []
              pos: 12564
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 12572
                length: 9
              pos: 12545
              length: 114
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.DAY_OF_MONTH, amount);
                children: []
                pos: 12605
                length: 48
              pos: 12595
              length: 64
          children: []
          pos: 12545
          length: 114
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addHours
              children: []
              pos: 13108
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 13117
                length: 9
              pos: 13089
              length: 114
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.HOUR_OF_DAY, amount);
                children: []
                pos: 13150
                length: 47
              pos: 13140
              length: 63
          children: []
          pos: 13089
          length: 114
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMinutes
              children: []
              pos: 13654
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 13665
                length: 9
              pos: 13635
              length: 111
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MINUTE, amount);
                children: []
                pos: 13698
                length: 42
              pos: 13688
              length: 58
          children: []
          pos: 13635
          length: 111
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addSeconds
              children: []
              pos: 14197
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 14208
                length: 9
              pos: 14178
              length: 111
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.SECOND, amount);
                children: []
                pos: 14241
                length: 42
              pos: 14231
              length: 58
          children: []
          pos: 14178
          length: 111
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMilliseconds
              children: []
              pos: 14745
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 14761
                length: 9
              pos: 14726
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MILLISECOND, amount);
                children: []
                pos: 14794
                length: 47
              pos: 14784
              length: 63
          children: []
          pos: 14726
          length: 121
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: add
              children: []
              pos: 15336
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 15340
                length: 9
              pos: 15317
              length: 323
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 15396
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 15404
                            length: 4
                        children: []
                        pos: 15396
                        length: 12
                    children: []
                    pos: 15395
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 15424
                    length: 64
                  pos: 15410
                  length: 88
                pos: 15392
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar c = Calendar.getInstance();
                children: []
                pos: 15507
                length: 36
              - type: expression_statement
                fields:
                  text: c.setTime(date);
                children: []
                pos: 15552
                length: 16
              - type: expression_statement
                fields:
                  text: c.add(calendarField, amount);
                children: []
                pos: 15577
                length: 29
              - type: return_statement
                fields:
                  text: return c.getTime();
                children: []
                pos: 15615
                length: 19
              pos: 15382
              length: 258
          children: []
          pos: 15317
          length: 323
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 17037
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 17043
                length: 9
              pos: 17018
              length: 311
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 17079
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17087
                            length: 4
                        children: []
                        pos: 17079
                        length: 12
                    children: []
                    pos: 17078
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 17107
                    length: 64
                  pos: 17093
                  length: 88
                pos: 17075
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 17190
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(date);
                children: []
                pos: 17238
                length: 19
              - type: expression_statement
                fields:
                  text: modify(gval, field, true);
                children: []
                pos: 17266
                length: 26
              - type: return_statement
                fields:
                  text: return gval.getTime();
                children: []
                pos: 17301
                length: 22
              pos: 17065
              length: 264
          children: []
          pos: 17018
          length: 311
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 18673
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar date
                children: []
                pos: 18679
                length: 13
              pos: 18650
              length: 291
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 18719
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 18727
                            length: 4
                        children: []
                        pos: 18719
                        length: 12
                    children: []
                    pos: 18718
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 18747
                    length: 64
                  pos: 18733
                  length: 88
                pos: 18715
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar rounded = (Calendar) date.clone();
                children: []
                pos: 18830
                length: 43
              - type: expression_statement
                fields:
                  text: modify(rounded, field, true);
                children: []
                pos: 18882
                length: 29
              - type: return_statement
                fields:
                  text: return rounded;
                children: []
                pos: 18920
                length: 15
              pos: 18705
              length: 236
          children: []
          pos: 18650
          length: 291
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 20398
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object date
                children: []
                pos: 20404
                length: 11
              pos: 20379
              length: 456
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 20442
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20450
                            length: 4
                        children: []
                        pos: 20442
                        length: 12
                    children: []
                    pos: 20441
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 20470
                    length: 64
                  pos: 20456
                  length: 88
                pos: 20438
                length: 106
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: date instanceof Date
                        children: []
                        pos: 20557
                        length: 20
                    children: []
                    pos: 20556
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return round((Date) date, field);
                    children: []
                    pos: 20593
                    length: 33
                  pos: 20579
                  length: 57
                pos: 20553
                length: 276
              pos: 20428
              length: 407
          children: []
          pos: 20379
          length: 456
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 21616
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 21625
                length: 9
              pos: 21597
              length: 315
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 21661
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21669
                            length: 4
                        children: []
                        pos: 21661
                        length: 12
                    children: []
                    pos: 21660
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 21689
                    length: 64
                  pos: 21675
                  length: 88
                pos: 21657
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 21772
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(date);
                children: []
                pos: 21820
                length: 19
              - type: expression_statement
                fields:
                  text: modify(gval, field, false);
                children: []
                pos: 21848
                length: 27
              - type: return_statement
                fields:
                  text: return gval.getTime();
                children: []
                pos: 21884
                length: 22
              pos: 21647
              length: 265
          children: []
          pos: 21597
          length: 315
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 22640
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar date
                children: []
                pos: 22649
                length: 13
              pos: 22617
              length: 301
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 22689
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 22697
                            length: 4
                        children: []
                        pos: 22689
                        length: 12
                    children: []
                    pos: 22688
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 22717
                    length: 64
                  pos: 22703
                  length: 88
                pos: 22685
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar truncated = (Calendar) date.clone();
                children: []
                pos: 22800
                length: 45
              - type: expression_statement
                fields:
                  text: modify(truncated, field, false);
                children: []
                pos: 22854
                length: 32
              - type: return_statement
                fields:
                  text: return truncated;
                children: []
                pos: 22895
                length: 17
              pos: 22675
              length: 243
          children: []
          pos: 22617
          length: 301
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 23801
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object date
                children: []
                pos: 23810
                length: 11
              pos: 23782
              length: 468
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 23848
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23856
                            length: 4
                        children: []
                        pos: 23848
                        length: 12
                    children: []
                    pos: 23847
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 23876
                    length: 64
                  pos: 23862
                  length: 88
                pos: 23844
                length: 106
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: date instanceof Date
                        children: []
                        pos: 23963
                        length: 20
                    children: []
                    pos: 23962
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return truncate((Date) date, field);
                    children: []
                    pos: 23999
                    length: 36
                  pos: 23985
                  length: 60
                pos: 23959
                length: 285
              pos: 23834
              length: 416
          children: []
          pos: 23782
          length: 468
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: modify
              children: []
              pos: 24614
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar val
                children: []
                pos: 24621
                length: 12
              pos: 24594
              length: 5206
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: val.get(Calendar.YEAR)
                            children: []
                            pos: 24675
                            length: 22
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '280000000'
                            children: []
                            pos: 24700
                            length: 9
                        children: []
                        pos: 24675
                        length: 34
                    children: []
                    pos: 24674
                    length: 36
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new ArithmeticException("Calendar value too large
                        for accurate calculations");
                    children: []
                    pos: 24725
                    length: 84
                  pos: 24711
                  length: 108
                pos: 24671
                length: 148
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: field
                            children: []
                            pos: 24841
                            length: 5
                          right:
                            type: field_access
                            fields:
                              text: Calendar.MILLISECOND
                            children: []
                            pos: 24850
                            length: 20
                        children: []
                        pos: 24841
                        length: 29
                    children: []
                    pos: 24840
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 24886
                    length: 7
                  pos: 24872
                  length: 31
                pos: 24837
                length: 66
              - type: local_variable_declaration
                fields:
                  text: Date date = val.getTime();
                children: []
                pos: 25186
                length: 26
              - type: local_variable_declaration
                fields:
                  text: long time = date.getTime();
                children: []
                pos: 25221
                length: 27
              - type: local_variable_declaration
                fields:
                  text: boolean done = false;
                children: []
                pos: 25257
                length: 21
              - type: local_variable_declaration
                fields:
                  text: int millisecs = val.get(Calendar.MILLISECOND);
                children: []
                pos: 25321
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!round"
                            children: []
                            pos: 25380
                            length: 6
                          right:
                            type: less_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: millisecs
                                children: []
                                pos: 25390
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '500'
                                children: []
                                pos: 25402
                                length: 3
                            children: []
                            pos: 25390
                            length: 15
                        children: []
                        pos: 25380
                        length: 25
                    children: []
                    pos: 25379
                    length: 27
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - millisecs;
                    children: []
                    pos: 25421
                    length: 24
                  pos: 25407
                  length: 48
                pos: 25376
                length: 79
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: field
                            children: []
                            pos: 25468
                            length: 5
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SECOND
                            children: []
                            pos: 25477
                            length: 15
                        children: []
                        pos: 25468
                        length: 24
                    children: []
                    pos: 25467
                    length: 26
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: done = true;
                    children: []
                    pos: 25508
                    length: 12
                  pos: 25494
                  length: 36
                pos: 25464
                length: 66
              - type: local_variable_declaration
                fields:
                  text: int seconds = val.get(Calendar.SECOND);
                children: []
                pos: 25568
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!done"
                            children: []
                            pos: 25620
                            length: 5
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!round"
                                    children: []
                                    pos: 25630
                                    length: 6
                                  right:
                                    type: less_than
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: seconds
                                        children: []
                                        pos: 25640
                                        length: 7
                                      right:
                                        type: decimal_integer_literal
                                        fields:
                                          text: '30'
                                        children: []
                                        pos: 25650
                                        length: 2
                                    children: []
                                    pos: 25640
                                    length: 12
                                children: []
                                pos: 25630
                                length: 22
                            children: []
                            pos: 25629
                            length: 24
                        children: []
                        pos: 25620
                        length: 33
                    children: []
                    pos: 25619
                    length: 35
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - (seconds * 1000L);
                    children: []
                    pos: 25669
                    length: 32
                  pos: 25655
                  length: 56
                pos: 25616
                length: 95
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: field
                            children: []
                            pos: 25724
                            length: 5
                          right:
                            type: field_access
                            fields:
                              text: Calendar.MINUTE
                            children: []
                            pos: 25733
                            length: 15
                        children: []
                        pos: 25724
                        length: 24
                    children: []
                    pos: 25723
                    length: 26
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: done = true;
                    children: []
                    pos: 25764
                    length: 12
                  pos: 25750
                  length: 36
                pos: 25720
                length: 66
              - type: local_variable_declaration
                fields:
                  text: int minutes = val.get(Calendar.MINUTE);
                children: []
                pos: 25824
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!done"
                            children: []
                            pos: 25876
                            length: 5
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!round"
                                    children: []
                                    pos: 25886
                                    length: 6
                                  right:
                                    type: less_than
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: minutes
                                        children: []
                                        pos: 25896
                                        length: 7
                                      right:
                                        type: decimal_integer_literal
                                        fields:
                                          text: '30'
                                        children: []
                                        pos: 25906
                                        length: 2
                                    children: []
                                    pos: 25896
                                    length: 12
                                children: []
                                pos: 25886
                                length: 22
                            children: []
                            pos: 25885
                            length: 24
                        children: []
                        pos: 25876
                        length: 33
                    children: []
                    pos: 25875
                    length: 35
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - (minutes * 60000L);
                    children: []
                    pos: 25925
                    length: 33
                  pos: 25911
                  length: 57
                pos: 25872
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: date.getTime()
                            children: []
                            pos: 26004
                            length: 14
                          right:
                            type: identifier
                            fields:
                              text: time
                            children: []
                            pos: 26022
                            length: 4
                        children: []
                        pos: 26004
                        length: 22
                    children: []
                    pos: 26003
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: date.setTime(time);
                    children: []
                    pos: 26042
                    length: 19
                  - type: expression_statement
                    fields:
                      text: val.setTime(date);
                    children: []
                    pos: 26074
                    length: 18
                  pos: 26028
                  length: 74
                pos: 26000
                length: 102
              - type: local_variable_declaration
                fields:
                  text: boolean roundUp = false;
                children: []
                pos: 26202
                length: 24
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < fields.length; i++) {
                                for (int j = 0; j < fields[i].length; j++) {
                                    if (fields[i][j] == field) {
                                        //This is our field... we stop looping
                                        if (round && roundUp) {
                                            if (field == DateUtils.SEMI_MONTH) {
                                                //This is a special case that's hard to generalize
                                                //If the date is 1, we round up to 16, otherwise
                                                //  we subtract 15 days and add 1 month
                                                if (val.get(Calendar.DATE) == 1) {
                                                    val.add(Calendar.DATE, 15);
                                                } else {
                                                    val.add(Calendar.DATE, -15);
                                                    val.add(Calendar.MONTH, 1);
                                                }
                                            } else {
                                                //We need at add one to this field since the
                                                //  last number causes us to round up
                                                val.add(fields[i][0], 1);
                                            }
                                        }
                                        return;
                                    }
                                }
                                //We have various fields that are not easy roundings
                                int offset = 0;
                                boolean offsetSet = false;
                                //These are special types of fields that require different rounding rules
                                switch (field) {
                                    case DateUtils.SEMI_MONTH:
                                        if (fields[i][0] == Calendar.DATE) {
                                            //If we're going to drop the DATE field's value,
                                            //  we want to do this our own way.
                                            //We need to subtrace 1 since the date has a minimum of 1
                                            offset = val.get(Calendar.DATE) - 1;
                                            //If we're above 15 days adjustment, that means we're in the
                                            //  bottom half of the month and should stay accordingly.
                                            if (offset >= 15) {
                                                offset -= 15;
                                            }
                                            //Record whether we're in the top or bottom half of that range
                                            roundUp = offset > 7;
                                            offsetSet = true;
                                        }
                                        break;
                                    case Calendar.AM_PM:
                                        if (fields[i][0] == Calendar.HOUR_OF_DAY) {
                                            //If we're going to drop the HOUR field's value,
                                            //  we want to do this our own way.
                                            offset = val.get(Calendar.HOUR_OF_DAY);
                                            if (offset >= 12) {
                                                offset -= 12;
                                            }
                                            roundUp = offset > 6;
                                            offsetSet = true;
                                        }
                                        break;
                                }
                                if (!offsetSet) {
                                    int min = val.getActualMinimum(fields[i][0]);
                                    int max = val.getActualMaximum(fields[i][0]);
                                    //Calculate the offset from the minimum allowed value
                                    offset = val.get(fields[i][0]) - min;
                                    //Set roundUp if this is more than half way between the minimum and maximum
                                    roundUp = offset > ((max - min) / 2);
                                }
                                //We need to remove this field
                                if (offset != 0) {
                                    val.set(fields[i][0], val.get(fields[i][0]) - offset);
                                }
                            }
                children: []
                pos: 26235
                length: 3470
              - type: throw_statement
                fields:
                  text: throw new IllegalArgumentException("The field " + field +
                    " is not supported");
                children: []
                pos: 29714
                length: 79
              pos: 24661
              length: 5139
          children: []
          pos: 24594
          length: 5206
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 31120
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date focus
                children: []
                pos: 31129
                length: 10
              pos: 31097
              length: 303
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 31171
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 31180
                            length: 4
                        children: []
                        pos: 31171
                        length: 13
                    children: []
                    pos: 31170
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 31200
                    length: 64
                  pos: 31186
                  length: 88
                pos: 31167
                length: 107
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 31283
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(focus);
                children: []
                pos: 31331
                length: 20
              - type: return_statement
                fields:
                  text: return iterator(gval, rangeStyle);
                children: []
                pos: 31360
                length: 34
              pos: 31157
              length: 243
          children: []
          pos: 31097
          length: 303
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 32591
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar focus
                children: []
                pos: 32600
                length: 14
              pos: 32568
              length: 2864
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 32646
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 32655
                            length: 4
                        children: []
                        pos: 32646
                        length: 13
                    children: []
                    pos: 32645
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 32675
                    length: 64
                  pos: 32661
                  length: 88
                pos: 32642
                length: 107
              - type: local_variable_declaration
                fields:
                  text: Calendar start = null;
                children: []
                pos: 32758
                length: 22
              - type: local_variable_declaration
                fields:
                  text: Calendar end = null;
                children: []
                pos: 32789
                length: 20
              - type: local_variable_declaration
                fields:
                  text: int startCutoff = Calendar.SUNDAY;
                children: []
                pos: 32818
                length: 34
              - type: local_variable_declaration
                fields:
                  text: int endCutoff = Calendar.SATURDAY;
                children: []
                pos: 32861
                length: 34
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: rangeStyle
                        children: []
                        pos: 32912
                        length: 10
                    children: []
                    pos: 32911
                    length: 12
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                                    case RANGE_MONTH_SUNDAY:
                                    case RANGE_MONTH_MONDAY:
                                        //Set start to the first of the month
                                        start = truncate(focus, Calendar.MONTH);
                                        //Set end to the last of the month
                                        end = (Calendar) start.clone();
                                        end.add(Calendar.MONTH, 1);
                                        end.add(Calendar.DATE, -1);
                                        //Loop start back to the previous sunday or monday
                                        if (rangeStyle == RANGE_MONTH_MONDAY) {
                                            startCutoff = Calendar.MONDAY;
                                            endCutoff = Calendar.SUNDAY;
                                        }
                                        break;
                                    case RANGE_WEEK_SUNDAY:
                                    case RANGE_WEEK_MONDAY:
                                    case RANGE_WEEK_RELATIVE:
                                    case RANGE_WEEK_CENTER:
                                        //Set start and end to the current date
                                        start = truncate(focus, Calendar.DATE);
                                        end = truncate(focus, Calendar.DATE);
                                        switch (rangeStyle) {
                                            case RANGE_WEEK_SUNDAY:
                                                //already set by default
                                                break;
                                            case RANGE_WEEK_MONDAY:
                                                startCutoff = Calendar.MONDAY;
                                                endCutoff = Calendar.SUNDAY;
                                                break;
                                            case RANGE_WEEK_RELATIVE:
                                                startCutoff = focus.get(Calendar.DAY_OF_WEEK);
                                                endCutoff = startCutoff - 1;
                                                break;
                                            case RANGE_WEEK_CENTER:
                                                startCutoff = focus.get(Calendar.DAY_OF_WEEK) - 3;
                                                endCutoff = focus.get(Calendar.DAY_OF_WEEK) + 3;
                                                break;
                                        }
                                        break;
                                    default:
                                        throw new IllegalArgumentException("The range style " + rangeStyle + " is not valid.");
                                }
                    children: []
                    pos: 32924
                    length: 1894
                children: []
                pos: 32904
                length: 1914
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: startCutoff
                            children: []
                            pos: 34831
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SUNDAY
                            children: []
                            pos: 34845
                            length: 15
                        children: []
                        pos: 34831
                        length: 29
                    children: []
                    pos: 34830
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: startCutoff += 7;
                    children: []
                    pos: 34876
                    length: 17
                  pos: 34862
                  length: 41
                pos: 34827
                length: 76
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: startCutoff
                            children: []
                            pos: 34916
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SATURDAY
                            children: []
                            pos: 34930
                            length: 17
                        children: []
                        pos: 34916
                        length: 31
                    children: []
                    pos: 34915
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: startCutoff -= 7;
                    children: []
                    pos: 34963
                    length: 17
                  pos: 34949
                  length: 41
                pos: 34912
                length: 78
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: endCutoff
                            children: []
                            pos: 35003
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SUNDAY
                            children: []
                            pos: 35015
                            length: 15
                        children: []
                        pos: 35003
                        length: 27
                    children: []
                    pos: 35002
                    length: 29
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: endCutoff += 7;
                    children: []
                    pos: 35046
                    length: 15
                  pos: 35032
                  length: 39
                pos: 34999
                length: 72
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: endCutoff
                            children: []
                            pos: 35084
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SATURDAY
                            children: []
                            pos: 35096
                            length: 17
                        children: []
                        pos: 35084
                        length: 29
                    children: []
                    pos: 35083
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: endCutoff -= 7;
                    children: []
                    pos: 35129
                    length: 15
                  pos: 35115
                  length: 39
                pos: 35080
                length: 74
              - type: while_statement
                fields:
                  text: |-
                    while (start.get(Calendar.DAY_OF_WEEK) != startCutoff) {
                                start.add(Calendar.DATE, -1);
                            }
                children: []
                pos: 35163
                length: 108
              - type: while_statement
                fields:
                  text: |-
                    while (end.get(Calendar.DAY_OF_WEEK) != endCutoff) {
                                end.add(Calendar.DATE, 1);
                            }
                children: []
                pos: 35280
                length: 101
              - type: return_statement
                fields:
                  text: return new DateIterator(start, end);
                children: []
                pos: 35390
                length: 36
              pos: 32632
              length: 2800
          children: []
          pos: 32568
          length: 2864
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 36392
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object focus
                children: []
                pos: 36401
                length: 12
              pos: 36369
              length: 492
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 36445
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 36454
                            length: 4
                        children: []
                        pos: 36445
                        length: 13
                    children: []
                    pos: 36444
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 36474
                    length: 64
                  pos: 36460
                  length: 88
                pos: 36441
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: focus instanceof Date
                        children: []
                        pos: 36561
                        length: 21
                    children: []
                    pos: 36560
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return iterator((Date) focus, rangeStyle);
                    children: []
                    pos: 36598
                    length: 42
                  pos: 36584
                  length: 66
                pos: 36557
                length: 298
              pos: 36431
              length: 430
          children: []
          pos: 36369
          length: 492
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DateIterator
              children: []
              pos: 36925
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Calendar endFinal;
                children: []
                pos: 36968
                length: 32
              - type: field_declaration
                fields:
                  text: private final Calendar spot;
                children: []
                pos: 37009
                length: 28
              - type: constructor_declaration
                fields:
                  text: |-
                    DateIterator(Calendar startFinal, Calendar endFinal) {
                                super();
                                this.endFinal = endFinal;
                                spot = startFinal;
                                spot.add(Calendar.DATE, -1);
                            }
                children: []
                pos: 37270
                length: 195
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: hasNext
                    children: []
                    pos: 37666
                    length: 7
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 37651
                    length: 78
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return spot.before(endFinal);
                      children: []
                      pos: 37690
                      length: 29
                    pos: 37676
                    length: 53
                children: []
                pos: 37651
                length: 78
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: next
                    children: []
                    pos: 37894
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 37880
                    length: 212
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: spot.equals(endFinal)
                              children: []
                              pos: 37919
                              length: 21
                          children: []
                          pos: 37918
                          length: 23
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: throw_statement
                          fields:
                            text: throw new NoSuchElementException();
                          children: []
                          pos: 37960
                          length: 35
                        pos: 37942
                        length: 67
                      pos: 37915
                      length: 94
                    - type: expression_statement
                      fields:
                        text: spot.add(Calendar.DATE, 1);
                      children: []
                      pos: 38022
                      length: 27
                    - type: return_statement
                      fields:
                        text: return spot.clone();
                      children: []
                      pos: 38062
                      length: 20
                    pos: 37901
                    length: 191
                children: []
                pos: 37880
                length: 212
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: remove
                    children: []
                    pos: 38299
                    length: 6
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 38287
                    length: 87
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: throw_statement
                      fields:
                        text: throw new UnsupportedOperationException();
                      children: []
                      pos: 38322
                      length: 42
                    pos: 38308
                    length: 66
                children: []
                pos: 38287
                length: 87
              pos: 36912
              length: 1468
          children: []
          pos: 36912
          length: 1468
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_SECOND = 1000;
          children: []
          pos: 38695
          length: 48
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_MINUTE = 60 * 1000;
          children: []
          pos: 38908
          length: 53
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_HOUR = 60 * 60 * 1000;
          children: []
          pos: 39122
          length: 56
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_DAY = 24 * 60 * 60 * 1000;
          children: []
          pos: 39337
          length: 60
        pos: 1470
        length: 37934
    children: []
    pos: 1470
    length: 37934
  pos: 0
  length: 39405
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: DateUtils
        children: []
        pos: 1483
        length: 9
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: public static final TimeZone UTC_TIME_ZONE = TimeZone.getTimeZone("GMT");
          children: []
          pos: 1574
          length: 73
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_SECOND = 1000;
          children: []
          pos: 1738
          length: 50
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_MINUTE = 60 * MILLIS_PER_SECOND;
          children: []
          pos: 1879
          length: 68
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_HOUR = 60 * MILLIS_PER_MINUTE;
          children: []
          pos: 2036
          length: 66
        - type: field_declaration
          fields:
            text: public static final long MILLIS_PER_DAY = 24 * MILLIS_PER_HOUR;
          children: []
          pos: 2190
          length: 63
        - type: field_declaration
          fields:
            text: public final static int SEMI_MONTH = 1001;
          children: []
          pos: 2388
          length: 42
        - type: field_declaration
          fields:
            text: "private static final int[][] fields = {\n            {Calendar.MILLISECOND},\n
              \           {Calendar.SECOND},\n            {Calendar.MINUTE},\n            {Calendar.HOUR_OF_DAY,
              Calendar.HOUR},\n            {Calendar.DATE, Calendar.DAY_OF_MONTH,
              Calendar.AM_PM \n                /* Calendar.DAY_OF_YEAR, Calendar.DAY_OF_WEEK,
              Calendar.DAY_OF_WEEK_IN_MONTH */\n            },\n            {Calendar.MONTH,
              DateUtils.SEMI_MONTH},\n            {Calendar.YEAR},\n            {Calendar.ERA}};"
          children: []
          pos: 2436
          length: 476
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_SUNDAY = 1;
          children: []
          pos: 2975
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_MONDAY = 2;
          children: []
          pos: 3084
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_RELATIVE = 3;
          children: []
          pos: 3202
          length: 48
        - type: field_declaration
          fields:
            text: public final static int RANGE_WEEK_CENTER = 4;
          children: []
          pos: 3326
          length: 46
        - type: field_declaration
          fields:
            text: public final static int RANGE_MONTH_SUNDAY = 5;
          children: []
          pos: 3445
          length: 47
        - type: field_declaration
          fields:
            text: public final static int RANGE_MONTH_MONDAY = 6;
          children: []
          pos: 3565
          length: 47
        - type: constructor_declaration
          fields:
            text: |-
              public DateUtils() {
                      super();
                  }
          children: []
          pos: 3935
          length: 43
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameDay
              children: []
              pos: 4603
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date1
                children: []
                pos: 4613
                length: 10
              pos: 4581
              length: 388
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date1
                                children: []
                                pos: 4651
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4660
                                length: 4
                            children: []
                            pos: 4651
                            length: 13
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date2
                                children: []
                                pos: 4668
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 4677
                                length: 4
                            children: []
                            pos: 4668
                            length: 13
                        children: []
                        pos: 4651
                        length: 30
                    children: []
                    pos: 4650
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 4697
                    length: 64
                  pos: 4683
                  length: 88
                pos: 4647
                length: 124
              - type: local_variable_declaration
                fields:
                  text: Calendar cal1 = Calendar.getInstance();
                children: []
                pos: 4780
                length: 39
              - type: expression_statement
                fields:
                  text: cal1.setTime(date1);
                children: []
                pos: 4828
                length: 20
              - type: local_variable_declaration
                fields:
                  text: Calendar cal2 = Calendar.getInstance();
                children: []
                pos: 4857
                length: 39
              - type: expression_statement
                fields:
                  text: cal2.setTime(date2);
                children: []
                pos: 4905
                length: 20
              - type: return_statement
                fields:
                  text: return isSameDay(cal1, cal2);
                children: []
                pos: 4934
                length: 29
              pos: 4637
              length: 332
          children: []
          pos: 4581
          length: 388
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameDay
              children: []
              pos: 5530
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 5540
                length: 13
              pos: 5508
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 5584
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 5592
                                length: 4
                            children: []
                            pos: 5584
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 5600
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 5608
                                length: 4
                            children: []
                            pos: 5600
                            length: 12
                        children: []
                        pos: 5584
                        length: 28
                    children: []
                    pos: 5583
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 5628
                    length: 64
                  pos: 5614
                  length: 88
                pos: 5580
                length: 122
              - type: return_statement
                fields:
                  text: |-
                    return (cal1.get(Calendar.ERA) == cal2.get(Calendar.ERA) &&
                                    cal1.get(Calendar.YEAR) == cal2.get(Calendar.YEAR) &&
                                    cal1.get(Calendar.DAY_OF_YEAR) == cal2.get(Calendar.DAY_OF_YEAR));
                children: []
                pos: 5711
                length: 212
              pos: 5570
              length: 359
          children: []
          pos: 5508
          length: 421
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameInstant
              children: []
              pos: 6504
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date1
                children: []
                pos: 6518
                length: 10
              pos: 6482
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date1
                                children: []
                                pos: 6556
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 6565
                                length: 4
                            children: []
                            pos: 6556
                            length: 13
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: date2
                                children: []
                                pos: 6573
                                length: 5
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 6582
                                length: 4
                            children: []
                            pos: 6573
                            length: 13
                        children: []
                        pos: 6556
                        length: 30
                    children: []
                    pos: 6555
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 6602
                    length: 64
                  pos: 6588
                  length: 88
                pos: 6552
                length: 124
              - type: return_statement
                fields:
                  text: return date1.getTime() == date2.getTime();
                children: []
                pos: 6685
                length: 42
              pos: 6542
              length: 191
          children: []
          pos: 6482
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameInstant
              children: []
              pos: 7240
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 7254
                length: 13
              pos: 7218
              length: 273
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 7298
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 7306
                                length: 4
                            children: []
                            pos: 7298
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 7314
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 7322
                                length: 4
                            children: []
                            pos: 7314
                            length: 12
                        children: []
                        pos: 7298
                        length: 28
                    children: []
                    pos: 7297
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 7342
                    length: 64
                  pos: 7328
                  length: 88
                pos: 7294
                length: 122
              - type: return_statement
                fields:
                  text: return cal1.getTime().getTime() == cal2.getTime().getTime();
                children: []
                pos: 7425
                length: 60
              pos: 7284
              length: 207
          children: []
          pos: 7218
          length: 273
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isSameLocalTime
              children: []
              pos: 8140
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar cal1
                children: []
                pos: 8156
                length: 13
              pos: 8118
              length: 783
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal1
                                children: []
                                pos: 8200
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 8208
                                length: 4
                            children: []
                            pos: 8200
                            length: 12
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: cal2
                                children: []
                                pos: 8216
                                length: 4
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 8224
                                length: 4
                            children: []
                            pos: 8216
                            length: 12
                        children: []
                        pos: 8200
                        length: 28
                    children: []
                    pos: 8199
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 8244
                    length: 64
                  pos: 8230
                  length: 88
                pos: 8196
                length: 122
              - type: return_statement
                fields:
                  text: |-
                    return (cal1.get(Calendar.MILLISECOND) == cal2.get(Calendar.MILLISECOND) &&
                                    cal1.get(Calendar.SECOND) == cal2.get(Calendar.SECOND) &&
                                    cal1.get(Calendar.MINUTE) == cal2.get(Calendar.MINUTE) &&
                                    cal1.get(Calendar.HOUR) == cal2.get(Calendar.HOUR) &&
                                    cal1.get(Calendar.DAY_OF_YEAR) == cal2.get(Calendar.DAY_OF_YEAR) &&
                                    cal1.get(Calendar.YEAR) == cal2.get(Calendar.YEAR) &&
                                    cal1.get(Calendar.ERA) == cal2.get(Calendar.ERA) &&
                                    cal1.getClass() == cal2.getClass());
                children: []
                pos: 8327
                length: 568
              pos: 8186
              length: 715
          children: []
          pos: 8118
          length: 783
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parseDate
              children: []
              pos: 9664
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 9674
                length: 10
              pos: 9645
              length: 849
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: str
                                children: []
                                pos: 9746
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 9753
                                length: 4
                            children: []
                            pos: 9746
                            length: 11
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: parsePatterns
                                children: []
                                pos: 9761
                                length: 13
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 9778
                                length: 4
                            children: []
                            pos: 9761
                            length: 21
                        children: []
                        pos: 9746
                        length: 36
                    children: []
                    pos: 9745
                    length: 38
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Date and Patterns
                        must not be null");
                    children: []
                    pos: 9798
                    length: 73
                  pos: 9784
                  length: 97
                pos: 9742
                length: 139
              - type: local_variable_declaration
                fields:
                  text: SimpleDateFormat parser = null;
                children: []
                pos: 9899
                length: 31
              - type: local_variable_declaration
                fields:
                  text: ParsePosition pos = new ParsePosition(0);
                children: []
                pos: 9939
                length: 41
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < parsePatterns.length; i++) {
                                if (i == 0) {
                                    parser = new SimpleDateFormat(parsePatterns[0]);
                                } else {
                                    parser.applyPattern(parsePatterns[i]);
                                }
                                pos.setIndex(0);
                                Date date = parser.parse(str, pos);
                                if (date != null && pos.getIndex() == str.length()) {
                                    return date;
                                }
                            }
                children: []
                pos: 9989
                length: 425
              - type: throw_statement
                fields:
                  text: 'throw new ParseException("Unable to parse the date: " + str,
                    -1);'
                children: []
                pos: 10423
                length: 65
              pos: 9732
              length: 762
          children: []
          pos: 9645
          length: 849
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addYears
              children: []
              pos: 10943
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 10952
                length: 9
              pos: 10924
              length: 107
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.YEAR, amount);
                children: []
                pos: 10985
                length: 40
              pos: 10975
              length: 56
          children: []
          pos: 10924
          length: 107
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMonths
              children: []
              pos: 11481
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 11491
                length: 9
              pos: 11462
              length: 109
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MONTH, amount);
                children: []
                pos: 11524
                length: 41
              pos: 11514
              length: 57
          children: []
          pos: 11462
          length: 109
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addWeeks
              children: []
              pos: 12020
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 12029
                length: 9
              pos: 12001
              length: 115
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.WEEK_OF_YEAR, amount);
                children: []
                pos: 12062
                length: 48
              pos: 12052
              length: 64
          children: []
          pos: 12001
          length: 115
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addDays
              children: []
              pos: 12564
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 12572
                length: 9
              pos: 12545
              length: 114
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.DAY_OF_MONTH, amount);
                children: []
                pos: 12605
                length: 48
              pos: 12595
              length: 64
          children: []
          pos: 12545
          length: 114
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addHours
              children: []
              pos: 13108
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 13117
                length: 9
              pos: 13089
              length: 114
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.HOUR_OF_DAY, amount);
                children: []
                pos: 13150
                length: 47
              pos: 13140
              length: 63
          children: []
          pos: 13089
          length: 114
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMinutes
              children: []
              pos: 13654
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 13665
                length: 9
              pos: 13635
              length: 111
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MINUTE, amount);
                children: []
                pos: 13698
                length: 42
              pos: 13688
              length: 58
          children: []
          pos: 13635
          length: 111
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addSeconds
              children: []
              pos: 14197
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 14208
                length: 9
              pos: 14178
              length: 111
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.SECOND, amount);
                children: []
                pos: 14241
                length: 42
              pos: 14231
              length: 58
          children: []
          pos: 14178
          length: 111
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: addMilliseconds
              children: []
              pos: 14745
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 14761
                length: 9
              pos: 14726
              length: 121
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return add(date, Calendar.MILLISECOND, amount);
                children: []
                pos: 14794
                length: 47
              pos: 14784
              length: 63
          children: []
          pos: 14726
          length: 121
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: add
              children: []
              pos: 15336
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 15340
                length: 9
              pos: 15317
              length: 323
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 15396
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 15404
                            length: 4
                        children: []
                        pos: 15396
                        length: 12
                    children: []
                    pos: 15395
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 15424
                    length: 64
                  pos: 15410
                  length: 88
                pos: 15392
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar c = Calendar.getInstance();
                children: []
                pos: 15507
                length: 36
              - type: expression_statement
                fields:
                  text: c.setTime(date);
                children: []
                pos: 15552
                length: 16
              - type: expression_statement
                fields:
                  text: c.add(calendarField, amount);
                children: []
                pos: 15577
                length: 29
              - type: return_statement
                fields:
                  text: return c.getTime();
                children: []
                pos: 15615
                length: 19
              pos: 15382
              length: 258
          children: []
          pos: 15317
          length: 323
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 17037
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 17043
                length: 9
              pos: 17018
              length: 311
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 17079
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17087
                            length: 4
                        children: []
                        pos: 17079
                        length: 12
                    children: []
                    pos: 17078
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 17107
                    length: 64
                  pos: 17093
                  length: 88
                pos: 17075
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 17190
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(date);
                children: []
                pos: 17238
                length: 19
              - type: expression_statement
                fields:
                  text: modify(gval, field, true);
                children: []
                pos: 17266
                length: 26
              - type: return_statement
                fields:
                  text: return gval.getTime();
                children: []
                pos: 17301
                length: 22
              pos: 17065
              length: 264
          children: []
          pos: 17018
          length: 311
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 18673
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar date
                children: []
                pos: 18679
                length: 13
              pos: 18650
              length: 291
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 18719
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 18727
                            length: 4
                        children: []
                        pos: 18719
                        length: 12
                    children: []
                    pos: 18718
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 18747
                    length: 64
                  pos: 18733
                  length: 88
                pos: 18715
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar rounded = (Calendar) date.clone();
                children: []
                pos: 18830
                length: 43
              - type: expression_statement
                fields:
                  text: modify(rounded, field, true);
                children: []
                pos: 18882
                length: 29
              - type: return_statement
                fields:
                  text: return rounded;
                children: []
                pos: 18920
                length: 15
              pos: 18705
              length: 236
          children: []
          pos: 18650
          length: 291
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: round
              children: []
              pos: 20398
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object date
                children: []
                pos: 20404
                length: 11
              pos: 20379
              length: 456
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 20442
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20450
                            length: 4
                        children: []
                        pos: 20442
                        length: 12
                    children: []
                    pos: 20441
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 20470
                    length: 64
                  pos: 20456
                  length: 88
                pos: 20438
                length: 106
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: date instanceof Date
                        children: []
                        pos: 20557
                        length: 20
                    children: []
                    pos: 20556
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return round((Date) date, field);
                    children: []
                    pos: 20593
                    length: 33
                  pos: 20579
                  length: 57
                pos: 20553
                length: 276
              pos: 20428
              length: 407
          children: []
          pos: 20379
          length: 456
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 21616
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date date
                children: []
                pos: 21625
                length: 9
              pos: 21597
              length: 315
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 21661
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21669
                            length: 4
                        children: []
                        pos: 21661
                        length: 12
                    children: []
                    pos: 21660
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 21689
                    length: 64
                  pos: 21675
                  length: 88
                pos: 21657
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 21772
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(date);
                children: []
                pos: 21820
                length: 19
              - type: expression_statement
                fields:
                  text: modify(gval, field, false);
                children: []
                pos: 21848
                length: 27
              - type: return_statement
                fields:
                  text: return gval.getTime();
                children: []
                pos: 21884
                length: 22
              pos: 21647
              length: 265
          children: []
          pos: 21597
          length: 315
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 22640
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar date
                children: []
                pos: 22649
                length: 13
              pos: 22617
              length: 301
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 22689
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 22697
                            length: 4
                        children: []
                        pos: 22689
                        length: 12
                    children: []
                    pos: 22688
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 22717
                    length: 64
                  pos: 22703
                  length: 88
                pos: 22685
                length: 106
              - type: local_variable_declaration
                fields:
                  text: Calendar truncated = (Calendar) date.clone();
                children: []
                pos: 22800
                length: 45
              - type: expression_statement
                fields:
                  text: modify(truncated, field, false);
                children: []
                pos: 22854
                length: 32
              - type: return_statement
                fields:
                  text: return truncated;
                children: []
                pos: 22895
                length: 17
              pos: 22675
              length: 243
          children: []
          pos: 22617
          length: 301
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: truncate
              children: []
              pos: 23801
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object date
                children: []
                pos: 23810
                length: 11
              pos: 23782
              length: 468
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: date
                            children: []
                            pos: 23848
                            length: 4
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23856
                            length: 4
                        children: []
                        pos: 23848
                        length: 12
                    children: []
                    pos: 23847
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 23876
                    length: 64
                  pos: 23862
                  length: 88
                pos: 23844
                length: 106
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: date instanceof Date
                        children: []
                        pos: 23963
                        length: 20
                    children: []
                    pos: 23962
                    length: 22
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return truncate((Date) date, field);
                    children: []
                    pos: 23999
                    length: 36
                  pos: 23985
                  length: 60
                pos: 23959
                length: 285
              pos: 23834
              length: 416
          children: []
          pos: 23782
          length: 468
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: modify
              children: []
              pos: 24614
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar val
                children: []
                pos: 24621
                length: 12
              pos: 24594
              length: 5214
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: val.get(Calendar.YEAR)
                            children: []
                            pos: 24675
                            length: 22
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '280000000'
                            children: []
                            pos: 24700
                            length: 9
                        children: []
                        pos: 24675
                        length: 34
                    children: []
                    pos: 24674
                    length: 36
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new ArithmeticException("Calendar value too large
                        for accurate calculations");
                    children: []
                    pos: 24725
                    length: 84
                  pos: 24711
                  length: 108
                pos: 24671
                length: 148
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: field
                            children: []
                            pos: 24841
                            length: 5
                          right:
                            type: field_access
                            fields:
                              text: Calendar.MILLISECOND
                            children: []
                            pos: 24850
                            length: 20
                        children: []
                        pos: 24841
                        length: 29
                    children: []
                    pos: 24840
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 24886
                    length: 7
                  pos: 24872
                  length: 31
                pos: 24837
                length: 66
              - type: local_variable_declaration
                fields:
                  text: Date date = val.getTime();
                children: []
                pos: 25186
                length: 26
              - type: local_variable_declaration
                fields:
                  text: long time = date.getTime();
                children: []
                pos: 25221
                length: 27
              - type: local_variable_declaration
                fields:
                  text: boolean done = false;
                children: []
                pos: 25257
                length: 21
              - type: local_variable_declaration
                fields:
                  text: int millisecs = val.get(Calendar.MILLISECOND);
                children: []
                pos: 25321
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!round"
                            children: []
                            pos: 25380
                            length: 6
                          right:
                            type: less_than
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: millisecs
                                children: []
                                pos: 25390
                                length: 9
                              right:
                                type: decimal_integer_literal
                                fields:
                                  text: '500'
                                children: []
                                pos: 25402
                                length: 3
                            children: []
                            pos: 25390
                            length: 15
                        children: []
                        pos: 25380
                        length: 25
                    children: []
                    pos: 25379
                    length: 27
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - millisecs;
                    children: []
                    pos: 25421
                    length: 24
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: field
                                children: []
                                pos: 25458
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Calendar.SECOND
                                children: []
                                pos: 25467
                                length: 15
                            children: []
                            pos: 25458
                            length: 24
                        children: []
                        pos: 25457
                        length: 26
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: done = true;
                        children: []
                        pos: 25498
                        length: 12
                      pos: 25484
                      length: 40
                    pos: 25454
                    length: 70
                  pos: 25407
                  length: 127
                pos: 25376
                length: 158
              - type: local_variable_declaration
                fields:
                  text: int seconds = val.get(Calendar.SECOND);
                children: []
                pos: 25572
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!done"
                            children: []
                            pos: 25624
                            length: 5
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!round"
                                    children: []
                                    pos: 25634
                                    length: 6
                                  right:
                                    type: less_than
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: seconds
                                        children: []
                                        pos: 25644
                                        length: 7
                                      right:
                                        type: decimal_integer_literal
                                        fields:
                                          text: '30'
                                        children: []
                                        pos: 25654
                                        length: 2
                                    children: []
                                    pos: 25644
                                    length: 12
                                children: []
                                pos: 25634
                                length: 22
                            children: []
                            pos: 25633
                            length: 24
                        children: []
                        pos: 25624
                        length: 33
                    children: []
                    pos: 25623
                    length: 35
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - (seconds * 1000L);
                    children: []
                    pos: 25673
                    length: 32
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: field
                                children: []
                                pos: 25718
                                length: 5
                              right:
                                type: field_access
                                fields:
                                  text: Calendar.MINUTE
                                children: []
                                pos: 25727
                                length: 15
                            children: []
                            pos: 25718
                            length: 24
                        children: []
                        pos: 25717
                        length: 26
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: done = true;
                        children: []
                        pos: 25758
                        length: 12
                      pos: 25744
                      length: 40
                    pos: 25714
                    length: 70
                  pos: 25659
                  length: 135
                pos: 25620
                length: 174
              - type: local_variable_declaration
                fields:
                  text: int minutes = val.get(Calendar.MINUTE);
                children: []
                pos: 25832
                length: 39
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: unary_expression
                            fields:
                              text: "!done"
                            children: []
                            pos: 25884
                            length: 5
                          right:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: or
                                fields:
                                  left:
                                    type: unary_expression
                                    fields:
                                      text: "!round"
                                    children: []
                                    pos: 25894
                                    length: 6
                                  right:
                                    type: less_than
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: minutes
                                        children: []
                                        pos: 25904
                                        length: 7
                                      right:
                                        type: decimal_integer_literal
                                        fields:
                                          text: '30'
                                        children: []
                                        pos: 25914
                                        length: 2
                                    children: []
                                    pos: 25904
                                    length: 12
                                children: []
                                pos: 25894
                                length: 22
                            children: []
                            pos: 25893
                            length: 24
                        children: []
                        pos: 25884
                        length: 33
                    children: []
                    pos: 25883
                    length: 35
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: time = time - (minutes * 60000L);
                    children: []
                    pos: 25933
                    length: 33
                  pos: 25919
                  length: 57
                pos: 25880
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: date.getTime()
                            children: []
                            pos: 26012
                            length: 14
                          right:
                            type: identifier
                            fields:
                              text: time
                            children: []
                            pos: 26030
                            length: 4
                        children: []
                        pos: 26012
                        length: 22
                    children: []
                    pos: 26011
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: date.setTime(time);
                    children: []
                    pos: 26050
                    length: 19
                  - type: expression_statement
                    fields:
                      text: val.setTime(date);
                    children: []
                    pos: 26082
                    length: 18
                  pos: 26036
                  length: 74
                pos: 26008
                length: 102
              - type: local_variable_declaration
                fields:
                  text: boolean roundUp = false;
                children: []
                pos: 26210
                length: 24
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < fields.length; i++) {
                                for (int j = 0; j < fields[i].length; j++) {
                                    if (fields[i][j] == field) {
                                        //This is our field... we stop looping
                                        if (round && roundUp) {
                                            if (field == DateUtils.SEMI_MONTH) {
                                                //This is a special case that's hard to generalize
                                                //If the date is 1, we round up to 16, otherwise
                                                //  we subtract 15 days and add 1 month
                                                if (val.get(Calendar.DATE) == 1) {
                                                    val.add(Calendar.DATE, 15);
                                                } else {
                                                    val.add(Calendar.DATE, -15);
                                                    val.add(Calendar.MONTH, 1);
                                                }
                                            } else {
                                                //We need at add one to this field since the
                                                //  last number causes us to round up
                                                val.add(fields[i][0], 1);
                                            }
                                        }
                                        return;
                                    }
                                }
                                //We have various fields that are not easy roundings
                                int offset = 0;
                                boolean offsetSet = false;
                                //These are special types of fields that require different rounding rules
                                switch (field) {
                                    case DateUtils.SEMI_MONTH:
                                        if (fields[i][0] == Calendar.DATE) {
                                            //If we're going to drop the DATE field's value,
                                            //  we want to do this our own way.
                                            //We need to subtrace 1 since the date has a minimum of 1
                                            offset = val.get(Calendar.DATE) - 1;
                                            //If we're above 15 days adjustment, that means we're in the
                                            //  bottom half of the month and should stay accordingly.
                                            if (offset >= 15) {
                                                offset -= 15;
                                            }
                                            //Record whether we're in the top or bottom half of that range
                                            roundUp = offset > 7;
                                            offsetSet = true;
                                        }
                                        break;
                                    case Calendar.AM_PM:
                                        if (fields[i][0] == Calendar.HOUR_OF_DAY) {
                                            //If we're going to drop the HOUR field's value,
                                            //  we want to do this our own way.
                                            offset = val.get(Calendar.HOUR_OF_DAY);
                                            if (offset >= 12) {
                                                offset -= 12;
                                            }
                                            roundUp = offset > 6;
                                            offsetSet = true;
                                        }
                                        break;
                                }
                                if (!offsetSet) {
                                    int min = val.getActualMinimum(fields[i][0]);
                                    int max = val.getActualMaximum(fields[i][0]);
                                    //Calculate the offset from the minimum allowed value
                                    offset = val.get(fields[i][0]) - min;
                                    //Set roundUp if this is more than half way between the minimum and maximum
                                    roundUp = offset > ((max - min) / 2);
                                }
                                //We need to remove this field
                                if (offset != 0) {
                                    val.set(fields[i][0], val.get(fields[i][0]) - offset);
                                }
                            }
                children: []
                pos: 26243
                length: 3470
              - type: throw_statement
                fields:
                  text: throw new IllegalArgumentException("The field " + field +
                    " is not supported");
                children: []
                pos: 29722
                length: 79
              pos: 24661
              length: 5147
          children: []
          pos: 24594
          length: 5214
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 31128
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Date focus
                children: []
                pos: 31137
                length: 10
              pos: 31105
              length: 303
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 31179
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 31188
                            length: 4
                        children: []
                        pos: 31179
                        length: 13
                    children: []
                    pos: 31178
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 31208
                    length: 64
                  pos: 31194
                  length: 88
                pos: 31175
                length: 107
              - type: local_variable_declaration
                fields:
                  text: Calendar gval = Calendar.getInstance();
                children: []
                pos: 31291
                length: 39
              - type: expression_statement
                fields:
                  text: gval.setTime(focus);
                children: []
                pos: 31339
                length: 20
              - type: return_statement
                fields:
                  text: return iterator(gval, rangeStyle);
                children: []
                pos: 31368
                length: 34
              pos: 31165
              length: 243
          children: []
          pos: 31105
          length: 303
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 32599
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Calendar focus
                children: []
                pos: 32608
                length: 14
              pos: 32576
              length: 2864
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 32654
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 32663
                            length: 4
                        children: []
                        pos: 32654
                        length: 13
                    children: []
                    pos: 32653
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 32683
                    length: 64
                  pos: 32669
                  length: 88
                pos: 32650
                length: 107
              - type: local_variable_declaration
                fields:
                  text: Calendar start = null;
                children: []
                pos: 32766
                length: 22
              - type: local_variable_declaration
                fields:
                  text: Calendar end = null;
                children: []
                pos: 32797
                length: 20
              - type: local_variable_declaration
                fields:
                  text: int startCutoff = Calendar.SUNDAY;
                children: []
                pos: 32826
                length: 34
              - type: local_variable_declaration
                fields:
                  text: int endCutoff = Calendar.SATURDAY;
                children: []
                pos: 32869
                length: 34
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: rangeStyle
                        children: []
                        pos: 32920
                        length: 10
                    children: []
                    pos: 32919
                    length: 12
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                                    case RANGE_MONTH_SUNDAY:
                                    case RANGE_MONTH_MONDAY:
                                        //Set start to the first of the month
                                        start = truncate(focus, Calendar.MONTH);
                                        //Set end to the last of the month
                                        end = (Calendar) start.clone();
                                        end.add(Calendar.MONTH, 1);
                                        end.add(Calendar.DATE, -1);
                                        //Loop start back to the previous sunday or monday
                                        if (rangeStyle == RANGE_MONTH_MONDAY) {
                                            startCutoff = Calendar.MONDAY;
                                            endCutoff = Calendar.SUNDAY;
                                        }
                                        break;
                                    case RANGE_WEEK_SUNDAY:
                                    case RANGE_WEEK_MONDAY:
                                    case RANGE_WEEK_RELATIVE:
                                    case RANGE_WEEK_CENTER:
                                        //Set start and end to the current date
                                        start = truncate(focus, Calendar.DATE);
                                        end = truncate(focus, Calendar.DATE);
                                        switch (rangeStyle) {
                                            case RANGE_WEEK_SUNDAY:
                                                //already set by default
                                                break;
                                            case RANGE_WEEK_MONDAY:
                                                startCutoff = Calendar.MONDAY;
                                                endCutoff = Calendar.SUNDAY;
                                                break;
                                            case RANGE_WEEK_RELATIVE:
                                                startCutoff = focus.get(Calendar.DAY_OF_WEEK);
                                                endCutoff = startCutoff - 1;
                                                break;
                                            case RANGE_WEEK_CENTER:
                                                startCutoff = focus.get(Calendar.DAY_OF_WEEK) - 3;
                                                endCutoff = focus.get(Calendar.DAY_OF_WEEK) + 3;
                                                break;
                                        }
                                        break;
                                    default:
                                        throw new IllegalArgumentException("The range style " + rangeStyle + " is not valid.");
                                }
                    children: []
                    pos: 32932
                    length: 1894
                children: []
                pos: 32912
                length: 1914
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: startCutoff
                            children: []
                            pos: 34839
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SUNDAY
                            children: []
                            pos: 34853
                            length: 15
                        children: []
                        pos: 34839
                        length: 29
                    children: []
                    pos: 34838
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: startCutoff += 7;
                    children: []
                    pos: 34884
                    length: 17
                  pos: 34870
                  length: 41
                pos: 34835
                length: 76
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: startCutoff
                            children: []
                            pos: 34924
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SATURDAY
                            children: []
                            pos: 34938
                            length: 17
                        children: []
                        pos: 34924
                        length: 31
                    children: []
                    pos: 34923
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: startCutoff -= 7;
                    children: []
                    pos: 34971
                    length: 17
                  pos: 34957
                  length: 41
                pos: 34920
                length: 78
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: endCutoff
                            children: []
                            pos: 35011
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SUNDAY
                            children: []
                            pos: 35023
                            length: 15
                        children: []
                        pos: 35011
                        length: 27
                    children: []
                    pos: 35010
                    length: 29
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: endCutoff += 7;
                    children: []
                    pos: 35054
                    length: 15
                  pos: 35040
                  length: 39
                pos: 35007
                length: 72
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: endCutoff
                            children: []
                            pos: 35092
                            length: 9
                          right:
                            type: field_access
                            fields:
                              text: Calendar.SATURDAY
                            children: []
                            pos: 35104
                            length: 17
                        children: []
                        pos: 35092
                        length: 29
                    children: []
                    pos: 35091
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: endCutoff -= 7;
                    children: []
                    pos: 35137
                    length: 15
                  pos: 35123
                  length: 39
                pos: 35088
                length: 74
              - type: while_statement
                fields:
                  text: |-
                    while (start.get(Calendar.DAY_OF_WEEK) != startCutoff) {
                                start.add(Calendar.DATE, -1);
                            }
                children: []
                pos: 35171
                length: 108
              - type: while_statement
                fields:
                  text: |-
                    while (end.get(Calendar.DAY_OF_WEEK) != endCutoff) {
                                end.add(Calendar.DATE, 1);
                            }
                children: []
                pos: 35288
                length: 101
              - type: return_statement
                fields:
                  text: return new DateIterator(start, end);
                children: []
                pos: 35398
                length: 36
              pos: 32640
              length: 2800
          children: []
          pos: 32576
          length: 2864
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: iterator
              children: []
              pos: 36400
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object focus
                children: []
                pos: 36409
                length: 12
              pos: 36377
              length: 492
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: focus
                            children: []
                            pos: 36453
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 36462
                            length: 4
                        children: []
                        pos: 36453
                        length: 13
                    children: []
                    pos: 36452
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The date must not
                        be null");
                    children: []
                    pos: 36482
                    length: 64
                  pos: 36468
                  length: 88
                pos: 36449
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: focus instanceof Date
                        children: []
                        pos: 36569
                        length: 21
                    children: []
                    pos: 36568
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return iterator((Date) focus, rangeStyle);
                    children: []
                    pos: 36606
                    length: 42
                  pos: 36592
                  length: 66
                pos: 36565
                length: 298
              pos: 36439
              length: 430
          children: []
          pos: 36377
          length: 492
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: DateIterator
              children: []
              pos: 36933
              length: 12
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private final Calendar endFinal;
                children: []
                pos: 36976
                length: 32
              - type: field_declaration
                fields:
                  text: private final Calendar spot;
                children: []
                pos: 37017
                length: 28
              - type: constructor_declaration
                fields:
                  text: |-
                    DateIterator(Calendar startFinal, Calendar endFinal) {
                                super();
                                this.endFinal = endFinal;
                                spot = startFinal;
                                spot.add(Calendar.DATE, -1);
                            }
                children: []
                pos: 37278
                length: 195
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: hasNext
                    children: []
                    pos: 37674
                    length: 7
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 37659
                    length: 78
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return spot.before(endFinal);
                      children: []
                      pos: 37698
                      length: 29
                    pos: 37684
                    length: 53
                children: []
                pos: 37659
                length: 78
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: next
                    children: []
                    pos: 37902
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 37888
                    length: 212
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: method_invocation
                              fields:
                                text: spot.equals(endFinal)
                              children: []
                              pos: 37927
                              length: 21
                          children: []
                          pos: 37926
                          length: 23
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: throw_statement
                          fields:
                            text: throw new NoSuchElementException();
                          children: []
                          pos: 37968
                          length: 35
                        pos: 37950
                        length: 67
                      pos: 37923
                      length: 94
                    - type: expression_statement
                      fields:
                        text: spot.add(Calendar.DATE, 1);
                      children: []
                      pos: 38030
                      length: 27
                    - type: return_statement
                      fields:
                        text: return spot.clone();
                      children: []
                      pos: 38070
                      length: 20
                    pos: 37909
                    length: 191
                children: []
                pos: 37888
                length: 212
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: remove
                    children: []
                    pos: 38307
                    length: 6
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 38295
                    length: 87
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: throw_statement
                      fields:
                        text: throw new UnsupportedOperationException();
                      children: []
                      pos: 38330
                      length: 42
                    pos: 38316
                    length: 66
                children: []
                pos: 38295
                length: 87
              pos: 36920
              length: 1468
          children: []
          pos: 36920
          length: 1468
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_SECOND = 1000;
          children: []
          pos: 38703
          length: 48
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_MINUTE = 60 * 1000;
          children: []
          pos: 38916
          length: 53
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_HOUR = 60 * 60 * 1000;
          children: []
          pos: 39130
          length: 56
        - type: field_declaration
          fields:
            text: public static final int MILLIS_IN_DAY = 24 * 60 * 60 * 1000;
          children: []
          pos: 39345
          length: 60
        pos: 1470
        length: 37942
    children: []
    pos: 1470
    length: 37942
  pos: 0
  length: 39413
text_diff: "--- before\n+++ after\n@@ -640,18 +640,18 @@\n         int millisecs =
  val.get(Calendar.MILLISECOND);\n         if (!round || millisecs < 500) {\n             time
  = time - millisecs;\n-        }\n         if (field == Calendar.SECOND) {\n             done
  = true;\n+            }\n         }\n \n         // truncate seconds\n         int
  seconds = val.get(Calendar.SECOND);\n         if (!done && (!round || seconds <
  30)) {\n             time = time - (seconds * 1000L);\n-        }\n         if (field
  == Calendar.MINUTE) {\n             done = true;\n+            }\n         }\n \n
  \        // truncate minutes\n"
tree_diff: |+
  New cluster:
  MOVE from block [25407,25455]
  ------------
  ===
  move-tree
  ---
  if_statement [25464,25530]
      parenthesized_expression [25467,25493]
          equals [25468,25492]
              identifier: field [25468,25473]
              field_access: Calendar.SECOND [25477,25492]
      block [25494,25530]
          expression_statement: done = true; [25508,25520]
  to
  block [25407,25455]
  at 1
  ===
  move-tree
  ---
  if_statement [25720,25786]
      parenthesized_expression [25723,25749]
          equals [25724,25748]
              identifier: field [25724,25729]
              field_access: Calendar.MINUTE [25733,25748]
      block [25750,25786]
          expression_statement: done = true; [25764,25776]
  to
  block [25655,25711]
  at 1

...
