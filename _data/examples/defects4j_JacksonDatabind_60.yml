---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: JsonValueSerializer
        children: []
        pos: 1663
        length: 19
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final AnnotatedMethod _accessorMethod;
          children: []
          pos: 1859
          length: 48
        - type: field_declaration
          fields:
            text: protected final JsonSerializer<Object> _valueSerializer;
          children: []
          pos: 1913
          length: 56
        - type: field_declaration
          fields:
            text: protected final BeanProperty _property;
          children: []
          pos: 1975
          length: 39
        - type: field_declaration
          fields:
            text: protected final boolean _forceTypeInformation;
          children: []
          pos: 2296
          length: 46
        - type: constructor_declaration
          fields:
            text: |-
              @SuppressWarnings("unchecked")
                  public JsonValueSerializer(AnnotatedMethod valueMethod, JsonSerializer<?> ser)
                  {
                      super(valueMethod.getType());
                      _accessorMethod = valueMethod;
                      _valueSerializer = (JsonSerializer<Object>) ser;
                      _property = null;
                      _forceTypeInformation = true; // gets reconsidered when we are contextualized
                  }
          children: []
          pos: 2910
          length: 371
        - type: constructor_declaration
          fields:
            text: |-
              @SuppressWarnings("unchecked")
                  public JsonValueSerializer(JsonValueSerializer src, BeanProperty property,
                          JsonSerializer<?> ser, boolean forceTypeInfo)
                  {
                      super(_notNullClass(src.handledType()));
                      _accessorMethod = src._accessorMethod;
                      _valueSerializer = (JsonSerializer<Object>) ser;
                      _property = property;
                      _forceTypeInformation = forceTypeInfo;
                  }
          children: []
          pos: 3287
          length: 409
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _notNullClass
              children: []
              pos: 3772
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 3786
                length: 12
              pos: 3702
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (cls == null) ? Object.class : (Class<Object>) cls;'
                children: []
                pos: 3810
                length: 58
              pos: 3800
              length: 74
          children: []
          pos: 3702
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withResolved
              children: []
              pos: 3911
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: BeanProperty property
                children: []
                pos: 3924
                length: 21
              pos: 3884
              length: 365
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: _property
                                    children: []
                                    pos: 4023
                                    length: 9
                                  right:
                                    type: identifier
                                    fields:
                                      text: property
                                    children: []
                                    pos: 4036
                                    length: 8
                                children: []
                                pos: 4023
                                length: 21
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: _valueSerializer
                                    children: []
                                    pos: 4048
                                    length: 16
                                  right:
                                    type: identifier
                                    fields:
                                      text: ser
                                    children: []
                                    pos: 4068
                                    length: 3
                                children: []
                                pos: 4048
                                length: 23
                            children: []
                            pos: 4023
                            length: 48
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: forceTypeInfo
                                children: []
                                pos: 4091
                                length: 13
                              right:
                                type: identifier
                                fields:
                                  text: _forceTypeInformation
                                children: []
                                pos: 4108
                                length: 21
                            children: []
                            pos: 4091
                            length: 38
                        children: []
                        pos: 4023
                        length: 106
                    children: []
                    pos: 4022
                    length: 108
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4145
                    length: 12
                  pos: 4131
                  length: 36
                pos: 4019
                length: 148
              - type: return_statement
                fields:
                  text: return new JsonValueSerializer(this, property, ser, forceTypeInfo);
                children: []
                pos: 4176
                length: 67
              pos: 4009
              length: 240
          children: []
          pos: 3884
          length: 365
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createContextual
              children: []
              pos: 4609
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider provider
                children: []
                pos: 4626
                length: 27
              pos: 4570
              length: 1802
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JsonSerializer<?> ser = _valueSerializer;
                children: []
                pos: 4740
                length: 41
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: ser
                            children: []
                            pos: 4794
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4801
                            length: 4
                        children: []
                        pos: 4794
                        length: 11
                    children: []
                    pos: 4793
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JavaType t = _accessorMethod.getType();
                    children: []
                    pos: 5080
                    length: 39
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: provider.isEnabled(MapperFeature.USE_STATIC_TYPING)
                                children: []
                                pos: 5136
                                length: 51
                              right:
                                type: method_invocation
                                fields:
                                  text: t.isFinal()
                                children: []
                                pos: 5191
                                length: 11
                            children: []
                            pos: 5136
                            length: 66
                        children: []
                        pos: 5135
                        length: 68
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: ser = provider.findPrimaryPropertySerializer(t, property);
                        children: []
                        pos: 5607
                        length: 58
                      - type: local_variable_declaration
                        fields:
                          text: boolean forceTypeInformation = isNaturalTypeWithStdHandling(t.getRawClass(),
                            ser);
                        children: []
                        pos: 5914
                        length: 82
                      - type: return_statement
                        fields:
                          text: return withResolved(property, ser, forceTypeInformation);
                        children: []
                        pos: 6013
                        length: 57
                      pos: 5204
                      length: 880
                    pos: 5132
                    length: 952
                  pos: 4807
                  length: 1287
                pos: 4790
                length: 1555
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 6354
                length: 12
              pos: 4730
              length: 1642
          children: []
          pos: 4570
          length: 1802
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serialize
              children: []
              pos: 6584
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object bean
                children: []
                pos: 6594
                length: 11
              pos: 6558
              length: 1545
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Object value = _accessorMethod.getValue(bean);
                      children: []
                      pos: 6702
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 6765
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 6774
                                  length: 4
                              children: []
                              pos: 6765
                              length: 13
                          children: []
                          pos: 6764
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: prov.defaultSerializeNull(gen);
                          children: []
                          pos: 6798
                          length: 31
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 6846
                          length: 7
                        pos: 6780
                        length: 87
                      pos: 6761
                      length: 106
                    - type: local_variable_declaration
                      fields:
                        text: JsonSerializer<Object> ser = _valueSerializer;
                      children: []
                      pos: 6880
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ser
                                  children: []
                                  pos: 6943
                                  length: 3
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 6950
                                  length: 4
                              children: []
                              pos: 6943
                              length: 11
                          children: []
                          pos: 6942
                          length: 13
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Class<?> c = value.getClass();
                          children: []
                          pos: 6974
                          length: 30
                        - type: expression_statement
                          fields:
                            text: ser = prov.findTypedValueSerializer(c, true, _property);
                          children: []
                          pos: 7328
                          length: 56
                        pos: 6956
                        length: 442
                      pos: 6939
                      length: 459
                    - type: expression_statement
                      fields:
                        text: ser.serialize(value, gen, prov);
                      children: []
                      pos: 7411
                      length: 32
                    pos: 6688
                    length: 765
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      throw ioe;
                                  }
                      children: []
                      pos: 7454
                      length: 58
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Exception e) {
                                      Throwable t = e;
                                      // Need to unwrap this specific type, to see infinite recursion...
                                      while (t instanceof InvocationTargetException && t.getCause() != null) {
                                          t = t.getCause();
                                      }
                                      // Errors shouldn't be wrapped (and often can't, as well)
                                      if (t instanceof Error) {
                                          throw (Error) t;
                                      }
                                      // let's try to indicate the path best we can...
                                      throw JsonMappingException.wrapWithPath(t, bean, _accessorMethod.getName() + "()");
                                  }
                      children: []
                      pos: 7513
                      length: 584
                    pos: 6684
                    length: 1413
                children: []
                pos: 6684
                length: 1413
              pos: 6674
              length: 1429
          children: []
          pos: 6558
          length: 1545
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serializeWithType
              children: []
              pos: 8135
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object bean
                children: []
                pos: 8153
                length: 11
              pos: 8109
              length: 2371
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Object value = null;
                children: []
                pos: 8361
                length: 20
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: value = _accessorMethod.getValue(bean);
                      children: []
                      pos: 8408
                      length: 39
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 8531
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 8540
                                  length: 4
                              children: []
                              pos: 8531
                              length: 13
                          children: []
                          pos: 8530
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: provider.defaultSerializeNull(gen);
                          children: []
                          pos: 8564
                          length: 35
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 8616
                          length: 7
                        pos: 8546
                        length: 91
                      pos: 8527
                      length: 110
                    - type: local_variable_declaration
                      fields:
                        text: JsonSerializer<Object> ser = _valueSerializer;
                      children: []
                      pos: 8650
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ser
                                  children: []
                                  pos: 8713
                                  length: 3
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 8720
                                  length: 4
                              children: []
                              pos: 8713
                              length: 11
                          children: []
                          pos: 8712
                          length: 13
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: ser = provider.findValueSerializer(value.getClass(),
                              _property);
                          children: []
                          pos: 8874
                          length: 64
                        pos: 8726
                        length: 226
                      pos: 8709
                      length: 749
                    - type: local_variable_declaration
                      fields:
                        text: TypeSerializerRerouter rr = new TypeSerializerRerouter(typeSer0,
                          bean);
                      children: []
                      pos: 9688
                      length: 71
                    - type: expression_statement
                      fields:
                        text: ser.serializeWithType(value, gen, provider, rr);
                      children: []
                      pos: 9772
                      length: 48
                    pos: 8394
                    length: 1436
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      throw ioe;
                                  }
                      children: []
                      pos: 9831
                      length: 58
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Exception e) {
                                      Throwable t = e;
                                      // Need to unwrap this specific type, to see infinite recursion...
                                      while (t instanceof InvocationTargetException && t.getCause() != null) {
                                          t = t.getCause();
                                      }
                                      // Errors shouldn't be wrapped (and often can't, as well)
                                      if (t instanceof Error) {
                                          throw (Error) t;
                                      }
                                      // let's try to indicate the path best we can...
                                      throw JsonMappingException.wrapWithPath(t, bean, _accessorMethod.getName() + "()");
                                  }
                      children: []
                      pos: 9890
                      length: 584
                    pos: 8390
                    length: 2084
                children: []
                pos: 8390
                length: 2084
              pos: 8274
              length: 2206
          children: []
          pos: 8109
          length: 2371
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getSchema
              children: []
              pos: 10557
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider provider
                children: []
                pos: 10567
                length: 27
              pos: 10490
              length: 403
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: _valueSerializer instanceof SchemaAware
                        children: []
                        pos: 10665
                        length: 39
                    children: []
                    pos: 10664
                    length: 41
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return ((SchemaAware)_valueSerializer).getSchema(provider,
                        null);
                    children: []
                    pos: 10720
                    length: 65
                  pos: 10706
                  length: 89
                pos: 10661
                length: 134
              - type: return_statement
                fields:
                  text: return com.fasterxml.jackson.databind.jsonschema.JsonSchema.getDefaultSchemaNode();
                children: []
                pos: 10804
                length: 83
              pos: 10651
              length: 242
          children: []
          pos: 10490
          length: 403
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: acceptJsonFormatVisitor
              children: []
              pos: 10925
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 10949
                length: 32
              pos: 10899
              length: 1335
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final JavaType type = _accessorMethod.getType();
                children: []
                pos: 11549
                length: 48
              - type: local_variable_declaration
                fields:
                  text: Class<?> declaring = _accessorMethod.getDeclaringClass();
                children: []
                pos: 11606
                length: 57
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: declaring
                                    children: []
                                    pos: 11677
                                    length: 9
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 11690
                                    length: 4
                                children: []
                                pos: 11677
                                length: 17
                            children: []
                            pos: 11676
                            length: 19
                          right:
                            type: method_invocation
                            fields:
                              text: declaring.isEnum()
                            children: []
                            pos: 11699
                            length: 18
                        children: []
                        pos: 11676
                        length: 41
                    children: []
                    pos: 11675
                    length: 43
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: _acceptJsonFormatVisitorForEnum(visitor, typeHint,
                                declaring)
                            children: []
                            pos: 11737
                            length: 61
                        children: []
                        pos: 11736
                        length: 63
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 11818
                        length: 7
                      pos: 11800
                      length: 39
                    pos: 11733
                    length: 106
                  pos: 11719
                  length: 130
                pos: 11672
                length: 177
              - type: local_variable_declaration
                fields:
                  text: JsonSerializer<Object> ser = _valueSerializer;
                children: []
                pos: 11858
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: ser
                            children: []
                            pos: 11917
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11924
                            length: 4
                        children: []
                        pos: 11917
                        length: 11
                    children: []
                    pos: 11916
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ser = visitor.getProvider().findTypedValueSerializer(type,
                        false, _property);
                    children: []
                    pos: 11944
                    length: 77
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: ser
                                children: []
                                pos: 12038
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 12045
                                length: 4
                            children: []
                            pos: 12038
                            length: 11
                        children: []
                        pos: 12037
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: visitor.expectAnyFormat(typeHint);
                        children: []
                        pos: 12093
                        length: 34
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 12144
                        length: 7
                      pos: 12051
                      length: 114
                    pos: 12034
                    length: 131
                  pos: 11930
                  length: 245
                pos: 11913
                length: 262
              - type: expression_statement
                fields:
                  text: ser.acceptJsonFormatVisitor(visitor, null);
                children: []
                pos: 12184
                length: 43
              pos: 11042
              length: 1192
          children: []
          pos: 10899
          length: 1335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _acceptJsonFormatVisitorForEnum
              children: []
              pos: 12533
              length: 31
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 12565
                length: 32
              pos: 12515
              length: 1382
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JsonStringFormatVisitor stringVisitor = visitor.expectStringFormat(typeHint);
                children: []
                pos: 12761
                length: 77
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: stringVisitor
                            children: []
                            pos: 12851
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 12868
                            length: 4
                        children: []
                        pos: 12851
                        length: 21
                    children: []
                    pos: 12850
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Set<String> enums = new LinkedHashSet<String>();
                    children: []
                    pos: 12888
                    length: 48
                  - type: enhanced_for_statement
                    fields:
                      text: |-
                        for (Object en : enumType.getEnumConstants()) {
                                        try {
                                            // 21-Apr-2016, tatu: This is convoluted to the max, but essentially we
                                            //   call `@JsonValue`-annotated accessor method on all Enum members,
                                            //   so it all "works out". To some degree.
                                            enums.add(String.valueOf(_accessorMethod.callOn(en)));
                                        } catch (Exception e) {
                                            Throwable t = e;
                                            while (t instanceof InvocationTargetException && t.getCause() != null) {
                                                t = t.getCause();
                                            }
                                            if (t instanceof Error) {
                                                throw (Error) t;
                                            }
                                            throw JsonMappingException.wrapWithPath(t, en, _accessorMethod.getName() + "()");
                                        }
                                    }
                    children: []
                    pos: 12949
                    length: 867
                  - type: expression_statement
                    fields:
                      text: stringVisitor.enumTypes(enums);
                    children: []
                    pos: 13829
                    length: 31
                  pos: 12874
                  length: 996
                pos: 12847
                length: 1023
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 13879
                length: 12
              pos: 12689
              length: 1208
          children: []
          pos: 12515
          length: 1382
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isNaturalTypeWithStdHandling
              children: []
              pos: 13921
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> rawType
                children: []
                pos: 13950
                length: 16
              pos: 13903
              length: 593
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: rawType.isPrimitive()
                        children: []
                        pos: 14068
                        length: 21
                    children: []
                    pos: 14067
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: rawType
                                        children: []
                                        pos: 14109
                                        length: 7
                                      right:
                                        type: field_access
                                        fields:
                                          text: Integer.TYPE
                                        children: []
                                        pos: 14120
                                        length: 12
                                    children: []
                                    pos: 14109
                                    length: 23
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: rawType
                                        children: []
                                        pos: 14136
                                        length: 7
                                      right:
                                        type: field_access
                                        fields:
                                          text: Boolean.TYPE
                                        children: []
                                        pos: 14147
                                        length: 12
                                    children: []
                                    pos: 14136
                                    length: 23
                                children: []
                                pos: 14109
                                length: 50
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: rawType
                                    children: []
                                    pos: 14163
                                    length: 7
                                  right:
                                    type: field_access
                                    fields:
                                      text: Double.TYPE
                                    children: []
                                    pos: 14174
                                    length: 11
                                children: []
                                pos: 14163
                                length: 22
                            children: []
                            pos: 14109
                            length: 76
                        children: []
                        pos: 14108
                        length: 78
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return false;
                        children: []
                        pos: 14205
                        length: 13
                      pos: 14187
                      length: 45
                    pos: 14105
                    length: 127
                  pos: 14091
                  length: 151
                pos: 14064
                length: 385
              - type: return_statement
                fields:
                  text: return isDefaultSerializer(ser);
                children: []
                pos: 14458
                length: 32
              pos: 13995
              length: 501
          children: []
          pos: 13903
          length: 593
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 14695
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 14667
              length: 177
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return "(@JsonValue serializer for method " + _accessorMethod.getDeclaringClass()
                    + "#" + _accessorMethod.getName() + ")";
                children: []
                pos: 14716
                length: 122
              pos: 14706
              length: 138
          children: []
          pos: 14667
          length: 177
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: TypeSerializerRerouter
              children: []
              pos: 15260
              length: 22
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: protected final TypeSerializer _typeSerializer;
                children: []
                pos: 15328
                length: 47
              - type: field_declaration
                fields:
                  text: protected final Object _forObject;
                children: []
                pos: 15384
                length: 34
              - type: constructor_declaration
                fields:
                  text: |-
                    public TypeSerializerRerouter(TypeSerializer ts, Object ob) {
                                _typeSerializer = ts;
                                _forObject = ob;
                            }
                children: []
                pos: 15428
                length: 134
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: forProperty
                    children: []
                    pos: 15612
                    length: 11
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: BeanProperty prop
                      children: []
                      pos: 15624
                      length: 17
                    pos: 15572
                    length: 164
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: throw_statement
                      fields:
                        text: throw new UnsupportedOperationException();
                      children: []
                      pos: 15684
                      length: 42
                    pos: 15643
                    length: 93
                children: []
                pos: 15572
                length: 164
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getTypeInclusion
                    children: []
                    pos: 15774
                    length: 16
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 15746
                    length: 113
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return _typeSerializer.getTypeInclusion();
                      children: []
                      pos: 15807
                      length: 42
                    pos: 15793
                    length: 66
                children: []
                pos: 15746
                length: 113
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getPropertyName
                    children: []
                    pos: 15901
                    length: 15
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 15869
                    length: 115
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return _typeSerializer.getPropertyName();
                      children: []
                      pos: 15933
                      length: 41
                    pos: 15919
                    length: 65
                children: []
                pos: 15869
                length: 115
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: getTypeIdResolver
                    children: []
                    pos: 16034
                    length: 17
                  parameters:
                    type: method_parameters
                    fields: {}
                    children: []
                    pos: 15994
                    length: 127
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return _typeSerializer.getTypeIdResolver();
                      children: []
                      pos: 16068
                      length: 43
                    pos: 16054
                    length: 67
                children: []
                pos: 15994
                length: 127
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForScalar
                    children: []
                    pos: 16161
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 16186
                      length: 12
                    pos: 16131
                    length: 189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForScalar(_forObject,
                          gen);
                      children: []
                      pos: 16252
                      length: 58
                    pos: 16238
                    length: 82
                children: []
                pos: 16131
                length: 189
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForObject
                    children: []
                    pos: 16360
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 16385
                      length: 12
                    pos: 16330
                    length: 189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForObject(_forObject,
                          gen);
                      children: []
                      pos: 16451
                      length: 58
                    pos: 16437
                    length: 82
                children: []
                pos: 16330
                length: 189
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForArray
                    children: []
                    pos: 16559
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 16583
                      length: 12
                    pos: 16529
                    length: 187
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForArray(_forObject,
                          gen);
                      children: []
                      pos: 16649
                      length: 57
                    pos: 16635
                    length: 81
                children: []
                pos: 16529
                length: 187
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypeSuffixForScalar
                    children: []
                    pos: 16756
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 16781
                      length: 12
                    pos: 16726
                    length: 189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypeSuffixForScalar(_forObject,
                          gen);
                      children: []
                      pos: 16847
                      length: 58
                    pos: 16833
                    length: 82
                children: []
                pos: 16726
                length: 189
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypeSuffixForObject
                    children: []
                    pos: 16955
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 16980
                      length: 12
                    pos: 16925
                    length: 189
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypeSuffixForObject(_forObject,
                          gen);
                      children: []
                      pos: 17046
                      length: 58
                    pos: 17032
                    length: 82
                children: []
                pos: 16925
                length: 189
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypeSuffixForArray
                    children: []
                    pos: 17154
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 17178
                      length: 12
                    pos: 17124
                    length: 187
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypeSuffixForArray(_forObject,
                          gen);
                      children: []
                      pos: 17244
                      length: 57
                    pos: 17230
                    length: 81
                children: []
                pos: 17124
                length: 187
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForScalar
                    children: []
                    pos: 17333
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 17358
                      length: 12
                    pos: 17321
                    length: 192
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForScalar(_forObject,
                          gen, type);
                      children: []
                      pos: 17439
                      length: 64
                    pos: 17425
                    length: 88
                children: []
                pos: 17321
                length: 192
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForObject
                    children: []
                    pos: 17535
                    length: 24
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 17560
                      length: 12
                    pos: 17523
                    length: 192
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForObject(_forObject,
                          gen, type);
                      children: []
                      pos: 17641
                      length: 64
                    pos: 17627
                    length: 88
                children: []
                pos: 17523
                length: 192
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeTypePrefixForArray
                    children: []
                    pos: 17737
                    length: 23
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 17761
                      length: 12
                    pos: 17725
                    length: 190
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeTypePrefixForArray(_forObject,
                          gen, type);
                      children: []
                      pos: 17842
                      length: 63
                    pos: 17828
                    length: 87
                children: []
                pos: 17725
                length: 190
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypePrefixForScalar
                    children: []
                    pos: 17963
                    length: 30
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 17994
                      length: 12
                    pos: 17933
                    length: 240
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypePrefixForScalar(_forObject,
                          gen, typeId);
                      children: []
                      pos: 18091
                      length: 72
                    pos: 18077
                    length: 96
                children: []
                pos: 17933
                length: 240
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypePrefixForObject
                    children: []
                    pos: 18213
                    length: 30
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 18244
                      length: 12
                    pos: 18183
                    length: 224
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypePrefixForObject(_forObject,
                          gen, typeId);
                      children: []
                      pos: 18325
                      length: 72
                    pos: 18311
                    length: 96
                children: []
                pos: 18183
                length: 224
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypePrefixForArray
                    children: []
                    pos: 18447
                    length: 29
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 18477
                      length: 12
                    pos: 18417
                    length: 222
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypePrefixForArray(_forObject,
                          gen, typeId);
                      children: []
                      pos: 18558
                      length: 71
                    pos: 18544
                    length: 95
                children: []
                pos: 18417
                length: 222
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypeSuffixForScalar
                    children: []
                    pos: 18679
                    length: 30
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 18710
                      length: 12
                    pos: 18649
                    length: 224
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypeSuffixForScalar(_forObject,
                          gen, typeId);
                      children: []
                      pos: 18791
                      length: 72
                    pos: 18777
                    length: 96
                children: []
                pos: 18649
                length: 224
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypeSuffixForObject
                    children: []
                    pos: 18913
                    length: 30
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 18944
                      length: 12
                    pos: 18883
                    length: 224
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypeSuffixForObject(_forObject,
                          gen, typeId);
                      children: []
                      pos: 19025
                      length: 72
                    pos: 19011
                    length: 96
                children: []
                pos: 18883
                length: 224
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: writeCustomTypeSuffixForArray
                    children: []
                    pos: 19147
                    length: 29
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: Object value
                      children: []
                      pos: 19177
                      length: 12
                    pos: 19117
                    length: 222
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: _typeSerializer.writeCustomTypeSuffixForArray(_forObject,
                          gen, typeId);
                      children: []
                      pos: 19258
                      length: 71
                    pos: 19244
                    length: 95
                children: []
                pos: 19117
                length: 222
              pos: 15247
              length: 4098
          children: []
          pos: 15247
          length: 4098
        pos: 1606
        length: 17741
    children: []
    pos: 1606
    length: 17741
  pos: 0
  length: 19348
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: JsonValueSerializer
        children: []
        pos: 1543
        length: 19
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected final AnnotatedMethod _accessorMethod;
          children: []
          pos: 1739
          length: 48
        - type: field_declaration
          fields:
            text: protected final JsonSerializer<Object> _valueSerializer;
          children: []
          pos: 1793
          length: 56
        - type: field_declaration
          fields:
            text: protected final BeanProperty _property;
          children: []
          pos: 1855
          length: 39
        - type: field_declaration
          fields:
            text: protected final boolean _forceTypeInformation;
          children: []
          pos: 2176
          length: 46
        - type: constructor_declaration
          fields:
            text: |-
              @SuppressWarnings("unchecked")
                  public JsonValueSerializer(AnnotatedMethod valueMethod, JsonSerializer<?> ser)
                  {
                      super(valueMethod.getType());
                      _accessorMethod = valueMethod;
                      _valueSerializer = (JsonSerializer<Object>) ser;
                      _property = null;
                      _forceTypeInformation = true; // gets reconsidered when we are contextualized
                  }
          children: []
          pos: 2790
          length: 371
        - type: constructor_declaration
          fields:
            text: |-
              @SuppressWarnings("unchecked")
                  public JsonValueSerializer(JsonValueSerializer src, BeanProperty property,
                          JsonSerializer<?> ser, boolean forceTypeInfo)
                  {
                      super(_notNullClass(src.handledType()));
                      _accessorMethod = src._accessorMethod;
                      _valueSerializer = (JsonSerializer<Object>) ser;
                      _property = property;
                      _forceTypeInformation = forceTypeInfo;
                  }
          children: []
          pos: 3167
          length: 409
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _notNullClass
              children: []
              pos: 3652
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 3666
                length: 12
              pos: 3582
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (cls == null) ? Object.class : (Class<Object>) cls;'
                children: []
                pos: 3690
                length: 58
              pos: 3680
              length: 74
          children: []
          pos: 3582
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withResolved
              children: []
              pos: 3791
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: BeanProperty property
                children: []
                pos: 3804
                length: 21
              pos: 3764
              length: 365
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: and
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: _property
                                    children: []
                                    pos: 3903
                                    length: 9
                                  right:
                                    type: identifier
                                    fields:
                                      text: property
                                    children: []
                                    pos: 3916
                                    length: 8
                                children: []
                                pos: 3903
                                length: 21
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: _valueSerializer
                                    children: []
                                    pos: 3928
                                    length: 16
                                  right:
                                    type: identifier
                                    fields:
                                      text: ser
                                    children: []
                                    pos: 3948
                                    length: 3
                                children: []
                                pos: 3928
                                length: 23
                            children: []
                            pos: 3903
                            length: 48
                          right:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: forceTypeInfo
                                children: []
                                pos: 3971
                                length: 13
                              right:
                                type: identifier
                                fields:
                                  text: _forceTypeInformation
                                children: []
                                pos: 3988
                                length: 21
                            children: []
                            pos: 3971
                            length: 38
                        children: []
                        pos: 3903
                        length: 106
                    children: []
                    pos: 3902
                    length: 108
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4025
                    length: 12
                  pos: 4011
                  length: 36
                pos: 3899
                length: 148
              - type: return_statement
                fields:
                  text: return new JsonValueSerializer(this, property, ser, forceTypeInfo);
                children: []
                pos: 4056
                length: 67
              pos: 3889
              length: 240
          children: []
          pos: 3764
          length: 365
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createContextual
              children: []
              pos: 4489
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider provider
                children: []
                pos: 4506
                length: 27
              pos: 4450
              length: 1802
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JsonSerializer<?> ser = _valueSerializer;
                children: []
                pos: 4620
                length: 41
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: ser
                            children: []
                            pos: 4674
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4681
                            length: 4
                        children: []
                        pos: 4674
                        length: 11
                    children: []
                    pos: 4673
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JavaType t = _accessorMethod.getType();
                    children: []
                    pos: 4960
                    length: 39
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: provider.isEnabled(MapperFeature.USE_STATIC_TYPING)
                                children: []
                                pos: 5016
                                length: 51
                              right:
                                type: method_invocation
                                fields:
                                  text: t.isFinal()
                                children: []
                                pos: 5071
                                length: 11
                            children: []
                            pos: 5016
                            length: 66
                        children: []
                        pos: 5015
                        length: 68
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: ser = provider.findPrimaryPropertySerializer(t, property);
                        children: []
                        pos: 5487
                        length: 58
                      - type: local_variable_declaration
                        fields:
                          text: boolean forceTypeInformation = isNaturalTypeWithStdHandling(t.getRawClass(),
                            ser);
                        children: []
                        pos: 5794
                        length: 82
                      - type: return_statement
                        fields:
                          text: return withResolved(property, ser, forceTypeInformation);
                        children: []
                        pos: 5893
                        length: 57
                      pos: 5084
                      length: 880
                    pos: 5012
                    length: 952
                  pos: 4687
                  length: 1287
                pos: 4670
                length: 1555
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 6234
                length: 12
              pos: 4610
              length: 1642
          children: []
          pos: 4450
          length: 1802
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serialize
              children: []
              pos: 6464
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object bean
                children: []
                pos: 6474
                length: 11
              pos: 6438
              length: 1545
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Object value = _accessorMethod.getValue(bean);
                      children: []
                      pos: 6582
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 6645
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 6654
                                  length: 4
                              children: []
                              pos: 6645
                              length: 13
                          children: []
                          pos: 6644
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: prov.defaultSerializeNull(gen);
                          children: []
                          pos: 6678
                          length: 31
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 6726
                          length: 7
                        pos: 6660
                        length: 87
                      pos: 6641
                      length: 106
                    - type: local_variable_declaration
                      fields:
                        text: JsonSerializer<Object> ser = _valueSerializer;
                      children: []
                      pos: 6760
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ser
                                  children: []
                                  pos: 6823
                                  length: 3
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 6830
                                  length: 4
                              children: []
                              pos: 6823
                              length: 11
                          children: []
                          pos: 6822
                          length: 13
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: Class<?> c = value.getClass();
                          children: []
                          pos: 6854
                          length: 30
                        - type: expression_statement
                          fields:
                            text: ser = prov.findTypedValueSerializer(c, true, _property);
                          children: []
                          pos: 7208
                          length: 56
                        pos: 6836
                        length: 442
                      pos: 6819
                      length: 459
                    - type: expression_statement
                      fields:
                        text: ser.serialize(value, gen, prov);
                      children: []
                      pos: 7291
                      length: 32
                    pos: 6568
                    length: 765
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      throw ioe;
                                  }
                      children: []
                      pos: 7334
                      length: 58
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Exception e) {
                                      Throwable t = e;
                                      // Need to unwrap this specific type, to see infinite recursion...
                                      while (t instanceof InvocationTargetException && t.getCause() != null) {
                                          t = t.getCause();
                                      }
                                      // Errors shouldn't be wrapped (and often can't, as well)
                                      if (t instanceof Error) {
                                          throw (Error) t;
                                      }
                                      // let's try to indicate the path best we can...
                                      throw JsonMappingException.wrapWithPath(t, bean, _accessorMethod.getName() + "()");
                                  }
                      children: []
                      pos: 7393
                      length: 584
                    pos: 6564
                    length: 1413
                children: []
                pos: 6564
                length: 1413
              pos: 6554
              length: 1429
          children: []
          pos: 6438
          length: 1545
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: serializeWithType
              children: []
              pos: 8015
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object bean
                children: []
                pos: 8033
                length: 11
              pos: 7989
              length: 2293
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Object value = null;
                children: []
                pos: 8241
                length: 20
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: value = _accessorMethod.getValue(bean);
                      children: []
                      pos: 8288
                      length: 39
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: value
                                  children: []
                                  pos: 8411
                                  length: 5
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 8420
                                  length: 4
                              children: []
                              pos: 8411
                              length: 13
                          children: []
                          pos: 8410
                          length: 15
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: provider.defaultSerializeNull(gen);
                          children: []
                          pos: 8444
                          length: 35
                        - type: return_statement
                          fields:
                            text: return;
                          children: []
                          pos: 8496
                          length: 7
                        pos: 8426
                        length: 91
                      pos: 8407
                      length: 110
                    - type: local_variable_declaration
                      fields:
                        text: JsonSerializer<Object> ser = _valueSerializer;
                      children: []
                      pos: 8530
                      length: 46
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: equals
                              fields:
                                left:
                                  type: identifier
                                  fields:
                                    text: ser
                                  children: []
                                  pos: 8593
                                  length: 3
                                right:
                                  type: null_literal
                                  fields: {}
                                  children: []
                                  pos: 8600
                                  length: 4
                              children: []
                              pos: 8593
                              length: 11
                          children: []
                          pos: 8592
                          length: 13
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: ser = provider.findValueSerializer(value.getClass(),
                              _property);
                          children: []
                          pos: 8754
                          length: 64
                        pos: 8606
                        length: 226
                      pos: 8589
                      length: 749
                    - type: expression_statement
                      fields:
                        text: ser.serializeWithType(value, gen, provider, typeSer0);
                      children: []
                      pos: 9568
                      length: 54
                    pos: 8274
                    length: 1358
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      throw ioe;
                                  }
                      children: []
                      pos: 9633
                      length: 58
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Exception e) {
                                      Throwable t = e;
                                      // Need to unwrap this specific type, to see infinite recursion...
                                      while (t instanceof InvocationTargetException && t.getCause() != null) {
                                          t = t.getCause();
                                      }
                                      // Errors shouldn't be wrapped (and often can't, as well)
                                      if (t instanceof Error) {
                                          throw (Error) t;
                                      }
                                      // let's try to indicate the path best we can...
                                      throw JsonMappingException.wrapWithPath(t, bean, _accessorMethod.getName() + "()");
                                  }
                      children: []
                      pos: 9692
                      length: 584
                    pos: 8270
                    length: 2006
                children: []
                pos: 8270
                length: 2006
              pos: 8154
              length: 2128
          children: []
          pos: 7989
          length: 2293
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getSchema
              children: []
              pos: 10359
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: SerializerProvider provider
                children: []
                pos: 10369
                length: 27
              pos: 10292
              length: 403
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: _valueSerializer instanceof SchemaAware
                        children: []
                        pos: 10467
                        length: 39
                    children: []
                    pos: 10466
                    length: 41
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return ((SchemaAware)_valueSerializer).getSchema(provider,
                        null);
                    children: []
                    pos: 10522
                    length: 65
                  pos: 10508
                  length: 89
                pos: 10463
                length: 134
              - type: return_statement
                fields:
                  text: return com.fasterxml.jackson.databind.jsonschema.JsonSchema.getDefaultSchemaNode();
                children: []
                pos: 10606
                length: 83
              pos: 10453
              length: 242
          children: []
          pos: 10292
          length: 403
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: acceptJsonFormatVisitor
              children: []
              pos: 10727
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 10751
                length: 32
              pos: 10701
              length: 1335
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final JavaType type = _accessorMethod.getType();
                children: []
                pos: 11351
                length: 48
              - type: local_variable_declaration
                fields:
                  text: Class<?> declaring = _accessorMethod.getDeclaringClass();
                children: []
                pos: 11408
                length: 57
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: declaring
                                    children: []
                                    pos: 11479
                                    length: 9
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 11492
                                    length: 4
                                children: []
                                pos: 11479
                                length: 17
                            children: []
                            pos: 11478
                            length: 19
                          right:
                            type: method_invocation
                            fields:
                              text: declaring.isEnum()
                            children: []
                            pos: 11501
                            length: 18
                        children: []
                        pos: 11478
                        length: 41
                    children: []
                    pos: 11477
                    length: 43
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: _acceptJsonFormatVisitorForEnum(visitor, typeHint,
                                declaring)
                            children: []
                            pos: 11539
                            length: 61
                        children: []
                        pos: 11538
                        length: 63
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 11620
                        length: 7
                      pos: 11602
                      length: 39
                    pos: 11535
                    length: 106
                  pos: 11521
                  length: 130
                pos: 11474
                length: 177
              - type: local_variable_declaration
                fields:
                  text: JsonSerializer<Object> ser = _valueSerializer;
                children: []
                pos: 11660
                length: 46
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: ser
                            children: []
                            pos: 11719
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11726
                            length: 4
                        children: []
                        pos: 11719
                        length: 11
                    children: []
                    pos: 11718
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: ser = visitor.getProvider().findTypedValueSerializer(type,
                        false, _property);
                    children: []
                    pos: 11746
                    length: 77
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: ser
                                children: []
                                pos: 11840
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 11847
                                length: 4
                            children: []
                            pos: 11840
                            length: 11
                        children: []
                        pos: 11839
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: visitor.expectAnyFormat(typeHint);
                        children: []
                        pos: 11895
                        length: 34
                      - type: return_statement
                        fields:
                          text: return;
                        children: []
                        pos: 11946
                        length: 7
                      pos: 11853
                      length: 114
                    pos: 11836
                    length: 131
                  pos: 11732
                  length: 245
                pos: 11715
                length: 262
              - type: expression_statement
                fields:
                  text: ser.acceptJsonFormatVisitor(visitor, null);
                children: []
                pos: 11986
                length: 43
              pos: 10844
              length: 1192
          children: []
          pos: 10701
          length: 1335
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _acceptJsonFormatVisitorForEnum
              children: []
              pos: 12335
              length: 31
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JsonFormatVisitorWrapper visitor
                children: []
                pos: 12367
                length: 32
              pos: 12317
              length: 1382
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JsonStringFormatVisitor stringVisitor = visitor.expectStringFormat(typeHint);
                children: []
                pos: 12563
                length: 77
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: stringVisitor
                            children: []
                            pos: 12653
                            length: 13
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 12670
                            length: 4
                        children: []
                        pos: 12653
                        length: 21
                    children: []
                    pos: 12652
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Set<String> enums = new LinkedHashSet<String>();
                    children: []
                    pos: 12690
                    length: 48
                  - type: enhanced_for_statement
                    fields:
                      text: |-
                        for (Object en : enumType.getEnumConstants()) {
                                        try {
                                            // 21-Apr-2016, tatu: This is convoluted to the max, but essentially we
                                            //   call `@JsonValue`-annotated accessor method on all Enum members,
                                            //   so it all "works out". To some degree.
                                            enums.add(String.valueOf(_accessorMethod.callOn(en)));
                                        } catch (Exception e) {
                                            Throwable t = e;
                                            while (t instanceof InvocationTargetException && t.getCause() != null) {
                                                t = t.getCause();
                                            }
                                            if (t instanceof Error) {
                                                throw (Error) t;
                                            }
                                            throw JsonMappingException.wrapWithPath(t, en, _accessorMethod.getName() + "()");
                                        }
                                    }
                    children: []
                    pos: 12751
                    length: 867
                  - type: expression_statement
                    fields:
                      text: stringVisitor.enumTypes(enums);
                    children: []
                    pos: 13631
                    length: 31
                  pos: 12676
                  length: 996
                pos: 12649
                length: 1023
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 13681
                length: 12
              pos: 12491
              length: 1208
          children: []
          pos: 12317
          length: 1382
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isNaturalTypeWithStdHandling
              children: []
              pos: 13723
              length: 28
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> rawType
                children: []
                pos: 13752
                length: 16
              pos: 13705
              length: 593
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: rawType.isPrimitive()
                        children: []
                        pos: 13870
                        length: 21
                    children: []
                    pos: 13869
                    length: 23
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: and
                                fields:
                                  left:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: rawType
                                        children: []
                                        pos: 13911
                                        length: 7
                                      right:
                                        type: field_access
                                        fields:
                                          text: Integer.TYPE
                                        children: []
                                        pos: 13922
                                        length: 12
                                    children: []
                                    pos: 13911
                                    length: 23
                                  right:
                                    type: not_equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: rawType
                                        children: []
                                        pos: 13938
                                        length: 7
                                      right:
                                        type: field_access
                                        fields:
                                          text: Boolean.TYPE
                                        children: []
                                        pos: 13949
                                        length: 12
                                    children: []
                                    pos: 13938
                                    length: 23
                                children: []
                                pos: 13911
                                length: 50
                              right:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: rawType
                                    children: []
                                    pos: 13965
                                    length: 7
                                  right:
                                    type: field_access
                                    fields:
                                      text: Double.TYPE
                                    children: []
                                    pos: 13976
                                    length: 11
                                children: []
                                pos: 13965
                                length: 22
                            children: []
                            pos: 13911
                            length: 76
                        children: []
                        pos: 13910
                        length: 78
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return false;
                        children: []
                        pos: 14007
                        length: 13
                      pos: 13989
                      length: 45
                    pos: 13907
                    length: 127
                  pos: 13893
                  length: 151
                pos: 13866
                length: 385
              - type: return_statement
                fields:
                  text: return isDefaultSerializer(ser);
                children: []
                pos: 14260
                length: 32
              pos: 13797
              length: 501
          children: []
          pos: 13705
          length: 593
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 14497
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 14469
              length: 177
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return "(@JsonValue serializer for method " + _accessorMethod.getDeclaringClass()
                    + "#" + _accessorMethod.getName() + ")";
                children: []
                pos: 14518
                length: 122
              pos: 14508
              length: 138
          children: []
          pos: 14469
          length: 177
        pos: 1486
        length: 13588
    children: []
    pos: 1486
    length: 13588
  pos: 0
  length: 15075
text_diff: "--- before\n+++ after\n@@ -6,7 +6,6 @@\n import java.util.LinkedHashSet;\n
  import java.util.Set;\n \n-import com.fasterxml.jackson.annotation.JsonTypeInfo.As;\n
  import com.fasterxml.jackson.core.*;\n import com.fasterxml.jackson.databind.*;\n
  import com.fasterxml.jackson.databind.annotation.JacksonStdImpl;\n@@ -15,7 +14,6
  @@\n import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonFormatVisitorWrapper;\n
  import com.fasterxml.jackson.databind.jsonFormatVisitors.JsonStringFormatVisitor;\n
  import com.fasterxml.jackson.databind.jsonschema.SchemaAware;\n-import com.fasterxml.jackson.databind.jsontype.TypeIdResolver;\n
  import com.fasterxml.jackson.databind.jsontype.TypeSerializer;\n import com.fasterxml.jackson.databind.ser.BeanSerializer;\n
  import com.fasterxml.jackson.databind.ser.ContextualSerializer;\n@@ -225,8 +223,7
  @@\n             // 28-Sep-2016, tatu: As per [databind#1385], we do need to do
  some juggling\n             //    to use different Object for type id (logical type)
  and actual serialization\n             //    (delegat type).\n-            TypeSerializerRerouter
  rr = new TypeSerializerRerouter(typeSer0, bean);\n-            ser.serializeWithType(value,
  gen, provider, rr);\n+            ser.serializeWithType(value, gen, provider, typeSer0);\n
  \        } catch (IOException ioe) {\n             throw ioe;\n         } catch
  (Exception e) {\n@@ -363,108 +360,24 @@\n      * override Object to use for type
  id (logical type) even when asking serialization\n      * of something else (delegate
  type)\n      */\n-    static class TypeSerializerRerouter\n-        extends TypeSerializer\n-
  \   {\n-        protected final TypeSerializer _typeSerializer;\n-        protected
  final Object _forObject;\n \n-        public TypeSerializerRerouter(TypeSerializer
  ts, Object ob) {\n-            _typeSerializer = ts;\n-            _forObject =
  ob;\n-        }\n \n-        @Override\n-        public TypeSerializer forProperty(BeanProperty
  prop) { // should never get called\n-            throw new UnsupportedOperationException();\n-
  \       }\n \n-        @Override\n-        public As getTypeInclusion() {\n-            return
  _typeSerializer.getTypeInclusion();\n-        }\n \n-        @Override\n-        public
  String getPropertyName() {\n-            return _typeSerializer.getPropertyName();\n-
  \       }\n \n-        @Override\n-        public TypeIdResolver getTypeIdResolver()
  {\n-            return _typeSerializer.getTypeIdResolver();\n-        }\n \n-        @Override\n-
  \       public void writeTypePrefixForScalar(Object value, JsonGenerator gen) throws
  IOException {\n-            _typeSerializer.writeTypePrefixForScalar(_forObject,
  gen);\n-        }\n \n-        @Override\n-        public void writeTypePrefixForObject(Object
  value, JsonGenerator gen) throws IOException {\n-            _typeSerializer.writeTypePrefixForObject(_forObject,
  gen);\n-        }\n \n-        @Override\n-        public void writeTypePrefixForArray(Object
  value, JsonGenerator gen) throws IOException {\n-            _typeSerializer.writeTypePrefixForArray(_forObject,
  gen);\n-        }\n \n-        @Override\n-        public void writeTypeSuffixForScalar(Object
  value, JsonGenerator gen) throws IOException {\n-            _typeSerializer.writeTypeSuffixForScalar(_forObject,
  gen);\n-        }\n \n-        @Override\n-        public void writeTypeSuffixForObject(Object
  value, JsonGenerator gen) throws IOException {\n-            _typeSerializer.writeTypeSuffixForObject(_forObject,
  gen);\n-        }\n \n-        @Override\n-        public void writeTypeSuffixForArray(Object
  value, JsonGenerator gen) throws IOException {\n-            _typeSerializer.writeTypeSuffixForArray(_forObject,
  gen);\n-        }\n \n-        public void writeTypePrefixForScalar(Object value,
  JsonGenerator gen, Class<?> type) throws IOException {\n-            _typeSerializer.writeTypePrefixForScalar(_forObject,
  gen, type);\n-        }\n \n-        public void writeTypePrefixForObject(Object
  value, JsonGenerator gen, Class<?> type) throws IOException {\n-            _typeSerializer.writeTypePrefixForObject(_forObject,
  gen, type);\n-        }\n \n-        public void writeTypePrefixForArray(Object
  value, JsonGenerator gen, Class<?> type) throws IOException {\n-            _typeSerializer.writeTypePrefixForArray(_forObject,
  gen, type);\n-        }\n         \n-        @Override\n-        public void writeCustomTypePrefixForScalar(Object
  value, JsonGenerator gen, String typeId)\n-                throws IOException {\n-
  \           _typeSerializer.writeCustomTypePrefixForScalar(_forObject, gen, typeId);\n-
  \       }\n \n-        @Override\n-        public void writeCustomTypePrefixForObject(Object
  value, JsonGenerator gen, String typeId) throws IOException {\n-            _typeSerializer.writeCustomTypePrefixForObject(_forObject,
  gen, typeId);\n-        }\n \n-        @Override\n-        public void writeCustomTypePrefixForArray(Object
  value, JsonGenerator gen, String typeId) throws IOException {\n-            _typeSerializer.writeCustomTypePrefixForArray(_forObject,
  gen, typeId);\n-        }\n \n-        @Override\n-        public void writeCustomTypeSuffixForScalar(Object
  value, JsonGenerator gen, String typeId) throws IOException {\n-            _typeSerializer.writeCustomTypeSuffixForScalar(_forObject,
  gen, typeId);\n-        }\n \n-        @Override\n-        public void writeCustomTypeSuffixForObject(Object
  value, JsonGenerator gen, String typeId) throws IOException {\n-            _typeSerializer.writeCustomTypeSuffixForObject(_forObject,
  gen, typeId);\n-        }\n \n-        @Override\n-        public void writeCustomTypeSuffixForArray(Object
  value, JsonGenerator gen, String typeId) throws IOException {\n-            _typeSerializer.writeCustomTypeSuffixForArray(_forObject,
  gen, typeId);\n-        }\n-    }\n }\n"
tree_diff: |+
  New cluster:
  UPDATE from ser.serializeWithType(value, gen, provider, rr); to ser.serializeWithType(value, gen, provider, typeSer0);
  ------------
  ===
  update-node
  ---
  expression_statement: ser.serializeWithType(value, gen, provider, rr); [9772,9820]
  replace ser.serializeWithType(value, gen, provider, rr); by ser.serializeWithType(value, gen, provider, typeSer0);

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: TypeSerializerRerouter rr = new TypeSerializerRerouter(typeSer0, bean); [9688,9759]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: TypeSerializerRerouter rr = new TypeSerializerRerouter(typeSer0, bean); [9688,9759]
  ===

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  class_declaration [15247,19345]
      identifier: TypeSerializerRerouter [15260,15282]
      class_body [15247,19345]
          field_declaration: protected final TypeSerializer _typeSerializer; [15328,15375]
          field_declaration: protected final Object _forObject; [15384,15418]
          constructor_declaration: public TypeSerializerRerouter(TypeSerializer ts, Object ob) {
              _typeSerializer = ts;
              _forObject = ob;
          } [15428,15562]
          method_declaration [15572,15736]
              identifier: forProperty [15612,15623]
              method_parameters [15572,15736]
                  formal_parameter: BeanProperty prop [15624,15641]
              block [15643,15736]
                  throw_statement: throw new UnsupportedOperationException(); [15684,15726]
          method_declaration [15746,15859]
              identifier: getTypeInclusion [15774,15790]
              method_parameters [15746,15859]
              block [15793,15859]
                  return_statement: return _typeSerializer.getTypeInclusion(); [15807,15849]
          method_declaration [15869,15984]
              identifier: getPropertyName [15901,15916]
              method_parameters [15869,15984]
              block [15919,15984]
                  return_statement: return _typeSerializer.getPropertyName(); [15933,15974]
          method_declaration [15994,16121]
              identifier: getTypeIdResolver [16034,16051]
              method_parameters [15994,16121]
              block [16054,16121]
                  return_statement: return _typeSerializer.getTypeIdResolver(); [16068,16111]
          method_declaration [16131,16320]
              identifier: writeTypePrefixForScalar [16161,16185]
              method_parameters [16131,16320]
                  formal_parameter: Object value [16186,16198]
              block [16238,16320]
                  expression_statement: _typeSerializer.writeTypePrefixForScalar(_forObject, gen); [16252,16310]
          method_declaration [16330,16519]
              identifier: writeTypePrefixForObject [16360,16384]
              method_parameters [16330,16519]
                  formal_parameter: Object value [16385,16397]
              block [16437,16519]
                  expression_statement: _typeSerializer.writeTypePrefixForObject(_forObject, gen); [16451,16509]
          method_declaration [16529,16716]
              identifier: writeTypePrefixForArray [16559,16582]
              method_parameters [16529,16716]
                  formal_parameter: Object value [16583,16595]
              block [16635,16716]
                  expression_statement: _typeSerializer.writeTypePrefixForArray(_forObject, gen); [16649,16706]
          method_declaration [16726,16915]
              identifier: writeTypeSuffixForScalar [16756,16780]
              method_parameters [16726,16915]
                  formal_parameter: Object value [16781,16793]
              block [16833,16915]
                  expression_statement: _typeSerializer.writeTypeSuffixForScalar(_forObject, gen); [16847,16905]
          method_declaration [16925,17114]
              identifier: writeTypeSuffixForObject [16955,16979]
              method_parameters [16925,17114]
                  formal_parameter: Object value [16980,16992]
              block [17032,17114]
                  expression_statement: _typeSerializer.writeTypeSuffixForObject(_forObject, gen); [17046,17104]
          method_declaration [17124,17311]
              identifier: writeTypeSuffixForArray [17154,17177]
              method_parameters [17124,17311]
                  formal_parameter: Object value [17178,17190]
              block [17230,17311]
                  expression_statement: _typeSerializer.writeTypeSuffixForArray(_forObject, gen); [17244,17301]
          method_declaration [17321,17513]
              identifier: writeTypePrefixForScalar [17333,17357]
              method_parameters [17321,17513]
                  formal_parameter: Object value [17358,17370]
              block [17425,17513]
                  expression_statement: _typeSerializer.writeTypePrefixForScalar(_forObject, gen, type); [17439,17503]
          method_declaration [17523,17715]
              identifier: writeTypePrefixForObject [17535,17559]
              method_parameters [17523,17715]
                  formal_parameter: Object value [17560,17572]
              block [17627,17715]
                  expression_statement: _typeSerializer.writeTypePrefixForObject(_forObject, gen, type); [17641,17705]
          method_declaration [17725,17915]
              identifier: writeTypePrefixForArray [17737,17760]
              method_parameters [17725,17915]
                  formal_parameter: Object value [17761,17773]
              block [17828,17915]
                  expression_statement: _typeSerializer.writeTypePrefixForArray(_forObject, gen, type); [17842,17905]
          method_declaration [17933,18173]
              identifier: writeCustomTypePrefixForScalar [17963,17993]
              method_parameters [17933,18173]
                  formal_parameter: Object value [17994,18006]
              block [18077,18173]
                  expression_statement: _typeSerializer.writeCustomTypePrefixForScalar(_forObject, gen, typeId); [18091,18163]
          method_declaration [18183,18407]
              identifier: writeCustomTypePrefixForObject [18213,18243]
              method_parameters [18183,18407]
                  formal_parameter: Object value [18244,18256]
              block [18311,18407]
                  expression_statement: _typeSerializer.writeCustomTypePrefixForObject(_forObject, gen, typeId); [18325,18397]
          method_declaration [18417,18639]
              identifier: writeCustomTypePrefixForArray [18447,18476]
              method_parameters [18417,18639]
                  formal_parameter: Object value [18477,18489]
              block [18544,18639]
                  expression_statement: _typeSerializer.writeCustomTypePrefixForArray(_forObject, gen, typeId); [18558,18629]
          method_declaration [18649,18873]
              identifier: writeCustomTypeSuffixForScalar [18679,18709]
              method_parameters [18649,18873]
                  formal_parameter: Object value [18710,18722]
              block [18777,18873]
                  expression_statement: _typeSerializer.writeCustomTypeSuffixForScalar(_forObject, gen, typeId); [18791,18863]
          method_declaration [18883,19107]
              identifier: writeCustomTypeSuffixForObject [18913,18943]
              method_parameters [18883,19107]
                  formal_parameter: Object value [18944,18956]
              block [19011,19107]
                  expression_statement: _typeSerializer.writeCustomTypeSuffixForObject(_forObject, gen, typeId); [19025,19097]
          method_declaration [19117,19339]
              identifier: writeCustomTypeSuffixForArray [19147,19176]
              method_parameters [19117,19339]
                  formal_parameter: Object value [19177,19189]
              block [19244,19339]
                  expression_statement: _typeSerializer.writeCustomTypeSuffixForArray(_forObject, gen, typeId); [19258,19329]

...
