---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ByteBuddyMockMaker
        children: []
        pos: 544
        length: 18
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final ClassInstantiator classInstantiator;
          children: []
          pos: 591
          length: 50
        - type: field_declaration
          fields:
            text: private final CachingMockBytecodeGenerator cachingMockBytecodeGenerator;
          children: []
          pos: 646
          length: 72
        - type: constructor_declaration
          fields:
            text: |-
              public ByteBuddyMockMaker() {
                      classInstantiator = initializeClassInstantiator();
                      cachingMockBytecodeGenerator = new CachingMockBytecodeGenerator();
                  }
          children: []
          pos: 724
          length: 169
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createMock
              children: []
              pos: 912
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockCreationSettings<T> settings
                children: []
                pos: 923
                length: 32
              pos: 899
              length: 1894
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: settings.getSerializableMode()
                            children: []
                            pos: 992
                            length: 30
                          right:
                            type: field_access
                            fields:
                              text: SerializableMode.ACROSS_CLASSLOADERS
                            children: []
                            pos: 1026
                            length: 36
                        children: []
                        pos: 992
                        length: 70
                    children: []
                    pos: 991
                    length: 72
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new MockitoException("Serialization across classloaders
                        not yet supported with ByteBuddyMockMaker");
                    children: []
                    pos: 1078
                    length: 106
                  pos: 1064
                  length: 130
                pos: 988
                length: 206
              - type: local_variable_declaration
                fields:
                  text: |-
                    Class<? extends T> mockedProxyType = cachingMockBytecodeGenerator.get(
                                    settings.getTypeToMock(),
                                    settings.getExtraInterfaces()
                            );
                children: []
                pos: 1203
                length: 169
              - type: local_variable_declaration
                fields:
                  text: Instantiator instantiator = new InstantiatorProvider().getInstantiator(settings);
                children: []
                pos: 1381
                length: 81
              - type: local_variable_declaration
                fields:
                  text: T mockInstance = null;
                children: []
                pos: 1471
                length: 22
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: mockInstance = instantiator.newInstance(mockedProxyType);
                      children: []
                      pos: 1520
                      length: 57
                    - type: local_variable_declaration
                      fields:
                        text: MockMethodInterceptor.MockAccess mockAccess = (MockMethodInterceptor.MockAccess)
                          mockInstance;
                      children: []
                      pos: 1590
                      length: 94
                    - type: expression_statement
                      fields:
                        text: mockAccess.setMockitoInterceptor(new MockMethodInterceptor(asInternalMockHandler(handler),
                          settings));
                      children: []
                      pos: 1697
                      length: 102
                    - type: return_statement
                      fields:
                        text: return ensureMockIsAssignableToMockedType(settings,
                          mockInstance);
                      children: []
                      pos: 1813
                      length: 66
                    pos: 1506
                    length: 383
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (ClassCastException cce) {
                                      throw new MockitoException(join(
                                              "ClassCastException occurred while creating the mockito mock :",
                                              "  class to mock : " + describeClass(mockedProxyType),
                                              "  created class : " + describeClass(settings.getTypeToMock()),
                                              "  proxy instance class : " + describeClass(mockInstance),
                                              "  instance creation by : " + instantiator.getClass().getSimpleName(),
                                              "",
                                              "You might experience classloading issues, please ask the mockito mailing-list.",
                                              ""
                                      ),cce);
                                  }
                      children: []
                      pos: 1890
                      length: 670
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (org.mockito.internal.creation.instance.InstantiationException e) {
                                      throw new MockitoException("Unable to create mock instance of type '" + mockedProxyType.getSuperclass().getSimpleName() + "'", e);
                                  }
                      children: []
                      pos: 2561
                      length: 226
                    pos: 1502
                    length: 1285
                children: []
                pos: 1502
                length: 1285
              pos: 978
              length: 1815
          children: []
          pos: 899
          length: 1894
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: ensureMockIsAssignableToMockedType
              children: []
              pos: 2813
              length: 34
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockCreationSettings<T> settings
                children: []
                pos: 2848
                length: 32
              pos: 2799
              length: 395
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Class<T> typeToMock = settings.getTypeToMock();
                children: []
                pos: 3103
                length: 47
              - type: return_statement
                fields:
                  text: return typeToMock.cast(mock);
                children: []
                pos: 3159
                length: 29
              pos: 2890
              length: 304
          children: []
          pos: 2799
          length: 395
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: describeClass
              children: []
              pos: 3222
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class type
                children: []
                pos: 3236
                length: 10
              pos: 3200
              length: 188
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return type == null ? "null" : "''" + type.getCanonicalName()
                    + "'', loaded by classloader : ''" + type.getClassLoader() + "''";'
                children: []
                pos: 3258
                length: 124
              pos: 3248
              length: 140
          children: []
          pos: 3200
          length: 188
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: describeClass
              children: []
              pos: 3416
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object instance
                children: []
                pos: 3430
                length: 15
              pos: 3394
              length: 139
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return instance == null ? "null" : describeClass(instance.getClass());'
                children: []
                pos: 3457
                length: 70
              pos: 3447
              length: 86
          children: []
          pos: 3394
          length: 139
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getHandler
              children: []
              pos: 3558
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object mock
                children: []
                pos: 3569
                length: 11
              pos: 3539
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(mock instanceof MockMethodInterceptor.MockAccess)"
                        children: []
                        pos: 3596
                        length: 51
                    children: []
                    pos: 3595
                    length: 53
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 3663
                    length: 12
                  pos: 3649
                  length: 36
                pos: 3592
                length: 93
              - type: return_statement
                fields:
                  text: return ((MockMethodInterceptor.MockAccess) mock).getMockitoInterceptor().getMockHandler();
                children: []
                pos: 3694
                length: 90
              pos: 3582
              length: 208
          children: []
          pos: 3539
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetMock
              children: []
              pos: 3808
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object mock
                children: []
                pos: 3818
                length: 11
              pos: 3796
              length: 268
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: |-
                    ((MockMethodInterceptor.MockAccess) mock).setMockitoInterceptor(
                                    new MockMethodInterceptor(asInternalMockHandler(newHandler), settings)
                            );
                children: []
                pos: 3896
                length: 162
              pos: 3886
              length: 178
          children: []
          pos: 3796
          length: 268
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: initializeClassInstantiator
              children: []
              pos: 4103
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4070
              length: 948
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Class<?> objenesisClassLoader = Class.forName("org.mockito.internal.creation.bytebuddy.ClassInstantiator$UsingObjenesis");
                      children: []
                      pos: 4161
                      length: 122
                    - type: local_variable_declaration
                      fields:
                        text: Constructor<?> usingClassCacheConstructor = objenesisClassLoader.getDeclaredConstructor(boolean.class);
                      children: []
                      pos: 4296
                      length: 103
                    - type: return_statement
                      fields:
                        text: return ClassInstantiator.class.cast(usingClassCacheConstructor.newInstance(new
                          GlobalConfiguration().enableClassCache()));
                      children: []
                      pos: 4412
                      length: 122
                    pos: 4147
                    length: 397
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Throwable throwable) {
                                      // MockitoException cannot be used at this point as we are early in the classloading chain and necessary dependencies may not yet be loadable by the classloader
                                      throw new IllegalStateException(join(
                                              "Mockito could not create mock: Objenesis is missing on the classpath.",
                                              "Please add Objenesis on the classpath.",
                                              ""
                                      ), throwable);
                                  }
                      children: []
                      pos: 4545
                      length: 467
                    pos: 4143
                    length: 869
                children: []
                pos: 4143
                length: 869
              pos: 4133
              length: 885
          children: []
          pos: 4070
          length: 948
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asInternalMockHandler
              children: []
              pos: 5059
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockHandler handler
                children: []
                pos: 5081
                length: 19
              pos: 5024
              length: 450
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(handler instanceof InternalMockHandler)"
                        children: []
                        pos: 5116
                        length: 41
                    children: []
                    pos: 5115
                    length: 43
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new MockitoException(join(
                                            "At the moment you cannot provide own implementations of MockHandler.",
                                            "Please see the javadocs for the MockMaker interface.",
                                            ""
                                    ));
                    children: []
                    pos: 5173
                    length: 239
                  pos: 5159
                  length: 263
                pos: 5112
                length: 310
              - type: return_statement
                fields:
                  text: return (InternalMockHandler) handler;
                children: []
                pos: 5431
                length: 37
              pos: 5102
              length: 372
          children: []
          pos: 5024
          length: 450
        pos: 531
        length: 4945
    children: []
    pos: 531
    length: 4945
  pos: 0
  length: 5477
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ByteBuddyMockMaker
        children: []
        pos: 544
        length: 18
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final ClassInstantiator classInstantiator;
          children: []
          pos: 591
          length: 50
        - type: field_declaration
          fields:
            text: private final CachingMockBytecodeGenerator cachingMockBytecodeGenerator;
          children: []
          pos: 646
          length: 72
        - type: constructor_declaration
          fields:
            text: |-
              public ByteBuddyMockMaker() {
                      classInstantiator = initializeClassInstantiator();
                      cachingMockBytecodeGenerator = new CachingMockBytecodeGenerator();
                  }
          children: []
          pos: 724
          length: 169
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createMock
              children: []
              pos: 912
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockCreationSettings<T> settings
                children: []
                pos: 923
                length: 32
              pos: 899
              length: 1814
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: settings.getSerializableMode()
                            children: []
                            pos: 992
                            length: 30
                          right:
                            type: field_access
                            fields:
                              text: SerializableMode.ACROSS_CLASSLOADERS
                            children: []
                            pos: 1026
                            length: 36
                        children: []
                        pos: 992
                        length: 70
                    children: []
                    pos: 991
                    length: 72
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new MockitoException("Serialization across classloaders
                        not yet supported with ByteBuddyMockMaker");
                    children: []
                    pos: 1078
                    length: 106
                  pos: 1064
                  length: 130
                pos: 988
                length: 206
              - type: local_variable_declaration
                fields:
                  text: |-
                    Class<? extends T> mockedProxyType = cachingMockBytecodeGenerator.get(
                                    settings.getTypeToMock(),
                                    settings.getExtraInterfaces()
                            );
                children: []
                pos: 1203
                length: 169
              - type: local_variable_declaration
                fields:
                  text: T mockInstance = null;
                children: []
                pos: 1381
                length: 22
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: mockInstance = classInstantiator.instantiate(mockedProxyType);
                      children: []
                      pos: 1430
                      length: 62
                    - type: local_variable_declaration
                      fields:
                        text: MockMethodInterceptor.MockAccess mockAccess = (MockMethodInterceptor.MockAccess)
                          mockInstance;
                      children: []
                      pos: 1505
                      length: 94
                    - type: expression_statement
                      fields:
                        text: mockAccess.setMockitoInterceptor(new MockMethodInterceptor(asInternalMockHandler(handler),
                          settings));
                      children: []
                      pos: 1612
                      length: 102
                    - type: return_statement
                      fields:
                        text: return ensureMockIsAssignableToMockedType(settings,
                          mockInstance);
                      children: []
                      pos: 1728
                      length: 66
                    pos: 1416
                    length: 388
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (ClassCastException cce) {
                                      throw new MockitoException(join(
                                              "ClassCastException occurred while creating the mockito mock :",
                                              "  class to mock : " + describeClass(mockedProxyType),
                                              "  created class : " + describeClass(settings.getTypeToMock()),
                                              "  proxy instance class : " + describeClass(mockInstance),
                                              "  instance creation by : " + classInstantiator.getClass().getSimpleName(),
                                              "",
                                              "You might experience classloading issues, please ask the mockito mailing-list.",
                                              ""
                                      ),cce);
                                  }
                      children: []
                      pos: 1805
                      length: 675
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (org.mockito.internal.creation.instance.InstantiationException e) {
                                      throw new MockitoException("Unable to create mock instance of type '" + mockedProxyType.getSuperclass().getSimpleName() + "'", e);
                                  }
                      children: []
                      pos: 2481
                      length: 226
                    pos: 1412
                    length: 1295
                children: []
                pos: 1412
                length: 1295
              pos: 978
              length: 1735
          children: []
          pos: 899
          length: 1814
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: ensureMockIsAssignableToMockedType
              children: []
              pos: 2733
              length: 34
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockCreationSettings<T> settings
                children: []
                pos: 2768
                length: 32
              pos: 2719
              length: 395
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Class<T> typeToMock = settings.getTypeToMock();
                children: []
                pos: 3023
                length: 47
              - type: return_statement
                fields:
                  text: return typeToMock.cast(mock);
                children: []
                pos: 3079
                length: 29
              pos: 2810
              length: 304
          children: []
          pos: 2719
          length: 395
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: describeClass
              children: []
              pos: 3142
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class type
                children: []
                pos: 3156
                length: 10
              pos: 3120
              length: 188
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return type == null ? "null" : "''" + type.getCanonicalName()
                    + "'', loaded by classloader : ''" + type.getClassLoader() + "''";'
                children: []
                pos: 3178
                length: 124
              pos: 3168
              length: 140
          children: []
          pos: 3120
          length: 188
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: describeClass
              children: []
              pos: 3336
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object instance
                children: []
                pos: 3350
                length: 15
              pos: 3314
              length: 139
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return instance == null ? "null" : describeClass(instance.getClass());'
                children: []
                pos: 3377
                length: 70
              pos: 3367
              length: 86
          children: []
          pos: 3314
          length: 139
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getHandler
              children: []
              pos: 3478
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object mock
                children: []
                pos: 3489
                length: 11
              pos: 3459
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(mock instanceof MockMethodInterceptor.MockAccess)"
                        children: []
                        pos: 3516
                        length: 51
                    children: []
                    pos: 3515
                    length: 53
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 3583
                    length: 12
                  pos: 3569
                  length: 36
                pos: 3512
                length: 93
              - type: return_statement
                fields:
                  text: return ((MockMethodInterceptor.MockAccess) mock).getMockitoInterceptor().getMockHandler();
                children: []
                pos: 3614
                length: 90
              pos: 3502
              length: 208
          children: []
          pos: 3459
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: resetMock
              children: []
              pos: 3728
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object mock
                children: []
                pos: 3738
                length: 11
              pos: 3716
              length: 268
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: |-
                    ((MockMethodInterceptor.MockAccess) mock).setMockitoInterceptor(
                                    new MockMethodInterceptor(asInternalMockHandler(newHandler), settings)
                            );
                children: []
                pos: 3816
                length: 162
              pos: 3806
              length: 178
          children: []
          pos: 3716
          length: 268
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: initializeClassInstantiator
              children: []
              pos: 4023
              length: 27
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3990
              length: 948
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Class<?> objenesisClassLoader = Class.forName("org.mockito.internal.creation.bytebuddy.ClassInstantiator$UsingObjenesis");
                      children: []
                      pos: 4081
                      length: 122
                    - type: local_variable_declaration
                      fields:
                        text: Constructor<?> usingClassCacheConstructor = objenesisClassLoader.getDeclaredConstructor(boolean.class);
                      children: []
                      pos: 4216
                      length: 103
                    - type: return_statement
                      fields:
                        text: return ClassInstantiator.class.cast(usingClassCacheConstructor.newInstance(new
                          GlobalConfiguration().enableClassCache()));
                      children: []
                      pos: 4332
                      length: 122
                    pos: 4067
                    length: 397
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Throwable throwable) {
                                      // MockitoException cannot be used at this point as we are early in the classloading chain and necessary dependencies may not yet be loadable by the classloader
                                      throw new IllegalStateException(join(
                                              "Mockito could not create mock: Objenesis is missing on the classpath.",
                                              "Please add Objenesis on the classpath.",
                                              ""
                                      ), throwable);
                                  }
                      children: []
                      pos: 4465
                      length: 467
                    pos: 4063
                    length: 869
                children: []
                pos: 4063
                length: 869
              pos: 4053
              length: 885
          children: []
          pos: 3990
          length: 948
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asInternalMockHandler
              children: []
              pos: 4979
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: MockHandler handler
                children: []
                pos: 5001
                length: 19
              pos: 4944
              length: 450
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!(handler instanceof InternalMockHandler)"
                        children: []
                        pos: 5036
                        length: 41
                    children: []
                    pos: 5035
                    length: 43
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new MockitoException(join(
                                            "At the moment you cannot provide own implementations of MockHandler.",
                                            "Please see the javadocs for the MockMaker interface.",
                                            ""
                                    ));
                    children: []
                    pos: 5093
                    length: 239
                  pos: 5079
                  length: 263
                pos: 5032
                length: 310
              - type: return_statement
                fields:
                  text: return (InternalMockHandler) handler;
                children: []
                pos: 5351
                length: 37
              pos: 5022
              length: 372
          children: []
          pos: 4944
          length: 450
        pos: 531
        length: 4865
    children: []
    pos: 531
    length: 4865
  pos: 0
  length: 5397
text_diff: "--- before\n+++ after\n@@ -29,10 +29,9 @@\n                 settings.getTypeToMock(),\n
  \                settings.getExtraInterfaces()\n         );\n-        Instantiator
  instantiator = new InstantiatorProvider().getInstantiator(settings);\n         T
  mockInstance = null;\n         try {\n-            mockInstance = instantiator.newInstance(mockedProxyType);\n+
  \           mockInstance = classInstantiator.instantiate(mockedProxyType);\n             MockMethodInterceptor.MockAccess
  mockAccess = (MockMethodInterceptor.MockAccess) mockInstance;\n             mockAccess.setMockitoInterceptor(new
  MockMethodInterceptor(asInternalMockHandler(handler), settings));\n \n@@ -43,7 +42,7
  @@\n                     \"  class to mock : \" + describeClass(mockedProxyType),\n
  \                    \"  created class : \" + describeClass(settings.getTypeToMock()),\n
  \                    \"  proxy instance class : \" + describeClass(mockInstance),\n-
  \                   \"  instance creation by : \" + instantiator.getClass().getSimpleName(),\n+
  \                   \"  instance creation by : \" + classInstantiator.getClass().getSimpleName(),\n
  \                    \"\",\n                     \"You might experience classloading
  issues, please ask the mockito mailing-list.\",\n                     \"\"\n"
tree_diff: |+
  New cluster:
  UPDATE from mockInstance = instantiator.newInstance(mockedProxyType); to mockInstance = classInstantiator.instantiate(mockedProxyType);
  ------------
  ===
  update-node
  ---
  expression_statement: mockInstance = instantiator.newInstance(mockedProxyType); [1520,1577]
  replace mockInstance = instantiator.newInstance(mockedProxyType); by mockInstance = classInstantiator.instantiate(mockedProxyType);

  New cluster:
  UPDATE from catch (ClassCastException cce) {
              throw new MockitoException(join(
                      "ClassCastException occurred while creating the mockito mock :",
                      "  class to mock : " + describeClass(mockedProxyType),
                      "  created class : " + describeClass(settings.getTypeToMock()),
                      "  proxy instance class : " + describeClass(mockInstance),
                      "  instance creation by : " + instantiator.getClass().getSimpleName(),
                      "",
                      "You might experience classloading issues, please ask the mockito mailing-list.",
                      ""
              ),cce);
          } to catch (ClassCastException cce) {
              throw new MockitoException(join(
                      "ClassCastException occurred while creating the mockito mock :",
                      "  class to mock : " + describeClass(mockedProxyType),
                      "  created class : " + describeClass(settings.getTypeToMock()),
                      "  proxy instance class : " + describeClass(mockInstance),
                      "  instance creation by : " + classInstantiator.getClass().getSimpleName(),
                      "",
                      "You might experience classloading issues, please ask the mockito mailing-list.",
                      ""
              ),cce);
          }
  ------------
  ===
  update-node
  ---
  catch_clause: catch (ClassCastException cce) {
              throw new MockitoException(join(
                      "ClassCastException occurred while creating the mockito mock :",
                      "  class to mock : " + describeClass(mockedProxyType),
                      "  created class : " + describeClass(settings.getTypeToMock()),
                      "  proxy instance class : " + describeClass(mockInstance),
                      "  instance creation by : " + instantiator.getClass().getSimpleName(),
                      "",
                      "You might experience classloading issues, please ask the mockito mailing-list.",
                      ""
              ),cce);
          } [1890,2560]
  replace catch (ClassCastException cce) {
              throw new MockitoException(join(
                      "ClassCastException occurred while creating the mockito mock :",
                      "  class to mock : " + describeClass(mockedProxyType),
                      "  created class : " + describeClass(settings.getTypeToMock()),
                      "  proxy instance class : " + describeClass(mockInstance),
                      "  instance creation by : " + instantiator.getClass().getSimpleName(),
                      "",
                      "You might experience classloading issues, please ask the mockito mailing-list.",
                      ""
              ),cce);
          } by catch (ClassCastException cce) {
              throw new MockitoException(join(
                      "ClassCastException occurred while creating the mockito mock :",
                      "  class to mock : " + describeClass(mockedProxyType),
                      "  created class : " + describeClass(settings.getTypeToMock()),
                      "  proxy instance class : " + describeClass(mockInstance),
                      "  instance creation by : " + classInstantiator.getClass().getSimpleName(),
                      "",
                      "You might experience classloading issues, please ask the mockito mailing-list.",
                      ""
              ),cce);
          }

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: Instantiator instantiator = new InstantiatorProvider().getInstantiator(settings); [1381,1462]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: Instantiator instantiator = new InstantiatorProvider().getInstantiator(settings); [1381,1462]
  ===

...
