---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: PatternBuilder
        children: []
        pos: 1462
        length: 14
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final GroupBuilder gbuilder;
          children: []
          pos: 1484
          length: 36
        - type: field_declaration
          fields:
            text: private final DefaultOptionBuilder obuilder;
          children: []
          pos: 1525
          length: 44
        - type: field_declaration
          fields:
            text: private final ArgumentBuilder abuilder;
          children: []
          pos: 1574
          length: 39
        - type: constructor_declaration
          fields:
            text: |-
              public PatternBuilder() {
                      this(
                          new GroupBuilder(),
                          new DefaultOptionBuilder(),
                          new ArgumentBuilder());
                  }
          children: []
          pos: 1671
          length: 153
        - type: constructor_declaration
          fields:
            text: |-
              public PatternBuilder(
                      final GroupBuilder gbuilder,
                      final DefaultOptionBuilder obuilder,
                      final ArgumentBuilder abuilder) {
                      this.gbuilder = gbuilder;
                      this.obuilder = obuilder;
                      this.abuilder = abuilder;
                  }
          children: []
          pos: 2034
          length: 254
        - type: field_declaration
          fields:
            text: private final Set options = new LinkedHashSet();
          children: []
          pos: 2294
          length: 48
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: create
              children: []
              pos: 2453
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2439
              length: 439
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final Option option;
                children: []
                pos: 2472
                length: 20
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: options.size()
                            children: []
                            pos: 2506
                            length: 14
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '1'
                            children: []
                            pos: 2524
                            length: 1
                        children: []
                        pos: 2506
                        length: 19
                    children: []
                    pos: 2505
                    length: 21
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: option = (Option)options.iterator().next();
                    children: []
                    pos: 2541
                    length: 43
                  pos: 2527
                  length: 67
                pos: 2502
                length: 328
              - type: expression_statement
                fields:
                  text: reset();
                children: []
                pos: 2840
                length: 8
              - type: return_statement
                fields:
                  text: return option;
                children: []
                pos: 2858
                length: 14
              pos: 2462
              length: 416
          children: []
          pos: 2439
          length: 439
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: reset
              children: []
              pos: 2949
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2927
              length: 83
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: options.clear();
                children: []
                pos: 2967
                length: 16
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 2992
                length: 12
              pos: 2957
              length: 53
          children: []
          pos: 2927
          length: 83
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createOption
              children: []
              pos: 3029
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final char type
                children: []
                pos: 3051
                length: 15
              pos: 3016
              length: 736
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final Argument argument;
                children: []
                pos: 3134
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: type
                            children: []
                            pos: 3171
                            length: 4
                          right:
                            type: character_literal
                            fields:
                              text: "' '"
                            children: []
                            pos: 3179
                            length: 3
                        children: []
                        pos: 3171
                        length: 11
                    children: []
                    pos: 3170
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: abuilder.reset();
                    children: []
                    pos: 3198
                    length: 17
                  - type: expression_statement
                    fields:
                      text: abuilder.withValidator(validator(type));
                    children: []
                    pos: 3228
                    length: 40
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: identifier
                            fields:
                              text: required
                            children: []
                            pos: 3285
                            length: 8
                        children: []
                        pos: 3284
                        length: 10
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: abuilder.withMinimum(1);
                        children: []
                        pos: 3313
                        length: 24
                      pos: 3295
                      length: 56
                    pos: 3281
                    length: 70
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: type
                                children: []
                                pos: 3368
                                length: 4
                              right:
                                type: character_literal
                                fields:
                                  text: "'*'"
                                children: []
                                pos: 3376
                                length: 3
                            children: []
                            pos: 3368
                            length: 11
                        children: []
                        pos: 3367
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: abuilder.withMaximum(1);
                        children: []
                        pos: 3399
                        length: 24
                      pos: 3381
                      length: 56
                    pos: 3364
                    length: 73
                  - type: expression_statement
                    fields:
                      text: argument = abuilder.create();
                    children: []
                    pos: 3450
                    length: 29
                  pos: 3184
                  length: 305
                pos: 3167
                length: 376
              - type: expression_statement
                fields:
                  text: obuilder.reset();
                children: []
                pos: 3553
                length: 17
              - type: expression_statement
                fields:
                  text: obuilder.withArgument(argument);
                children: []
                pos: 3579
                length: 32
              - type: expression_statement
                fields:
                  text: obuilder.withShortName(String.valueOf(opt));
                children: []
                pos: 3620
                length: 44
              - type: expression_statement
                fields:
                  text: obuilder.withRequired(required);
                children: []
                pos: 3673
                length: 32
              - type: expression_statement
                fields:
                  text: options.add(obuilder.create());
                children: []
                pos: 3715
                length: 31
              pos: 3124
              length: 628
          children: []
          pos: 3016
          length: 736
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withPattern
              children: []
              pos: 3882
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String pattern
                children: []
                pos: 3894
                length: 20
              pos: 3870
              length: 1052
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int sz = pattern.length();
                children: []
                pos: 3926
                length: 26
              - type: local_variable_declaration
                fields:
                  text: char opt = ' ';
                children: []
                pos: 3962
                length: 15
              - type: local_variable_declaration
                fields:
                  text: char ch = ' ';
                children: []
                pos: 3986
                length: 14
              - type: local_variable_declaration
                fields:
                  text: char type = ' ';
                children: []
                pos: 4009
                length: 16
              - type: local_variable_declaration
                fields:
                  text: boolean required = false;
                children: []
                pos: 4034
                length: 25
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                ch = pattern.charAt(i);

                                switch (ch) {
                                    case '!' :
                                        required = true;
                                        break;
                                    case '@' :
                                    case ':' :
                                    case '%' :
                                    case '+' :
                                    case '#' :
                                    case '<' :
                                    case '>' :
                                    case '*' :
                                    case '/' :
                                        type = ch;
                                        break;
                                    default :
                                        if (opt != ' ') {
                                            createOption(type, required, opt);
                                            required = false;
                                            type = ' ';
                                        }

                                        opt = ch;
                                }
                            }
                children: []
                pos: 4069
                length: 763
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: opt
                            children: []
                            pos: 4846
                            length: 3
                          right:
                            type: character_literal
                            fields:
                              text: "' '"
                            children: []
                            pos: 4853
                            length: 3
                        children: []
                        pos: 4846
                        length: 10
                    children: []
                    pos: 4845
                    length: 12
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: createOption(type, required, opt);
                    children: []
                    pos: 4872
                    length: 34
                  pos: 4858
                  length: 58
                pos: 4842
                length: 74
              pos: 3916
              length: 1006
          children: []
          pos: 3870
          length: 1052
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: validator
              children: []
              pos: 4953
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final char c
                children: []
                pos: 4963
                length: 12
              pos: 4928
              length: 1023
            body:
              type: block
              fields: {}
              children:
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: c
                        children: []
                        pos: 4995
                        length: 1
                    children: []
                    pos: 4994
                    length: 3
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                                    case '@' :
                                        final ClassValidator classv = new ClassValidator();
                                        classv.setInstance(true);
                                        return classv;
                                    case '+' :
                                        final ClassValidator instancev = new ClassValidator();
                                        return instancev;
                                        //case ':':// no validator needed for a string
                                    case '%' :
                                        return NumberValidator.getNumberInstance();
                                    case '#' :
                                        return DateValidator.getDateInstance();
                                    case '<' :
                                        final FileValidator existingv = new FileValidator();
                                        existingv.setExisting(true);
                                        existingv.setFile(true);
                                        return existingv;
                                    case '>' :
                                    case '*' :
                                        return new FileValidator();
                                    case '/' :
                                        return new UrlValidator();
                                    default :
                                        return null;
                                }
                    children: []
                    pos: 4998
                    length: 947
                children: []
                pos: 4987
                length: 958
              pos: 4977
              length: 974
          children: []
          pos: 4928
          length: 1023
        pos: 1449
        length: 4504
    children: []
    pos: 1449
    length: 4504
  pos: 0
  length: 5954
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: PatternBuilder
        children: []
        pos: 1456
        length: 14
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private final GroupBuilder gbuilder;
          children: []
          pos: 1478
          length: 36
        - type: field_declaration
          fields:
            text: private final DefaultOptionBuilder obuilder;
          children: []
          pos: 1519
          length: 44
        - type: field_declaration
          fields:
            text: private final ArgumentBuilder abuilder;
          children: []
          pos: 1568
          length: 39
        - type: constructor_declaration
          fields:
            text: |-
              public PatternBuilder() {
                      this(
                          new GroupBuilder(),
                          new DefaultOptionBuilder(),
                          new ArgumentBuilder());
                  }
          children: []
          pos: 1665
          length: 153
        - type: constructor_declaration
          fields:
            text: |-
              public PatternBuilder(
                      final GroupBuilder gbuilder,
                      final DefaultOptionBuilder obuilder,
                      final ArgumentBuilder abuilder) {
                      this.gbuilder = gbuilder;
                      this.obuilder = obuilder;
                      this.abuilder = abuilder;
                  }
          children: []
          pos: 2028
          length: 254
        - type: field_declaration
          fields:
            text: private final Set options = new HashSet();
          children: []
          pos: 2288
          length: 42
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: create
              children: []
              pos: 2441
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2427
              length: 439
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final Option option;
                children: []
                pos: 2460
                length: 20
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: options.size()
                            children: []
                            pos: 2494
                            length: 14
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '1'
                            children: []
                            pos: 2512
                            length: 1
                        children: []
                        pos: 2494
                        length: 19
                    children: []
                    pos: 2493
                    length: 21
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: option = (Option)options.iterator().next();
                    children: []
                    pos: 2529
                    length: 43
                  pos: 2515
                  length: 67
                pos: 2490
                length: 328
              - type: expression_statement
                fields:
                  text: reset();
                children: []
                pos: 2828
                length: 8
              - type: return_statement
                fields:
                  text: return option;
                children: []
                pos: 2846
                length: 14
              pos: 2450
              length: 416
          children: []
          pos: 2427
          length: 439
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: reset
              children: []
              pos: 2937
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2915
              length: 83
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: options.clear();
                children: []
                pos: 2955
                length: 16
              - type: return_statement
                fields:
                  text: return this;
                children: []
                pos: 2980
                length: 12
              pos: 2945
              length: 53
          children: []
          pos: 2915
          length: 83
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createOption
              children: []
              pos: 3017
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final char type
                children: []
                pos: 3039
                length: 15
              pos: 3004
              length: 736
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: final Argument argument;
                children: []
                pos: 3122
                length: 24
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: type
                            children: []
                            pos: 3159
                            length: 4
                          right:
                            type: character_literal
                            fields:
                              text: "' '"
                            children: []
                            pos: 3167
                            length: 3
                        children: []
                        pos: 3159
                        length: 11
                    children: []
                    pos: 3158
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: abuilder.reset();
                    children: []
                    pos: 3186
                    length: 17
                  - type: expression_statement
                    fields:
                      text: abuilder.withValidator(validator(type));
                    children: []
                    pos: 3216
                    length: 40
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: identifier
                            fields:
                              text: required
                            children: []
                            pos: 3273
                            length: 8
                        children: []
                        pos: 3272
                        length: 10
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: abuilder.withMinimum(1);
                        children: []
                        pos: 3301
                        length: 24
                      pos: 3283
                      length: 56
                    pos: 3269
                    length: 70
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: type
                                children: []
                                pos: 3356
                                length: 4
                              right:
                                type: character_literal
                                fields:
                                  text: "'*'"
                                children: []
                                pos: 3364
                                length: 3
                            children: []
                            pos: 3356
                            length: 11
                        children: []
                        pos: 3355
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: abuilder.withMaximum(1);
                        children: []
                        pos: 3387
                        length: 24
                      pos: 3369
                      length: 56
                    pos: 3352
                    length: 73
                  - type: expression_statement
                    fields:
                      text: argument = abuilder.create();
                    children: []
                    pos: 3438
                    length: 29
                  pos: 3172
                  length: 305
                pos: 3155
                length: 376
              - type: expression_statement
                fields:
                  text: obuilder.reset();
                children: []
                pos: 3541
                length: 17
              - type: expression_statement
                fields:
                  text: obuilder.withArgument(argument);
                children: []
                pos: 3567
                length: 32
              - type: expression_statement
                fields:
                  text: obuilder.withShortName(String.valueOf(opt));
                children: []
                pos: 3608
                length: 44
              - type: expression_statement
                fields:
                  text: obuilder.withRequired(required);
                children: []
                pos: 3661
                length: 32
              - type: expression_statement
                fields:
                  text: options.add(obuilder.create());
                children: []
                pos: 3703
                length: 31
              pos: 3112
              length: 628
          children: []
          pos: 3004
          length: 736
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withPattern
              children: []
              pos: 3870
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final String pattern
                children: []
                pos: 3882
                length: 20
              pos: 3858
              length: 1052
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: int sz = pattern.length();
                children: []
                pos: 3914
                length: 26
              - type: local_variable_declaration
                fields:
                  text: char opt = ' ';
                children: []
                pos: 3950
                length: 15
              - type: local_variable_declaration
                fields:
                  text: char ch = ' ';
                children: []
                pos: 3974
                length: 14
              - type: local_variable_declaration
                fields:
                  text: char type = ' ';
                children: []
                pos: 3997
                length: 16
              - type: local_variable_declaration
                fields:
                  text: boolean required = false;
                children: []
                pos: 4022
                length: 25
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                ch = pattern.charAt(i);

                                switch (ch) {
                                    case '!' :
                                        required = true;
                                        break;
                                    case '@' :
                                    case ':' :
                                    case '%' :
                                    case '+' :
                                    case '#' :
                                    case '<' :
                                    case '>' :
                                    case '*' :
                                    case '/' :
                                        type = ch;
                                        break;
                                    default :
                                        if (opt != ' ') {
                                            createOption(type, required, opt);
                                            required = false;
                                            type = ' ';
                                        }

                                        opt = ch;
                                }
                            }
                children: []
                pos: 4057
                length: 763
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: opt
                            children: []
                            pos: 4834
                            length: 3
                          right:
                            type: character_literal
                            fields:
                              text: "' '"
                            children: []
                            pos: 4841
                            length: 3
                        children: []
                        pos: 4834
                        length: 10
                    children: []
                    pos: 4833
                    length: 12
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: createOption(type, required, opt);
                    children: []
                    pos: 4860
                    length: 34
                  pos: 4846
                  length: 58
                pos: 4830
                length: 74
              pos: 3904
              length: 1006
          children: []
          pos: 3858
          length: 1052
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: validator
              children: []
              pos: 4941
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final char c
                children: []
                pos: 4951
                length: 12
              pos: 4916
              length: 1023
            body:
              type: block
              fields: {}
              children:
              - type: switch_expression
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: c
                        children: []
                        pos: 4983
                        length: 1
                    children: []
                    pos: 4982
                    length: 3
                  body:
                    type: switch_block
                    fields:
                      text: |-
                        {
                                    case '@' :
                                        final ClassValidator classv = new ClassValidator();
                                        classv.setInstance(true);
                                        return classv;
                                    case '+' :
                                        final ClassValidator instancev = new ClassValidator();
                                        return instancev;
                                        //case ':':// no validator needed for a string
                                    case '%' :
                                        return NumberValidator.getNumberInstance();
                                    case '#' :
                                        return DateValidator.getDateInstance();
                                    case '<' :
                                        final FileValidator existingv = new FileValidator();
                                        existingv.setExisting(true);
                                        existingv.setFile(true);
                                        return existingv;
                                    case '>' :
                                    case '*' :
                                        return new FileValidator();
                                    case '/' :
                                        return new UrlValidator();
                                    default :
                                        return null;
                                }
                    children: []
                    pos: 4986
                    length: 947
                children: []
                pos: 4975
                length: 958
              pos: 4965
              length: 974
          children: []
          pos: 4916
          length: 1023
        pos: 1443
        length: 4498
    children: []
    pos: 1443
    length: 4498
  pos: 0
  length: 5942
text_diff: "--- before\n+++ after\n@@ -16,8 +16,8 @@\n  */\n package org.apache.commons.cli2.builder;\n
  \n+import java.util.HashSet;\n import java.util.Iterator;\n-import java.util.LinkedHashSet;\n
  import java.util.Set;\n \n import org.apache.commons.cli2.Argument;\n@@ -64,7 +64,7
  @@\n         this.abuilder = abuilder;\n     }\n \n-    private final Set options
  = new LinkedHashSet();\n+    private final Set options = new HashSet();\n \n     /**\n
  \     * Creates a new Option instance.\n"
tree_diff: |+
  New cluster:
  UPDATE from private final Set options = new LinkedHashSet(); to private final Set options = new HashSet();
  ------------
  ===
  update-node
  ---
  field_declaration: private final Set options = new LinkedHashSet(); [2294,2342]
  replace private final Set options = new LinkedHashSet(); by private final Set options = new HashSet();

...
