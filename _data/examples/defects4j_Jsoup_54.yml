---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: W3CDom
        children: []
        pos: 1035
        length: 6
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
          children: []
          pos: 1048
          length: 80
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: fromJsoup
              children: []
              pos: 1267
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: org.jsoup.nodes.Document in
                children: []
                pos: 1277
                length: 27
              pos: 1251
              length: 495
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(in);
                children: []
                pos: 1316
                length: 21
              - type: local_variable_declaration
                fields:
                  text: DocumentBuilder builder;
                children: []
                pos: 1346
                length: 24
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: factory.setNamespaceAware(true);
                      children: []
                      pos: 1443
                      length: 32
                    - type: expression_statement
                      fields:
                        text: builder = factory.newDocumentBuilder();
                      children: []
                      pos: 1488
                      length: 39
                    - type: local_variable_declaration
                      fields:
                        text: Document out = builder.newDocument();
                      children: []
                      pos: 1540
                      length: 37
                    - type: expression_statement
                      fields:
                        text: convert(in, out);
                      children: []
                      pos: 1590
                      length: 17
                    - type: return_statement
                      fields:
                        text: return out;
                      children: []
                      pos: 1620
                      length: 11
                    pos: 1383
                    length: 258
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (ParserConfigurationException e) {
                                      throw new IllegalStateException(e);
                                  }
                      children: []
                      pos: 1642
                      length: 98
                    pos: 1379
                    length: 361
                children: []
                pos: 1379
                length: 361
              pos: 1306
              length: 440
          children: []
          pos: 1251
          length: 495
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: convert
              children: []
              pos: 2052
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: org.jsoup.nodes.Document in
                children: []
                pos: 2060
                length: 27
              pos: 2040
              length: 353
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!StringUtil.isBlank(in.location())"
                        children: []
                        pos: 2117
                        length: 34
                    children: []
                    pos: 2116
                    length: 36
                children:
                - type: expression_statement
                  fields:
                    text: out.setDocumentURI(in.location());
                  children: []
                  pos: 2165
                  length: 34
                pos: 2113
                length: 86
              - type: local_variable_declaration
                fields:
                  text: org.jsoup.nodes.Element rootEl = in.child(0);
                children: []
                pos: 2209
                length: 45
              - type: local_variable_declaration
                fields:
                  text: NodeTraversor traversor = new NodeTraversor(new W3CBuilder(out));
                children: []
                pos: 2286
                length: 65
              - type: expression_statement
                fields:
                  text: traversor.traverse(rootEl);
                children: []
                pos: 2360
                length: 27
              pos: 2103
              length: 290
          children: []
          pos: 2040
          length: 353
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: W3CBuilder
              children: []
              pos: 2493
              length: 10
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private static final String xmlnsKey = "xmlns";
                children: []
                pos: 2537
                length: 47
              - type: field_declaration
                fields:
                  text: private static final String xmlnsPrefix = "xmlns:";
                children: []
                pos: 2593
                length: 51
              - type: field_declaration
                fields:
                  text: private final Document doc;
                children: []
                pos: 2654
                length: 27
              - type: field_declaration
                fields:
                  text: private final HashMap<String, String> namespaces = new HashMap<String,
                    String>();
                children: []
                pos: 2690
                length: 81
              - type: field_declaration
                fields:
                  text: private Element dest;
                children: []
                pos: 2797
                length: 21
              - type: constructor_declaration
                fields:
                  text: |-
                    public W3CBuilder(Document doc) {
                                this.doc = doc;
                            }
                children: []
                pos: 2828
                length: 71
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: head
                    children: []
                    pos: 2921
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 2926
                      length: 27
                    pos: 2909
                    length: 1571
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: source instanceof org.jsoup.nodes.Element
                              children: []
                              pos: 2984
                              length: 41
                          children: []
                          pos: 2983
                          length: 43
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: org.jsoup.nodes.Element sourceEl = (org.jsoup.nodes.Element)
                              source;
                          children: []
                          pos: 3045
                          length: 68
                        - type: local_variable_declaration
                          fields:
                            text: String prefix = updateNamespaces(sourceEl);
                          children: []
                          pos: 3131
                          length: 43
                        - type: local_variable_declaration
                          fields:
                            text: String namespace = namespaces.get(prefix);
                          children: []
                          pos: 3191
                          length: 42
                        - type: local_variable_declaration
                          fields:
                            text: Element el = doc.createElementNS(namespace, sourceEl.tagName());
                          children: []
                          pos: 3251
                          length: 64
                        - type: expression_statement
                          fields:
                            text: copyAttributes(sourceEl, el);
                          children: []
                          pos: 3332
                          length: 29
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: dest
                                      children: []
                                      pos: 3382
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 3390
                                      length: 4
                                  children: []
                                  pos: 3382
                                  length: 12
                              children: []
                              pos: 3381
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: doc.appendChild(el);
                              children: []
                              pos: 3438
                              length: 20
                            pos: 3396
                            length: 80
                          pos: 3378
                          length: 165
                        - type: expression_statement
                          fields:
                            text: dest = el;
                          children: []
                          pos: 3560
                          length: 10
                        pos: 3027
                        length: 568
                      pos: 2980
                      length: 1490
                    pos: 2966
                    length: 1514
                children: []
                pos: 2909
                length: 1571
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: tail
                    children: []
                    pos: 4502
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 4507
                      length: 27
                    pos: 4490
                    length: 266
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: instanceof_expression
                                  fields:
                                    text: source instanceof org.jsoup.nodes.Element
                                  children: []
                                  pos: 4565
                                  length: 41
                                right:
                                  type: instanceof_expression
                                  fields:
                                    text: dest.getParentNode() instanceof Element
                                  children: []
                                  pos: 4610
                                  length: 39
                              children: []
                              pos: 4565
                              length: 84
                          children: []
                          pos: 4564
                          length: 86
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: dest = (Element) dest.getParentNode();
                          children: []
                          pos: 4669
                          length: 38
                        pos: 4651
                        length: 95
                      pos: 4561
                      length: 185
                    pos: 4547
                    length: 209
                children: []
                pos: 4490
                length: 266
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: copyAttributes
                    children: []
                    pos: 4779
                    length: 14
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 4794
                      length: 27
                    pos: 4766
                    length: 447
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (Attribute attribute : source.attributes()) {
                                          // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                                          String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                                          if (key.matches("[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]*"))
                                              el.setAttribute(key, attribute.getValue());
                                      }
                      children: []
                      pos: 4849
                      length: 354
                    pos: 4835
                    length: 378
                children: []
                pos: 4766
                length: 447
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: updateNamespaces
                    children: []
                    pos: 5343
                    length: 16
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Element el
                      children: []
                      pos: 5360
                      length: 26
                    pos: 5328
                    length: 869
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Attributes attributes = el.attributes();
                      children: []
                      pos: 5518
                      length: 40
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (Attribute attr : attributes) {
                                          String key = attr.getKey();
                                          String prefix;
                                          if (key.equals(xmlnsKey)) {
                                              prefix = "";
                                          } else if (key.startsWith(xmlnsPrefix)) {
                                              prefix = key.substring(xmlnsPrefix.length());
                                          } else {
                                              continue;
                                          }
                                          namespaces.put(prefix, attr.getValue());
                                      }
                      children: []
                      pos: 5571
                      length: 455
                    - type: local_variable_declaration
                      fields:
                        text: int pos = el.tagName().indexOf(":");
                      children: []
                      pos: 6085
                      length: 36
                    - type: return_statement
                      fields:
                        text: 'return pos > 0 ? el.tagName().substring(0, pos) : "";'
                      children: []
                      pos: 6134
                      length: 53
                    pos: 5388
                    length: 809
                children: []
                pos: 5328
                length: 869
              pos: 2470
              length: 3734
          children: []
          pos: 2470
          length: 3734
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asString
              children: []
              pos: 6346
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Document doc
                children: []
                pos: 6355
                length: 12
              pos: 6332
              length: 548
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: DOMSource domSource = new DOMSource(doc);
                      children: []
                      pos: 6397
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 6451
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: StreamResult result = new StreamResult(writer);
                      children: []
                      pos: 6505
                      length: 47
                    - type: local_variable_declaration
                      fields:
                        text: TransformerFactory tf = TransformerFactory.newInstance();
                      children: []
                      pos: 6565
                      length: 57
                    - type: local_variable_declaration
                      fields:
                        text: Transformer transformer = tf.newTransformer();
                      children: []
                      pos: 6635
                      length: 46
                    - type: expression_statement
                      fields:
                        text: transformer.transform(domSource, result);
                      children: []
                      pos: 6694
                      length: 41
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 6748
                      length: 25
                    pos: 6383
                    length: 400
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (TransformerException e) {
                                      throw new IllegalStateException(e);
                                  }
                      children: []
                      pos: 6784
                      length: 90
                    pos: 6379
                    length: 495
                children: []
                pos: 6379
                length: 495
              pos: 6369
              length: 511
          children: []
          pos: 6332
          length: 548
        pos: 1022
        length: 5860
    children: []
    pos: 1022
    length: 5860
  pos: 0
  length: 6883
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: W3CDom
        children: []
        pos: 1035
        length: 6
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
          children: []
          pos: 1048
          length: 80
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: fromJsoup
              children: []
              pos: 1267
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: org.jsoup.nodes.Document in
                children: []
                pos: 1277
                length: 27
              pos: 1251
              length: 495
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: Validate.notNull(in);
                children: []
                pos: 1316
                length: 21
              - type: local_variable_declaration
                fields:
                  text: DocumentBuilder builder;
                children: []
                pos: 1346
                length: 24
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: expression_statement
                      fields:
                        text: factory.setNamespaceAware(true);
                      children: []
                      pos: 1443
                      length: 32
                    - type: expression_statement
                      fields:
                        text: builder = factory.newDocumentBuilder();
                      children: []
                      pos: 1488
                      length: 39
                    - type: local_variable_declaration
                      fields:
                        text: Document out = builder.newDocument();
                      children: []
                      pos: 1540
                      length: 37
                    - type: expression_statement
                      fields:
                        text: convert(in, out);
                      children: []
                      pos: 1590
                      length: 17
                    - type: return_statement
                      fields:
                        text: return out;
                      children: []
                      pos: 1620
                      length: 11
                    pos: 1383
                    length: 258
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (ParserConfigurationException e) {
                                      throw new IllegalStateException(e);
                                  }
                      children: []
                      pos: 1642
                      length: 98
                    pos: 1379
                    length: 361
                children: []
                pos: 1379
                length: 361
              pos: 1306
              length: 440
          children: []
          pos: 1251
          length: 495
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: convert
              children: []
              pos: 2052
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: org.jsoup.nodes.Document in
                children: []
                pos: 2060
                length: 27
              pos: 2040
              length: 353
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!StringUtil.isBlank(in.location())"
                        children: []
                        pos: 2117
                        length: 34
                    children: []
                    pos: 2116
                    length: 36
                children:
                - type: expression_statement
                  fields:
                    text: out.setDocumentURI(in.location());
                  children: []
                  pos: 2165
                  length: 34
                pos: 2113
                length: 86
              - type: local_variable_declaration
                fields:
                  text: org.jsoup.nodes.Element rootEl = in.child(0);
                children: []
                pos: 2209
                length: 45
              - type: local_variable_declaration
                fields:
                  text: NodeTraversor traversor = new NodeTraversor(new W3CBuilder(out));
                children: []
                pos: 2286
                length: 65
              - type: expression_statement
                fields:
                  text: traversor.traverse(rootEl);
                children: []
                pos: 2360
                length: 27
              pos: 2103
              length: 290
          children: []
          pos: 2040
          length: 353
        - type: class_declaration
          fields:
            name:
              type: identifier
              fields:
                text: W3CBuilder
              children: []
              pos: 2493
              length: 10
            body:
              type: class_body
              fields: {}
              children:
              - type: field_declaration
                fields:
                  text: private static final String xmlnsKey = "xmlns";
                children: []
                pos: 2537
                length: 47
              - type: field_declaration
                fields:
                  text: private static final String xmlnsPrefix = "xmlns:";
                children: []
                pos: 2593
                length: 51
              - type: field_declaration
                fields:
                  text: private final Document doc;
                children: []
                pos: 2654
                length: 27
              - type: field_declaration
                fields:
                  text: private final HashMap<String, String> namespaces = new HashMap<String,
                    String>();
                children: []
                pos: 2690
                length: 81
              - type: field_declaration
                fields:
                  text: private Element dest;
                children: []
                pos: 2797
                length: 21
              - type: constructor_declaration
                fields:
                  text: |-
                    public W3CBuilder(Document doc) {
                                this.doc = doc;
                            }
                children: []
                pos: 2828
                length: 71
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: head
                    children: []
                    pos: 2921
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 2926
                      length: 27
                    pos: 2909
                    length: 1571
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: instanceof_expression
                              fields:
                                text: source instanceof org.jsoup.nodes.Element
                              children: []
                              pos: 2984
                              length: 41
                          children: []
                          pos: 2983
                          length: 43
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: local_variable_declaration
                          fields:
                            text: org.jsoup.nodes.Element sourceEl = (org.jsoup.nodes.Element)
                              source;
                          children: []
                          pos: 3045
                          length: 68
                        - type: local_variable_declaration
                          fields:
                            text: String prefix = updateNamespaces(sourceEl);
                          children: []
                          pos: 3131
                          length: 43
                        - type: local_variable_declaration
                          fields:
                            text: String namespace = namespaces.get(prefix);
                          children: []
                          pos: 3191
                          length: 42
                        - type: local_variable_declaration
                          fields:
                            text: Element el = doc.createElementNS(namespace, sourceEl.tagName());
                          children: []
                          pos: 3251
                          length: 64
                        - type: expression_statement
                          fields:
                            text: copyAttributes(sourceEl, el);
                          children: []
                          pos: 3332
                          length: 29
                        - type: if_statement
                          fields:
                            condition:
                              type: parenthesized_expression
                              fields:
                                expression:
                                  type: equals
                                  fields:
                                    left:
                                      type: identifier
                                      fields:
                                        text: dest
                                      children: []
                                      pos: 3382
                                      length: 4
                                    right:
                                      type: null_literal
                                      fields: {}
                                      children: []
                                      pos: 3390
                                      length: 4
                                  children: []
                                  pos: 3382
                                  length: 12
                              children: []
                              pos: 3381
                              length: 14
                          children:
                          - type: block
                            fields: {}
                            children:
                            - type: expression_statement
                              fields:
                                text: doc.appendChild(el);
                              children: []
                              pos: 3438
                              length: 20
                            pos: 3396
                            length: 80
                          pos: 3378
                          length: 165
                        - type: expression_statement
                          fields:
                            text: dest = el;
                          children: []
                          pos: 3560
                          length: 10
                        pos: 3027
                        length: 568
                      pos: 2980
                      length: 1490
                    pos: 2966
                    length: 1514
                children: []
                pos: 2909
                length: 1571
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: tail
                    children: []
                    pos: 4502
                    length: 4
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 4507
                      length: 27
                    pos: 4490
                    length: 266
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: if_statement
                      fields:
                        condition:
                          type: parenthesized_expression
                          fields:
                            expression:
                              type: and
                              fields:
                                left:
                                  type: instanceof_expression
                                  fields:
                                    text: source instanceof org.jsoup.nodes.Element
                                  children: []
                                  pos: 4565
                                  length: 41
                                right:
                                  type: instanceof_expression
                                  fields:
                                    text: dest.getParentNode() instanceof Element
                                  children: []
                                  pos: 4610
                                  length: 39
                              children: []
                              pos: 4565
                              length: 84
                          children: []
                          pos: 4564
                          length: 86
                      children:
                      - type: block
                        fields: {}
                        children:
                        - type: expression_statement
                          fields:
                            text: dest = (Element) dest.getParentNode();
                          children: []
                          pos: 4669
                          length: 38
                        pos: 4651
                        length: 95
                      pos: 4561
                      length: 185
                    pos: 4547
                    length: 209
                children: []
                pos: 4490
                length: 266
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: copyAttributes
                    children: []
                    pos: 4779
                    length: 14
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Node source
                      children: []
                      pos: 4794
                      length: 27
                    pos: 4766
                    length: 381
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (Attribute attribute : source.attributes()) {
                                          // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                                          String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                                              el.setAttribute(key, attribute.getValue());
                                      }
                      children: []
                      pos: 4849
                      length: 288
                    pos: 4835
                    length: 312
                children: []
                pos: 4766
                length: 381
              - type: method_declaration
                fields:
                  name:
                    type: identifier
                    fields:
                      text: updateNamespaces
                    children: []
                    pos: 5277
                    length: 16
                  parameters:
                    type: method_parameters
                    fields: {}
                    children:
                    - type: formal_parameter
                      fields:
                        text: org.jsoup.nodes.Element el
                      children: []
                      pos: 5294
                      length: 26
                    pos: 5262
                    length: 869
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: Attributes attributes = el.attributes();
                      children: []
                      pos: 5452
                      length: 40
                    - type: enhanced_for_statement
                      fields:
                        text: |-
                          for (Attribute attr : attributes) {
                                          String key = attr.getKey();
                                          String prefix;
                                          if (key.equals(xmlnsKey)) {
                                              prefix = "";
                                          } else if (key.startsWith(xmlnsPrefix)) {
                                              prefix = key.substring(xmlnsPrefix.length());
                                          } else {
                                              continue;
                                          }
                                          namespaces.put(prefix, attr.getValue());
                                      }
                      children: []
                      pos: 5505
                      length: 455
                    - type: local_variable_declaration
                      fields:
                        text: int pos = el.tagName().indexOf(":");
                      children: []
                      pos: 6019
                      length: 36
                    - type: return_statement
                      fields:
                        text: 'return pos > 0 ? el.tagName().substring(0, pos) : "";'
                      children: []
                      pos: 6068
                      length: 53
                    pos: 5322
                    length: 809
                children: []
                pos: 5262
                length: 869
              pos: 2470
              length: 3668
          children: []
          pos: 2470
          length: 3668
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: asString
              children: []
              pos: 6280
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Document doc
                children: []
                pos: 6289
                length: 12
              pos: 6266
              length: 548
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: DOMSource domSource = new DOMSource(doc);
                      children: []
                      pos: 6331
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 6385
                      length: 41
                    - type: local_variable_declaration
                      fields:
                        text: StreamResult result = new StreamResult(writer);
                      children: []
                      pos: 6439
                      length: 47
                    - type: local_variable_declaration
                      fields:
                        text: TransformerFactory tf = TransformerFactory.newInstance();
                      children: []
                      pos: 6499
                      length: 57
                    - type: local_variable_declaration
                      fields:
                        text: Transformer transformer = tf.newTransformer();
                      children: []
                      pos: 6569
                      length: 46
                    - type: expression_statement
                      fields:
                        text: transformer.transform(domSource, result);
                      children: []
                      pos: 6628
                      length: 41
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 6682
                      length: 25
                    pos: 6317
                    length: 400
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (TransformerException e) {
                                      throw new IllegalStateException(e);
                                  }
                      children: []
                      pos: 6718
                      length: 90
                    pos: 6313
                    length: 495
                children: []
                pos: 6313
                length: 495
              pos: 6303
              length: 511
          children: []
          pos: 6266
          length: 548
        pos: 1022
        length: 5794
    children: []
    pos: 1022
    length: 5794
  pos: 0
  length: 6817
text_diff: |
  --- before
  +++ after
  @@ -123,7 +123,6 @@
               for (Attribute attribute : source.attributes()) {
                   // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                   String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
  -                if (key.matches("[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]*"))
                       el.setAttribute(key, attribute.getValue());
               }
           }
tree_diff: |+
  New cluster:
  UPDATE from for (Attribute attribute : source.attributes()) {
                  // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                  String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                  if (key.matches("[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]*"))
                      el.setAttribute(key, attribute.getValue());
              } to for (Attribute attribute : source.attributes()) {
                  // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                  String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                      el.setAttribute(key, attribute.getValue());
              }
  ------------
  ===
  update-node
  ---
  enhanced_for_statement: for (Attribute attribute : source.attributes()) {
                  // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                  String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                  if (key.matches("[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]*"))
                      el.setAttribute(key, attribute.getValue());
              } [4849,5203]
  replace for (Attribute attribute : source.attributes()) {
                  // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                  String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                  if (key.matches("[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]*"))
                      el.setAttribute(key, attribute.getValue());
              } by for (Attribute attribute : source.attributes()) {
                  // valid xml attribute names are: ^[a-zA-Z_:][-a-zA-Z0-9_:.]
                  String key = attribute.getKey().replaceAll("[^-a-zA-Z0-9_:.]", "");
                      el.setAttribute(key, attribute.getValue());
              }

...
