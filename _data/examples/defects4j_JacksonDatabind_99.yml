---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ReferenceType
        children: []
        pos: 366
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 1L;
          children: []
          pos: 405
          length: 48
        - type: field_declaration
          fields:
            text: protected final JavaType _referencedType;
          children: []
          pos: 459
          length: 41
        - type: field_declaration
          fields:
            text: protected final JavaType _anchorType;
          children: []
          pos: 809
          length: 37
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(Class<?> cls, TypeBindings bindings,
                          JavaType superClass, JavaType[] superInts, JavaType refType,
                          JavaType anchorType,
                          Object valueHandler, Object typeHandler, boolean asStatic)
                  {
                      super(cls, bindings, superClass, superInts, refType.hashCode(),
                              valueHandler, typeHandler, asStatic);
                      _referencedType = refType;
                      _anchorType = (anchorType == null) ? this : anchorType;
                  }
          children: []
          pos: 852
          length: 474
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(TypeBase base, JavaType refType)
                  {
                      super(base);
                      _referencedType = refType;
                      // we'll establish this as the anchor type
                      _anchorType = this;
                  }
          children: []
          pos: 1586
          length: 203
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: upgradeFrom
              children: []
              pos: 2214
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JavaType baseType
                children: []
                pos: 2226
                length: 17
              pos: 2186
              length: 570
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: refdType
                            children: []
                            pos: 2278
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 2290
                            length: 4
                        children: []
                        pos: 2278
                        length: 16
                    children: []
                    pos: 2277
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Missing referencedType");
                    children: []
                    pos: 2310
                    length: 61
                  pos: 2296
                  length: 85
                pos: 2274
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: baseType instanceof TypeBase
                        children: []
                        pos: 2536
                        length: 28
                    children: []
                    pos: 2535
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return new ReferenceType((TypeBase) baseType, refdType);
                    children: []
                    pos: 2580
                    length: 56
                  pos: 2566
                  length: 80
                pos: 2532
                length: 114
              - type: throw_statement
                fields:
                  text: throw new IllegalArgumentException("Can not upgrade from an
                    instance of "+baseType.getClass());
                children: []
                pos: 2655
                length: 95
              pos: 2264
              length: 492
          children: []
          pos: 2186
          length: 570
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 2824
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 2834
                length: 12
              pos: 2796
              length: 281
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(cls, bindings, superClass, superInts,
                                    refType, null, null, null, false);
                children: []
                pos: 2958
                length: 113
              pos: 2948
              length: 129
          children: []
          pos: 2796
          length: 281
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 3140
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 3150
                length: 12
              pos: 3083
              length: 285
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(cls, TypeBindings.emptyBindings(),
                                    // !!! TODO: missing supertypes
                                    null, null, null, refType, null, null, false);
                children: []
                pos: 3192
                length: 170
              pos: 3182
              length: 186
          children: []
          pos: 3083
          length: 285
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentType
              children: []
              pos: 3404
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JavaType contentType
                children: []
                pos: 3420
                length: 20
              pos: 3374
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _referencedType
                            children: []
                            pos: 3456
                            length: 15
                          right:
                            type: identifier
                            fields:
                              text: contentType
                            children: []
                            pos: 3475
                            length: 11
                        children: []
                        pos: 3456
                        length: 30
                    children: []
                    pos: 3455
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 3502
                    length: 12
                  pos: 3488
                  length: 36
                pos: 3452
                length: 72
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    contentType, _anchorType, _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 3533
                length: 157
              pos: 3442
              length: 254
          children: []
          pos: 3374
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withTypeHandler
              children: []
              pos: 3737
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 3753
                length: 8
              pos: 3702
              length: 299
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 3781
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _typeHandler
                            children: []
                            pos: 3786
                            length: 12
                        children: []
                        pos: 3781
                        length: 17
                    children: []
                    pos: 3780
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 3814
                    length: 12
                  pos: 3800
                  length: 36
                pos: 3777
                length: 59
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType, _anchorType, _valueHandler, h, _asStatic);
                children: []
                pos: 3845
                length: 150
              pos: 3767
              length: 234
          children: []
          pos: 3702
          length: 299
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentTypeHandler
              children: []
              pos: 4042
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4065
                length: 8
              pos: 4007
              length: 380
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4093
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getTypeHandler()
                            children: []
                            pos: 4098
                            length: 40
                        children: []
                        pos: 4093
                        length: 45
                    children: []
                    pos: 4092
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4154
                    length: 12
                  pos: 4140
                  length: 36
                pos: 4089
                length: 87
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType.withTypeHandler(h), _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 4185
                length: 196
              pos: 4079
              length: 308
          children: []
          pos: 4007
          length: 380
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withValueHandler
              children: []
              pos: 4428
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4445
                length: 8
              pos: 4393
              length: 311
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4469
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _valueHandler
                            children: []
                            pos: 4474
                            length: 13
                        children: []
                        pos: 4469
                        length: 18
                    children: []
                    pos: 4468
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4503
                    length: 12
                  pos: 4489
                  length: 36
                pos: 4465
                length: 60
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings,
                                    _superClass, _superInterfaces, _referencedType, _anchorType,
                                    h, _typeHandler,_asStatic);
                children: []
                pos: 4534
                length: 164
              pos: 4455
              length: 249
          children: []
          pos: 4393
          length: 311
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentValueHandler
              children: []
              pos: 4745
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4769
                length: 8
              pos: 4710
              length: 417
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4793
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getValueHandler()
                            children: []
                            pos: 4798
                            length: 41
                        children: []
                        pos: 4793
                        length: 46
                    children: []
                    pos: 4792
                    length: 48
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4855
                    length: 12
                  pos: 4841
                  length: 36
                pos: 4789
                length: 88
              - type: local_variable_declaration
                fields:
                  text: JavaType refdType = _referencedType.withValueHandler(h);
                children: []
                pos: 4886
                length: 56
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings,
                                    _superClass, _superInterfaces, refdType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 4951
                length: 170
              pos: 4779
              length: 348
          children: []
          pos: 4710
          length: 417
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withStaticTyping
              children: []
              pos: 5168
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5133
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: _asStatic
                        children: []
                        pos: 5201
                        length: 9
                    children: []
                    pos: 5200
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 5226
                    length: 12
                  pos: 5212
                  length: 36
                pos: 5197
                length: 51
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType.withStaticTyping(), _anchorType,
                                     _valueHandler, _typeHandler, true);
                children: []
                pos: 5257
                length: 192
              pos: 5187
              length: 268
          children: []
          pos: 5133
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: refine
              children: []
              pos: 5491
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> rawType
                children: []
                pos: 5498
                length: 16
              pos: 5461
              length: 331
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(rawType, _bindings,
                                    superClass, superInterfaces, _referencedType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 5610
                length: 176
              pos: 5600
              length: 192
          children: []
          pos: 5461
          length: 331
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: buildCanonicalName
              children: []
              pos: 5829
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5798
              length: 276
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder();
                children: []
                pos: 5864
                length: 39
              - type: expression_statement
                fields:
                  text: sb.append(_class.getName());
                children: []
                pos: 5912
                length: 28
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 5949
                length: 15
              - type: expression_statement
                fields:
                  text: sb.append(_referencedType.toCanonical());
                children: []
                pos: 5973
                length: 41
              - type: expression_statement
                fields:
                  text: sb.append('>');
                children: []
                pos: 6023
                length: 15
              - type: return_statement
                fields:
                  text: return sb.toString();
                children: []
                pos: 6047
                length: 21
              pos: 5854
              length: 220
          children: []
          pos: 5798
          length: 276
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _narrow
              children: []
              pos: 6306
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> subclass
                children: []
                pos: 6314
                length: 17
              pos: 6244
              length: 355
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(subclass, _bindings,
                                    _superClass, _superInterfaces, _referencedType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 6414
                length: 179
              pos: 6337
              length: 262
          children: []
          pos: 6244
          length: 355
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getContentType
              children: []
              pos: 6807
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6777
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 6834
                length: 23
              pos: 6824
              length: 39
          children: []
          pos: 6777
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReferencedType
              children: []
              pos: 6899
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6869
              length: 89
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 6929
                length: 23
              pos: 6919
              length: 39
          children: []
          pos: 6869
          length: 89
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasContentType
              children: []
              pos: 6993
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6964
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 7020
                length: 12
              pos: 7010
              length: 28
          children: []
          pos: 6964
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isReferenceType
              children: []
              pos: 7073
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7044
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 7101
                length: 12
              pos: 7091
              length: 28
          children: []
          pos: 7044
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getErasedSignature
              children: []
              pos: 7160
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 7179
                length: 16
              pos: 7125
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _classSignature(_class, sb, true);
                children: []
                pos: 7207
                length: 41
              pos: 7197
              length: 57
          children: []
          pos: 7125
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGenericSignature
              children: []
              pos: 7299
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 7319
                length: 16
              pos: 7264
              length: 250
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _classSignature(_class, sb, false);
                children: []
                pos: 7351
                length: 35
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 7395
                length: 15
              - type: expression_statement
                fields:
                  text: sb = _referencedType.getGenericSignature(sb);
                children: []
                pos: 7419
                length: 45
              - type: expression_statement
                fields:
                  text: sb.append(">;");
                children: []
                pos: 7473
                length: 16
              - type: return_statement
                fields:
                  text: return sb;
                children: []
                pos: 7498
                length: 10
              pos: 7341
              length: 173
          children: []
          pos: 7264
          length: 250
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getAnchorType
              children: []
              pos: 7700
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7684
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _anchorType;
                children: []
                pos: 7726
                length: 19
              pos: 7716
              length: 35
          children: []
          pos: 7684
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isAnchorType
              children: []
              pos: 7958
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7943
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (_anchorType == this);
                children: []
                pos: 7983
                length: 29
              pos: 7973
              length: 45
          children: []
          pos: 7943
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 8220
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8192
              length: 313
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new StringBuilder(40)
                                .append("[reference type, class ")
                                .append(buildCanonicalName())
                                .append('<')
                                .append(_referencedType)
                                .append('>')
                                .append(']')
                                .toString();
                children: []
                pos: 8245
                length: 254
              pos: 8235
              length: 270
          children: []
          pos: 8192
          length: 313
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 8540
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 8547
                length: 8
              pos: 8511
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 8575
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 8580
                            length: 4
                        children: []
                        pos: 8575
                        length: 9
                    children: []
                    pos: 8574
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 8586
                  length: 12
                pos: 8571
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 8611
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8616
                            length: 4
                        children: []
                        pos: 8611
                        length: 9
                    children: []
                    pos: 8610
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8622
                  length: 13
                pos: 8607
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: o.getClass()
                            children: []
                            pos: 8648
                            length: 12
                          right:
                            type: method_invocation
                            fields:
                              text: getClass()
                            children: []
                            pos: 8664
                            length: 10
                        children: []
                        pos: 8648
                        length: 26
                    children: []
                    pos: 8647
                    length: 28
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8676
                  length: 13
                pos: 8644
                length: 45
              - type: local_variable_declaration
                fields:
                  text: ReferenceType other = (ReferenceType) o;
                children: []
                pos: 8699
                length: 40
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: field_access
                            fields:
                              text: other._class
                            children: []
                            pos: 8753
                            length: 12
                          right:
                            type: identifier
                            fields:
                              text: _class
                            children: []
                            pos: 8769
                            length: 6
                        children: []
                        pos: 8753
                        length: 22
                    children: []
                    pos: 8752
                    length: 24
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8777
                  length: 13
                pos: 8749
                length: 41
              - type: return_statement
                fields:
                  text: return _referencedType.equals(other._referencedType);
                children: []
                pos: 8873
                length: 53
              pos: 8561
              length: 371
          children: []
          pos: 8511
          length: 421
        pos: 353
        length: 8581
    children: []
    pos: 353
    length: 8581
  pos: 0
  length: 8935
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ReferenceType
        children: []
        pos: 366
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 1L;
          children: []
          pos: 405
          length: 48
        - type: field_declaration
          fields:
            text: protected final JavaType _referencedType;
          children: []
          pos: 459
          length: 41
        - type: field_declaration
          fields:
            text: protected final JavaType _anchorType;
          children: []
          pos: 809
          length: 37
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(Class<?> cls, TypeBindings bindings,
                          JavaType superClass, JavaType[] superInts, JavaType refType,
                          JavaType anchorType,
                          Object valueHandler, Object typeHandler, boolean asStatic)
                  {
                      super(cls, bindings, superClass, superInts, refType.hashCode(),
                              valueHandler, typeHandler, asStatic);
                      _referencedType = refType;
                      _anchorType = (anchorType == null) ? this : anchorType;
                  }
          children: []
          pos: 852
          length: 474
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(TypeBase base, JavaType refType)
                  {
                      super(base);
                      _referencedType = refType;
                      // we'll establish this as the anchor type
                      _anchorType = this;
                  }
          children: []
          pos: 1586
          length: 203
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: upgradeFrom
              children: []
              pos: 2214
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JavaType baseType
                children: []
                pos: 2226
                length: 17
              pos: 2186
              length: 570
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: refdType
                            children: []
                            pos: 2278
                            length: 8
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 2290
                            length: 4
                        children: []
                        pos: 2278
                        length: 16
                    children: []
                    pos: 2277
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("Missing referencedType");
                    children: []
                    pos: 2310
                    length: 61
                  pos: 2296
                  length: 85
                pos: 2274
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: instanceof_expression
                        fields:
                          text: baseType instanceof TypeBase
                        children: []
                        pos: 2536
                        length: 28
                    children: []
                    pos: 2535
                    length: 30
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return new ReferenceType((TypeBase) baseType, refdType);
                    children: []
                    pos: 2580
                    length: 56
                  pos: 2566
                  length: 80
                pos: 2532
                length: 114
              - type: throw_statement
                fields:
                  text: throw new IllegalArgumentException("Can not upgrade from an
                    instance of "+baseType.getClass());
                children: []
                pos: 2655
                length: 95
              pos: 2264
              length: 492
          children: []
          pos: 2186
          length: 570
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 2824
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 2834
                length: 12
              pos: 2796
              length: 281
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(cls, bindings, superClass, superInts,
                                    refType, null, null, null, false);
                children: []
                pos: 2958
                length: 113
              pos: 2948
              length: 129
          children: []
          pos: 2796
          length: 281
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 3140
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 3150
                length: 12
              pos: 3083
              length: 285
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(cls, TypeBindings.emptyBindings(),
                                    // !!! TODO: missing supertypes
                                    null, null, null, refType, null, null, false);
                children: []
                pos: 3192
                length: 170
              pos: 3182
              length: 186
          children: []
          pos: 3083
          length: 285
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentType
              children: []
              pos: 3404
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: JavaType contentType
                children: []
                pos: 3420
                length: 20
              pos: 3374
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: _referencedType
                            children: []
                            pos: 3456
                            length: 15
                          right:
                            type: identifier
                            fields:
                              text: contentType
                            children: []
                            pos: 3475
                            length: 11
                        children: []
                        pos: 3456
                        length: 30
                    children: []
                    pos: 3455
                    length: 32
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 3502
                    length: 12
                  pos: 3488
                  length: 36
                pos: 3452
                length: 72
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    contentType, _anchorType, _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 3533
                length: 157
              pos: 3442
              length: 254
          children: []
          pos: 3374
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withTypeHandler
              children: []
              pos: 3737
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 3753
                length: 8
              pos: 3702
              length: 299
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 3781
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _typeHandler
                            children: []
                            pos: 3786
                            length: 12
                        children: []
                        pos: 3781
                        length: 17
                    children: []
                    pos: 3780
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 3814
                    length: 12
                  pos: 3800
                  length: 36
                pos: 3777
                length: 59
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType, _anchorType, _valueHandler, h, _asStatic);
                children: []
                pos: 3845
                length: 150
              pos: 3767
              length: 234
          children: []
          pos: 3702
          length: 299
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentTypeHandler
              children: []
              pos: 4042
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4065
                length: 8
              pos: 4007
              length: 380
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4093
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getTypeHandler()
                            children: []
                            pos: 4098
                            length: 40
                        children: []
                        pos: 4093
                        length: 45
                    children: []
                    pos: 4092
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4154
                    length: 12
                  pos: 4140
                  length: 36
                pos: 4089
                length: 87
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType.withTypeHandler(h), _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 4185
                length: 196
              pos: 4079
              length: 308
          children: []
          pos: 4007
          length: 380
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withValueHandler
              children: []
              pos: 4428
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4445
                length: 8
              pos: 4393
              length: 311
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4469
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _valueHandler
                            children: []
                            pos: 4474
                            length: 13
                        children: []
                        pos: 4469
                        length: 18
                    children: []
                    pos: 4468
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4503
                    length: 12
                  pos: 4489
                  length: 36
                pos: 4465
                length: 60
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings,
                                    _superClass, _superInterfaces, _referencedType, _anchorType,
                                    h, _typeHandler,_asStatic);
                children: []
                pos: 4534
                length: 164
              pos: 4455
              length: 249
          children: []
          pos: 4393
          length: 311
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentValueHandler
              children: []
              pos: 4745
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 4769
                length: 8
              pos: 4710
              length: 417
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 4793
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getValueHandler()
                            children: []
                            pos: 4798
                            length: 41
                        children: []
                        pos: 4793
                        length: 46
                    children: []
                    pos: 4792
                    length: 48
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 4855
                    length: 12
                  pos: 4841
                  length: 36
                pos: 4789
                length: 88
              - type: local_variable_declaration
                fields:
                  text: JavaType refdType = _referencedType.withValueHandler(h);
                children: []
                pos: 4886
                length: 56
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings,
                                    _superClass, _superInterfaces, refdType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 4951
                length: 170
              pos: 4779
              length: 348
          children: []
          pos: 4710
          length: 417
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withStaticTyping
              children: []
              pos: 5168
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5133
              length: 322
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: _asStatic
                        children: []
                        pos: 5201
                        length: 9
                    children: []
                    pos: 5200
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 5226
                    length: 12
                  pos: 5212
                  length: 36
                pos: 5197
                length: 51
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _bindings, _superClass, _superInterfaces,
                                    _referencedType.withStaticTyping(), _anchorType,
                                     _valueHandler, _typeHandler, true);
                children: []
                pos: 5257
                length: 192
              pos: 5187
              length: 268
          children: []
          pos: 5133
          length: 322
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: refine
              children: []
              pos: 5491
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> rawType
                children: []
                pos: 5498
                length: 16
              pos: 5461
              length: 331
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(rawType, _bindings,
                                    superClass, superInterfaces, _referencedType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 5610
                length: 176
              pos: 5600
              length: 192
          children: []
          pos: 5461
          length: 331
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: buildCanonicalName
              children: []
              pos: 5829
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 5798
              length: 252
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder();
                children: []
                pos: 5864
                length: 39
              - type: expression_statement
                fields:
                  text: sb.append(_class.getName());
                children: []
                pos: 5912
                length: 28
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 5949
                length: 15
              - type: expression_statement
                fields:
                  text: sb.append(_referencedType.toCanonical());
                children: []
                pos: 5973
                length: 41
              - type: return_statement
                fields:
                  text: return sb.toString();
                children: []
                pos: 6023
                length: 21
              pos: 5854
              length: 196
          children: []
          pos: 5798
          length: 252
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _narrow
              children: []
              pos: 6282
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> subclass
                children: []
                pos: 6290
                length: 17
              pos: 6220
              length: 355
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(subclass, _bindings,
                                    _superClass, _superInterfaces, _referencedType, _anchorType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 6390
                length: 179
              pos: 6313
              length: 262
          children: []
          pos: 6220
          length: 355
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getContentType
              children: []
              pos: 6783
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6753
              length: 86
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 6810
                length: 23
              pos: 6800
              length: 39
          children: []
          pos: 6753
          length: 86
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReferencedType
              children: []
              pos: 6875
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6845
              length: 89
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 6905
                length: 23
              pos: 6895
              length: 39
          children: []
          pos: 6845
          length: 89
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasContentType
              children: []
              pos: 6969
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 6940
              length: 74
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 6996
                length: 12
              pos: 6986
              length: 28
          children: []
          pos: 6940
          length: 74
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isReferenceType
              children: []
              pos: 7049
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7020
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 7077
                length: 12
              pos: 7067
              length: 28
          children: []
          pos: 7020
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getErasedSignature
              children: []
              pos: 7136
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 7155
                length: 16
              pos: 7101
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _classSignature(_class, sb, true);
                children: []
                pos: 7183
                length: 41
              pos: 7173
              length: 57
          children: []
          pos: 7101
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGenericSignature
              children: []
              pos: 7275
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 7295
                length: 16
              pos: 7240
              length: 250
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _classSignature(_class, sb, false);
                children: []
                pos: 7327
                length: 35
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 7371
                length: 15
              - type: expression_statement
                fields:
                  text: sb = _referencedType.getGenericSignature(sb);
                children: []
                pos: 7395
                length: 45
              - type: expression_statement
                fields:
                  text: sb.append(">;");
                children: []
                pos: 7449
                length: 16
              - type: return_statement
                fields:
                  text: return sb;
                children: []
                pos: 7474
                length: 10
              pos: 7317
              length: 173
          children: []
          pos: 7240
          length: 250
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getAnchorType
              children: []
              pos: 7676
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7660
              length: 67
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _anchorType;
                children: []
                pos: 7702
                length: 19
              pos: 7692
              length: 35
          children: []
          pos: 7660
          length: 67
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isAnchorType
              children: []
              pos: 7934
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 7919
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return (_anchorType == this);
                children: []
                pos: 7959
                length: 29
              pos: 7949
              length: 45
          children: []
          pos: 7919
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 8196
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 8168
              length: 313
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new StringBuilder(40)
                                .append("[reference type, class ")
                                .append(buildCanonicalName())
                                .append('<')
                                .append(_referencedType)
                                .append('>')
                                .append(']')
                                .toString();
                children: []
                pos: 8221
                length: 254
              pos: 8211
              length: 270
          children: []
          pos: 8168
          length: 313
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 8516
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 8523
                length: 8
              pos: 8487
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 8551
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 8556
                            length: 4
                        children: []
                        pos: 8551
                        length: 9
                    children: []
                    pos: 8550
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 8562
                  length: 12
                pos: 8547
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 8587
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 8592
                            length: 4
                        children: []
                        pos: 8587
                        length: 9
                    children: []
                    pos: 8586
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8598
                  length: 13
                pos: 8583
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: o.getClass()
                            children: []
                            pos: 8624
                            length: 12
                          right:
                            type: method_invocation
                            fields:
                              text: getClass()
                            children: []
                            pos: 8640
                            length: 10
                        children: []
                        pos: 8624
                        length: 26
                    children: []
                    pos: 8623
                    length: 28
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8652
                  length: 13
                pos: 8620
                length: 45
              - type: local_variable_declaration
                fields:
                  text: ReferenceType other = (ReferenceType) o;
                children: []
                pos: 8675
                length: 40
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: field_access
                            fields:
                              text: other._class
                            children: []
                            pos: 8729
                            length: 12
                          right:
                            type: identifier
                            fields:
                              text: _class
                            children: []
                            pos: 8745
                            length: 6
                        children: []
                        pos: 8729
                        length: 22
                    children: []
                    pos: 8728
                    length: 24
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 8753
                  length: 13
                pos: 8725
                length: 41
              - type: return_statement
                fields:
                  text: return _referencedType.equals(other._referencedType);
                children: []
                pos: 8849
                length: 53
              pos: 8537
              length: 371
          children: []
          pos: 8487
          length: 421
        pos: 353
        length: 8557
    children: []
    pos: 353
    length: 8557
  pos: 0
  length: 8911
text_diff: "--- before\n+++ after\n@@ -166,7 +166,6 @@\n         sb.append(_class.getName());\n
  \        sb.append('<');\n         sb.append(_referencedType.toCanonical());\n-
  \       sb.append('>');\n         return sb.toString();\n     }\n \n"
tree_diff: |+
  New cluster:
  ===
  delete-node
  ---
  expression_statement: sb.append('>'); [6023,6038]
  ===
  ------------
  ===
  delete-node
  ---
  expression_statement: sb.append('>'); [6023,6038]
  ===

...
