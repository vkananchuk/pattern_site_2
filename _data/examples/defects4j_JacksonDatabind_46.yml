---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ReferenceType
        children: []
        pos: 366
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 1L;
          children: []
          pos: 405
          length: 48
        - type: field_declaration
          fields:
            text: protected final JavaType _referencedType;
          children: []
          pos: 459
          length: 41
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(Class<?> cls, JavaType refType,
                          Object valueHandler, Object typeHandler, boolean asStatic)
                  {
                      super(cls, refType.hashCode(),
                              valueHandler, typeHandler, asStatic);
                      _referencedType = refType;
                  }
          children: []
          pos: 506
          length: 266
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 806
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 816
                length: 12
              pos: 778
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new ReferenceType(cls, refType, null, null, false);
                children: []
                pos: 915
                length: 58
              pos: 905
              length: 74
          children: []
          pos: 778
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withTypeHandler
              children: []
              pos: 1059
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1075
                length: 8
              pos: 1024
              length: 228
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1103
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _typeHandler
                            children: []
                            pos: 1108
                            length: 12
                        children: []
                        pos: 1103
                        length: 17
                    children: []
                    pos: 1102
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1136
                    length: 12
                  pos: 1122
                  length: 36
                pos: 1099
                length: 59
              - type: return_statement
                fields:
                  text: return new ReferenceType(_class, _referencedType, _valueHandler,
                    h, _asStatic);
                children: []
                pos: 1167
                length: 79
              pos: 1089
              length: 163
          children: []
          pos: 1024
          length: 228
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentTypeHandler
              children: []
              pos: 1293
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1316
                length: 8
              pos: 1258
              length: 309
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1344
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getTypeHandler()
                            children: []
                            pos: 1349
                            length: 40
                        children: []
                        pos: 1344
                        length: 45
                    children: []
                    pos: 1343
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1405
                    length: 12
                  pos: 1391
                  length: 36
                pos: 1340
                length: 87
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withTypeHandler(h),
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 1436
                length: 125
              pos: 1330
              length: 237
          children: []
          pos: 1258
          length: 309
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withValueHandler
              children: []
              pos: 1608
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1625
                length: 8
              pos: 1573
              length: 224
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1649
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _valueHandler
                            children: []
                            pos: 1654
                            length: 13
                        children: []
                        pos: 1649
                        length: 18
                    children: []
                    pos: 1648
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1683
                    length: 12
                  pos: 1669
                  length: 36
                pos: 1645
                length: 60
              - type: return_statement
                fields:
                  text: return new ReferenceType(_class, _referencedType, h, _typeHandler,_asStatic);
                children: []
                pos: 1714
                length: 77
              pos: 1635
              length: 162
          children: []
          pos: 1573
          length: 224
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentValueHandler
              children: []
              pos: 1838
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1862
                length: 8
              pos: 1803
              length: 308
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1886
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getValueHandler()
                            children: []
                            pos: 1891
                            length: 41
                        children: []
                        pos: 1886
                        length: 46
                    children: []
                    pos: 1885
                    length: 48
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1948
                    length: 12
                  pos: 1934
                  length: 36
                pos: 1882
                length: 88
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withValueHandler(h),
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 1979
                length: 126
              pos: 1872
              length: 239
          children: []
          pos: 1803
          length: 308
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withStaticTyping
              children: []
              pos: 2152
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2117
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: _asStatic
                        children: []
                        pos: 2185
                        length: 9
                    children: []
                    pos: 2184
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 2210
                    length: 12
                  pos: 2196
                  length: 36
                pos: 2181
                length: 51
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withStaticTyping(),
                                     _valueHandler, _typeHandler, true);
                children: []
                pos: 2241
                length: 121
              pos: 2171
              length: 197
          children: []
          pos: 2117
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: buildCanonicalName
              children: []
              pos: 2405
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2374
              length: 252
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder();
                children: []
                pos: 2440
                length: 39
              - type: expression_statement
                fields:
                  text: sb.append(_class.getName());
                children: []
                pos: 2488
                length: 28
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 2525
                length: 15
              - type: expression_statement
                fields:
                  text: sb.append(_referencedType.toCanonical());
                children: []
                pos: 2549
                length: 41
              - type: return_statement
                fields:
                  text: return sb.toString();
                children: []
                pos: 2599
                length: 21
              pos: 2430
              length: 196
          children: []
          pos: 2374
          length: 252
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _narrow
              children: []
              pos: 2833
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> subclass
                children: []
                pos: 2841
                length: 17
              pos: 2800
              length: 255
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(subclass, _referencedType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 2941
                length: 108
              pos: 2864
              length: 191
          children: []
          pos: 2800
          length: 255
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReferencedType
              children: []
              pos: 3259
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3229
              length: 89
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 3289
                length: 23
              pos: 3279
              length: 39
          children: []
          pos: 3229
          length: 89
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isReferenceType
              children: []
              pos: 3353
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3324
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 3381
                length: 12
              pos: 3371
              length: 28
          children: []
          pos: 3324
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedTypeCount
              children: []
              pos: 3606
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3581
              length: 71
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return 1;
                children: []
                pos: 3637
                length: 9
              pos: 3627
              length: 25
          children: []
          pos: 3581
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedType
              children: []
              pos: 3688
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 3702
                length: 9
              pos: 3658
              length: 116
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (index == 0) ? _referencedType : null;'
                children: []
                pos: 3723
                length: 45
              pos: 3713
              length: 61
          children: []
          pos: 3658
          length: 116
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedTypeName
              children: []
              pos: 3808
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 3826
                length: 9
              pos: 3780
              length: 106
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (index == 0) ? "T" : null;'
                children: []
                pos: 3847
                length: 33
              pos: 3837
              length: 49
          children: []
          pos: 3780
          length: 106
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getParameterSource
              children: []
              pos: 3922
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3892
              length: 132
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _class;
                children: []
                pos: 4004
                length: 14
              pos: 3943
              length: 81
          children: []
          pos: 3892
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getErasedSignature
              children: []
              pos: 4069
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 4088
                length: 16
              pos: 4034
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _classSignature(_class, sb, true);
                children: []
                pos: 4116
                length: 41
              pos: 4106
              length: 57
          children: []
          pos: 4034
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGenericSignature
              children: []
              pos: 4208
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 4228
                length: 16
              pos: 4173
              length: 250
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _classSignature(_class, sb, false);
                children: []
                pos: 4260
                length: 35
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 4304
                length: 15
              - type: expression_statement
                fields:
                  text: sb = _referencedType.getGenericSignature(sb);
                children: []
                pos: 4328
                length: 45
              - type: expression_statement
                fields:
                  text: sb.append(">;");
                children: []
                pos: 4382
                length: 16
              - type: return_statement
                fields:
                  text: return sb;
                children: []
                pos: 4407
                length: 10
              pos: 4250
              length: 173
          children: []
          pos: 4173
          length: 250
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 4629
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4601
              length: 313
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new StringBuilder(40)
                                .append("[reference type, class ")
                                .append(buildCanonicalName())
                                .append('<')
                                .append(_referencedType)
                                .append('>')
                                .append(']')
                                .toString();
                children: []
                pos: 4654
                length: 254
              pos: 4644
              length: 270
          children: []
          pos: 4601
          length: 313
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 4949
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 4956
                length: 8
              pos: 4920
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 4984
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 4989
                            length: 4
                        children: []
                        pos: 4984
                        length: 9
                    children: []
                    pos: 4983
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 4995
                  length: 12
                pos: 4980
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5020
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5025
                            length: 4
                        children: []
                        pos: 5020
                        length: 9
                    children: []
                    pos: 5019
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5031
                  length: 13
                pos: 5016
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: o.getClass()
                            children: []
                            pos: 5057
                            length: 12
                          right:
                            type: method_invocation
                            fields:
                              text: getClass()
                            children: []
                            pos: 5073
                            length: 10
                        children: []
                        pos: 5057
                        length: 26
                    children: []
                    pos: 5056
                    length: 28
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5085
                  length: 13
                pos: 5053
                length: 45
              - type: local_variable_declaration
                fields:
                  text: ReferenceType other = (ReferenceType) o;
                children: []
                pos: 5108
                length: 40
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: field_access
                            fields:
                              text: other._class
                            children: []
                            pos: 5162
                            length: 12
                          right:
                            type: identifier
                            fields:
                              text: _class
                            children: []
                            pos: 5178
                            length: 6
                        children: []
                        pos: 5162
                        length: 22
                    children: []
                    pos: 5161
                    length: 24
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5186
                  length: 13
                pos: 5158
                length: 41
              - type: return_statement
                fields:
                  text: return _referencedType.equals(other._referencedType);
                children: []
                pos: 5282
                length: 53
              pos: 4970
              length: 371
          children: []
          pos: 4920
          length: 421
        pos: 353
        length: 4990
    children: []
    pos: 353
    length: 4990
  pos: 0
  length: 5344
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: ReferenceType
        children: []
        pos: 366
        length: 13
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = 1L;
          children: []
          pos: 405
          length: 48
        - type: field_declaration
          fields:
            text: protected final JavaType _referencedType;
          children: []
          pos: 459
          length: 41
        - type: constructor_declaration
          fields:
            text: |-
              protected ReferenceType(Class<?> cls, JavaType refType,
                          Object valueHandler, Object typeHandler, boolean asStatic)
                  {
                      super(cls, refType.hashCode(),
                              valueHandler, typeHandler, asStatic);
                      _referencedType = refType;
                  }
          children: []
          pos: 506
          length: 266
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: construct
              children: []
              pos: 806
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> cls
                children: []
                pos: 816
                length: 12
              pos: 778
              length: 201
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new ReferenceType(cls, refType, null, null, false);
                children: []
                pos: 915
                length: 58
              pos: 905
              length: 74
          children: []
          pos: 778
          length: 201
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withTypeHandler
              children: []
              pos: 1059
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1075
                length: 8
              pos: 1024
              length: 228
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1103
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _typeHandler
                            children: []
                            pos: 1108
                            length: 12
                        children: []
                        pos: 1103
                        length: 17
                    children: []
                    pos: 1102
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1136
                    length: 12
                  pos: 1122
                  length: 36
                pos: 1099
                length: 59
              - type: return_statement
                fields:
                  text: return new ReferenceType(_class, _referencedType, _valueHandler,
                    h, _asStatic);
                children: []
                pos: 1167
                length: 79
              pos: 1089
              length: 163
          children: []
          pos: 1024
          length: 228
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentTypeHandler
              children: []
              pos: 1293
              length: 22
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1316
                length: 8
              pos: 1258
              length: 309
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1344
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getTypeHandler()
                            children: []
                            pos: 1349
                            length: 40
                        children: []
                        pos: 1344
                        length: 45
                    children: []
                    pos: 1343
                    length: 47
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1405
                    length: 12
                  pos: 1391
                  length: 36
                pos: 1340
                length: 87
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withTypeHandler(h),
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 1436
                length: 125
              pos: 1330
              length: 237
          children: []
          pos: 1258
          length: 309
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withValueHandler
              children: []
              pos: 1608
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1625
                length: 8
              pos: 1573
              length: 224
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1649
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: _valueHandler
                            children: []
                            pos: 1654
                            length: 13
                        children: []
                        pos: 1649
                        length: 18
                    children: []
                    pos: 1648
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1683
                    length: 12
                  pos: 1669
                  length: 36
                pos: 1645
                length: 60
              - type: return_statement
                fields:
                  text: return new ReferenceType(_class, _referencedType, h, _typeHandler,_asStatic);
                children: []
                pos: 1714
                length: 77
              pos: 1635
              length: 162
          children: []
          pos: 1573
          length: 224
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withContentValueHandler
              children: []
              pos: 1838
              length: 23
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object h
                children: []
                pos: 1862
                length: 8
              pos: 1803
              length: 308
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: h
                            children: []
                            pos: 1886
                            length: 1
                          right:
                            type: method_invocation
                            fields:
                              text: _referencedType.<Object>getValueHandler()
                            children: []
                            pos: 1891
                            length: 41
                        children: []
                        pos: 1886
                        length: 46
                    children: []
                    pos: 1885
                    length: 48
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 1948
                    length: 12
                  pos: 1934
                  length: 36
                pos: 1882
                length: 88
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withValueHandler(h),
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 1979
                length: 126
              pos: 1872
              length: 239
          children: []
          pos: 1803
          length: 308
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: withStaticTyping
              children: []
              pos: 2152
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2117
              length: 251
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: _asStatic
                        children: []
                        pos: 2185
                        length: 9
                    children: []
                    pos: 2184
                    length: 11
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return this;
                    children: []
                    pos: 2210
                    length: 12
                  pos: 2196
                  length: 36
                pos: 2181
                length: 51
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(_class, _referencedType.withStaticTyping(),
                                     _valueHandler, _typeHandler, true);
                children: []
                pos: 2241
                length: 121
              pos: 2171
              length: 197
          children: []
          pos: 2117
          length: 251
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: buildCanonicalName
              children: []
              pos: 2405
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 2374
              length: 252
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: StringBuilder sb = new StringBuilder();
                children: []
                pos: 2440
                length: 39
              - type: expression_statement
                fields:
                  text: sb.append(_class.getName());
                children: []
                pos: 2488
                length: 28
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 2525
                length: 15
              - type: expression_statement
                fields:
                  text: sb.append(_referencedType.toCanonical());
                children: []
                pos: 2549
                length: 41
              - type: return_statement
                fields:
                  text: return sb.toString();
                children: []
                pos: 2599
                length: 21
              pos: 2430
              length: 196
          children: []
          pos: 2374
          length: 252
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: _narrow
              children: []
              pos: 2833
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Class<?> subclass
                children: []
                pos: 2841
                length: 17
              pos: 2800
              length: 255
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new ReferenceType(subclass, _referencedType,
                                    _valueHandler, _typeHandler, _asStatic);
                children: []
                pos: 2941
                length: 108
              pos: 2864
              length: 191
          children: []
          pos: 2800
          length: 255
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getReferencedType
              children: []
              pos: 3259
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3229
              length: 89
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _referencedType;
                children: []
                pos: 3289
                length: 23
              pos: 3279
              length: 39
          children: []
          pos: 3229
          length: 89
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: isReferenceType
              children: []
              pos: 3353
              length: 15
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3324
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 3381
                length: 12
              pos: 3371
              length: 28
          children: []
          pos: 3324
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedTypeCount
              children: []
              pos: 3606
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3581
              length: 71
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return 1;
                children: []
                pos: 3637
                length: 9
              pos: 3627
              length: 25
          children: []
          pos: 3581
          length: 71
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedType
              children: []
              pos: 3688
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 3702
                length: 9
              pos: 3658
              length: 116
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (index == 0) ? _referencedType : null;'
                children: []
                pos: 3723
                length: 45
              pos: 3713
              length: 61
          children: []
          pos: 3658
          length: 116
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: containedTypeName
              children: []
              pos: 3808
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int index
                children: []
                pos: 3826
                length: 9
              pos: 3780
              length: 106
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: 'return (index == 0) ? "T" : null;'
                children: []
                pos: 3847
                length: 33
              pos: 3837
              length: 49
          children: []
          pos: 3780
          length: 106
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getParameterSource
              children: []
              pos: 3922
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3892
              length: 132
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _class;
                children: []
                pos: 4004
                length: 14
              pos: 3943
              length: 81
          children: []
          pos: 3892
          length: 132
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getErasedSignature
              children: []
              pos: 4069
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 4088
                length: 16
              pos: 4034
              length: 129
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return _classSignature(_class, sb, true);
                children: []
                pos: 4116
                length: 41
              pos: 4106
              length: 57
          children: []
          pos: 4034
          length: 129
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getGenericSignature
              children: []
              pos: 4208
              length: 19
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: StringBuilder sb
                children: []
                pos: 4228
                length: 16
              pos: 4173
              length: 249
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: _classSignature(_class, sb, false);
                children: []
                pos: 4260
                length: 35
              - type: expression_statement
                fields:
                  text: sb.append('<');
                children: []
                pos: 4304
                length: 15
              - type: expression_statement
                fields:
                  text: sb = _referencedType.getGenericSignature(sb);
                children: []
                pos: 4328
                length: 45
              - type: expression_statement
                fields:
                  text: sb.append(';');
                children: []
                pos: 4382
                length: 15
              - type: return_statement
                fields:
                  text: return sb;
                children: []
                pos: 4406
                length: 10
              pos: 4250
              length: 172
          children: []
          pos: 4173
          length: 249
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 4628
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 4600
              length: 313
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return new StringBuilder(40)
                                .append("[reference type, class ")
                                .append(buildCanonicalName())
                                .append('<')
                                .append(_referencedType)
                                .append('>')
                                .append(']')
                                .toString();
                children: []
                pos: 4653
                length: 254
              pos: 4643
              length: 270
          children: []
          pos: 4600
          length: 313
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: equals
              children: []
              pos: 4948
              length: 6
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object o
                children: []
                pos: 4955
                length: 8
              pos: 4919
              length: 421
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 4983
                            length: 1
                          right:
                            type: this
                            fields: {}
                            children: []
                            pos: 4988
                            length: 4
                        children: []
                        pos: 4983
                        length: 9
                    children: []
                    pos: 4982
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return true;
                  children: []
                  pos: 4994
                  length: 12
                pos: 4979
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: o
                            children: []
                            pos: 5019
                            length: 1
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5024
                            length: 4
                        children: []
                        pos: 5019
                        length: 9
                    children: []
                    pos: 5018
                    length: 11
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5030
                  length: 13
                pos: 5015
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: o.getClass()
                            children: []
                            pos: 5056
                            length: 12
                          right:
                            type: method_invocation
                            fields:
                              text: getClass()
                            children: []
                            pos: 5072
                            length: 10
                        children: []
                        pos: 5056
                        length: 26
                    children: []
                    pos: 5055
                    length: 28
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5084
                  length: 13
                pos: 5052
                length: 45
              - type: local_variable_declaration
                fields:
                  text: ReferenceType other = (ReferenceType) o;
                children: []
                pos: 5107
                length: 40
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: field_access
                            fields:
                              text: other._class
                            children: []
                            pos: 5161
                            length: 12
                          right:
                            type: identifier
                            fields:
                              text: _class
                            children: []
                            pos: 5177
                            length: 6
                        children: []
                        pos: 5161
                        length: 22
                    children: []
                    pos: 5160
                    length: 24
                children:
                - type: return_statement
                  fields:
                    text: return false;
                  children: []
                  pos: 5185
                  length: 13
                pos: 5157
                length: 41
              - type: return_statement
                fields:
                  text: return _referencedType.equals(other._referencedType);
                children: []
                pos: 5281
                length: 53
              pos: 4969
              length: 371
          children: []
          pos: 4919
          length: 421
        pos: 353
        length: 4989
    children: []
    pos: 353
    length: 4989
  pos: 0
  length: 5343
text_diff: "--- before\n+++ after\n@@ -153,7 +153,7 @@\n         _classSignature(_class,
  sb, false);\n         sb.append('<');\n         sb = _referencedType.getGenericSignature(sb);\n-
  \       sb.append(\">;\");\n+        sb.append(';');\n         return sb;\n     }\n
  \    \n"
tree_diff: |+
  New cluster:
  UPDATE from sb.append(">;"); to sb.append(';');
  ------------
  ===
  update-node
  ---
  expression_statement: sb.append(">;"); [4382,4398]
  replace sb.append(">;"); by sb.append(';');

...
