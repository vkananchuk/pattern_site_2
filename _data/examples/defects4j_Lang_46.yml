---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: StringEscapeUtils
        children: []
        pos: 1495
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final char CSV_DELIMITER = ',';
          children: []
          pos: 1520
          length: 46
        - type: field_declaration
          fields:
            text: private static final char CSV_QUOTE = '"';
          children: []
          pos: 1571
          length: 42
        - type: field_declaration
          fields:
            text: private static final String CSV_QUOTE_STR = String.valueOf(CSV_QUOTE);
          children: []
          pos: 1618
          length: 70
        - type: field_declaration
          fields:
            text: private static final char[] CSV_SEARCH_CHARS = new char[] {CSV_DELIMITER,
              CSV_QUOTE, CharUtils.CR, CharUtils.LF};
          children: []
          pos: 1693
          length: 113
        - type: constructor_declaration
          fields:
            text: |-
              public StringEscapeUtils() {
                    super();
                  }
          children: []
          pos: 2171
          length: 49
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJava
              children: []
              pos: 3108
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 3119
                length: 10
              pos: 3087
              length: 108
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return escapeJavaStyleString(str, false, false);
                children: []
                pos: 3141
                length: 48
              pos: 3131
              length: 64
          children: []
          pos: 3087
          length: 108
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJava
              children: []
              pos: 3728
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 3739
                length: 10
              pos: 3709
              length: 135
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: escapeJavaStyleString(out, str, false, false);
                children: []
                pos: 3792
                length: 46
              pos: 3782
              length: 62
          children: []
          pos: 3709
          length: 135
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaScript
              children: []
              pos: 4694
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 4711
                length: 10
              pos: 4673
              length: 112
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return escapeJavaStyleString(str, true, true);
                children: []
                pos: 4733
                length: 46
              pos: 4723
              length: 62
          children: []
          pos: 4673
          length: 112
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaScript
              children: []
              pos: 5331
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 5348
                length: 10
              pos: 5312
              length: 139
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: escapeJavaStyleString(out, str, true, true);
                children: []
                pos: 5401
                length: 44
              pos: 5391
              length: 60
          children: []
          pos: 5312
          length: 139
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaStyleString
              children: []
              pos: 5787
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 5809
                length: 10
              pos: 5765
              length: 574
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 5891
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5898
                            length: 4
                        children: []
                        pos: 5891
                        length: 11
                    children: []
                    pos: 5890
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 5918
                    length: 12
                  pos: 5904
                  length: 36
                pos: 5887
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter(str.length()
                          * 2);
                      children: []
                      pos: 5967
                      length: 57
                    - type: expression_statement
                      fields:
                        text: escapeJavaStyleString(writer, str, escapeSingleQuotes,
                          escapeForwardSlash);
                      children: []
                      pos: 6037
                      length: 75
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 6125
                      length: 25
                    pos: 5953
                    length: 207
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 6161
                      length: 172
                    pos: 5949
                    length: 384
                children: []
                pos: 5949
                length: 384
              pos: 5877
              length: 462
          children: []
          pos: 5765
          length: 574
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaStyleString
              children: []
              pos: 6745
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 6767
                length: 10
              pos: 6725
              length: 2726
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 6891
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 6898
                            length: 4
                        children: []
                        pos: 6891
                        length: 11
                    children: []
                    pos: 6890
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The Writer must not
                        be null");
                    children: []
                    pos: 6918
                    length: 66
                  pos: 6904
                  length: 90
                pos: 6887
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 7007
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 7014
                            length: 4
                        children: []
                        pos: 7007
                        length: 11
                    children: []
                    pos: 7006
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 7034
                    length: 7
                  pos: 7020
                  length: 31
                pos: 7003
                length: 48
              - type: local_variable_declaration
                fields:
                  text: int sz;
                children: []
                pos: 7060
                length: 7
              - type: expression_statement
                fields:
                  text: sz = str.length();
                children: []
                pos: 7076
                length: 18
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                char ch = str.charAt(i);

                                // handle unicode
                                if (ch > 0xfff) {
                                    out.write("\\u" + hex(ch));
                                } else if (ch > 0xff) {
                                    out.write("\\u0" + hex(ch));
                                } else if (ch > 0x7f) {
                                    out.write("\\u00" + hex(ch));
                                } else if (ch < 32) {
                                    switch (ch) {
                                        case '\b' :
                                            out.write('\\');
                                            out.write('b');
                                            break;
                                        case '\n' :
                                            out.write('\\');
                                            out.write('n');
                                            break;
                                        case '\t' :
                                            out.write('\\');
                                            out.write('t');
                                            break;
                                        case '\f' :
                                            out.write('\\');
                                            out.write('f');
                                            break;
                                        case '\r' :
                                            out.write('\\');
                                            out.write('r');
                                            break;
                                        default :
                                            if (ch > 0xf) {
                                                out.write("\\u00" + hex(ch));
                                            } else {
                                                out.write("\\u000" + hex(ch));
                                            }
                                            break;
                                    }
                                } else {
                                    switch (ch) {
                                        case '\'' :
                                            if (escapeSingleQuote) {
                                                out.write('\\');
                                            }
                                            out.write('\'');
                                            break;
                                        case '"' :
                                            out.write('\\');
                                            out.write('"');
                                            break;
                                        case '\\' :
                                            out.write('\\');
                                            out.write('\\');
                                            break;
                                        case '/' :
                                            if (escapeForwardSlash) {
                                                out.write('\\');
                                            }
                                            out.write('/');
                                            break;
                                        default :
                                            out.write(ch);
                                            break;
                                    }
                                }
                            }
                children: []
                pos: 7103
                length: 2342
              pos: 6877
              length: 2574
          children: []
          pos: 6725
          length: 2726
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hex
              children: []
              pos: 9707
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: char ch
                children: []
                pos: 9711
                length: 7
              pos: 9685
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return Integer.toHexString(ch).toUpperCase();
                children: []
                pos: 9730
                length: 45
              pos: 9720
              length: 61
          children: []
          pos: 9685
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJava
              children: []
              pos: 10261
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 10274
                length: 10
              pos: 10240
              length: 455
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 10300
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 10307
                            length: 4
                        children: []
                        pos: 10300
                        length: 11
                    children: []
                    pos: 10299
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 10327
                    length: 12
                  pos: 10313
                  length: 36
                pos: 10296
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter(str.length());
                      children: []
                      pos: 10376
                      length: 53
                    - type: expression_statement
                      fields:
                        text: unescapeJava(writer, str);
                      children: []
                      pos: 10442
                      length: 26
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 10481
                      length: 25
                    pos: 10362
                    length: 154
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 10517
                      length: 172
                    pos: 10358
                    length: 331
                children: []
                pos: 10358
                length: 331
              pos: 10286
              length: 409
          children: []
          pos: 10240
          length: 455
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJava
              children: []
              pos: 11416
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 11429
                length: 10
              pos: 11397
              length: 3002
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 11486
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11493
                            length: 4
                        children: []
                        pos: 11486
                        length: 11
                    children: []
                    pos: 11485
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The Writer must not
                        be null");
                    children: []
                    pos: 11513
                    length: 66
                  pos: 11499
                  length: 90
                pos: 11482
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 11602
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11609
                            length: 4
                        children: []
                        pos: 11602
                        length: 11
                    children: []
                    pos: 11601
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 11629
                    length: 7
                  pos: 11615
                  length: 31
                pos: 11598
                length: 48
              - type: local_variable_declaration
                fields:
                  text: int sz = str.length();
                children: []
                pos: 11655
                length: 22
              - type: local_variable_declaration
                fields:
                  text: StringBuffer unicode = new StringBuffer(4);
                children: []
                pos: 11686
                length: 43
              - type: local_variable_declaration
                fields:
                  text: boolean hadSlash = false;
                children: []
                pos: 11738
                length: 25
              - type: local_variable_declaration
                fields:
                  text: boolean inUnicode = false;
                children: []
                pos: 11772
                length: 26
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                char ch = str.charAt(i);
                                if (inUnicode) {
                                    // if in unicode, then we're reading unicode
                                    // values in somehow
                                    unicode.append(ch);
                                    if (unicode.length() == 4) {
                                        // unicode now contains the four hex digits
                                        // which represents our unicode character
                                        try {
                                            int value = Integer.parseInt(unicode.toString(), 16);
                                            out.write((char) value);
                                            unicode.setLength(0);
                                            inUnicode = false;
                                            hadSlash = false;
                                        } catch (NumberFormatException nfe) {
                                            throw new NestableRuntimeException("Unable to parse unicode value: " + unicode, nfe);
                                        }
                                    }
                                    continue;
                                }
                                if (hadSlash) {
                                    // handle an escaped value
                                    hadSlash = false;
                                    switch (ch) {
                                        case '\\':
                                            out.write('\\');
                                            break;
                                        case '\'':
                                            out.write('\'');
                                            break;
                                        case '\"':
                                            out.write('"');
                                            break;
                                        case 'r':
                                            out.write('\r');
                                            break;
                                        case 'f':
                                            out.write('\f');
                                            break;
                                        case 't':
                                            out.write('\t');
                                            break;
                                        case 'n':
                                            out.write('\n');
                                            break;
                                        case 'b':
                                            out.write('\b');
                                            break;
                                        case 'u':
                                            {
                                                // uh-oh, we're in unicode country....
                                                inUnicode = true;
                                                break;
                                            }
                                        default :
                                            out.write(ch);
                                            break;
                                    }
                                    continue;
                                } else if (ch == '\\') {
                                    hadSlash = true;
                                    continue;
                                }
                                out.write(ch);
                            }
                children: []
                pos: 11807
                length: 2407
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: hadSlash
                        children: []
                        pos: 14227
                        length: 8
                    children: []
                    pos: 14226
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write('\\');
                    children: []
                    pos: 14367
                    length: 16
                  pos: 14237
                  length: 156
                pos: 14223
                length: 170
              pos: 11472
              length: 2927
          children: []
          pos: 11397
          length: 3002
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJavaScript
              children: []
              pos: 14932
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 14951
                length: 10
              pos: 14911
              length: 93
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return unescapeJava(str);
                children: []
                pos: 14973
                length: 25
              pos: 14963
              length: 41
          children: []
          pos: 14911
          length: 93
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJavaScript
              children: []
              pos: 15771
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 15790
                length: 10
              pos: 15752
              length: 120
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: unescapeJava(out, str);
                children: []
                pos: 15843
                length: 23
              pos: 15833
              length: 39
          children: []
          pos: 15752
          length: 120
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeHtml
              children: []
              pos: 17279
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 17290
                length: 10
              pos: 17258
              length: 447
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 17316
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17323
                            length: 4
                        children: []
                        pos: 17316
                        length: 11
                    children: []
                    pos: 17315
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 17343
                    length: 12
                  pos: 17329
                  length: 36
                pos: 17312
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter ((int)(str.length()
                          * 1.5));
                      children: []
                      pos: 17392
                      length: 67
                    - type: expression_statement
                      fields:
                        text: escapeHtml(writer, str);
                      children: []
                      pos: 17472
                      length: 24
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 17509
                      length: 25
                    pos: 17378
                    length: 166
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) {
                                      //assert false;
                                      //should be impossible
                                      e.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 17545
                      length: 154
                    pos: 17374
                    length: 325
                children: []
                pos: 17374
                length: 325
              pos: 17302
              length: 403
          children: []
          pos: 17258
          length: 447
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeHtml
              children: []
              pos: 19292
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 19303
                length: 13
              pos: 19273
              length: 316
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 19366
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 19376
                            length: 4
                        children: []
                        pos: 19366
                        length: 14
                    children: []
                    pos: 19365
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 19397
                    length: 68
                  pos: 19383
                  length: 92
                pos: 19362
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: string
                            children: []
                            pos: 19488
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 19498
                            length: 4
                        children: []
                        pos: 19488
                        length: 14
                    children: []
                    pos: 19487
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 19518
                    length: 7
                  pos: 19504
                  length: 31
                pos: 19484
                length: 51
              - type: expression_statement
                fields:
                  text: Entities.HTML40.escape(writer, string);
                children: []
                pos: 19544
                length: 39
              pos: 19352
              length: 237
          children: []
          pos: 19273
          length: 316
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeHtml
              children: []
              pos: 20415
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 20428
                length: 10
              pos: 20394
              length: 451
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 20454
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20461
                            length: 4
                        children: []
                        pos: 20454
                        length: 11
                    children: []
                    pos: 20453
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 20481
                    length: 12
                  pos: 20467
                  length: 36
                pos: 20450
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter ((int)(str.length()
                          * 1.5));
                      children: []
                      pos: 20530
                      length: 67
                    - type: expression_statement
                      fields:
                        text: unescapeHtml(writer, str);
                      children: []
                      pos: 20610
                      length: 26
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 20649
                      length: 25
                    pos: 20516
                    length: 168
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) {
                                      //assert false;
                                      //should be impossible
                                      e.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 20685
                      length: 154
                    pos: 20512
                    length: 327
                children: []
                pos: 20512
                length: 327
              pos: 20440
              length: 405
          children: []
          pos: 20394
          length: 451
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeHtml
              children: []
              pos: 21683
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 21696
                length: 13
              pos: 21664
              length: 320
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 21759
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21769
                            length: 4
                        children: []
                        pos: 21759
                        length: 14
                    children: []
                    pos: 21758
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 21790
                    length: 68
                  pos: 21776
                  length: 92
                pos: 21755
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: string
                            children: []
                            pos: 21881
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21891
                            length: 4
                        children: []
                        pos: 21881
                        length: 14
                    children: []
                    pos: 21880
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 21911
                    length: 7
                  pos: 21897
                  length: 31
                pos: 21877
                length: 51
              - type: expression_statement
                fields:
                  text: Entities.HTML40.unescape(writer, string);
                children: []
                pos: 21937
                length: 41
              pos: 21745
              length: 239
          children: []
          pos: 21664
          length: 320
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeXml
              children: []
              pos: 22961
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 22971
                length: 13
              pos: 22942
              length: 303
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 23031
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23041
                            length: 4
                        children: []
                        pos: 23031
                        length: 14
                    children: []
                    pos: 23030
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 23062
                    length: 68
                  pos: 23048
                  length: 92
                pos: 23027
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 23153
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23160
                            length: 4
                        children: []
                        pos: 23153
                        length: 11
                    children: []
                    pos: 23152
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 23180
                    length: 7
                  pos: 23166
                  length: 31
                pos: 23149
                length: 48
              - type: expression_statement
                fields:
                  text: Entities.XML.escape(writer, str);
                children: []
                pos: 23206
                length: 33
              pos: 23017
              length: 228
          children: []
          pos: 22942
          length: 303
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeXml
              children: []
              pos: 24042
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 24052
                length: 10
              pos: 24021
              length: 153
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 24078
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 24085
                            length: 4
                        children: []
                        pos: 24078
                        length: 11
                    children: []
                    pos: 24077
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 24105
                    length: 12
                  pos: 24091
                  length: 36
                pos: 24074
                length: 53
              - type: return_statement
                fields:
                  text: return Entities.XML.escape(str);
                children: []
                pos: 24136
                length: 32
              pos: 24064
              length: 110
          children: []
          pos: 24021
          length: 153
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeXml
              children: []
              pos: 25054
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 25066
                length: 13
              pos: 25035
              length: 307
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 25126
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 25136
                            length: 4
                        children: []
                        pos: 25126
                        length: 14
                    children: []
                    pos: 25125
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 25157
                    length: 68
                  pos: 25143
                  length: 92
                pos: 25122
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 25248
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 25255
                            length: 4
                        children: []
                        pos: 25248
                        length: 11
                    children: []
                    pos: 25247
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 25275
                    length: 7
                  pos: 25261
                  length: 31
                pos: 25244
                length: 48
              - type: expression_statement
                fields:
                  text: Entities.XML.unescape(writer, str);
                children: []
                pos: 25301
                length: 35
              pos: 25112
              length: 230
          children: []
          pos: 25035
          length: 307
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeXml
              children: []
              pos: 26044
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 26056
                length: 10
              pos: 26023
              length: 157
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 26082
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 26089
                            length: 4
                        children: []
                        pos: 26082
                        length: 11
                    children: []
                    pos: 26081
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 26109
                    length: 12
                  pos: 26095
                  length: 36
                pos: 26078
                length: 53
              - type: return_statement
                fields:
                  text: return Entities.XML.unescape(str);
                children: []
                pos: 26140
                length: 34
              pos: 26068
              length: 112
          children: []
          pos: 26023
          length: 157
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeSql
              children: []
              pos: 27067
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 27077
                length: 10
              pos: 27046
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 27103
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 27110
                            length: 4
                        children: []
                        pos: 27103
                        length: 11
                    children: []
                    pos: 27102
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 27130
                    length: 12
                  pos: 27116
                  length: 36
                pos: 27099
                length: 53
              - type: return_statement
                fields:
                  text: return StringUtils.replace(str, "'", "''");
                children: []
                pos: 27161
                length: 43
              pos: 27089
              length: 121
          children: []
          pos: 27046
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeCsv
              children: []
              pos: 28268
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 28278
                length: 10
              pos: 28247
              length: 472
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsNone(str, CSV_SEARCH_CHARS)
                        children: []
                        pos: 28304
                        length: 47
                    children: []
                    pos: 28303
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return str;
                    children: []
                    pos: 28367
                    length: 11
                  pos: 28353
                  length: 35
                pos: 28300
                length: 88
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 28415
                      length: 41
                    - type: expression_statement
                      fields:
                        text: escapeCsv(writer, str);
                      children: []
                      pos: 28469
                      length: 23
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 28505
                      length: 25
                    pos: 28401
                    length: 139
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 28541
                      length: 172
                    pos: 28397
                    length: 316
                children: []
                pos: 28397
                length: 316
              pos: 28290
              length: 429
          children: []
          pos: 28247
          length: 472
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeCsv
              children: []
              pos: 29754
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 29764
                length: 10
              pos: 29735
              length: 539
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsNone(str, CSV_SEARCH_CHARS)
                        children: []
                        pos: 29821
                        length: 47
                    children: []
                    pos: 29820
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: str
                                children: []
                                pos: 29888
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 29895
                                length: 4
                            children: []
                            pos: 29888
                            length: 11
                        children: []
                        pos: 29887
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: out.write(str);
                        children: []
                        pos: 29919
                        length: 15
                      pos: 29901
                      length: 47
                    pos: 29884
                    length: 64
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 29961
                    length: 7
                  pos: 29870
                  length: 108
                pos: 29817
                length: 161
              - type: expression_statement
                fields:
                  text: out.write(CSV_QUOTE);
                children: []
                pos: 29987
                length: 21
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < str.length(); i++) {
                                char c = str.charAt(i);
                                if (c == CSV_QUOTE) {
                                    out.write(CSV_QUOTE); // escape double quote
                                }
                                out.write(c);
                            }
                children: []
                pos: 30017
                length: 221
              - type: expression_statement
                fields:
                  text: out.write(CSV_QUOTE);
                children: []
                pos: 30247
                length: 21
              pos: 29807
              length: 467
          children: []
          pos: 29735
          length: 539
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeCsv
              children: []
              pos: 31288
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 31300
                length: 10
              pos: 31267
              length: 441
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 31326
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 31333
                            length: 4
                        children: []
                        pos: 31326
                        length: 11
                    children: []
                    pos: 31325
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 31353
                    length: 12
                  pos: 31339
                  length: 36
                pos: 31322
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 31402
                      length: 41
                    - type: expression_statement
                      fields:
                        text: unescapeCsv(writer, str);
                      children: []
                      pos: 31456
                      length: 25
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 31494
                      length: 25
                    pos: 31388
                    length: 141
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 31530
                      length: 172
                    pos: 31384
                    length: 318
                children: []
                pos: 31384
                length: 318
              pos: 31312
              length: 396
          children: []
          pos: 31267
          length: 441
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeCsv
              children: []
              pos: 32806
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 32818
                length: 10
              pos: 32787
              length: 713
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 32875
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 32882
                            length: 4
                        children: []
                        pos: 32875
                        length: 11
                    children: []
                    pos: 32874
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 32902
                    length: 7
                  pos: 32888
                  length: 31
                pos: 32871
                length: 48
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: str.length()
                            children: []
                            pos: 32932
                            length: 12
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '2'
                            children: []
                            pos: 32947
                            length: 1
                        children: []
                        pos: 32932
                        length: 16
                    children: []
                    pos: 32931
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write(str);
                    children: []
                    pos: 32964
                    length: 15
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 32992
                    length: 7
                  pos: 32950
                  length: 59
                pos: 32928
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: str.charAt(0)
                                children: []
                                pos: 33023
                                length: 13
                              right:
                                type: identifier
                                fields:
                                  text: CSV_QUOTE
                                children: []
                                pos: 33040
                                length: 9
                            children: []
                            pos: 33023
                            length: 26
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: str.charAt(str.length() - 1)
                                children: []
                                pos: 33053
                                length: 28
                              right:
                                type: identifier
                                fields:
                                  text: CSV_QUOTE
                                children: []
                                pos: 33085
                                length: 9
                            children: []
                            pos: 33053
                            length: 41
                        children: []
                        pos: 33023
                        length: 71
                    children: []
                    pos: 33021
                    length: 75
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write(str);
                    children: []
                    pos: 33111
                    length: 15
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 33139
                    length: 7
                  pos: 33097
                  length: 59
                pos: 33018
                length: 138
              - type: local_variable_declaration
                fields:
                  text: String quoteless = str.substring(1, str.length() - 1);
                children: []
                pos: 33190
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsAny(quoteless, CSV_SEARCH_CHARS)
                        children: []
                        pos: 33259
                        length: 52
                    children: []
                    pos: 33257
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: str = StringUtils.replace(quoteless, CSV_QUOTE_STR + CSV_QUOTE_STR,
                        CSV_QUOTE_STR);
                    children: []
                    pos: 33376
                    length: 83
                  pos: 33314
                  length: 155
                pos: 33254
                length: 215
              - type: expression_statement
                fields:
                  text: out.write(str);
                children: []
                pos: 33479
                length: 15
              pos: 32861
              length: 639
          children: []
          pos: 32787
          length: 713
        pos: 1482
        length: 32021
    children: []
    pos: 1482
    length: 32021
  pos: 0
  length: 33504
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: StringEscapeUtils
        children: []
        pos: 1495
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final char CSV_DELIMITER = ',';
          children: []
          pos: 1520
          length: 46
        - type: field_declaration
          fields:
            text: private static final char CSV_QUOTE = '"';
          children: []
          pos: 1571
          length: 42
        - type: field_declaration
          fields:
            text: private static final String CSV_QUOTE_STR = String.valueOf(CSV_QUOTE);
          children: []
          pos: 1618
          length: 70
        - type: field_declaration
          fields:
            text: private static final char[] CSV_SEARCH_CHARS = new char[] {CSV_DELIMITER,
              CSV_QUOTE, CharUtils.CR, CharUtils.LF};
          children: []
          pos: 1693
          length: 113
        - type: constructor_declaration
          fields:
            text: |-
              public StringEscapeUtils() {
                    super();
                  }
          children: []
          pos: 2171
          length: 49
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJava
              children: []
              pos: 3108
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 3119
                length: 10
              pos: 3087
              length: 101
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return escapeJavaStyleString(str, false);
                children: []
                pos: 3141
                length: 41
              pos: 3131
              length: 57
          children: []
          pos: 3087
          length: 101
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJava
              children: []
              pos: 3721
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 3732
                length: 10
              pos: 3702
              length: 128
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: escapeJavaStyleString(out, str, false);
                children: []
                pos: 3785
                length: 39
              pos: 3775
              length: 55
          children: []
          pos: 3702
          length: 128
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaScript
              children: []
              pos: 4680
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 4697
                length: 10
              pos: 4659
              length: 106
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return escapeJavaStyleString(str, true);
                children: []
                pos: 4719
                length: 40
              pos: 4709
              length: 56
          children: []
          pos: 4659
          length: 106
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaScript
              children: []
              pos: 5311
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 5328
                length: 10
              pos: 5292
              length: 133
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: escapeJavaStyleString(out, str, true);
                children: []
                pos: 5381
                length: 38
              pos: 5371
              length: 54
          children: []
          pos: 5292
          length: 133
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaStyleString
              children: []
              pos: 5761
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 5783
                length: 10
              pos: 5739
              length: 526
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 5837
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5844
                            length: 4
                        children: []
                        pos: 5837
                        length: 11
                    children: []
                    pos: 5836
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 5864
                    length: 12
                  pos: 5850
                  length: 36
                pos: 5833
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter(str.length()
                          * 2);
                      children: []
                      pos: 5913
                      length: 57
                    - type: expression_statement
                      fields:
                        text: escapeJavaStyleString(writer, str, escapeSingleQuotes);
                      children: []
                      pos: 5983
                      length: 55
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 6051
                      length: 25
                    pos: 5899
                    length: 187
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 6087
                      length: 172
                    pos: 5895
                    length: 364
                children: []
                pos: 5895
                length: 364
              pos: 5823
              length: 442
          children: []
          pos: 5739
          length: 526
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeJavaStyleString
              children: []
              pos: 6671
              length: 21
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 6693
                length: 10
              pos: 6651
              length: 2610
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 6777
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 6784
                            length: 4
                        children: []
                        pos: 6777
                        length: 11
                    children: []
                    pos: 6776
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The Writer must not
                        be null");
                    children: []
                    pos: 6804
                    length: 66
                  pos: 6790
                  length: 90
                pos: 6773
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 6893
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 6900
                            length: 4
                        children: []
                        pos: 6893
                        length: 11
                    children: []
                    pos: 6892
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 6920
                    length: 7
                  pos: 6906
                  length: 31
                pos: 6889
                length: 48
              - type: local_variable_declaration
                fields:
                  text: int sz;
                children: []
                pos: 6946
                length: 7
              - type: expression_statement
                fields:
                  text: sz = str.length();
                children: []
                pos: 6962
                length: 18
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                char ch = str.charAt(i);

                                // handle unicode
                                if (ch > 0xfff) {
                                    out.write("\\u" + hex(ch));
                                } else if (ch > 0xff) {
                                    out.write("\\u0" + hex(ch));
                                } else if (ch > 0x7f) {
                                    out.write("\\u00" + hex(ch));
                                } else if (ch < 32) {
                                    switch (ch) {
                                        case '\b' :
                                            out.write('\\');
                                            out.write('b');
                                            break;
                                        case '\n' :
                                            out.write('\\');
                                            out.write('n');
                                            break;
                                        case '\t' :
                                            out.write('\\');
                                            out.write('t');
                                            break;
                                        case '\f' :
                                            out.write('\\');
                                            out.write('f');
                                            break;
                                        case '\r' :
                                            out.write('\\');
                                            out.write('r');
                                            break;
                                        default :
                                            if (ch > 0xf) {
                                                out.write("\\u00" + hex(ch));
                                            } else {
                                                out.write("\\u000" + hex(ch));
                                            }
                                            break;
                                    }
                                } else {
                                    switch (ch) {
                                        case '\'' :
                                            if (escapeSingleQuote) {
                                                out.write('\\');
                                            }
                                            out.write('\'');
                                            break;
                                        case '"' :
                                            out.write('\\');
                                            out.write('"');
                                            break;
                                        case '\\' :
                                            out.write('\\');
                                            out.write('\\');
                                            break;
                                        case '/' :
                                                out.write('\\');
                                            out.write('/');
                                            break;
                                        default :
                                            out.write(ch);
                                            break;
                                    }
                                }
                            }
                children: []
                pos: 6989
                length: 2266
              pos: 6763
              length: 2498
          children: []
          pos: 6651
          length: 2610
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hex
              children: []
              pos: 9517
              length: 3
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: char ch
                children: []
                pos: 9521
                length: 7
              pos: 9495
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return Integer.toHexString(ch).toUpperCase();
                children: []
                pos: 9540
                length: 45
              pos: 9530
              length: 61
          children: []
          pos: 9495
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJava
              children: []
              pos: 10071
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 10084
                length: 10
              pos: 10050
              length: 455
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 10110
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 10117
                            length: 4
                        children: []
                        pos: 10110
                        length: 11
                    children: []
                    pos: 10109
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 10137
                    length: 12
                  pos: 10123
                  length: 36
                pos: 10106
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter(str.length());
                      children: []
                      pos: 10186
                      length: 53
                    - type: expression_statement
                      fields:
                        text: unescapeJava(writer, str);
                      children: []
                      pos: 10252
                      length: 26
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 10291
                      length: 25
                    pos: 10172
                    length: 154
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 10327
                      length: 172
                    pos: 10168
                    length: 331
                children: []
                pos: 10168
                length: 331
              pos: 10096
              length: 409
          children: []
          pos: 10050
          length: 455
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJava
              children: []
              pos: 11226
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 11239
                length: 10
              pos: 11207
              length: 3002
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: out
                            children: []
                            pos: 11296
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11303
                            length: 4
                        children: []
                        pos: 11296
                        length: 11
                    children: []
                    pos: 11295
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException("The Writer must not
                        be null");
                    children: []
                    pos: 11323
                    length: 66
                  pos: 11309
                  length: 90
                pos: 11292
                length: 107
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 11412
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 11419
                            length: 4
                        children: []
                        pos: 11412
                        length: 11
                    children: []
                    pos: 11411
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 11439
                    length: 7
                  pos: 11425
                  length: 31
                pos: 11408
                length: 48
              - type: local_variable_declaration
                fields:
                  text: int sz = str.length();
                children: []
                pos: 11465
                length: 22
              - type: local_variable_declaration
                fields:
                  text: StringBuffer unicode = new StringBuffer(4);
                children: []
                pos: 11496
                length: 43
              - type: local_variable_declaration
                fields:
                  text: boolean hadSlash = false;
                children: []
                pos: 11548
                length: 25
              - type: local_variable_declaration
                fields:
                  text: boolean inUnicode = false;
                children: []
                pos: 11582
                length: 26
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < sz; i++) {
                                char ch = str.charAt(i);
                                if (inUnicode) {
                                    // if in unicode, then we're reading unicode
                                    // values in somehow
                                    unicode.append(ch);
                                    if (unicode.length() == 4) {
                                        // unicode now contains the four hex digits
                                        // which represents our unicode character
                                        try {
                                            int value = Integer.parseInt(unicode.toString(), 16);
                                            out.write((char) value);
                                            unicode.setLength(0);
                                            inUnicode = false;
                                            hadSlash = false;
                                        } catch (NumberFormatException nfe) {
                                            throw new NestableRuntimeException("Unable to parse unicode value: " + unicode, nfe);
                                        }
                                    }
                                    continue;
                                }
                                if (hadSlash) {
                                    // handle an escaped value
                                    hadSlash = false;
                                    switch (ch) {
                                        case '\\':
                                            out.write('\\');
                                            break;
                                        case '\'':
                                            out.write('\'');
                                            break;
                                        case '\"':
                                            out.write('"');
                                            break;
                                        case 'r':
                                            out.write('\r');
                                            break;
                                        case 'f':
                                            out.write('\f');
                                            break;
                                        case 't':
                                            out.write('\t');
                                            break;
                                        case 'n':
                                            out.write('\n');
                                            break;
                                        case 'b':
                                            out.write('\b');
                                            break;
                                        case 'u':
                                            {
                                                // uh-oh, we're in unicode country....
                                                inUnicode = true;
                                                break;
                                            }
                                        default :
                                            out.write(ch);
                                            break;
                                    }
                                    continue;
                                } else if (ch == '\\') {
                                    hadSlash = true;
                                    continue;
                                }
                                out.write(ch);
                            }
                children: []
                pos: 11617
                length: 2407
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: identifier
                        fields:
                          text: hadSlash
                        children: []
                        pos: 14037
                        length: 8
                    children: []
                    pos: 14036
                    length: 10
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write('\\');
                    children: []
                    pos: 14177
                    length: 16
                  pos: 14047
                  length: 156
                pos: 14033
                length: 170
              pos: 11282
              length: 2927
          children: []
          pos: 11207
          length: 3002
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJavaScript
              children: []
              pos: 14742
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 14761
                length: 10
              pos: 14721
              length: 93
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return unescapeJava(str);
                children: []
                pos: 14783
                length: 25
              pos: 14773
              length: 41
          children: []
          pos: 14721
          length: 93
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeJavaScript
              children: []
              pos: 15581
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 15600
                length: 10
              pos: 15562
              length: 120
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: unescapeJava(out, str);
                children: []
                pos: 15653
                length: 23
              pos: 15643
              length: 39
          children: []
          pos: 15562
          length: 120
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeHtml
              children: []
              pos: 17089
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 17100
                length: 10
              pos: 17068
              length: 447
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 17126
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 17133
                            length: 4
                        children: []
                        pos: 17126
                        length: 11
                    children: []
                    pos: 17125
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 17153
                    length: 12
                  pos: 17139
                  length: 36
                pos: 17122
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter ((int)(str.length()
                          * 1.5));
                      children: []
                      pos: 17202
                      length: 67
                    - type: expression_statement
                      fields:
                        text: escapeHtml(writer, str);
                      children: []
                      pos: 17282
                      length: 24
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 17319
                      length: 25
                    pos: 17188
                    length: 166
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) {
                                      //assert false;
                                      //should be impossible
                                      e.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 17355
                      length: 154
                    pos: 17184
                    length: 325
                children: []
                pos: 17184
                length: 325
              pos: 17112
              length: 403
          children: []
          pos: 17068
          length: 447
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeHtml
              children: []
              pos: 19102
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 19113
                length: 13
              pos: 19083
              length: 316
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 19176
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 19186
                            length: 4
                        children: []
                        pos: 19176
                        length: 14
                    children: []
                    pos: 19175
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 19207
                    length: 68
                  pos: 19193
                  length: 92
                pos: 19172
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: string
                            children: []
                            pos: 19298
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 19308
                            length: 4
                        children: []
                        pos: 19298
                        length: 14
                    children: []
                    pos: 19297
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 19328
                    length: 7
                  pos: 19314
                  length: 31
                pos: 19294
                length: 51
              - type: expression_statement
                fields:
                  text: Entities.HTML40.escape(writer, string);
                children: []
                pos: 19354
                length: 39
              pos: 19162
              length: 237
          children: []
          pos: 19083
          length: 316
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeHtml
              children: []
              pos: 20225
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 20238
                length: 10
              pos: 20204
              length: 451
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 20264
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 20271
                            length: 4
                        children: []
                        pos: 20264
                        length: 11
                    children: []
                    pos: 20263
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 20291
                    length: 12
                  pos: 20277
                  length: 36
                pos: 20260
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter ((int)(str.length()
                          * 1.5));
                      children: []
                      pos: 20340
                      length: 67
                    - type: expression_statement
                      fields:
                        text: unescapeHtml(writer, str);
                      children: []
                      pos: 20420
                      length: 26
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 20459
                      length: 25
                    pos: 20326
                    length: 168
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException e) {
                                      //assert false;
                                      //should be impossible
                                      e.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 20495
                      length: 154
                    pos: 20322
                    length: 327
                children: []
                pos: 20322
                length: 327
              pos: 20250
              length: 405
          children: []
          pos: 20204
          length: 451
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeHtml
              children: []
              pos: 21493
              length: 12
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 21506
                length: 13
              pos: 21474
              length: 320
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 21569
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21579
                            length: 4
                        children: []
                        pos: 21569
                        length: 14
                    children: []
                    pos: 21568
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 21600
                    length: 68
                  pos: 21586
                  length: 92
                pos: 21565
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: string
                            children: []
                            pos: 21691
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 21701
                            length: 4
                        children: []
                        pos: 21691
                        length: 14
                    children: []
                    pos: 21690
                    length: 16
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 21721
                    length: 7
                  pos: 21707
                  length: 31
                pos: 21687
                length: 51
              - type: expression_statement
                fields:
                  text: Entities.HTML40.unescape(writer, string);
                children: []
                pos: 21747
                length: 41
              pos: 21555
              length: 239
          children: []
          pos: 21474
          length: 320
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeXml
              children: []
              pos: 22771
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 22781
                length: 13
              pos: 22752
              length: 303
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 22841
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 22851
                            length: 4
                        children: []
                        pos: 22841
                        length: 14
                    children: []
                    pos: 22840
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 22872
                    length: 68
                  pos: 22858
                  length: 92
                pos: 22837
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 22963
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 22970
                            length: 4
                        children: []
                        pos: 22963
                        length: 11
                    children: []
                    pos: 22962
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 22990
                    length: 7
                  pos: 22976
                  length: 31
                pos: 22959
                length: 48
              - type: expression_statement
                fields:
                  text: Entities.XML.escape(writer, str);
                children: []
                pos: 23016
                length: 33
              pos: 22827
              length: 228
          children: []
          pos: 22752
          length: 303
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeXml
              children: []
              pos: 23852
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 23862
                length: 10
              pos: 23831
              length: 153
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 23888
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 23895
                            length: 4
                        children: []
                        pos: 23888
                        length: 11
                    children: []
                    pos: 23887
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 23915
                    length: 12
                  pos: 23901
                  length: 36
                pos: 23884
                length: 53
              - type: return_statement
                fields:
                  text: return Entities.XML.escape(str);
                children: []
                pos: 23946
                length: 32
              pos: 23874
              length: 110
          children: []
          pos: 23831
          length: 153
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeXml
              children: []
              pos: 24864
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer writer
                children: []
                pos: 24876
                length: 13
              pos: 24845
              length: 307
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: writer
                            children: []
                            pos: 24936
                            length: 6
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 24946
                            length: 4
                        children: []
                        pos: 24936
                        length: 14
                    children: []
                    pos: 24935
                    length: 17
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: throw new IllegalArgumentException ("The Writer must not
                        be null.");
                    children: []
                    pos: 24967
                    length: 68
                  pos: 24953
                  length: 92
                pos: 24932
                length: 113
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 25058
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 25065
                            length: 4
                        children: []
                        pos: 25058
                        length: 11
                    children: []
                    pos: 25057
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 25085
                    length: 7
                  pos: 25071
                  length: 31
                pos: 25054
                length: 48
              - type: expression_statement
                fields:
                  text: Entities.XML.unescape(writer, str);
                children: []
                pos: 25111
                length: 35
              pos: 24922
              length: 230
          children: []
          pos: 24845
          length: 307
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeXml
              children: []
              pos: 25854
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 25866
                length: 10
              pos: 25833
              length: 157
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 25892
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 25899
                            length: 4
                        children: []
                        pos: 25892
                        length: 11
                    children: []
                    pos: 25891
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 25919
                    length: 12
                  pos: 25905
                  length: 36
                pos: 25888
                length: 53
              - type: return_statement
                fields:
                  text: return Entities.XML.unescape(str);
                children: []
                pos: 25950
                length: 34
              pos: 25878
              length: 112
          children: []
          pos: 25833
          length: 157
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeSql
              children: []
              pos: 26877
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 26887
                length: 10
              pos: 26856
              length: 164
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 26913
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 26920
                            length: 4
                        children: []
                        pos: 26913
                        length: 11
                    children: []
                    pos: 26912
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 26940
                    length: 12
                  pos: 26926
                  length: 36
                pos: 26909
                length: 53
              - type: return_statement
                fields:
                  text: return StringUtils.replace(str, "'", "''");
                children: []
                pos: 26971
                length: 43
              pos: 26899
              length: 121
          children: []
          pos: 26856
          length: 164
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeCsv
              children: []
              pos: 28078
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 28088
                length: 10
              pos: 28057
              length: 472
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsNone(str, CSV_SEARCH_CHARS)
                        children: []
                        pos: 28114
                        length: 47
                    children: []
                    pos: 28113
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return str;
                    children: []
                    pos: 28177
                    length: 11
                  pos: 28163
                  length: 35
                pos: 28110
                length: 88
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 28225
                      length: 41
                    - type: expression_statement
                      fields:
                        text: escapeCsv(writer, str);
                      children: []
                      pos: 28279
                      length: 23
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 28315
                      length: 25
                    pos: 28211
                    length: 139
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 28351
                      length: 172
                    pos: 28207
                    length: 316
                children: []
                pos: 28207
                length: 316
              pos: 28100
              length: 429
          children: []
          pos: 28057
          length: 472
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: escapeCsv
              children: []
              pos: 29564
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 29574
                length: 10
              pos: 29545
              length: 539
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsNone(str, CSV_SEARCH_CHARS)
                        children: []
                        pos: 29631
                        length: 47
                    children: []
                    pos: 29630
                    length: 49
                children:
                - type: block
                  fields: {}
                  children:
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: str
                                children: []
                                pos: 29698
                                length: 3
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 29705
                                length: 4
                            children: []
                            pos: 29698
                            length: 11
                        children: []
                        pos: 29697
                        length: 13
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: out.write(str);
                        children: []
                        pos: 29729
                        length: 15
                      pos: 29711
                      length: 47
                    pos: 29694
                    length: 64
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 29771
                    length: 7
                  pos: 29680
                  length: 108
                pos: 29627
                length: 161
              - type: expression_statement
                fields:
                  text: out.write(CSV_QUOTE);
                children: []
                pos: 29797
                length: 21
              - type: for_statement
                fields:
                  text: |-
                    for (int i = 0; i < str.length(); i++) {
                                char c = str.charAt(i);
                                if (c == CSV_QUOTE) {
                                    out.write(CSV_QUOTE); // escape double quote
                                }
                                out.write(c);
                            }
                children: []
                pos: 29827
                length: 221
              - type: expression_statement
                fields:
                  text: out.write(CSV_QUOTE);
                children: []
                pos: 30057
                length: 21
              pos: 29617
              length: 467
          children: []
          pos: 29545
          length: 539
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeCsv
              children: []
              pos: 31098
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String str
                children: []
                pos: 31110
                length: 10
              pos: 31077
              length: 441
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 31136
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 31143
                            length: 4
                        children: []
                        pos: 31136
                        length: 11
                    children: []
                    pos: 31135
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return null;
                    children: []
                    pos: 31163
                    length: 12
                  pos: 31149
                  length: 36
                pos: 31132
                length: 53
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: local_variable_declaration
                      fields:
                        text: StringWriter writer = new StringWriter();
                      children: []
                      pos: 31212
                      length: 41
                    - type: expression_statement
                      fields:
                        text: unescapeCsv(writer, str);
                      children: []
                      pos: 31266
                      length: 25
                    - type: return_statement
                      fields:
                        text: return writer.toString();
                      children: []
                      pos: 31304
                      length: 25
                    pos: 31198
                    length: 141
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (IOException ioe) {
                                      // this should never ever happen while writing to a StringWriter
                                      ioe.printStackTrace();
                                      return null;
                                  }
                      children: []
                      pos: 31340
                      length: 172
                    pos: 31194
                    length: 318
                children: []
                pos: 31194
                length: 318
              pos: 31122
              length: 396
          children: []
          pos: 31077
          length: 441
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: unescapeCsv
              children: []
              pos: 32616
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Writer out
                children: []
                pos: 32628
                length: 10
              pos: 32597
              length: 713
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: str
                            children: []
                            pos: 32685
                            length: 3
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 32692
                            length: 4
                        children: []
                        pos: 32685
                        length: 11
                    children: []
                    pos: 32684
                    length: 13
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 32712
                    length: 7
                  pos: 32698
                  length: 31
                pos: 32681
                length: 48
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: less_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: str.length()
                            children: []
                            pos: 32742
                            length: 12
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '2'
                            children: []
                            pos: 32757
                            length: 1
                        children: []
                        pos: 32742
                        length: 16
                    children: []
                    pos: 32741
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write(str);
                    children: []
                    pos: 32774
                    length: 15
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 32802
                    length: 7
                  pos: 32760
                  length: 59
                pos: 32738
                length: 81
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: str.charAt(0)
                                children: []
                                pos: 32833
                                length: 13
                              right:
                                type: identifier
                                fields:
                                  text: CSV_QUOTE
                                children: []
                                pos: 32850
                                length: 9
                            children: []
                            pos: 32833
                            length: 26
                          right:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: str.charAt(str.length() - 1)
                                children: []
                                pos: 32863
                                length: 28
                              right:
                                type: identifier
                                fields:
                                  text: CSV_QUOTE
                                children: []
                                pos: 32895
                                length: 9
                            children: []
                            pos: 32863
                            length: 41
                        children: []
                        pos: 32833
                        length: 71
                    children: []
                    pos: 32831
                    length: 75
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: out.write(str);
                    children: []
                    pos: 32921
                    length: 15
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 32949
                    length: 7
                  pos: 32907
                  length: 59
                pos: 32828
                length: 138
              - type: local_variable_declaration
                fields:
                  text: String quoteless = str.substring(1, str.length() - 1);
                children: []
                pos: 33000
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: StringUtils.containsAny(quoteless, CSV_SEARCH_CHARS)
                        children: []
                        pos: 33069
                        length: 52
                    children: []
                    pos: 33067
                    length: 56
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: str = StringUtils.replace(quoteless, CSV_QUOTE_STR + CSV_QUOTE_STR,
                        CSV_QUOTE_STR);
                    children: []
                    pos: 33186
                    length: 83
                  pos: 33124
                  length: 155
                pos: 33064
                length: 215
              - type: expression_statement
                fields:
                  text: out.write(str);
                children: []
                pos: 33289
                length: 15
              pos: 32671
              length: 639
          children: []
          pos: 32597
          length: 713
        pos: 1482
        length: 31831
    children: []
    pos: 1482
    length: 31831
  pos: 0
  length: 33314
text_diff: "--- before\n+++ after\n@@ -83,7 +83,7 @@\n      * @return String with
  escaped values, <code>null</code> if null string input\n      */\n     public static
  String escapeJava(String str) {\n-        return escapeJavaStyleString(str, false,
  false);\n+        return escapeJavaStyleString(str, false);\n     }\n \n     /**\n@@
  -99,7 +99,7 @@\n      * @throws IOException if error occurs on underlying Writer\n
  \     */\n     public static void escapeJava(Writer out, String str) throws IOException
  {\n-        escapeJavaStyleString(out, str, false, false);\n+        escapeJavaStyleString(out,
  str, false);\n     }\n \n     /**\n@@ -124,7 +124,7 @@\n      * @return String with
  escaped values, <code>null</code> if null string input\n      */\n     public static
  String escapeJavaScript(String str) {\n-        return escapeJavaStyleString(str,
  true, true);\n+        return escapeJavaStyleString(str, true);\n     }\n \n     /**\n@@
  -140,7 +140,7 @@\n      * @throws IOException if error occurs on underlying Writer\n
  \     **/\n     public static void escapeJavaScript(Writer out, String str) throws
  IOException {\n-        escapeJavaStyleString(out, str, true, true);\n+        escapeJavaStyleString(out,
  str, true);\n     }\n \n     /**\n@@ -151,13 +151,13 @@\n      * @param escapeForwardSlash
  TODO\n      * @return the escaped string\n      */\n-    private static String escapeJavaStyleString(String
  str, boolean escapeSingleQuotes, boolean escapeForwardSlash) {\n+    private static
  String escapeJavaStyleString(String str, boolean escapeSingleQuotes) {\n         if
  (str == null) {\n             return null;\n         }\n         try {\n             StringWriter
  writer = new StringWriter(str.length() * 2);\n-            escapeJavaStyleString(writer,
  str, escapeSingleQuotes, escapeForwardSlash);\n+            escapeJavaStyleString(writer,
  str, escapeSingleQuotes);\n             return writer.toString();\n         } catch
  (IOException ioe) {\n             // this should never ever happen while writing
  to a StringWriter\n@@ -175,8 +175,7 @@\n      * @param escapeForwardSlash TODO\n
  \     * @throws IOException if an IOException occurs\n      */\n-    private static
  void escapeJavaStyleString(Writer out, String str, boolean escapeSingleQuote,\n-
  \           boolean escapeForwardSlash) throws IOException {\n+    private static
  void escapeJavaStyleString(Writer out, String str, boolean escapeSingleQuote) throws
  IOException {\n         if (out == null) {\n             throw new IllegalArgumentException(\"The
  Writer must not be null\");\n         }\n@@ -242,9 +241,7 @@\n                         out.write('\\\\');\n
  \                        break;\n                     case '/' :\n-                        if
  (escapeForwardSlash) {\n                             out.write('\\\\');\n-                        }\n
  \                        out.write('/');\n                         break;\n                     default
  :\n"
tree_diff: |+
  New cluster:
  UPDATE from return escapeJavaStyleString(str, false, false); to return escapeJavaStyleString(str, false);
  ------------
  ===
  update-node
  ---
  return_statement: return escapeJavaStyleString(str, false, false); [3141,3189]
  replace return escapeJavaStyleString(str, false, false); by return escapeJavaStyleString(str, false);

  New cluster:
  UPDATE from escapeJavaStyleString(out, str, false, false); to escapeJavaStyleString(out, str, false);
  ------------
  ===
  update-node
  ---
  expression_statement: escapeJavaStyleString(out, str, false, false); [3792,3838]
  replace escapeJavaStyleString(out, str, false, false); by escapeJavaStyleString(out, str, false);

  New cluster:
  UPDATE from return escapeJavaStyleString(str, true, true); to return escapeJavaStyleString(str, true);
  ------------
  ===
  update-node
  ---
  return_statement: return escapeJavaStyleString(str, true, true); [4733,4779]
  replace return escapeJavaStyleString(str, true, true); by return escapeJavaStyleString(str, true);

  New cluster:
  UPDATE from escapeJavaStyleString(out, str, true, true); to escapeJavaStyleString(out, str, true);
  ------------
  ===
  update-node
  ---
  expression_statement: escapeJavaStyleString(out, str, true, true); [5401,5445]
  replace escapeJavaStyleString(out, str, true, true); by escapeJavaStyleString(out, str, true);

  New cluster:
  UPDATE from for (int i = 0; i < sz; i++) {
              char ch = str.charAt(i);

              // handle unicode
              if (ch > 0xfff) {
                  out.write("\\u" + hex(ch));
              } else if (ch > 0xff) {
                  out.write("\\u0" + hex(ch));
              } else if (ch > 0x7f) {
                  out.write("\\u00" + hex(ch));
              } else if (ch < 32) {
                  switch (ch) {
                      case '\b' :
                          out.write('\\');
                          out.write('b');
                          break;
                      case '\n' :
                          out.write('\\');
                          out.write('n');
                          break;
                      case '\t' :
                          out.write('\\');
                          out.write('t');
                          break;
                      case '\f' :
                          out.write('\\');
                          out.write('f');
                          break;
                      case '\r' :
                          out.write('\\');
                          out.write('r');
                          break;
                      default :
                          if (ch > 0xf) {
                              out.write("\\u00" + hex(ch));
                          } else {
                              out.write("\\u000" + hex(ch));
                          }
                          break;
                  }
              } else {
                  switch (ch) {
                      case '\'' :
                          if (escapeSingleQuote) {
                              out.write('\\');
                          }
                          out.write('\'');
                          break;
                      case '"' :
                          out.write('\\');
                          out.write('"');
                          break;
                      case '\\' :
                          out.write('\\');
                          out.write('\\');
                          break;
                      case '/' :
                          if (escapeForwardSlash) {
                              out.write('\\');
                          }
                          out.write('/');
                          break;
                      default :
                          out.write(ch);
                          break;
                  }
              }
          } to for (int i = 0; i < sz; i++) {
              char ch = str.charAt(i);

              // handle unicode
              if (ch > 0xfff) {
                  out.write("\\u" + hex(ch));
              } else if (ch > 0xff) {
                  out.write("\\u0" + hex(ch));
              } else if (ch > 0x7f) {
                  out.write("\\u00" + hex(ch));
              } else if (ch < 32) {
                  switch (ch) {
                      case '\b' :
                          out.write('\\');
                          out.write('b');
                          break;
                      case '\n' :
                          out.write('\\');
                          out.write('n');
                          break;
                      case '\t' :
                          out.write('\\');
                          out.write('t');
                          break;
                      case '\f' :
                          out.write('\\');
                          out.write('f');
                          break;
                      case '\r' :
                          out.write('\\');
                          out.write('r');
                          break;
                      default :
                          if (ch > 0xf) {
                              out.write("\\u00" + hex(ch));
                          } else {
                              out.write("\\u000" + hex(ch));
                          }
                          break;
                  }
              } else {
                  switch (ch) {
                      case '\'' :
                          if (escapeSingleQuote) {
                              out.write('\\');
                          }
                          out.write('\'');
                          break;
                      case '"' :
                          out.write('\\');
                          out.write('"');
                          break;
                      case '\\' :
                          out.write('\\');
                          out.write('\\');
                          break;
                      case '/' :
                              out.write('\\');
                          out.write('/');
                          break;
                      default :
                          out.write(ch);
                          break;
                  }
              }
          }
  ------------
  ===
  update-node
  ---
  for_statement: for (int i = 0; i < sz; i++) {
              char ch = str.charAt(i);

              // handle unicode
              if (ch > 0xfff) {
                  out.write("\\u" + hex(ch));
              } else if (ch > 0xff) {
                  out.write("\\u0" + hex(ch));
              } else if (ch > 0x7f) {
                  out.write("\\u00" + hex(ch));
              } else if (ch < 32) {
                  switch (ch) {
                      case '\b' :
                          out.write('\\');
                          out.write('b');
                          break;
                      case '\n' :
                          out.write('\\');
                          out.write('n');
                          break;
                      case '\t' :
                          out.write('\\');
                          out.write('t');
                          break;
                      case '\f' :
                          out.write('\\');
                          out.write('f');
                          break;
                      case '\r' :
                          out.write('\\');
                          out.write('r');
                          break;
                      default :
                          if (ch > 0xf) {
                              out.write("\\u00" + hex(ch));
                          } else {
                              out.write("\\u000" + hex(ch));
                          }
                          break;
                  }
              } else {
                  switch (ch) {
                      case '\'' :
                          if (escapeSingleQuote) {
                              out.write('\\');
                          }
                          out.write('\'');
                          break;
                      case '"' :
                          out.write('\\');
                          out.write('"');
                          break;
                      case '\\' :
                          out.write('\\');
                          out.write('\\');
                          break;
                      case '/' :
                          if (escapeForwardSlash) {
                              out.write('\\');
                          }
                          out.write('/');
                          break;
                      default :
                          out.write(ch);
                          break;
                  }
              }
          } [7103,9445]
  replace for (int i = 0; i < sz; i++) {
              char ch = str.charAt(i);

              // handle unicode
              if (ch > 0xfff) {
                  out.write("\\u" + hex(ch));
              } else if (ch > 0xff) {
                  out.write("\\u0" + hex(ch));
              } else if (ch > 0x7f) {
                  out.write("\\u00" + hex(ch));
              } else if (ch < 32) {
                  switch (ch) {
                      case '\b' :
                          out.write('\\');
                          out.write('b');
                          break;
                      case '\n' :
                          out.write('\\');
                          out.write('n');
                          break;
                      case '\t' :
                          out.write('\\');
                          out.write('t');
                          break;
                      case '\f' :
                          out.write('\\');
                          out.write('f');
                          break;
                      case '\r' :
                          out.write('\\');
                          out.write('r');
                          break;
                      default :
                          if (ch > 0xf) {
                              out.write("\\u00" + hex(ch));
                          } else {
                              out.write("\\u000" + hex(ch));
                          }
                          break;
                  }
              } else {
                  switch (ch) {
                      case '\'' :
                          if (escapeSingleQuote) {
                              out.write('\\');
                          }
                          out.write('\'');
                          break;
                      case '"' :
                          out.write('\\');
                          out.write('"');
                          break;
                      case '\\' :
                          out.write('\\');
                          out.write('\\');
                          break;
                      case '/' :
                          if (escapeForwardSlash) {
                              out.write('\\');
                          }
                          out.write('/');
                          break;
                      default :
                          out.write(ch);
                          break;
                  }
              }
          } by for (int i = 0; i < sz; i++) {
              char ch = str.charAt(i);

              // handle unicode
              if (ch > 0xfff) {
                  out.write("\\u" + hex(ch));
              } else if (ch > 0xff) {
                  out.write("\\u0" + hex(ch));
              } else if (ch > 0x7f) {
                  out.write("\\u00" + hex(ch));
              } else if (ch < 32) {
                  switch (ch) {
                      case '\b' :
                          out.write('\\');
                          out.write('b');
                          break;
                      case '\n' :
                          out.write('\\');
                          out.write('n');
                          break;
                      case '\t' :
                          out.write('\\');
                          out.write('t');
                          break;
                      case '\f' :
                          out.write('\\');
                          out.write('f');
                          break;
                      case '\r' :
                          out.write('\\');
                          out.write('r');
                          break;
                      default :
                          if (ch > 0xf) {
                              out.write("\\u00" + hex(ch));
                          } else {
                              out.write("\\u000" + hex(ch));
                          }
                          break;
                  }
              } else {
                  switch (ch) {
                      case '\'' :
                          if (escapeSingleQuote) {
                              out.write('\\');
                          }
                          out.write('\'');
                          break;
                      case '"' :
                          out.write('\\');
                          out.write('"');
                          break;
                      case '\\' :
                          out.write('\\');
                          out.write('\\');
                          break;
                      case '/' :
                              out.write('\\');
                          out.write('/');
                          break;
                      default :
                          out.write(ch);
                          break;
                  }
              }
          }

  New cluster:
  UPDATE from escapeJavaStyleString(writer, str, escapeSingleQuotes, escapeForwardSlash); to escapeJavaStyleString(writer, str, escapeSingleQuotes);
  ------------
  ===
  update-node
  ---
  expression_statement: escapeJavaStyleString(writer, str, escapeSingleQuotes, escapeForwardSlash); [6037,6112]
  replace escapeJavaStyleString(writer, str, escapeSingleQuotes, escapeForwardSlash); by escapeJavaStyleString(writer, str, escapeSingleQuotes);

...
