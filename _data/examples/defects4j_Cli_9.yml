---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: Parser
        children: []
        pos: 1184
        length: 6
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected CommandLine cmd;
          children: []
          pos: 1259
          length: 26
        - type: field_declaration
          fields:
            text: private Options options;
          children: []
          pos: 1318
          length: 24
        - type: field_declaration
          fields:
            text: private List requiredOptions;
          children: []
          pos: 1392
          length: 29
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setOptions
              children: []
              pos: 1442
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Options options
                children: []
                pos: 1453
                length: 21
              pos: 1427
              length: 149
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.options = options;
                children: []
                pos: 1486
                length: 23
              - type: expression_statement
                fields:
                  text: this.requiredOptions = options.getRequiredOptions();
                children: []
                pos: 1518
                length: 52
              pos: 1476
              length: 100
          children: []
          pos: 1427
          length: 149
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptions
              children: []
              pos: 1600
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1582
              length: 62
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return options;
                children: []
                pos: 1623
                length: 15
              pos: 1613
              length: 31
          children: []
          pos: 1582
          length: 62
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getRequiredOptions
              children: []
              pos: 1665
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1650
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return requiredOptions;
                children: []
                pos: 1696
                length: 23
              pos: 1686
              length: 39
          children: []
          pos: 1650
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flatten
              children: []
              pos: 2224
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options opts
                children: []
                pos: 2232
                length: 12
              pos: 2196
              length: 136
          children: []
          pos: 2196
          length: 136
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 2711
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 2717
                length: 15
              pos: 2692
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, null, false);
                children: []
                pos: 2812
                length: 46
              pos: 2802
              length: 62
          children: []
          pos: 2692
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 3333
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 3339
                length: 15
              pos: 3314
              length: 217
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, properties, false);
                children: []
                pos: 3473
                length: 52
              pos: 3463
              length: 68
          children: []
          pos: 3314
          length: 217
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 4109
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 4115
                length: 15
              pos: 4090
              length: 223
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, null, stopAtNonOption);
                children: []
                pos: 4251
                length: 56
              pos: 4241
              length: 72
          children: []
          pos: 4090
          length: 223
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 4895
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 4901
                length: 15
              pos: 4876
              length: 2626
            body:
              type: block
              fields: {}
              children:
              - type: for_statement
                fields:
                  text: |-
                    for (Iterator it = options.helpOptions().iterator(); it.hasNext();) {
                                Option opt = (Option) it.next();
                                opt.clearValues();
                            }
                children: []
                pos: 5140
                length: 155
              - type: expression_statement
                fields:
                  text: setOptions(options);
                children: []
                pos: 5335
                length: 20
              - type: expression_statement
                fields:
                  text: cmd = new CommandLine();
                children: []
                pos: 5365
                length: 24
              - type: local_variable_declaration
                fields:
                  text: boolean eatTheRest = false;
                children: []
                pos: 5399
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: arguments
                            children: []
                            pos: 5440
                            length: 9
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5453
                            length: 4
                        children: []
                        pos: 5440
                        length: 17
                    children: []
                    pos: 5439
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: arguments = new String[0];
                    children: []
                    pos: 5481
                    length: 26
                  pos: 5467
                  length: 50
                pos: 5436
                length: 81
              - type: local_variable_declaration
                fields:
                  text: "List tokenList = Arrays.asList(flatten(getOptions(), \n                                               arguments,
                    \n                                               stopAtNonOption));"
                children: []
                pos: 5527
                length: 178
              - type: local_variable_declaration
                fields:
                  text: ListIterator iterator = tokenList.listIterator();
                children: []
                pos: 5715
                length: 49
              - type: while_statement
                fields:
                  text: |-
                    while (iterator.hasNext())
                            {
                                String t = (String) iterator.next();

                                // the value is the double-dash
                                if ("--".equals(t))
                                {
                                    eatTheRest = true;
                                }

                                // the value is a single dash
                                else if ("-".equals(t))
                                {
                                    if (stopAtNonOption)
                                    {
                                        eatTheRest = true;
                                    }
                                    else
                                    {
                                        cmd.addArg(t);
                                    }
                                }

                                // the value is an option
                                else if (t.startsWith("-"))
                                {
                                    if (stopAtNonOption && !getOptions().hasOption(t))
                                    {
                                        eatTheRest = true;
                                        cmd.addArg(t);
                                    }
                                    else
                                    {
                                        processOption(t, iterator);
                                    }
                                }

                                // the value is an argument
                                else
                                {
                                    cmd.addArg(t);

                                    if (stopAtNonOption)
                                    {
                                        eatTheRest = true;
                                    }
                                }

                                // eat the remaining tokens
                                if (eatTheRest)
                                {
                                    while (iterator.hasNext())
                                    {
                                        String str = (String) iterator.next();

                                        // ensure only one double-dash is added
                                        if (!"--".equals(str))
                                        {
                                            cmd.addArg(str);
                                        }
                                    }
                                }
                            }
                children: []
                pos: 5814
                length: 1589
              - type: expression_statement
                fields:
                  text: processProperties(properties);
                children: []
                pos: 7413
                length: 30
              - type: expression_statement
                fields:
                  text: checkRequiredOptions();
                children: []
                pos: 7452
                length: 23
              - type: return_statement
                fields:
                  text: return cmd;
                children: []
                pos: 7485
                length: 11
              pos: 5050
              length: 2452
          children: []
          pos: 4876
          length: 2626
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processProperties
              children: []
              pos: 7703
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Properties properties
                children: []
                pos: 7721
                length: 21
              pos: 7688
              length: 1505
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: properties
                            children: []
                            pos: 7762
                            length: 10
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 7776
                            length: 4
                        children: []
                        pos: 7762
                        length: 18
                    children: []
                    pos: 7761
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 7804
                    length: 7
                  pos: 7790
                  length: 31
                pos: 7758
                length: 63
              - type: for_statement
                fields:
                  text: "for (Enumeration e = properties.propertyNames(); e.hasMoreElements();)\n
                    \       {\n            String option = e.nextElement().toString();\n\n
                    \           if (!cmd.hasOption(option))\n            {\n                Option
                    opt = getOptions().getOption(option);\n\n                // get
                    the value from the properties instance\n                String
                    value = properties.getProperty(option);\n\n                if
                    (opt.hasArg())\n                {\n                    if ((opt.getValues()
                    == null)\n                        || (opt.getValues().length ==
                    0))\n                    {\n                        try\n                        {\n
                    \                           opt.addValueForProcessing(value);\n
                    \                       }\n                        catch (RuntimeException
                    exp)\n                        {\n                            //
                    if we cannot add the value don't worry about it\n                        }\n
                    \                   }\n                }\n                else
                    if (!(\"yes\".equalsIgnoreCase(value) \n                           ||
                    \"true\".equalsIgnoreCase(value)\n                           ||
                    \"1\".equalsIgnoreCase(value)))\n                {\n                    //
                    if the value is not yes, true or 1 then don't add the\n                    //
                    option to the CommandLine\n                    break;\n                }\n\n
                    \               cmd.addOption(opt);\n            }\n        }"
                children: []
                pos: 7831
                length: 1356
              pos: 7748
              length: 1445
          children: []
          pos: 7688
          length: 1505
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkRequiredOptions
              children: []
              pos: 9438
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 9423
              length: 749
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: getRequiredOptions().size()
                            children: []
                            pos: 9599
                            length: 27
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 9629
                            length: 1
                        children: []
                        pos: 9599
                        length: 31
                    children: []
                    pos: 9598
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Iterator iter = getRequiredOptions().iterator();
                    children: []
                    pos: 9654
                    length: 48
                  - type: local_variable_declaration
                    fields:
                      text: StringBuffer buff = new StringBuffer("Missing required
                        option");
                    children: []
                    pos: 9715
                    length: 64
                  - type: expression_statement
                    fields:
                      text: 'buff.append(getRequiredOptions().size() == 1 ? "" : "s");'
                    children: []
                    pos: 9792
                    length: 57
                  - type: expression_statement
                    fields:
                      text: 'buff.append(": ");'
                    children: []
                    pos: 9862
                    length: 18
                  - type: while_statement
                    fields:
                      text: |-
                        while (iter.hasNext())
                                    {
                                        buff.append(iter.next());
                                        buff.append(", ");
                                    }
                    children: []
                    pos: 9944
                    length: 127
                  - type: throw_statement
                    fields:
                      text: throw new MissingOptionException(buff.substring(0, buff.length()
                        - 2));
                    children: []
                    pos: 10085
                    length: 71
                  pos: 9640
                  length: 526
                pos: 9595
                length: 571
              pos: 9503
              length: 669
          children: []
          pos: 9423
          length: 749
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processArgs
              children: []
              pos: 10606
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Option opt
                children: []
                pos: 10618
                length: 10
              pos: 10594
              length: 948
            body:
              type: block
              fields: {}
              children:
              - type: while_statement
                fields:
                  text: |-
                    while (iter.hasNext())
                            {
                                String str = (String) iter.next();

                                // found an Option, not an argument
                                if (getOptions().hasOption(str) && str.startsWith("-"))
                                {
                                    iter.previous();
                                    break;
                                }

                                // found a value
                                try
                                {
                                    opt.addValueForProcessing( Util.stripLeadingAndTrailingQuotes(str) );
                                }
                                catch (RuntimeException exp)
                                {
                                    iter.previous();
                                    break;
                                }
                            }
                children: []
                pos: 10734
                length: 575
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: opt.getValues()
                                    children: []
                                    pos: 11324
                                    length: 15
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 11343
                                    length: 4
                                children: []
                                pos: 11324
                                length: 23
                            children: []
                            pos: 11323
                            length: 25
                          right:
                            type: unary_expression
                            fields:
                              text: "!opt.hasOptionalArg()"
                            children: []
                            pos: 11352
                            length: 21
                        children: []
                        pos: 11323
                        length: 50
                    children: []
                    pos: 11322
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new MissingArgumentException("Missing argument for option:"
                                                                       + opt.getKey());
                    children: []
                    pos: 11397
                    length: 129
                  pos: 11383
                  length: 153
                pos: 11319
                length: 217
              pos: 10683
              length: 859
          children: []
          pos: 10594
          length: 948
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processOption
              children: []
              pos: 11966
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String arg
                children: []
                pos: 11980
                length: 10
              pos: 11951
              length: 1337
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: boolean hasOption = getOptions().hasOption(arg);
                children: []
                pos: 12055
                length: 48
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasOption"
                        children: []
                        pos: 12187
                        length: 10
                    children: []
                    pos: 12186
                    length: 12
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: "throw new UnrecognizedOptionException(\"Unrecognized
                        option: \" \n                                                  +
                        arg);"
                    children: []
                    pos: 12221
                    length: 120
                  pos: 12207
                  length: 144
                pos: 12183
                length: 168
              - type: local_variable_declaration
                fields:
                  text: final Option opt = getOptions().getOption(arg);
                children: []
                pos: 12414
                length: 47
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: opt.isRequired()
                        children: []
                        pos: 12580
                        length: 16
                    children: []
                    pos: 12579
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: getRequiredOptions().remove(opt.getKey());
                    children: []
                    pos: 12620
                    length: 42
                  pos: 12606
                  length: 66
                pos: 12576
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: getOptions().getOptionGroup(opt)
                            children: []
                            pos: 12793
                            length: 32
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 12829
                            length: 4
                        children: []
                        pos: 12793
                        length: 40
                    children: []
                    pos: 12792
                    length: 42
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: OptionGroup group = getOptions().getOptionGroup(opt);
                    children: []
                    pos: 12857
                    length: 53
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: group.isRequired()
                            children: []
                            pos: 12928
                            length: 18
                        children: []
                        pos: 12927
                        length: 20
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: getRequiredOptions().remove(group);
                        children: []
                        pos: 12978
                        length: 35
                      pos: 12960
                      length: 67
                    pos: 12924
                    length: 103
                  - type: expression_statement
                    fields:
                      text: group.setSelected(opt);
                    children: []
                    pos: 13041
                    length: 23
                  pos: 12843
                  length: 231
                pos: 12789
                length: 285
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: opt.hasArg()
                        children: []
                        pos: 13137
                        length: 12
                    children: []
                    pos: 13136
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: processArgs(opt, iter);
                    children: []
                    pos: 13173
                    length: 23
                  pos: 13159
                  length: 47
                pos: 13133
                length: 73
              - type: expression_statement
                fields:
                  text: cmd.addOption(opt);
                children: []
                pos: 13263
                length: 19
              pos: 12045
              length: 1243
          children: []
          pos: 11951
          length: 1337
        pos: 1162
        length: 12128
    children: []
    pos: 1162
    length: 12128
  pos: 0
  length: 13291
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: Parser
        children: []
        pos: 1184
        length: 6
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: protected CommandLine cmd;
          children: []
          pos: 1259
          length: 26
        - type: field_declaration
          fields:
            text: private Options options;
          children: []
          pos: 1318
          length: 24
        - type: field_declaration
          fields:
            text: private List requiredOptions;
          children: []
          pos: 1392
          length: 29
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: setOptions
              children: []
              pos: 1442
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: final Options options
                children: []
                pos: 1453
                length: 21
              pos: 1427
              length: 149
            body:
              type: block
              fields: {}
              children:
              - type: expression_statement
                fields:
                  text: this.options = options;
                children: []
                pos: 1486
                length: 23
              - type: expression_statement
                fields:
                  text: this.requiredOptions = options.getRequiredOptions();
                children: []
                pos: 1518
                length: 52
              pos: 1476
              length: 100
          children: []
          pos: 1427
          length: 149
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getOptions
              children: []
              pos: 1600
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1582
              length: 62
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return options;
                children: []
                pos: 1623
                length: 15
              pos: 1613
              length: 31
          children: []
          pos: 1582
          length: 62
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getRequiredOptions
              children: []
              pos: 1665
              length: 18
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1650
              length: 75
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return requiredOptions;
                children: []
                pos: 1696
                length: 23
              pos: 1686
              length: 39
          children: []
          pos: 1650
          length: 75
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: flatten
              children: []
              pos: 2224
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options opts
                children: []
                pos: 2232
                length: 12
              pos: 2196
              length: 136
          children: []
          pos: 2196
          length: 136
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 2711
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 2717
                length: 15
              pos: 2692
              length: 172
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, null, false);
                children: []
                pos: 2812
                length: 46
              pos: 2802
              length: 62
          children: []
          pos: 2692
          length: 172
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 3333
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 3339
                length: 15
              pos: 3314
              length: 217
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, properties, false);
                children: []
                pos: 3473
                length: 52
              pos: 3463
              length: 68
          children: []
          pos: 3314
          length: 217
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 4109
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 4115
                length: 15
              pos: 4090
              length: 223
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return parse(options, arguments, null, stopAtNonOption);
                children: []
                pos: 4251
                length: 56
              pos: 4241
              length: 72
          children: []
          pos: 4090
          length: 223
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: parse
              children: []
              pos: 4895
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Options options
                children: []
                pos: 4901
                length: 15
              pos: 4876
              length: 2626
            body:
              type: block
              fields: {}
              children:
              - type: for_statement
                fields:
                  text: |-
                    for (Iterator it = options.helpOptions().iterator(); it.hasNext();) {
                                Option opt = (Option) it.next();
                                opt.clearValues();
                            }
                children: []
                pos: 5140
                length: 155
              - type: expression_statement
                fields:
                  text: setOptions(options);
                children: []
                pos: 5335
                length: 20
              - type: expression_statement
                fields:
                  text: cmd = new CommandLine();
                children: []
                pos: 5365
                length: 24
              - type: local_variable_declaration
                fields:
                  text: boolean eatTheRest = false;
                children: []
                pos: 5399
                length: 27
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: arguments
                            children: []
                            pos: 5440
                            length: 9
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5453
                            length: 4
                        children: []
                        pos: 5440
                        length: 17
                    children: []
                    pos: 5439
                    length: 19
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: arguments = new String[0];
                    children: []
                    pos: 5481
                    length: 26
                  pos: 5467
                  length: 50
                pos: 5436
                length: 81
              - type: local_variable_declaration
                fields:
                  text: "List tokenList = Arrays.asList(flatten(getOptions(), \n                                               arguments,
                    \n                                               stopAtNonOption));"
                children: []
                pos: 5527
                length: 178
              - type: local_variable_declaration
                fields:
                  text: ListIterator iterator = tokenList.listIterator();
                children: []
                pos: 5715
                length: 49
              - type: while_statement
                fields:
                  text: |-
                    while (iterator.hasNext())
                            {
                                String t = (String) iterator.next();

                                // the value is the double-dash
                                if ("--".equals(t))
                                {
                                    eatTheRest = true;
                                }

                                // the value is a single dash
                                else if ("-".equals(t))
                                {
                                    if (stopAtNonOption)
                                    {
                                        eatTheRest = true;
                                    }
                                    else
                                    {
                                        cmd.addArg(t);
                                    }
                                }

                                // the value is an option
                                else if (t.startsWith("-"))
                                {
                                    if (stopAtNonOption && !getOptions().hasOption(t))
                                    {
                                        eatTheRest = true;
                                        cmd.addArg(t);
                                    }
                                    else
                                    {
                                        processOption(t, iterator);
                                    }
                                }

                                // the value is an argument
                                else
                                {
                                    cmd.addArg(t);

                                    if (stopAtNonOption)
                                    {
                                        eatTheRest = true;
                                    }
                                }

                                // eat the remaining tokens
                                if (eatTheRest)
                                {
                                    while (iterator.hasNext())
                                    {
                                        String str = (String) iterator.next();

                                        // ensure only one double-dash is added
                                        if (!"--".equals(str))
                                        {
                                            cmd.addArg(str);
                                        }
                                    }
                                }
                            }
                children: []
                pos: 5814
                length: 1589
              - type: expression_statement
                fields:
                  text: processProperties(properties);
                children: []
                pos: 7413
                length: 30
              - type: expression_statement
                fields:
                  text: checkRequiredOptions();
                children: []
                pos: 7452
                length: 23
              - type: return_statement
                fields:
                  text: return cmd;
                children: []
                pos: 7485
                length: 11
              pos: 5050
              length: 2452
          children: []
          pos: 4876
          length: 2626
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processProperties
              children: []
              pos: 7703
              length: 17
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Properties properties
                children: []
                pos: 7721
                length: 21
              pos: 7688
              length: 1505
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: properties
                            children: []
                            pos: 7762
                            length: 10
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 7776
                            length: 4
                        children: []
                        pos: 7762
                        length: 18
                    children: []
                    pos: 7761
                    length: 20
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return;
                    children: []
                    pos: 7804
                    length: 7
                  pos: 7790
                  length: 31
                pos: 7758
                length: 63
              - type: for_statement
                fields:
                  text: "for (Enumeration e = properties.propertyNames(); e.hasMoreElements();)\n
                    \       {\n            String option = e.nextElement().toString();\n\n
                    \           if (!cmd.hasOption(option))\n            {\n                Option
                    opt = getOptions().getOption(option);\n\n                // get
                    the value from the properties instance\n                String
                    value = properties.getProperty(option);\n\n                if
                    (opt.hasArg())\n                {\n                    if ((opt.getValues()
                    == null)\n                        || (opt.getValues().length ==
                    0))\n                    {\n                        try\n                        {\n
                    \                           opt.addValueForProcessing(value);\n
                    \                       }\n                        catch (RuntimeException
                    exp)\n                        {\n                            //
                    if we cannot add the value don't worry about it\n                        }\n
                    \                   }\n                }\n                else
                    if (!(\"yes\".equalsIgnoreCase(value) \n                           ||
                    \"true\".equalsIgnoreCase(value)\n                           ||
                    \"1\".equalsIgnoreCase(value)))\n                {\n                    //
                    if the value is not yes, true or 1 then don't add the\n                    //
                    option to the CommandLine\n                    break;\n                }\n\n
                    \               cmd.addOption(opt);\n            }\n        }"
                children: []
                pos: 7831
                length: 1356
              pos: 7748
              length: 1445
          children: []
          pos: 7688
          length: 1505
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: checkRequiredOptions
              children: []
              pos: 9438
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 9423
              length: 693
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: greater_than
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: getRequiredOptions().size()
                            children: []
                            pos: 9599
                            length: 27
                          right:
                            type: decimal_integer_literal
                            fields:
                              text: '0'
                            children: []
                            pos: 9629
                            length: 1
                        children: []
                        pos: 9599
                        length: 31
                    children: []
                    pos: 9598
                    length: 33
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Iterator iter = getRequiredOptions().iterator();
                    children: []
                    pos: 9654
                    length: 48
                  - type: local_variable_declaration
                    fields:
                      text: StringBuffer buff = new StringBuffer("Missing required
                        option");
                    children: []
                    pos: 9715
                    length: 64
                  - type: expression_statement
                    fields:
                      text: 'buff.append(getRequiredOptions().size() == 1 ? "" : "s");'
                    children: []
                    pos: 9792
                    length: 57
                  - type: expression_statement
                    fields:
                      text: 'buff.append(": ");'
                    children: []
                    pos: 9862
                    length: 18
                  - type: while_statement
                    fields:
                      text: |-
                        while (iter.hasNext())
                                    {
                                        buff.append(iter.next());
                                    }
                    children: []
                    pos: 9944
                    length: 92
                  - type: throw_statement
                    fields:
                      text: throw new MissingOptionException(buff.toString());
                    children: []
                    pos: 10050
                    length: 50
                  pos: 9640
                  length: 470
                pos: 9595
                length: 515
              pos: 9503
              length: 613
          children: []
          pos: 9423
          length: 693
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processArgs
              children: []
              pos: 10550
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Option opt
                children: []
                pos: 10562
                length: 10
              pos: 10538
              length: 948
            body:
              type: block
              fields: {}
              children:
              - type: while_statement
                fields:
                  text: |-
                    while (iter.hasNext())
                            {
                                String str = (String) iter.next();

                                // found an Option, not an argument
                                if (getOptions().hasOption(str) && str.startsWith("-"))
                                {
                                    iter.previous();
                                    break;
                                }

                                // found a value
                                try
                                {
                                    opt.addValueForProcessing( Util.stripLeadingAndTrailingQuotes(str) );
                                }
                                catch (RuntimeException exp)
                                {
                                    iter.previous();
                                    break;
                                }
                            }
                children: []
                pos: 10678
                length: 575
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: method_invocation
                                    fields:
                                      text: opt.getValues()
                                    children: []
                                    pos: 11268
                                    length: 15
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 11287
                                    length: 4
                                children: []
                                pos: 11268
                                length: 23
                            children: []
                            pos: 11267
                            length: 25
                          right:
                            type: unary_expression
                            fields:
                              text: "!opt.hasOptionalArg()"
                            children: []
                            pos: 11296
                            length: 21
                        children: []
                        pos: 11267
                        length: 50
                    children: []
                    pos: 11266
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: |-
                        throw new MissingArgumentException("Missing argument for option:"
                                                                       + opt.getKey());
                    children: []
                    pos: 11341
                    length: 129
                  pos: 11327
                  length: 153
                pos: 11263
                length: 217
              pos: 10627
              length: 859
          children: []
          pos: 10538
          length: 948
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: processOption
              children: []
              pos: 11910
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: String arg
                children: []
                pos: 11924
                length: 10
              pos: 11895
              length: 1337
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: boolean hasOption = getOptions().hasOption(arg);
                children: []
                pos: 11999
                length: 48
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: unary_expression
                        fields:
                          text: "!hasOption"
                        children: []
                        pos: 12131
                        length: 10
                    children: []
                    pos: 12130
                    length: 12
                children:
                - type: block
                  fields: {}
                  children:
                  - type: throw_statement
                    fields:
                      text: "throw new UnrecognizedOptionException(\"Unrecognized
                        option: \" \n                                                  +
                        arg);"
                    children: []
                    pos: 12165
                    length: 120
                  pos: 12151
                  length: 144
                pos: 12127
                length: 168
              - type: local_variable_declaration
                fields:
                  text: final Option opt = getOptions().getOption(arg);
                children: []
                pos: 12358
                length: 47
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: opt.isRequired()
                        children: []
                        pos: 12524
                        length: 16
                    children: []
                    pos: 12523
                    length: 18
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: getRequiredOptions().remove(opt.getKey());
                    children: []
                    pos: 12564
                    length: 42
                  pos: 12550
                  length: 66
                pos: 12520
                length: 96
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: getOptions().getOptionGroup(opt)
                            children: []
                            pos: 12737
                            length: 32
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 12773
                            length: 4
                        children: []
                        pos: 12737
                        length: 40
                    children: []
                    pos: 12736
                    length: 42
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: OptionGroup group = getOptions().getOptionGroup(opt);
                    children: []
                    pos: 12801
                    length: 53
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: method_invocation
                            fields:
                              text: group.isRequired()
                            children: []
                            pos: 12872
                            length: 18
                        children: []
                        pos: 12871
                        length: 20
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: getRequiredOptions().remove(group);
                        children: []
                        pos: 12922
                        length: 35
                      pos: 12904
                      length: 67
                    pos: 12868
                    length: 103
                  - type: expression_statement
                    fields:
                      text: group.setSelected(opt);
                    children: []
                    pos: 12985
                    length: 23
                  pos: 12787
                  length: 231
                pos: 12733
                length: 285
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: opt.hasArg()
                        children: []
                        pos: 13081
                        length: 12
                    children: []
                    pos: 13080
                    length: 14
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: processArgs(opt, iter);
                    children: []
                    pos: 13117
                    length: 23
                  pos: 13103
                  length: 47
                pos: 13077
                length: 73
              - type: expression_statement
                fields:
                  text: cmd.addOption(opt);
                children: []
                pos: 13207
                length: 19
              pos: 11989
              length: 1243
          children: []
          pos: 11895
          length: 1337
        pos: 1162
        length: 12072
    children: []
    pos: 1162
    length: 12072
  pos: 0
  length: 13235
text_diff: "--- before\n+++ after\n@@ -317,10 +317,9 @@\n             while (iter.hasNext())\n
  \            {\n                 buff.append(iter.next());\n-                buff.append(\",
  \");\n             }\n \n-            throw new MissingOptionException(buff.substring(0,
  buff.length() - 2));\n+            throw new MissingOptionException(buff.toString());\n
  \        }\n     }\n \n"
tree_diff: |+
  New cluster:
  UPDATE from while (iter.hasNext())
              {
                  buff.append(iter.next());
                  buff.append(", ");
              } to while (iter.hasNext())
              {
                  buff.append(iter.next());
              }
  ------------
  ===
  update-node
  ---
  while_statement: while (iter.hasNext())
              {
                  buff.append(iter.next());
                  buff.append(", ");
              } [9944,10071]
  replace while (iter.hasNext())
              {
                  buff.append(iter.next());
                  buff.append(", ");
              } by while (iter.hasNext())
              {
                  buff.append(iter.next());
              }

  New cluster:
  UPDATE from throw new MissingOptionException(buff.substring(0, buff.length() - 2)); to throw new MissingOptionException(buff.toString());
  ------------
  ===
  update-node
  ---
  throw_statement: throw new MissingOptionException(buff.substring(0, buff.length() - 2)); [10085,10156]
  replace throw new MissingOptionException(buff.substring(0, buff.length() - 2)); by throw new MissingOptionException(buff.toString());

...
