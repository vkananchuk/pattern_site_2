---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: InvocationMatcher
        children: []
        pos: 649
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = -3047126096857467610L;
          children: []
          pos: 751
          length: 67
        - type: field_declaration
          fields:
            text: private final Invocation invocation;
          children: []
          pos: 823
          length: 36
        - type: field_declaration
          fields:
            text: private final List<Matcher> matchers;
          children: []
          pos: 864
          length: 37
        - type: constructor_declaration
          fields:
            text: |-
              public InvocationMatcher(Invocation invocation, List<Matcher> matchers) {
                      this.invocation = invocation;
                      if (matchers.isEmpty()) {
                          this.matchers = ArgumentsProcessor.argumentsToMatchers(invocation.getArguments());
                      } else {
                          this.matchers = matchers;
                      }
                  }
          children: []
          pos: 907
          length: 311
        - type: constructor_declaration
          fields:
            text: |-
              public InvocationMatcher(Invocation invocation) {
                      this(invocation, Collections.<Matcher>emptyList());
                  }
          children: []
          pos: 1228
          length: 115
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMethod
              children: []
              pos: 1363
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1349
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return invocation.getMethod();
                children: []
                pos: 1385
                length: 30
              pos: 1375
              length: 46
          children: []
          pos: 1349
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getInvocation
              children: []
              pos: 1449
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1431
              length: 73
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return this.invocation;
                children: []
                pos: 1475
                length: 23
              pos: 1465
              length: 39
          children: []
          pos: 1431
          length: 73
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchers
              children: []
              pos: 1535
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1514
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return this.matchers;
                children: []
                pos: 1559
                length: 21
              pos: 1549
              length: 37
          children: []
          pos: 1514
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 1610
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1596
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new PrintSettings().print(matchers, invocation);
                children: []
                pos: 1631
                length: 55
              pos: 1621
              length: 71
          children: []
          pos: 1596
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matches
              children: []
              pos: 1713
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation actual
                children: []
                pos: 1721
                length: 17
              pos: 1698
              length: 226
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return invocation.getMock().equals(actual.getMock())
                                    && hasSameMethod(actual)
                                    && new ArgumentsComparator().argumentsMatch(this, actual);
                children: []
                pos: 1750
                length: 168
              pos: 1740
              length: 184
          children: []
          pos: 1698
          length: 226
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: safelyArgumentsMatch
              children: []
              pos: 1946
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object[] actualArgs
                children: []
                pos: 1967
                length: 19
              pos: 1930
              length: 226
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return new ArgumentsComparator().argumentsMatch(this,
                          actualArgs);
                      children: []
                      pos: 2016
                      length: 66
                    pos: 2002
                    length: 90
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Throwable t) {
                                      return false;
                                  }
                      children: []
                      pos: 2093
                      length: 57
                    pos: 1998
                    length: 152
                children: []
                pos: 1998
                length: 152
              pos: 1988
              length: 168
          children: []
          pos: 1930
          length: 226
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasSimilarMethod
              children: []
              pos: 2318
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation candidate
                children: []
                pos: 2335
                length: 20
              pos: 2303
              length: 750
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: String wantedMethodName = getMethod().getName();
                children: []
                pos: 2367
                length: 48
              - type: local_variable_declaration
                fields:
                  text: String currentMethodName = candidate.getMethod().getName();
                children: []
                pos: 2424
                length: 59
              - type: local_variable_declaration
                fields:
                  text: final boolean methodNameEquals = wantedMethodName.equals(currentMethodName);
                children: []
                pos: 2501
                length: 76
              - type: local_variable_declaration
                fields:
                  text: final boolean isUnverified = !candidate.isVerified();
                children: []
                pos: 2586
                length: 53
              - type: local_variable_declaration
                fields:
                  text: final boolean mockIsTheSame = getInvocation().getMock() ==
                    candidate.getMock();
                children: []
                pos: 2648
                length: 79
              - type: local_variable_declaration
                fields:
                  text: final boolean methodEquals = hasSameMethod(candidate);
                children: []
                pos: 2736
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: unary_expression
                                fields:
                                  text: "!methodNameEquals"
                                children: []
                                pos: 2804
                                length: 17
                              right:
                                type: unary_expression
                                fields:
                                  text: "!isUnverified"
                                children: []
                                pos: 2825
                                length: 13
                            children: []
                            pos: 2804
                            length: 34
                          right:
                            type: unary_expression
                            fields:
                              text: "!mockIsTheSame"
                            children: []
                            pos: 2842
                            length: 14
                        children: []
                        pos: 2804
                        length: 52
                    children: []
                    pos: 2803
                    length: 54
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 2872
                    length: 13
                  pos: 2858
                  length: 37
                pos: 2800
                length: 95
              - type: local_variable_declaration
                fields:
                  text: final boolean overloadedButSameArgs = !methodEquals && safelyArgumentsMatch(candidate.getArguments());
                children: []
                pos: 2905
                length: 102
              - type: return_statement
                fields:
                  text: return !overloadedButSameArgs;
                children: []
                pos: 3017
                length: 30
              pos: 2357
              length: 696
          children: []
          pos: 2303
          length: 750
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasSameMethod
              children: []
              pos: 3074
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation candidate
                children: []
                pos: 3088
                length: 20
              pos: 3059
              length: 800
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Method m1 = invocation.getMethod();
                children: []
                pos: 3293
                length: 35
              - type: local_variable_declaration
                fields:
                  text: Method m2 = candidate.getMethod();
                children: []
                pos: 3337
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: m1.getName()
                                children: []
                                pos: 3393
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3409
                                length: 4
                            children: []
                            pos: 3393
                            length: 20
                          right:
                            type: method_invocation
                            fields:
                              text: m1.getName().equals(m2.getName())
                            children: []
                            pos: 3417
                            length: 33
                        children: []
                        pos: 3393
                        length: 57
                    children: []
                    pos: 3392
                    length: 59
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Class[] params1 = m1.getParameterTypes();
                    children: []
                    pos: 3504
                    length: 41
                  - type: local_variable_declaration
                    fields:
                      text: Class[] params2 = m2.getParameterTypes();
                    children: []
                    pos: 3555
                    length: 41
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: params1.length
                                children: []
                                pos: 3610
                                length: 14
                              right:
                                type: field_access
                                fields:
                                  text: params2.length
                                children: []
                                pos: 3628
                                length: 14
                            children: []
                            pos: 3610
                            length: 32
                        children: []
                        pos: 3609
                        length: 34
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: for_statement
                        fields:
                          text: "for (int i = 0; i < params1.length; i++) {\n        \t\tif
                            (params1[i] != params2[i])\n        \t\t    return false;\n
                            \       \t    }"
                        children: []
                        pos: 3659
                        length: 125
                      - type: return_statement
                        fields:
                          text: return true;
                        children: []
                        pos: 3798
                        length: 12
                      pos: 3644
                      length: 177
                    pos: 3606
                    length: 215
                  pos: 3452
                  length: 379
                pos: 3389
                length: 442
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 3840
                length: 13
              pos: 3110
              length: 749
          children: []
          pos: 3059
          length: 800
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getLocation
              children: []
              pos: 3885
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3869
              length: 78
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return invocation.getLocation();
                children: []
                pos: 3909
                length: 32
              pos: 3899
              length: 48
          children: []
          pos: 3869
          length: 78
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: captureArgumentsFrom
              children: []
              pos: 3965
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation invocation
                children: []
                pos: 3986
                length: 21
              pos: 3953
              length: 1278
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: invocation.getMethod().isVarArgs()
                        children: []
                        pos: 4023
                        length: 34
                    children: []
                    pos: 4022
                    length: 36
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: int indexOfVararg = invocation.getRawArguments().length
                        - 1;
                    children: []
                    pos: 4073
                    length: 60
                  - type: for_statement
                    fields:
                      text: |-
                        for (int position = 0; position < indexOfVararg; position++) {
                                        Matcher m = matchers.get(position);
                                        if (m instanceof CapturesArguments) {
                                            ((CapturesArguments) m).captureFrom(invocation.getArgumentAt(position, Object.class));
                                        }
                                    }
                    children: []
                    pos: 4146
                    length: 307
                  - type: enhanced_for_statement
                    fields:
                      text: |-
                        for (Matcher m : uniqueMatcherSet(indexOfVararg)) {
                                        if (m instanceof CapturesArguments) {
                                            Object rawArgument = invocation.getRawArguments()[indexOfVararg];
                                            for (int i = 0; i < Array.getLength(rawArgument); i++) {
                                                ((CapturesArguments) m).captureFrom(Array.get(rawArgument, i));
                                            }
                                        }
                                    }
                    children: []
                    pos: 4466
                    length: 410
                  pos: 4059
                  length: 827
                pos: 4019
                length: 1206
              pos: 4009
              length: 1222
          children: []
          pos: 3953
          length: 1278
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: uniqueMatcherSet
              children: []
              pos: 5258
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: int indexOfVararg
                children: []
                pos: 5275
                length: 17
              pos: 5237
              length: 485
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: HashSet<Matcher> set = new HashSet<Matcher>();
                children: []
                pos: 5304
                length: 46
              - type: for_statement
                fields:
                  text: |-
                    for (int position = indexOfVararg; position < matchers.size(); position++) {
                                Matcher matcher = matchers.get(position);
                                if(matcher instanceof MatcherDecorator) {
                                    set.add(((MatcherDecorator) matcher).getActualMatcher());
                                } else {
                                    set.add(matcher);
                                }
                            }
                children: []
                pos: 5359
                length: 337
              - type: return_statement
                fields:
                  text: return set;
                children: []
                pos: 5705
                length: 11
              pos: 5294
              length: 428
          children: []
          pos: 5237
          length: 485
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createFrom
              children: []
              pos: 5766
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: List<Invocation> invocations
                children: []
                pos: 5777
                length: 28
              pos: 5728
              length: 287
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: LinkedList<InvocationMatcher> out = new LinkedList<InvocationMatcher>();
                children: []
                pos: 5817
                length: 72
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Invocation i : invocations) {
                                out.add(new InvocationMatcher(i));
                            }
                children: []
                pos: 5898
                length: 91
              - type: return_statement
                fields:
                  text: return out;
                children: []
                pos: 5998
                length: 11
              pos: 5807
              length: 208
          children: []
          pos: 5728
          length: 287
        pos: 605
        length: 5412
    children: []
    pos: 605
    length: 5412
  pos: 0
  length: 6018
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: InvocationMatcher
        children: []
        pos: 649
        length: 17
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: private static final long serialVersionUID = -3047126096857467610L;
          children: []
          pos: 751
          length: 67
        - type: field_declaration
          fields:
            text: private final Invocation invocation;
          children: []
          pos: 823
          length: 36
        - type: field_declaration
          fields:
            text: private final List<Matcher> matchers;
          children: []
          pos: 864
          length: 37
        - type: constructor_declaration
          fields:
            text: |-
              public InvocationMatcher(Invocation invocation, List<Matcher> matchers) {
                      this.invocation = invocation;
                      if (matchers.isEmpty()) {
                          this.matchers = ArgumentsProcessor.argumentsToMatchers(invocation.getArguments());
                      } else {
                          this.matchers = matchers;
                      }
                  }
          children: []
          pos: 907
          length: 311
        - type: constructor_declaration
          fields:
            text: |-
              public InvocationMatcher(Invocation invocation) {
                      this(invocation, Collections.<Matcher>emptyList());
                  }
          children: []
          pos: 1228
          length: 115
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMethod
              children: []
              pos: 1363
              length: 9
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1349
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return invocation.getMethod();
                children: []
                pos: 1385
                length: 30
              pos: 1375
              length: 46
          children: []
          pos: 1349
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getInvocation
              children: []
              pos: 1449
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1431
              length: 73
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return this.invocation;
                children: []
                pos: 1475
                length: 23
              pos: 1465
              length: 39
          children: []
          pos: 1431
          length: 73
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getMatchers
              children: []
              pos: 1535
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1514
              length: 72
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return this.matchers;
                children: []
                pos: 1559
                length: 21
              pos: 1549
              length: 37
          children: []
          pos: 1514
          length: 72
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: toString
              children: []
              pos: 1610
              length: 8
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 1596
              length: 96
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return new PrintSettings().print(matchers, invocation);
                children: []
                pos: 1631
                length: 55
              pos: 1621
              length: 71
          children: []
          pos: 1596
          length: 96
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: matches
              children: []
              pos: 1713
              length: 7
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation actual
                children: []
                pos: 1721
                length: 17
              pos: 1698
              length: 226
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: |-
                    return invocation.getMock().equals(actual.getMock())
                                    && hasSameMethod(actual)
                                    && new ArgumentsComparator().argumentsMatch(this, actual);
                children: []
                pos: 1750
                length: 168
              pos: 1740
              length: 184
          children: []
          pos: 1698
          length: 226
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: safelyArgumentsMatch
              children: []
              pos: 1946
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Object[] actualArgs
                children: []
                pos: 1967
                length: 19
              pos: 1930
              length: 226
            body:
              type: block
              fields: {}
              children:
              - type: try_statement
                fields:
                  body:
                    type: block
                    fields: {}
                    children:
                    - type: return_statement
                      fields:
                        text: return new ArgumentsComparator().argumentsMatch(this,
                          actualArgs);
                      children: []
                      pos: 2016
                      length: 66
                    pos: 2002
                    length: 90
                  excepts:
                    type: excepts
                    fields: {}
                    children:
                    - type: catch_clause
                      fields:
                        text: |-
                          catch (Throwable t) {
                                      return false;
                                  }
                      children: []
                      pos: 2093
                      length: 57
                    pos: 1998
                    length: 152
                children: []
                pos: 1998
                length: 152
              pos: 1988
              length: 168
          children: []
          pos: 1930
          length: 226
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasSimilarMethod
              children: []
              pos: 2318
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation candidate
                children: []
                pos: 2335
                length: 20
              pos: 2303
              length: 750
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: String wantedMethodName = getMethod().getName();
                children: []
                pos: 2367
                length: 48
              - type: local_variable_declaration
                fields:
                  text: String currentMethodName = candidate.getMethod().getName();
                children: []
                pos: 2424
                length: 59
              - type: local_variable_declaration
                fields:
                  text: final boolean methodNameEquals = wantedMethodName.equals(currentMethodName);
                children: []
                pos: 2501
                length: 76
              - type: local_variable_declaration
                fields:
                  text: final boolean isUnverified = !candidate.isVerified();
                children: []
                pos: 2586
                length: 53
              - type: local_variable_declaration
                fields:
                  text: final boolean mockIsTheSame = getInvocation().getMock() ==
                    candidate.getMock();
                children: []
                pos: 2648
                length: 79
              - type: local_variable_declaration
                fields:
                  text: final boolean methodEquals = hasSameMethod(candidate);
                children: []
                pos: 2736
                length: 54
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: or
                        fields:
                          left:
                            type: or
                            fields:
                              left:
                                type: unary_expression
                                fields:
                                  text: "!methodNameEquals"
                                children: []
                                pos: 2804
                                length: 17
                              right:
                                type: unary_expression
                                fields:
                                  text: "!isUnverified"
                                children: []
                                pos: 2825
                                length: 13
                            children: []
                            pos: 2804
                            length: 34
                          right:
                            type: unary_expression
                            fields:
                              text: "!mockIsTheSame"
                            children: []
                            pos: 2842
                            length: 14
                        children: []
                        pos: 2804
                        length: 52
                    children: []
                    pos: 2803
                    length: 54
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return false;
                    children: []
                    pos: 2872
                    length: 13
                  pos: 2858
                  length: 37
                pos: 2800
                length: 95
              - type: local_variable_declaration
                fields:
                  text: final boolean overloadedButSameArgs = !methodEquals && safelyArgumentsMatch(candidate.getArguments());
                children: []
                pos: 2905
                length: 102
              - type: return_statement
                fields:
                  text: return !overloadedButSameArgs;
                children: []
                pos: 3017
                length: 30
              pos: 2357
              length: 696
          children: []
          pos: 2303
          length: 750
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: hasSameMethod
              children: []
              pos: 3074
              length: 13
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation candidate
                children: []
                pos: 3088
                length: 20
              pos: 3059
              length: 800
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: Method m1 = invocation.getMethod();
                children: []
                pos: 3293
                length: 35
              - type: local_variable_declaration
                fields:
                  text: Method m2 = candidate.getMethod();
                children: []
                pos: 3337
                length: 34
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: m1.getName()
                                children: []
                                pos: 3393
                                length: 12
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3409
                                length: 4
                            children: []
                            pos: 3393
                            length: 20
                          right:
                            type: method_invocation
                            fields:
                              text: m1.getName().equals(m2.getName())
                            children: []
                            pos: 3417
                            length: 33
                        children: []
                        pos: 3393
                        length: 57
                    children: []
                    pos: 3392
                    length: 59
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Class[] params1 = m1.getParameterTypes();
                    children: []
                    pos: 3504
                    length: 41
                  - type: local_variable_declaration
                    fields:
                      text: Class[] params2 = m2.getParameterTypes();
                    children: []
                    pos: 3555
                    length: 41
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: field_access
                                fields:
                                  text: params1.length
                                children: []
                                pos: 3610
                                length: 14
                              right:
                                type: field_access
                                fields:
                                  text: params2.length
                                children: []
                                pos: 3628
                                length: 14
                            children: []
                            pos: 3610
                            length: 32
                        children: []
                        pos: 3609
                        length: 34
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: for_statement
                        fields:
                          text: "for (int i = 0; i < params1.length; i++) {\n        \t\tif
                            (params1[i] != params2[i])\n        \t\t    return false;\n
                            \       \t    }"
                        children: []
                        pos: 3659
                        length: 125
                      - type: return_statement
                        fields:
                          text: return true;
                        children: []
                        pos: 3798
                        length: 12
                      pos: 3644
                      length: 177
                    pos: 3606
                    length: 215
                  pos: 3452
                  length: 379
                pos: 3389
                length: 442
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 3840
                length: 13
              pos: 3110
              length: 749
          children: []
          pos: 3059
          length: 800
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getLocation
              children: []
              pos: 3885
              length: 11
            parameters:
              type: method_parameters
              fields: {}
              children: []
              pos: 3869
              length: 78
            body:
              type: block
              fields: {}
              children:
              - type: return_statement
                fields:
                  text: return invocation.getLocation();
                children: []
                pos: 3909
                length: 32
              pos: 3899
              length: 48
          children: []
          pos: 3869
          length: 78
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: captureArgumentsFrom
              children: []
              pos: 3965
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Invocation invocation
                children: []
                pos: 3986
                length: 21
              pos: 3953
              length: 1195
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: method_invocation
                        fields:
                          text: invocation.getMethod().isVarArgs()
                        children: []
                        pos: 4023
                        length: 34
                    children: []
                    pos: 4022
                    length: 36
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: int indexOfVararg = invocation.getRawArguments().length
                        - 1;
                    children: []
                    pos: 4073
                    length: 60
                  - type: for_statement
                    fields:
                      text: |-
                        for (int position = 0; position < indexOfVararg; position++) {
                                        Matcher m = matchers.get(position);
                                        if (m instanceof CapturesArguments) {
                                            ((CapturesArguments) m).captureFrom(invocation.getArgumentAt(position, Object.class));
                                        }
                                    }
                    children: []
                    pos: 4146
                    length: 307
                  - type: for_statement
                    fields:
                      text: |-
                        for (int position = indexOfVararg; position < matchers.size(); position++) {
                                        Matcher m = matchers.get(position);
                                        if (m instanceof CapturesArguments) {
                                            ((CapturesArguments) m).captureFrom(invocation.getRawArguments()[position - indexOfVararg]);
                                        }
                                    }
                    children: []
                    pos: 4466
                    length: 327
                  pos: 4059
                  length: 744
                pos: 4019
                length: 1123
              pos: 4009
              length: 1139
          children: []
          pos: 3953
          length: 1195
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: createFrom
              children: []
              pos: 5193
              length: 10
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: List<Invocation> invocations
                children: []
                pos: 5204
                length: 28
              pos: 5155
              length: 287
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: LinkedList<InvocationMatcher> out = new LinkedList<InvocationMatcher>();
                children: []
                pos: 5244
                length: 72
              - type: enhanced_for_statement
                fields:
                  text: |-
                    for (Invocation i : invocations) {
                                out.add(new InvocationMatcher(i));
                            }
                children: []
                pos: 5325
                length: 91
              - type: return_statement
                fields:
                  text: return out;
                children: []
                pos: 5425
                length: 11
              pos: 5234
              length: 208
          children: []
          pos: 5155
          length: 287
        pos: 605
        length: 4839
    children: []
    pos: 605
    length: 4839
  pos: 0
  length: 5445
text_diff: "--- before\n+++ after\n@@ -124,12 +124,10 @@\n                     ((CapturesArguments)
  m).captureFrom(invocation.getArgumentAt(position, Object.class));\n                 }\n
  \            }\n-            for (Matcher m : uniqueMatcherSet(indexOfVararg)) {\n+
  \           for (int position = indexOfVararg; position < matchers.size(); position++)
  {\n+                Matcher m = matchers.get(position);\n                 if (m
  instanceof CapturesArguments) {\n-                    Object rawArgument = invocation.getRawArguments()[indexOfVararg];\n-
  \                   for (int i = 0; i < Array.getLength(rawArgument); i++) {\n-
  \                       ((CapturesArguments) m).captureFrom(Array.get(rawArgument,
  i));\n-                    }\n+                    ((CapturesArguments) m).captureFrom(invocation.getRawArguments()[position
  - indexOfVararg]);\n                 }\n             }\n         } else {\n@@ -142,18
  +140,6 @@\n         }\n     }\n \n-    private Set<Matcher> uniqueMatcherSet(int
  indexOfVararg) {\n-        HashSet<Matcher> set = new HashSet<Matcher>();\n-        for
  (int position = indexOfVararg; position < matchers.size(); position++) {\n-            Matcher
  matcher = matchers.get(position);\n-            if(matcher instanceof MatcherDecorator)
  {\n-                set.add(((MatcherDecorator) matcher).getActualMatcher());\n-
  \           } else {\n-                set.add(matcher);\n-            }\n-        }\n-
  \       return set;\n-    }\n \n     public static List<InvocationMatcher> createFrom(List<Invocation>
  invocations) {\n         LinkedList<InvocationMatcher> out = new LinkedList<InvocationMatcher>();\n"
tree_diff: |+
  New cluster:
  ===
  insert-node
  ---
  for_statement: for (int position = indexOfVararg; position < matchers.size(); position++) {
                  Matcher m = matchers.get(position);
                  if (m instanceof CapturesArguments) {
                      ((CapturesArguments) m).captureFrom(invocation.getRawArguments()[position - indexOfVararg]);
                  }
              } [4466,4793]
  to
  block [4059,4886]
  at 2
  ------------
  ===
  insert-node
  ---
  for_statement: for (int position = indexOfVararg; position < matchers.size(); position++) {
                  Matcher m = matchers.get(position);
                  if (m instanceof CapturesArguments) {
                      ((CapturesArguments) m).captureFrom(invocation.getRawArguments()[position - indexOfVararg]);
                  }
              } [4466,4793]
  to
  block [4059,4886]
  at 2

  New cluster:
  ===
  delete-node
  ---
  enhanced_for_statement: for (Matcher m : uniqueMatcherSet(indexOfVararg)) {
                  if (m instanceof CapturesArguments) {
                      Object rawArgument = invocation.getRawArguments()[indexOfVararg];
                      for (int i = 0; i < Array.getLength(rawArgument); i++) {
                          ((CapturesArguments) m).captureFrom(Array.get(rawArgument, i));
                      }
                  }
              } [4466,4876]
  ===
  ------------
  ===
  delete-node
  ---
  enhanced_for_statement: for (Matcher m : uniqueMatcherSet(indexOfVararg)) {
                  if (m instanceof CapturesArguments) {
                      Object rawArgument = invocation.getRawArguments()[indexOfVararg];
                      for (int i = 0; i < Array.getLength(rawArgument); i++) {
                          ((CapturesArguments) m).captureFrom(Array.get(rawArgument, i));
                      }
                  }
              } [4466,4876]
  ===

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  method_declaration [5237,5722]
      identifier: uniqueMatcherSet [5258,5274]
      method_parameters [5237,5722]
          formal_parameter: int indexOfVararg [5275,5292]
      block [5294,5722]
          local_variable_declaration: HashSet<Matcher> set = new HashSet<Matcher>(); [5304,5350]
          for_statement: for (int position = indexOfVararg; position < matchers.size(); position++) {
              Matcher matcher = matchers.get(position);
              if(matcher instanceof MatcherDecorator) {
                  set.add(((MatcherDecorator) matcher).getActualMatcher());
              } else {
                  set.add(matcher);
              }
          } [5359,5696]
          return_statement: return set; [5705,5716]

...
