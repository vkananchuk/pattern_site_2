---
language: java
before_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: CheckGlobalThis
        children: []
        pos: 1838
        length: 15
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType GLOBAL_THIS = DiagnosticType.warning(
                    "JSC_USED_GLOBAL_THIS",
                    "dangerous use of the global 'this' object");
          children: []
          pos: 1879
          length: 147
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 2030
          length: 40
        - type: field_declaration
          fields:
            text: private final CheckLevel level;
          children: []
          pos: 2073
          length: 31
        - type: field_declaration
          fields:
            text: private Node assignLhsChild = null;
          children: []
          pos: 2301
          length: 35
        - type: constructor_declaration
          fields:
            text: |-
              CheckGlobalThis(AbstractCompiler compiler, CheckLevel level) {
                  this.compiler = compiler;
                  this.level = level;
                }
          children: []
          pos: 2340
          length: 120
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldTraverse
              children: []
              pos: 2640
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 2655
                length: 15
              pos: 2625
              length: 1744
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.getType()
                            children: []
                            pos: 2704
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Token.FUNCTION
                            children: []
                            pos: 2719
                            length: 14
                        children: []
                        pos: 2704
                        length: 29
                    children: []
                    pos: 2703
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JSDocInfo jsDoc = getFunctionJsDocInfo(n);
                    children: []
                    pos: 2838
                    length: 42
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: jsDoc
                                    children: []
                                    pos: 2891
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 2900
                                    length: 4
                                children: []
                                pos: 2891
                                length: 13
                              right:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: jsDoc.isConstructor()
                                        children: []
                                        pos: 2909
                                        length: 21
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: jsDoc.hasThisType()
                                        children: []
                                        pos: 2934
                                        length: 19
                                    children: []
                                    pos: 2909
                                    length: 44
                                children: []
                                pos: 2908
                                length: 46
                            children: []
                            pos: 2891
                            length: 63
                        children: []
                        pos: 2890
                        length: 65
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return false;
                        children: []
                        pos: 2966
                        length: 13
                      pos: 2956
                      length: 31
                    pos: 2887
                    length: 100
                  - type: local_variable_declaration
                    fields:
                      text: int pType = parent.getType();
                    children: []
                    pos: 3228
                    length: 29
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: unary_expression
                            fields:
                              text: |-
                                !(pType == Token.BLOCK ||
                                            pType == Token.SCRIPT ||
                                            pType == Token.NAME ||
                                            pType == Token.ASSIGN)
                            children: []
                            pos: 3268
                            length: 132
                        children: []
                        pos: 3267
                        length: 134
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return false;
                        children: []
                        pos: 3412
                        length: 13
                      pos: 3402
                      length: 31
                    pos: 3264
                    length: 169
                  pos: 2735
                  length: 704
                pos: 2700
                length: 739
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: parent
                                children: []
                                pos: 3449
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3459
                                length: 4
                            children: []
                            pos: 3449
                            length: 14
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: parent.getType()
                                children: []
                                pos: 3467
                                length: 16
                              right:
                                type: field_access
                                fields:
                                  text: Token.ASSIGN
                                children: []
                                pos: 3487
                                length: 12
                            children: []
                            pos: 3467
                            length: 32
                        children: []
                        pos: 3449
                        length: 50
                    children: []
                    pos: 3448
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Node lhs = parent.getFirstChild();
                    children: []
                    pos: 3509
                    length: 34
                  - type: local_variable_declaration
                    fields:
                      text: Node rhs = lhs.getNext();
                    children: []
                    pos: 3550
                    length: 25
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: "n"
                                children: []
                                pos: 3593
                                length: 1
                              right:
                                type: identifier
                                fields:
                                  text: lhs
                                children: []
                                pos: 3598
                                length: 3
                            children: []
                            pos: 3593
                            length: 8
                        children: []
                        pos: 3592
                        length: 10
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: assignLhsChild
                                    children: []
                                    pos: 3812
                                    length: 14
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 3830
                                    length: 4
                                children: []
                                pos: 3812
                                length: 22
                            children: []
                            pos: 3811
                            length: 24
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: assignLhsChild = lhs;
                            children: []
                            pos: 3848
                            length: 21
                          pos: 3836
                          length: 43
                        pos: 3808
                        length: 71
                      pos: 3603
                      length: 284
                    pos: 3589
                    length: 752
                  pos: 3501
                  length: 846
                pos: 3445
                length: 902
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 4353
                length: 12
              pos: 2693
              length: 1676
          children: []
          pos: 2625
          length: 1744
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: visit
              children: []
              pos: 4385
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 4391
                length: 15
              pos: 4373
              length: 260
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: n.getType()
                                children: []
                                pos: 4439
                                length: 11
                              right:
                                type: field_access
                                fields:
                                  text: Token.THIS
                                children: []
                                pos: 4454
                                length: 10
                            children: []
                            pos: 4439
                            length: 25
                          right:
                            type: method_invocation
                            fields:
                              text: shouldReportThis(n, parent)
                            children: []
                            pos: 4468
                            length: 27
                        children: []
                        pos: 4439
                        length: 56
                    children: []
                    pos: 4438
                    length: 58
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: compiler.report(t.makeError(n, level, GLOBAL_THIS));
                    children: []
                    pos: 4505
                    length: 52
                  pos: 4497
                  length: 66
                pos: 4435
                length: 128
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: "n"
                            children: []
                            pos: 4572
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: assignLhsChild
                            children: []
                            pos: 4577
                            length: 14
                        children: []
                        pos: 4572
                        length: 19
                    children: []
                    pos: 4571
                    length: 21
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: assignLhsChild = null;
                    children: []
                    pos: 4601
                    length: 22
                  pos: 4593
                  length: 36
                pos: 4568
                length: 61
              pos: 4429
              length: 204
          children: []
          pos: 4373
          length: 260
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldReportThis
              children: []
              pos: 4653
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 4670
                length: 6
              pos: 4637
              length: 283
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: assignLhsChild
                            children: []
                            pos: 4701
                            length: 14
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4719
                            length: 4
                        children: []
                        pos: 4701
                        length: 22
                    children: []
                    pos: 4700
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return true;
                    children: []
                    pos: 4794
                    length: 12
                  pos: 4725
                  length: 87
                pos: 4697
                length: 115
              - type: return_statement
                fields:
                  text: return parent != null && NodeUtil.isGet(parent);
                children: []
                pos: 4868
                length: 48
              pos: 4691
              length: 229
          children: []
          pos: 4637
          length: 283
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getFunctionJsDocInfo
              children: []
              pos: 5218
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 5239
                length: 6
              pos: 5200
              length: 543
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSDocInfo jsDoc = n.getJSDocInfo();
                children: []
                pos: 5253
                length: 35
              - type: local_variable_declaration
                fields:
                  text: Node parent = n.getParent();
                children: []
                pos: 5293
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: jsDoc
                            children: []
                            pos: 5330
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5339
                            length: 4
                        children: []
                        pos: 5330
                        length: 13
                    children: []
                    pos: 5329
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: int parentType = parent.getType();
                    children: []
                    pos: 5353
                    length: 34
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: parentType
                                    children: []
                                    pos: 5398
                                    length: 10
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.NAME
                                    children: []
                                    pos: 5412
                                    length: 10
                                children: []
                                pos: 5398
                                length: 24
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: parentType
                                    children: []
                                    pos: 5426
                                    length: 10
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.ASSIGN
                                    children: []
                                    pos: 5440
                                    length: 12
                                children: []
                                pos: 5426
                                length: 26
                            children: []
                            pos: 5398
                            length: 54
                        children: []
                        pos: 5397
                        length: 56
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: jsDoc = parent.getJSDocInfo();
                        children: []
                        pos: 5464
                        length: 30
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: jsDoc
                                        children: []
                                        pos: 5507
                                        length: 5
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 5516
                                        length: 4
                                    children: []
                                    pos: 5507
                                    length: 13
                                  right:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: parentType
                                        children: []
                                        pos: 5524
                                        length: 10
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.NAME
                                        children: []
                                        pos: 5538
                                        length: 10
                                    children: []
                                    pos: 5524
                                    length: 24
                                children: []
                                pos: 5507
                                length: 41
                            children: []
                            pos: 5506
                            length: 43
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: Node gramps = parent.getParent();
                            children: []
                            pos: 5562
                            length: 33
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: gramps.getType()
                                        children: []
                                        pos: 5610
                                        length: 16
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.VAR
                                        children: []
                                        pos: 5630
                                        length: 9
                                    children: []
                                    pos: 5610
                                    length: 29
                                children: []
                                pos: 5609
                                length: 31
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: jsDoc = gramps.getJSDocInfo();
                                children: []
                                pos: 5655
                                length: 30
                              pos: 5641
                              length: 56
                            pos: 5606
                            length: 91
                          pos: 5550
                          length: 157
                        pos: 5503
                        length: 204
                      pos: 5454
                      length: 261
                    pos: 5394
                    length: 321
                  pos: 5345
                  length: 376
                pos: 5326
                length: 395
              - type: return_statement
                fields:
                  text: return jsDoc;
                children: []
                pos: 5726
                length: 13
              pos: 5247
              length: 496
          children: []
          pos: 5200
          length: 543
        pos: 1826
        length: 3919
    children: []
    pos: 1826
    length: 3919
  pos: 0
  length: 5746
after_tree:
  type: program
  fields: {}
  children:
  - type: class_declaration
    fields:
      name:
        type: identifier
        fields:
          text: CheckGlobalThis
        children: []
        pos: 1838
        length: 15
      body:
        type: class_body
        fields: {}
        children:
        - type: field_declaration
          fields:
            text: |-
              static final DiagnosticType GLOBAL_THIS = DiagnosticType.warning(
                    "JSC_USED_GLOBAL_THIS",
                    "dangerous use of the global 'this' object");
          children: []
          pos: 1879
          length: 147
        - type: field_declaration
          fields:
            text: private final AbstractCompiler compiler;
          children: []
          pos: 2030
          length: 40
        - type: field_declaration
          fields:
            text: private final CheckLevel level;
          children: []
          pos: 2073
          length: 31
        - type: field_declaration
          fields:
            text: private Node assignLhsChild = null;
          children: []
          pos: 2301
          length: 35
        - type: constructor_declaration
          fields:
            text: |-
              CheckGlobalThis(AbstractCompiler compiler, CheckLevel level) {
                  this.compiler = compiler;
                  this.level = level;
                }
          children: []
          pos: 2340
          length: 120
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldTraverse
              children: []
              pos: 2640
              length: 14
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 2655
                length: 15
              pos: 2625
              length: 1532
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: method_invocation
                            fields:
                              text: n.getType()
                            children: []
                            pos: 2704
                            length: 11
                          right:
                            type: field_access
                            fields:
                              text: Token.FUNCTION
                            children: []
                            pos: 2719
                            length: 14
                        children: []
                        pos: 2704
                        length: 29
                    children: []
                    pos: 2703
                    length: 31
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: JSDocInfo jsDoc = getFunctionJsDocInfo(n);
                    children: []
                    pos: 2838
                    length: 42
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: and
                            fields:
                              left:
                                type: not_equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: jsDoc
                                    children: []
                                    pos: 2891
                                    length: 5
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 2900
                                    length: 4
                                children: []
                                pos: 2891
                                length: 13
                              right:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: or
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: jsDoc.isConstructor()
                                        children: []
                                        pos: 2909
                                        length: 21
                                      right:
                                        type: method_invocation
                                        fields:
                                          text: jsDoc.hasThisType()
                                        children: []
                                        pos: 2934
                                        length: 19
                                    children: []
                                    pos: 2909
                                    length: 44
                                children: []
                                pos: 2908
                                length: 46
                            children: []
                            pos: 2891
                            length: 63
                        children: []
                        pos: 2890
                        length: 65
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: return_statement
                        fields:
                          text: return false;
                        children: []
                        pos: 2966
                        length: 13
                      pos: 2956
                      length: 31
                    pos: 2887
                    length: 100
                  pos: 2735
                  length: 492
                pos: 2700
                length: 527
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: not_equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: parent
                                children: []
                                pos: 3237
                                length: 6
                              right:
                                type: null_literal
                                fields: {}
                                children: []
                                pos: 3247
                                length: 4
                            children: []
                            pos: 3237
                            length: 14
                          right:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: parent.getType()
                                children: []
                                pos: 3255
                                length: 16
                              right:
                                type: field_access
                                fields:
                                  text: Token.ASSIGN
                                children: []
                                pos: 3275
                                length: 12
                            children: []
                            pos: 3255
                            length: 32
                        children: []
                        pos: 3237
                        length: 50
                    children: []
                    pos: 3236
                    length: 52
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: Node lhs = parent.getFirstChild();
                    children: []
                    pos: 3297
                    length: 34
                  - type: local_variable_declaration
                    fields:
                      text: Node rhs = lhs.getNext();
                    children: []
                    pos: 3338
                    length: 25
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: equals
                            fields:
                              left:
                                type: identifier
                                fields:
                                  text: "n"
                                children: []
                                pos: 3381
                                length: 1
                              right:
                                type: identifier
                                fields:
                                  text: lhs
                                children: []
                                pos: 3386
                                length: 3
                            children: []
                            pos: 3381
                            length: 8
                        children: []
                        pos: 3380
                        length: 10
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: assignLhsChild
                                    children: []
                                    pos: 3600
                                    length: 14
                                  right:
                                    type: null_literal
                                    fields: {}
                                    children: []
                                    pos: 3618
                                    length: 4
                                children: []
                                pos: 3600
                                length: 22
                            children: []
                            pos: 3599
                            length: 24
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: expression_statement
                            fields:
                              text: assignLhsChild = lhs;
                            children: []
                            pos: 3636
                            length: 21
                          pos: 3624
                          length: 43
                        pos: 3596
                        length: 71
                      pos: 3391
                      length: 284
                    pos: 3377
                    length: 752
                  pos: 3289
                  length: 846
                pos: 3233
                length: 902
              - type: return_statement
                fields:
                  text: return true;
                children: []
                pos: 4141
                length: 12
              pos: 2693
              length: 1464
          children: []
          pos: 2625
          length: 1532
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: visit
              children: []
              pos: 4173
              length: 5
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: NodeTraversal t
                children: []
                pos: 4179
                length: 15
              pos: 4161
              length: 260
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: and
                        fields:
                          left:
                            type: equals
                            fields:
                              left:
                                type: method_invocation
                                fields:
                                  text: n.getType()
                                children: []
                                pos: 4227
                                length: 11
                              right:
                                type: field_access
                                fields:
                                  text: Token.THIS
                                children: []
                                pos: 4242
                                length: 10
                            children: []
                            pos: 4227
                            length: 25
                          right:
                            type: method_invocation
                            fields:
                              text: shouldReportThis(n, parent)
                            children: []
                            pos: 4256
                            length: 27
                        children: []
                        pos: 4227
                        length: 56
                    children: []
                    pos: 4226
                    length: 58
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: compiler.report(t.makeError(n, level, GLOBAL_THIS));
                    children: []
                    pos: 4293
                    length: 52
                  pos: 4285
                  length: 66
                pos: 4223
                length: 128
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: "n"
                            children: []
                            pos: 4360
                            length: 1
                          right:
                            type: identifier
                            fields:
                              text: assignLhsChild
                            children: []
                            pos: 4365
                            length: 14
                        children: []
                        pos: 4360
                        length: 19
                    children: []
                    pos: 4359
                    length: 21
                children:
                - type: block
                  fields: {}
                  children:
                  - type: expression_statement
                    fields:
                      text: assignLhsChild = null;
                    children: []
                    pos: 4389
                    length: 22
                  pos: 4381
                  length: 36
                pos: 4356
                length: 61
              pos: 4217
              length: 204
          children: []
          pos: 4161
          length: 260
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: shouldReportThis
              children: []
              pos: 4441
              length: 16
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 4458
                length: 6
              pos: 4425
              length: 248
            body:
              type: block
              fields: {}
              children:
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: not_equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: assignLhsChild
                            children: []
                            pos: 4489
                            length: 14
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 4507
                            length: 4
                        children: []
                        pos: 4489
                        length: 22
                    children: []
                    pos: 4488
                    length: 24
                children:
                - type: block
                  fields: {}
                  children:
                  - type: return_statement
                    fields:
                      text: return true;
                    children: []
                    pos: 4582
                    length: 12
                  pos: 4513
                  length: 87
                pos: 4485
                length: 115
              - type: return_statement
                fields:
                  text: return false;
                children: []
                pos: 4656
                length: 13
              pos: 4479
              length: 194
          children: []
          pos: 4425
          length: 248
        - type: method_declaration
          fields:
            name:
              type: identifier
              fields:
                text: getFunctionJsDocInfo
              children: []
              pos: 4971
              length: 20
            parameters:
              type: method_parameters
              fields: {}
              children:
              - type: formal_parameter
                fields:
                  text: Node n
                children: []
                pos: 4992
                length: 6
              pos: 4953
              length: 543
            body:
              type: block
              fields: {}
              children:
              - type: local_variable_declaration
                fields:
                  text: JSDocInfo jsDoc = n.getJSDocInfo();
                children: []
                pos: 5006
                length: 35
              - type: local_variable_declaration
                fields:
                  text: Node parent = n.getParent();
                children: []
                pos: 5046
                length: 28
              - type: if_statement
                fields:
                  condition:
                    type: parenthesized_expression
                    fields:
                      expression:
                        type: equals
                        fields:
                          left:
                            type: identifier
                            fields:
                              text: jsDoc
                            children: []
                            pos: 5083
                            length: 5
                          right:
                            type: null_literal
                            fields: {}
                            children: []
                            pos: 5092
                            length: 4
                        children: []
                        pos: 5083
                        length: 13
                    children: []
                    pos: 5082
                    length: 15
                children:
                - type: block
                  fields: {}
                  children:
                  - type: local_variable_declaration
                    fields:
                      text: int parentType = parent.getType();
                    children: []
                    pos: 5106
                    length: 34
                  - type: if_statement
                    fields:
                      condition:
                        type: parenthesized_expression
                        fields:
                          expression:
                            type: or
                            fields:
                              left:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: parentType
                                    children: []
                                    pos: 5151
                                    length: 10
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.NAME
                                    children: []
                                    pos: 5165
                                    length: 10
                                children: []
                                pos: 5151
                                length: 24
                              right:
                                type: equals
                                fields:
                                  left:
                                    type: identifier
                                    fields:
                                      text: parentType
                                    children: []
                                    pos: 5179
                                    length: 10
                                  right:
                                    type: field_access
                                    fields:
                                      text: Token.ASSIGN
                                    children: []
                                    pos: 5193
                                    length: 12
                                children: []
                                pos: 5179
                                length: 26
                            children: []
                            pos: 5151
                            length: 54
                        children: []
                        pos: 5150
                        length: 56
                    children:
                    - type: block
                      fields: {}
                      children:
                      - type: expression_statement
                        fields:
                          text: jsDoc = parent.getJSDocInfo();
                        children: []
                        pos: 5217
                        length: 30
                      - type: if_statement
                        fields:
                          condition:
                            type: parenthesized_expression
                            fields:
                              expression:
                                type: and
                                fields:
                                  left:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: jsDoc
                                        children: []
                                        pos: 5260
                                        length: 5
                                      right:
                                        type: null_literal
                                        fields: {}
                                        children: []
                                        pos: 5269
                                        length: 4
                                    children: []
                                    pos: 5260
                                    length: 13
                                  right:
                                    type: equals
                                    fields:
                                      left:
                                        type: identifier
                                        fields:
                                          text: parentType
                                        children: []
                                        pos: 5277
                                        length: 10
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.NAME
                                        children: []
                                        pos: 5291
                                        length: 10
                                    children: []
                                    pos: 5277
                                    length: 24
                                children: []
                                pos: 5260
                                length: 41
                            children: []
                            pos: 5259
                            length: 43
                        children:
                        - type: block
                          fields: {}
                          children:
                          - type: local_variable_declaration
                            fields:
                              text: Node gramps = parent.getParent();
                            children: []
                            pos: 5315
                            length: 33
                          - type: if_statement
                            fields:
                              condition:
                                type: parenthesized_expression
                                fields:
                                  expression:
                                    type: equals
                                    fields:
                                      left:
                                        type: method_invocation
                                        fields:
                                          text: gramps.getType()
                                        children: []
                                        pos: 5363
                                        length: 16
                                      right:
                                        type: field_access
                                        fields:
                                          text: Token.VAR
                                        children: []
                                        pos: 5383
                                        length: 9
                                    children: []
                                    pos: 5363
                                    length: 29
                                children: []
                                pos: 5362
                                length: 31
                            children:
                            - type: block
                              fields: {}
                              children:
                              - type: expression_statement
                                fields:
                                  text: jsDoc = gramps.getJSDocInfo();
                                children: []
                                pos: 5408
                                length: 30
                              pos: 5394
                              length: 56
                            pos: 5359
                            length: 91
                          pos: 5303
                          length: 157
                        pos: 5256
                        length: 204
                      pos: 5207
                      length: 261
                    pos: 5147
                    length: 321
                  pos: 5098
                  length: 376
                pos: 5079
                length: 395
              - type: return_statement
                fields:
                  text: return jsDoc;
                children: []
                pos: 5479
                length: 13
              pos: 5000
              length: 496
          children: []
          pos: 4953
          length: 543
        pos: 1826
        length: 3672
    children: []
    pos: 1826
    length: 3672
  pos: 0
  length: 5499
text_diff: "--- before\n+++ after\n@@ -96,13 +96,6 @@\n       // var a = function()
  { }; // or\n       // function a() {} // or\n       // a.x = function() {};\n-      int
  pType = parent.getType();\n-      if (!(pType == Token.BLOCK ||\n-            pType
  == Token.SCRIPT ||\n-            pType == Token.NAME ||\n-            pType == Token.ASSIGN))
  {\n-        return false;\n-      }\n     }\n \n     if (parent != null && parent.getType()
  == Token.ASSIGN) {\n@@ -150,7 +143,7 @@\n     }\n \n     // Also report a THIS with
  a property access.\n-    return parent != null && NodeUtil.isGet(parent);\n+    return
  false;\n   }\n \n   /**\n"
tree_diff: |+
  New cluster:
  UPDATE from return parent != null && NodeUtil.isGet(parent); to return false;
  ------------
  ===
  update-node
  ---
  return_statement: return parent != null && NodeUtil.isGet(parent); [4868,4916]
  replace return parent != null && NodeUtil.isGet(parent); by return false;

  New cluster:
  ===
  delete-node
  ---
  local_variable_declaration: int pType = parent.getType(); [3228,3257]
  ===
  ------------
  ===
  delete-node
  ---
  local_variable_declaration: int pType = parent.getType(); [3228,3257]
  ===

  New cluster:
  Unknown cluster type
  ------------
  ===
  delete-tree
  ---
  if_statement [3264,3433]
      parenthesized_expression [3267,3401]
          unary_expression: !(pType == Token.BLOCK ||
              pType == Token.SCRIPT ||
              pType == Token.NAME ||
              pType == Token.ASSIGN) [3268,3400]
      block [3402,3433]
          return_statement: return false; [3412,3425]

...
